var background=(function(){"use strict";(function(){try{var Le=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};Le.SENTRY_RELEASE={id:"384410028dc6aac75eb61d6b08dc7127d516d4af"}}catch{}})();try{(function(){var Le=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},Et=new Le.Error().stack;Et&&(Le._sentryDebugIds=Le._sentryDebugIds||{},Le._sentryDebugIds[Et]="a2b0eee6-adf4-4975-b039-b69f692b3787",Le._sentryDebugIdIdentifier="sentry-dbid-a2b0eee6-adf4-4975-b039-b69f692b3787")})()}catch{}function Le(e){return e==null||typeof e=="function"?{main:e}:e}const Et={small:512,medium:768,large:1028};class tt{static instance=null;constructor(){}static getInstance(){return tt.instance||(tt.instance=new tt),tt.instance}async getInteractiveSnapshot(t,r){return new Promise((n,o)=>{const s=a=>{chrome.runtime.lastError?o(new Error(chrome.runtime.lastError.message||"Unknown error")):n(a)};r?chrome.browserOS.getInteractiveSnapshot(t,r,s):chrome.browserOS.getInteractiveSnapshot(t,s)})}async click(t,r){return new Promise((n,o)=>{chrome.browserOS.click(t,r,()=>{chrome.runtime.lastError?o(new Error(chrome.runtime.lastError.message||"Unknown error")):n()})})}async inputText(t,r,n){return new Promise((o,s)=>{chrome.browserOS.inputText(t,r,n,()=>{chrome.runtime.lastError?s(new Error(chrome.runtime.lastError.message||"Unknown error")):o()})})}async clear(t,r){return new Promise((n,o)=>{chrome.browserOS.clear(t,r,()=>{chrome.runtime.lastError?o(new Error(chrome.runtime.lastError.message||"Unknown error")):n()})})}async scrollToNode(t,r){return new Promise((n,o)=>{chrome.browserOS.scrollToNode(t,r,s=>{chrome.runtime.lastError?o(new Error(chrome.runtime.lastError.message||"Unknown error")):n(s)})})}async sendKeys(t,r){return new Promise((n,o)=>{chrome.browserOS.sendKeys(t,r,()=>{chrome.runtime.lastError?o(new Error(chrome.runtime.lastError.message||"Unknown error")):n()})})}async getPageLoadStatus(t){return new Promise((r,n)=>{chrome.browserOS.getPageLoadStatus(t,o=>{chrome.runtime.lastError?n(new Error(chrome.runtime.lastError.message||"Unknown error")):r(o)})})}async getAccessibilityTree(t){return new Promise((r,n)=>{chrome.browserOS.getAccessibilityTree(t,o=>{chrome.runtime.lastError?n(new Error(chrome.runtime.lastError.message||"Unknown error")):r(o)})})}async captureScreenshot(t,r,n,o,s){return new Promise((a,i)=>{const c=m=>{chrome.runtime.lastError?i(new Error(chrome.runtime.lastError.message||"Unknown error")):a(m)};if(o!==void 0&&s!==void 0)chrome.browserOS.captureScreenshot(t,0,n||!1,o,s,c);else if(r!==void 0||n!==void 0){const m=r?Et[r]:0;n!==void 0?chrome.browserOS.captureScreenshot(t,m,n,c):chrome.browserOS.captureScreenshot(t,m,c)}else chrome.browserOS.captureScreenshot(t,c)})}async getSnapshot(t,r){return new Promise((n,o)=>{const s=a=>{chrome.runtime.lastError?o(new Error(chrome.runtime.lastError.message||"Unknown error")):n(a)};r?chrome.browserOS.getSnapshot(t,r,s):chrome.browserOS.getSnapshot(t,s)})}async getVersion(){return new Promise((t,r)=>{if(typeof chrome.browserOS.getVersionNumber!="function"){t(null);return}chrome.browserOS.getVersionNumber(n=>{chrome.runtime.lastError?r(new Error(chrome.runtime.lastError.message||"Unknown error")):t(n)})})}async getBrowserosVersion(){return new Promise((t,r)=>{if(typeof chrome.browserOS.getBrowserosVersionNumber!="function"){t(null);return}chrome.browserOS.getBrowserosVersionNumber(n=>{chrome.runtime.lastError?r(new Error(chrome.runtime.lastError.message||"Unknown error")):t(n)})})}async logMetric(t,r){if(typeof chrome.browserOS.logMetric=="function")return new Promise((n,o)=>{const s=()=>{chrome.runtime.lastError?o(new Error(chrome.runtime.lastError.message||"Unknown error")):n()};r?chrome.browserOS.logMetric(t,r,s):chrome.browserOS.logMetric(t,s)})}async executeJavaScript(t,r){if(typeof chrome.browserOS.executeJavaScript!="function")throw new Error("executeJavaScript API not available");return new Promise((n,o)=>{chrome.browserOS.executeJavaScript(t,r,s=>{chrome.runtime.lastError?o(new Error(chrome.runtime.lastError.message||"Unknown error")):n(s)})})}async clickCoordinates(t,r,n){if(typeof chrome.browserOS.clickCoordinates!="function")throw new Error("clickCoordinates API not available");return new Promise((o,s)=>{chrome.browserOS.clickCoordinates(t,r,n,()=>{chrome.runtime.lastError?s(new Error(chrome.runtime.lastError.message||"Unknown error")):o()})})}async typeAtCoordinates(t,r,n,o){if(typeof chrome.browserOS.typeAtCoordinates!="function")throw new Error("typeAtCoordinates API not available");return new Promise((s,a)=>{chrome.browserOS.typeAtCoordinates(t,r,n,o,()=>{chrome.runtime.lastError?a(new Error(chrome.runtime.lastError.message||"Unknown error")):s()})})}async getPref(t){if(typeof chrome.browserOS?.getPref!="function")throw new Error("getPref API not available");return new Promise((r,n)=>{chrome.browserOS.getPref(t,o=>{chrome.runtime.lastError?n(new Error(chrome.runtime.lastError.message||"Unknown error")):r(o)})})}async setPref(t,r,n){if(typeof chrome.browserOS?.setPref!="function")throw new Error("setPref API not available");return new Promise((o,s)=>{const a=i=>{chrome.runtime.lastError?s(new Error(chrome.runtime.lastError.message||"Unknown error")):o(i)};n!==void 0?chrome.browserOS.setPref(t,r,n,a):chrome.browserOS.setPref(t,r,a)})}async getAllPrefs(){if(typeof chrome.browserOS?.getAllPrefs!="function")throw new Error("getAllPrefs API not available");return new Promise((t,r)=>{chrome.browserOS.getAllPrefs(n=>{chrome.runtime.lastError?r(new Error(chrome.runtime.lastError.message||"Unknown error")):t(n)})})}isAPIAvailable(t){return t in chrome.browserOS}getAvailableAPIs(){return Object.keys(chrome.browserOS).filter(t=>typeof chrome.browserOS[t]=="function")}}const Ao=()=>tt.getInstance(),rc={OPENAI_COMPATIBLE_SUPPORT:{minVersion:"0.33.0.1"},MANAGED_MCP_SUPPORT:{minVersion:"0.34.0.0"}};function on(e){const t=e.split(".").map(Number);if(t.length!==4||t.some(Number.isNaN))throw new Error(`Invalid version format: ${e}`);return t}function Ro(e,t){for(let r=0;r<4;r++){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1}return 0}let rt=null,Pt=!1;const nc={async initialize(){if(!Pt){try{const t=await tt.getInstance().getBrowserosVersion();t&&(rt=on(t))}catch{}Pt=!0}},supports(e){if(!Pt)throw new Error("Capabilities.initialize() must be called before supports()");if(!rt)return!1;const t=rc[e];if(!t)return!1;if(t.minVersion){const r=on(t.minVersion);if(Ro(rt,r)<0)return!1}if(t.maxVersion){const r=on(t.maxVersion);if(Ro(rt,r)>=0)return!1}return!0},getOsVersion(){return rt?rt.join("."):null},isInitialized(){return Pt},reset(){rt=null,Pt=!1}},oc=Object.freeze({status:"aborted"});function z(e,t,r){function n(i,c){if(i._zod||Object.defineProperty(i,"_zod",{value:{def:c,constr:a,traits:new Set},enumerable:!1}),i._zod.traits.has(e))return;i._zod.traits.add(e),t(i,c);const m=a.prototype,h=Object.keys(m);for(let b=0;b<h.length;b++){const y=h[b];y in i||(i[y]=m[y].bind(i))}}const o=r?.Parent??Object;class s extends o{}Object.defineProperty(s,"name",{value:e});function a(i){var c;const m=r?.Parent?new s:this;n(m,i),(c=m._zod).deferred??(c.deferred=[]);for(const h of m._zod.deferred)h();return m}return Object.defineProperty(a,"init",{value:n}),Object.defineProperty(a,Symbol.hasInstance,{value:i=>r?.Parent&&i instanceof r.Parent?!0:i?._zod?.traits?.has(e)}),Object.defineProperty(a,"name",{value:e}),a}class lt extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class Io extends Error{constructor(t){super(`Encountered unidirectional transform during encode: ${t}`),this.name="ZodEncodeError"}}const Oo={};function Ge(e){return Oo}function sc(e){const t=Object.values(e).filter(n=>typeof n=="number");return Object.entries(e).filter(([n,o])=>t.indexOf(+n)===-1).map(([n,o])=>o)}function sn(e,t){return typeof t=="bigint"?t.toString():t}function Ut(e){return{get value(){{const t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function an(e){return e==null}function cn(e){const t=e.startsWith("^")?1:0,r=e.endsWith("$")?e.length-1:e.length;return e.slice(t,r)}function ac(e,t){const r=(e.toString().split(".")[1]||"").length,n=t.toString();let o=(n.split(".")[1]||"").length;if(o===0&&/\d?e-\d?/.test(n)){const c=n.match(/\d?e-(\d?)/);c?.[1]&&(o=Number.parseInt(c[1]))}const s=r>o?r:o,a=Number.parseInt(e.toFixed(s).replace(".","")),i=Number.parseInt(t.toFixed(s).replace(".",""));return a%i/10**s}const Co=Symbol("evaluating");function de(e,t,r){let n;Object.defineProperty(e,t,{get(){if(n!==Co)return n===void 0&&(n=Co,n=r()),n},set(o){Object.defineProperty(e,t,{value:o})},configurable:!0})}function nt(e,t,r){Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0})}function ot(...e){const t={};for(const r of e){const n=Object.getOwnPropertyDescriptors(r);Object.assign(t,n)}return Object.defineProperties({},t)}function No(e){return JSON.stringify(e)}function ic(e){return e.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}const zo="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function Tt(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}const cc=Ut(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const e=Function;return new e(""),!0}catch{return!1}});function dt(e){if(Tt(e)===!1)return!1;const t=e.constructor;if(t===void 0||typeof t!="function")return!0;const r=t.prototype;return!(Tt(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}function jo(e){return dt(e)?{...e}:Array.isArray(e)?[...e]:e}const uc=new Set(["string","number","symbol"]);function ft(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Je(e,t,r){const n=new e._zod.constr(t??e._zod.def);return(!t||r?.parent)&&(n._zod.parent=e),n}function K(e){const t=e;if(!t)return{};if(typeof t=="string")return{error:()=>t};if(t?.message!==void 0){if(t?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,typeof t.error=="string"?{...t,error:()=>t.error}:t}function lc(e){return Object.keys(e).filter(t=>e[t]._zod.optin==="optional"&&e[t]._zod.optout==="optional")}const dc={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function fc(e,t){const r=e._zod.def,n=ot(e._zod.def,{get shape(){const o={};for(const s in t){if(!(s in r.shape))throw new Error(`Unrecognized key: "${s}"`);t[s]&&(o[s]=r.shape[s])}return nt(this,"shape",o),o},checks:[]});return Je(e,n)}function hc(e,t){const r=e._zod.def,n=ot(e._zod.def,{get shape(){const o={...e._zod.def.shape};for(const s in t){if(!(s in r.shape))throw new Error(`Unrecognized key: "${s}"`);t[s]&&delete o[s]}return nt(this,"shape",o),o},checks:[]});return Je(e,n)}function mc(e,t){if(!dt(t))throw new Error("Invalid input to extend: expected a plain object");const r=e._zod.def.checks;if(r&&r.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const o=ot(e._zod.def,{get shape(){const s={...e._zod.def.shape,...t};return nt(this,"shape",s),s},checks:[]});return Je(e,o)}function pc(e,t){if(!dt(t))throw new Error("Invalid input to safeExtend: expected a plain object");const r={...e._zod.def,get shape(){const n={...e._zod.def.shape,...t};return nt(this,"shape",n),n},checks:e._zod.def.checks};return Je(e,r)}function gc(e,t){const r=ot(e._zod.def,{get shape(){const n={...e._zod.def.shape,...t._zod.def.shape};return nt(this,"shape",n),n},get catchall(){return t._zod.def.catchall},checks:[]});return Je(e,r)}function _c(e,t,r){const n=ot(t._zod.def,{get shape(){const o=t._zod.def.shape,s={...o};if(r)for(const a in r){if(!(a in o))throw new Error(`Unrecognized key: "${a}"`);r[a]&&(s[a]=e?new e({type:"optional",innerType:o[a]}):o[a])}else for(const a in o)s[a]=e?new e({type:"optional",innerType:o[a]}):o[a];return nt(this,"shape",s),s},checks:[]});return Je(t,n)}function vc(e,t,r){const n=ot(t._zod.def,{get shape(){const o=t._zod.def.shape,s={...o};if(r)for(const a in r){if(!(a in s))throw new Error(`Unrecognized key: "${a}"`);r[a]&&(s[a]=new e({type:"nonoptional",innerType:o[a]}))}else for(const a in o)s[a]=new e({type:"nonoptional",innerType:o[a]});return nt(this,"shape",s),s},checks:[]});return Je(t,n)}function ht(e,t=0){if(e.aborted===!0)return!0;for(let r=t;r<e.issues.length;r++)if(e.issues[r]?.continue!==!0)return!0;return!1}function mt(e,t){return t.map(r=>{var n;return(n=r).path??(n.path=[]),r.path.unshift(e),r})}function Dt(e){return typeof e=="string"?e:e?.message}function Ye(e,t,r){const n={...e,path:e.path??[]};if(!e.message){const o=Dt(e.inst?._zod.def?.error?.(e))??Dt(t?.error?.(e))??Dt(r.customError?.(e))??Dt(r.localeError?.(e))??"Invalid input";n.message=o}return delete n.inst,delete n.continue,t?.reportInput||delete n.input,n}function un(e){return Array.isArray(e)?"array":typeof e=="string"?"string":"unknown"}function At(...e){const[t,r,n]=e;return typeof t=="string"?{message:t,code:"custom",input:r,inst:n}:{...t}}const qo=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),e.message=JSON.stringify(t,sn,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},Mo=z("$ZodError",qo),xo=z("$ZodError",qo,{Parent:Error});function yc(e,t=r=>r.message){const r={},n=[];for(const o of e.issues)o.path.length>0?(r[o.path[0]]=r[o.path[0]]||[],r[o.path[0]].push(t(o))):n.push(t(o));return{formErrors:n,fieldErrors:r}}function wc(e,t=r=>r.message){const r={_errors:[]},n=o=>{for(const s of o.issues)if(s.code==="invalid_union"&&s.errors.length)s.errors.map(a=>n({issues:a}));else if(s.code==="invalid_key")n({issues:s.issues});else if(s.code==="invalid_element")n({issues:s.issues});else if(s.path.length===0)r._errors.push(t(s));else{let a=r,i=0;for(;i<s.path.length;){const c=s.path[i];i===s.path.length-1?(a[c]=a[c]||{_errors:[]},a[c]._errors.push(t(s))):a[c]=a[c]||{_errors:[]},a=a[c],i++}}};return n(e),r}const ln=e=>(t,r,n,o)=>{const s=n?Object.assign(n,{async:!1}):{async:!1},a=t._zod.run({value:r,issues:[]},s);if(a instanceof Promise)throw new lt;if(a.issues.length){const i=new(o?.Err??e)(a.issues.map(c=>Ye(c,s,Ge())));throw zo(i,o?.callee),i}return a.value},dn=e=>async(t,r,n,o)=>{const s=n?Object.assign(n,{async:!0}):{async:!0};let a=t._zod.run({value:r,issues:[]},s);if(a instanceof Promise&&(a=await a),a.issues.length){const i=new(o?.Err??e)(a.issues.map(c=>Ye(c,s,Ge())));throw zo(i,o?.callee),i}return a.value},Vt=e=>(t,r,n)=>{const o=n?{...n,async:!1}:{async:!1},s=t._zod.run({value:r,issues:[]},o);if(s instanceof Promise)throw new lt;return s.issues.length?{success:!1,error:new(e??Mo)(s.issues.map(a=>Ye(a,o,Ge())))}:{success:!0,data:s.value}},Uo=Vt(xo),Zt=e=>async(t,r,n)=>{const o=n?Object.assign(n,{async:!0}):{async:!0};let s=t._zod.run({value:r,issues:[]},o);return s instanceof Promise&&(s=await s),s.issues.length?{success:!1,error:new e(s.issues.map(a=>Ye(a,o,Ge())))}:{success:!0,data:s.value}},bc=Zt(xo),$c=e=>(t,r,n)=>{const o=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return ln(e)(t,r,o)},kc=e=>(t,r,n)=>ln(e)(t,r,n),Sc=e=>async(t,r,n)=>{const o=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return dn(e)(t,r,o)},Ec=e=>async(t,r,n)=>dn(e)(t,r,n),Pc=e=>(t,r,n)=>{const o=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return Vt(e)(t,r,o)},Tc=e=>(t,r,n)=>Vt(e)(t,r,n),Ac=e=>async(t,r,n)=>{const o=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return Zt(e)(t,r,o)},Rc=e=>async(t,r,n)=>Zt(e)(t,r,n),Ic=/^[cC][^\s-]{8,}$/,Oc=/^[0-9a-z]+$/,Cc=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,Nc=/^[0-9a-vA-V]{20}$/,zc=/^[A-Za-z0-9]{27}$/,jc=/^[a-zA-Z0-9_-]{21}$/,qc=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,Mc=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Do=e=>e?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,xc=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,Uc="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function Dc(){return new RegExp(Uc,"u")}const Vc=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Zc=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,Lc=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,Fc=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Hc=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,Vo=/^[A-Za-z0-9_-]*$/,Kc=/^\+(?:[0-9]){6,14}[0-9]$/,Zo="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",Wc=new RegExp(`^${Zo}$`);function Lo(e){const t="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof e.precision=="number"?e.precision===-1?`${t}`:e.precision===0?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function Bc(e){return new RegExp(`^${Lo(e)}$`)}function Gc(e){const t=Lo({precision:e.precision}),r=["Z"];e.local&&r.push(""),e.offset&&r.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const n=`${t}(?:${r.join("|")})`;return new RegExp(`^${Zo}T(?:${n})$`)}const Jc=e=>{const t=e?`[\\s\\S]{${e?.minimum??0},${e?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${t}$`)},Yc=/^-?\d+$/,Qc=/^-?\d+(?:\.\d+)?/,Xc=/^(?:true|false)$/i,eu=/^null$/i,tu=/^[^A-Z]*$/,ru=/^[^a-z]*$/,Oe=z("$ZodCheck",(e,t)=>{var r;e._zod??(e._zod={}),e._zod.def=t,(r=e._zod).onattach??(r.onattach=[])}),Fo={number:"number",bigint:"bigint",object:"date"},Ho=z("$ZodCheckLessThan",(e,t)=>{Oe.init(e,t);const r=Fo[typeof t.value];e._zod.onattach.push(n=>{const o=n._zod.bag,s=(t.inclusive?o.maximum:o.exclusiveMaximum)??Number.POSITIVE_INFINITY;t.value<s&&(t.inclusive?o.maximum=t.value:o.exclusiveMaximum=t.value)}),e._zod.check=n=>{(t.inclusive?n.value<=t.value:n.value<t.value)||n.issues.push({origin:r,code:"too_big",maximum:t.value,input:n.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),Ko=z("$ZodCheckGreaterThan",(e,t)=>{Oe.init(e,t);const r=Fo[typeof t.value];e._zod.onattach.push(n=>{const o=n._zod.bag,s=(t.inclusive?o.minimum:o.exclusiveMinimum)??Number.NEGATIVE_INFINITY;t.value>s&&(t.inclusive?o.minimum=t.value:o.exclusiveMinimum=t.value)}),e._zod.check=n=>{(t.inclusive?n.value>=t.value:n.value>t.value)||n.issues.push({origin:r,code:"too_small",minimum:t.value,input:n.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),nu=z("$ZodCheckMultipleOf",(e,t)=>{Oe.init(e,t),e._zod.onattach.push(r=>{var n;(n=r._zod.bag).multipleOf??(n.multipleOf=t.value)}),e._zod.check=r=>{if(typeof r.value!=typeof t.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof r.value=="bigint"?r.value%t.value===BigInt(0):ac(r.value,t.value)===0)||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:t.value,input:r.value,inst:e,continue:!t.abort})}}),ou=z("$ZodCheckNumberFormat",(e,t)=>{Oe.init(e,t),t.format=t.format||"float64";const r=t.format?.includes("int"),n=r?"int":"number",[o,s]=dc[t.format];e._zod.onattach.push(a=>{const i=a._zod.bag;i.format=t.format,i.minimum=o,i.maximum=s,r&&(i.pattern=Yc)}),e._zod.check=a=>{const i=a.value;if(r){if(!Number.isInteger(i)){a.issues.push({expected:n,format:t.format,code:"invalid_type",continue:!1,input:i,inst:e});return}if(!Number.isSafeInteger(i)){i>0?a.issues.push({input:i,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:n,continue:!t.abort}):a.issues.push({input:i,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:n,continue:!t.abort});return}}i<o&&a.issues.push({origin:"number",input:i,code:"too_small",minimum:o,inclusive:!0,inst:e,continue:!t.abort}),i>s&&a.issues.push({origin:"number",input:i,code:"too_big",maximum:s,inst:e})}}),su=z("$ZodCheckMaxLength",(e,t)=>{var r;Oe.init(e,t),(r=e._zod.def).when??(r.when=n=>{const o=n.value;return!an(o)&&o.length!==void 0}),e._zod.onattach.push(n=>{const o=n._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<o&&(n._zod.bag.maximum=t.maximum)}),e._zod.check=n=>{const o=n.value;if(o.length<=t.maximum)return;const a=un(o);n.issues.push({origin:a,code:"too_big",maximum:t.maximum,inclusive:!0,input:o,inst:e,continue:!t.abort})}}),au=z("$ZodCheckMinLength",(e,t)=>{var r;Oe.init(e,t),(r=e._zod.def).when??(r.when=n=>{const o=n.value;return!an(o)&&o.length!==void 0}),e._zod.onattach.push(n=>{const o=n._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>o&&(n._zod.bag.minimum=t.minimum)}),e._zod.check=n=>{const o=n.value;if(o.length>=t.minimum)return;const a=un(o);n.issues.push({origin:a,code:"too_small",minimum:t.minimum,inclusive:!0,input:o,inst:e,continue:!t.abort})}}),iu=z("$ZodCheckLengthEquals",(e,t)=>{var r;Oe.init(e,t),(r=e._zod.def).when??(r.when=n=>{const o=n.value;return!an(o)&&o.length!==void 0}),e._zod.onattach.push(n=>{const o=n._zod.bag;o.minimum=t.length,o.maximum=t.length,o.length=t.length}),e._zod.check=n=>{const o=n.value,s=o.length;if(s===t.length)return;const a=un(o),i=s>t.length;n.issues.push({origin:a,...i?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:n.value,inst:e,continue:!t.abort})}}),Lt=z("$ZodCheckStringFormat",(e,t)=>{var r,n;Oe.init(e,t),e._zod.onattach.push(o=>{const s=o._zod.bag;s.format=t.format,t.pattern&&(s.patterns??(s.patterns=new Set),s.patterns.add(t.pattern))}),t.pattern?(r=e._zod).check??(r.check=o=>{t.pattern.lastIndex=0,!t.pattern.test(o.value)&&o.issues.push({origin:"string",code:"invalid_format",format:t.format,input:o.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(n=e._zod).check??(n.check=()=>{})}),cu=z("$ZodCheckRegex",(e,t)=>{Lt.init(e,t),e._zod.check=r=>{t.pattern.lastIndex=0,!t.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),uu=z("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=tu),Lt.init(e,t)}),lu=z("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=ru),Lt.init(e,t)}),du=z("$ZodCheckIncludes",(e,t)=>{Oe.init(e,t);const r=ft(t.includes),n=new RegExp(typeof t.position=="number"?`^.{${t.position}}${r}`:r);t.pattern=n,e._zod.onattach.push(o=>{const s=o._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(n)}),e._zod.check=o=>{o.value.includes(t.includes,t.position)||o.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:o.value,inst:e,continue:!t.abort})}}),fu=z("$ZodCheckStartsWith",(e,t)=>{Oe.init(e,t);const r=new RegExp(`^${ft(t.prefix)}.*`);t.pattern??(t.pattern=r),e._zod.onattach.push(n=>{const o=n._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(r)}),e._zod.check=n=>{n.value.startsWith(t.prefix)||n.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:n.value,inst:e,continue:!t.abort})}}),hu=z("$ZodCheckEndsWith",(e,t)=>{Oe.init(e,t);const r=new RegExp(`.*${ft(t.suffix)}$`);t.pattern??(t.pattern=r),e._zod.onattach.push(n=>{const o=n._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(r)}),e._zod.check=n=>{n.value.endsWith(t.suffix)||n.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:n.value,inst:e,continue:!t.abort})}}),mu=z("$ZodCheckOverwrite",(e,t)=>{Oe.init(e,t),e._zod.check=r=>{r.value=t.tx(r.value)}});class pu{constructor(t=[]){this.content=[],this.indent=0,this&&(this.args=t)}indented(t){this.indent+=1,t(this),this.indent-=1}write(t){if(typeof t=="function"){t(this,{execution:"sync"}),t(this,{execution:"async"});return}const n=t.split(`
`).filter(a=>a),o=Math.min(...n.map(a=>a.length-a.trimStart().length)),s=n.map(a=>a.slice(o)).map(a=>" ".repeat(this.indent*2)+a);for(const a of s)this.content.push(a)}compile(){const t=Function,r=this?.args,o=[...(this?.content??[""]).map(s=>`  ${s}`)];return new t(...r,o.join(`
`))}}const gu={major:4,minor:1,patch:13},fe=z("$ZodType",(e,t)=>{var r;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=gu;const n=[...e._zod.def.checks??[]];e._zod.traits.has("$ZodCheck")&&n.unshift(e);for(const o of n)for(const s of o._zod.onattach)s(e);if(n.length===0)(r=e._zod).deferred??(r.deferred=[]),e._zod.deferred?.push(()=>{e._zod.run=e._zod.parse});else{const o=(a,i,c)=>{let m=ht(a),h;for(const b of i){if(b._zod.def.when){if(!b._zod.def.when(a))continue}else if(m)continue;const y=a.issues.length,$=b._zod.check(a);if($ instanceof Promise&&c?.async===!1)throw new lt;if(h||$ instanceof Promise)h=(h??Promise.resolve()).then(async()=>{await $,a.issues.length!==y&&(m||(m=ht(a,y)))});else{if(a.issues.length===y)continue;m||(m=ht(a,y))}}return h?h.then(()=>a):a},s=(a,i,c)=>{if(ht(a))return a.aborted=!0,a;const m=o(i,n,c);if(m instanceof Promise){if(c.async===!1)throw new lt;return m.then(h=>e._zod.parse(h,c))}return e._zod.parse(m,c)};e._zod.run=(a,i)=>{if(i.skipChecks)return e._zod.parse(a,i);if(i.direction==="backward"){const m=e._zod.parse({value:a.value,issues:[]},{...i,skipChecks:!0});return m instanceof Promise?m.then(h=>s(h,a,i)):s(m,a,i)}const c=e._zod.parse(a,i);if(c instanceof Promise){if(i.async===!1)throw new lt;return c.then(m=>o(m,n,i))}return o(c,n,i)}}e["~standard"]={validate:o=>{try{const s=Uo(e,o);return s.success?{value:s.data}:{issues:s.error?.issues}}catch{return bc(e,o).then(a=>a.success?{value:a.data}:{issues:a.error?.issues})}},vendor:"zod",version:1}}),fn=z("$ZodString",(e,t)=>{fe.init(e,t),e._zod.pattern=[...e?._zod.bag?.patterns??[]].pop()??Jc(e._zod.bag),e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=String(r.value)}catch{}return typeof r.value=="string"||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:e}),r}}),me=z("$ZodStringFormat",(e,t)=>{Lt.init(e,t),fn.init(e,t)}),_u=z("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=Mc),me.init(e,t)}),vu=z("$ZodUUID",(e,t)=>{if(t.version){const n={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(n===void 0)throw new Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=Do(n))}else t.pattern??(t.pattern=Do());me.init(e,t)}),yu=z("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=xc),me.init(e,t)}),wu=z("$ZodURL",(e,t)=>{me.init(e,t),e._zod.check=r=>{try{const n=r.value.trim(),o=new URL(n);t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(o.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:t.hostname.source,input:r.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(o.protocol.endsWith(":")?o.protocol.slice(0,-1):o.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:r.value,inst:e,continue:!t.abort})),t.normalize?r.value=o.href:r.value=n;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:e,continue:!t.abort})}}}),bu=z("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=Dc()),me.init(e,t)}),$u=z("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=jc),me.init(e,t)}),ku=z("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=Ic),me.init(e,t)}),Su=z("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=Oc),me.init(e,t)}),Eu=z("$ZodULID",(e,t)=>{t.pattern??(t.pattern=Cc),me.init(e,t)}),Pu=z("$ZodXID",(e,t)=>{t.pattern??(t.pattern=Nc),me.init(e,t)}),Tu=z("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=zc),me.init(e,t)}),Au=z("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=Gc(t)),me.init(e,t)}),Ru=z("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=Wc),me.init(e,t)}),Iu=z("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=Bc(t)),me.init(e,t)}),Ou=z("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=qc),me.init(e,t)}),Cu=z("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=Vc),me.init(e,t),e._zod.bag.format="ipv4"}),Nu=z("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=Zc),me.init(e,t),e._zod.bag.format="ipv6",e._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:e,continue:!t.abort})}}}),zu=z("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=Lc),me.init(e,t)}),ju=z("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=Fc),me.init(e,t),e._zod.check=r=>{const n=r.value.split("/");try{if(n.length!==2)throw new Error;const[o,s]=n;if(!s)throw new Error;const a=Number(s);if(`${a}`!==s)throw new Error;if(a<0||a>128)throw new Error;new URL(`http://[${o}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:e,continue:!t.abort})}}});function Wo(e){if(e==="")return!0;if(e.length%4!==0)return!1;try{return atob(e),!0}catch{return!1}}const qu=z("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=Hc),me.init(e,t),e._zod.bag.contentEncoding="base64",e._zod.check=r=>{Wo(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:e,continue:!t.abort})}});function Mu(e){if(!Vo.test(e))return!1;const t=e.replace(/[-_]/g,n=>n==="-"?"+":"/"),r=t.padEnd(Math.ceil(t.length/4)*4,"=");return Wo(r)}const xu=z("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=Vo),me.init(e,t),e._zod.bag.contentEncoding="base64url",e._zod.check=r=>{Mu(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:e,continue:!t.abort})}}),Uu=z("$ZodE164",(e,t)=>{t.pattern??(t.pattern=Kc),me.init(e,t)});function Du(e,t=null){try{const r=e.split(".");if(r.length!==3)return!1;const[n]=r;if(!n)return!1;const o=JSON.parse(atob(n));return!("typ"in o&&o?.typ!=="JWT"||!o.alg||t&&(!("alg"in o)||o.alg!==t))}catch{return!1}}const Vu=z("$ZodJWT",(e,t)=>{me.init(e,t),e._zod.check=r=>{Du(r.value,t.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:e,continue:!t.abort})}}),Bo=z("$ZodNumber",(e,t)=>{fe.init(e,t),e._zod.pattern=e._zod.bag.pattern??Qc,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=Number(r.value)}catch{}const o=r.value;if(typeof o=="number"&&!Number.isNaN(o)&&Number.isFinite(o))return r;const s=typeof o=="number"?Number.isNaN(o)?"NaN":Number.isFinite(o)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:o,inst:e,...s?{received:s}:{}}),r}}),Zu=z("$ZodNumberFormat",(e,t)=>{ou.init(e,t),Bo.init(e,t)}),Lu=z("$ZodBoolean",(e,t)=>{fe.init(e,t),e._zod.pattern=Xc,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=!!r.value}catch{}const o=r.value;return typeof o=="boolean"||r.issues.push({expected:"boolean",code:"invalid_type",input:o,inst:e}),r}}),Fu=z("$ZodNull",(e,t)=>{fe.init(e,t),e._zod.pattern=eu,e._zod.values=new Set([null]),e._zod.parse=(r,n)=>{const o=r.value;return o===null||r.issues.push({expected:"null",code:"invalid_type",input:o,inst:e}),r}}),Hu=z("$ZodAny",(e,t)=>{fe.init(e,t),e._zod.parse=r=>r}),Ku=z("$ZodUnknown",(e,t)=>{fe.init(e,t),e._zod.parse=r=>r}),Wu=z("$ZodNever",(e,t)=>{fe.init(e,t),e._zod.parse=(r,n)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:e}),r)});function Go(e,t,r){e.issues.length&&t.issues.push(...mt(r,e.issues)),t.value[r]=e.value}const Bu=z("$ZodArray",(e,t)=>{fe.init(e,t),e._zod.parse=(r,n)=>{const o=r.value;if(!Array.isArray(o))return r.issues.push({expected:"array",code:"invalid_type",input:o,inst:e}),r;r.value=Array(o.length);const s=[];for(let a=0;a<o.length;a++){const i=o[a],c=t.element._zod.run({value:i,issues:[]},n);c instanceof Promise?s.push(c.then(m=>Go(m,r,a))):Go(c,r,a)}return s.length?Promise.all(s).then(()=>r):r}});function Ft(e,t,r,n){e.issues.length&&t.issues.push(...mt(r,e.issues)),e.value===void 0?r in n&&(t.value[r]=void 0):t.value[r]=e.value}function Jo(e){const t=Object.keys(e.shape);for(const n of t)if(!e.shape?.[n]?._zod?.traits?.has("$ZodType"))throw new Error(`Invalid element at key "${n}": expected a Zod schema`);const r=lc(e.shape);return{...e,keys:t,keySet:new Set(t),numKeys:t.length,optionalKeys:new Set(r)}}function Yo(e,t,r,n,o,s){const a=[],i=o.keySet,c=o.catchall._zod,m=c.def.type;for(const h in t){if(i.has(h))continue;if(m==="never"){a.push(h);continue}const b=c.run({value:t[h],issues:[]},n);b instanceof Promise?e.push(b.then(y=>Ft(y,r,h,t))):Ft(b,r,h,t)}return a.length&&r.issues.push({code:"unrecognized_keys",keys:a,input:t,inst:s}),e.length?Promise.all(e).then(()=>r):r}const Gu=z("$ZodObject",(e,t)=>{if(fe.init(e,t),!Object.getOwnPropertyDescriptor(t,"shape")?.get){const i=t.shape;Object.defineProperty(t,"shape",{get:()=>{const c={...i};return Object.defineProperty(t,"shape",{value:c}),c}})}const n=Ut(()=>Jo(t));de(e._zod,"propValues",()=>{const i=t.shape,c={};for(const m in i){const h=i[m]._zod;if(h.values){c[m]??(c[m]=new Set);for(const b of h.values)c[m].add(b)}}return c});const o=Tt,s=t.catchall;let a;e._zod.parse=(i,c)=>{a??(a=n.value);const m=i.value;if(!o(m))return i.issues.push({expected:"object",code:"invalid_type",input:m,inst:e}),i;i.value={};const h=[],b=a.shape;for(const y of a.keys){const w=b[y]._zod.run({value:m[y],issues:[]},c);w instanceof Promise?h.push(w.then(_=>Ft(_,i,y,m))):Ft(w,i,y,m)}return s?Yo(h,m,i,c,n.value,e):h.length?Promise.all(h).then(()=>i):i}}),Ju=z("$ZodObjectJIT",(e,t)=>{Gu.init(e,t);const r=e._zod.parse,n=Ut(()=>Jo(t)),o=y=>{const $=new pu(["shape","payload","ctx"]),w=n.value,_=f=>{const v=No(f);return`shape[${v}]._zod.run({ value: input[${v}], issues: [] }, ctx)`};$.write("const input = payload.value;");const l=Object.create(null);let d=0;for(const f of w.keys)l[f]=`key_${d++}`;$.write("const newResult = {};");for(const f of w.keys){const v=l[f],p=No(f);$.write(`const ${v} = ${_(f)};`),$.write(`
        if (${v}.issues.length) {
          payload.issues = payload.issues.concat(${v}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${p}, ...iss.path] : [${p}]
          })));
        }
        
        
        if (${v}.value === undefined) {
          if (${p} in input) {
            newResult[${p}] = undefined;
          }
        } else {
          newResult[${p}] = ${v}.value;
        }
        
      `)}$.write("payload.value = newResult;"),$.write("return payload;");const u=$.compile();return(f,v)=>u(y,f,v)};let s;const a=Tt,i=!Oo.jitless,m=i&&cc.value,h=t.catchall;let b;e._zod.parse=(y,$)=>{b??(b=n.value);const w=y.value;return a(w)?i&&m&&$?.async===!1&&$.jitless!==!0?(s||(s=o(t.shape)),y=s(y,$),h?Yo([],w,y,$,b,e):y):r(y,$):(y.issues.push({expected:"object",code:"invalid_type",input:w,inst:e}),y)}});function Qo(e,t,r,n){for(const s of e)if(s.issues.length===0)return t.value=s.value,t;const o=e.filter(s=>!ht(s));return o.length===1?(t.value=o[0].value,o[0]):(t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:e.map(s=>s.issues.map(a=>Ye(a,n,Ge())))}),t)}const Xo=z("$ZodUnion",(e,t)=>{fe.init(e,t),de(e._zod,"optin",()=>t.options.some(o=>o._zod.optin==="optional")?"optional":void 0),de(e._zod,"optout",()=>t.options.some(o=>o._zod.optout==="optional")?"optional":void 0),de(e._zod,"values",()=>{if(t.options.every(o=>o._zod.values))return new Set(t.options.flatMap(o=>Array.from(o._zod.values)))}),de(e._zod,"pattern",()=>{if(t.options.every(o=>o._zod.pattern)){const o=t.options.map(s=>s._zod.pattern);return new RegExp(`^(${o.map(s=>cn(s.source)).join("|")})$`)}});const r=t.options.length===1,n=t.options[0]._zod.run;e._zod.parse=(o,s)=>{if(r)return n(o,s);let a=!1;const i=[];for(const c of t.options){const m=c._zod.run({value:o.value,issues:[]},s);if(m instanceof Promise)i.push(m),a=!0;else{if(m.issues.length===0)return m;i.push(m)}}return a?Promise.all(i).then(c=>Qo(c,o,e,s)):Qo(i,o,e,s)}}),Yu=z("$ZodDiscriminatedUnion",(e,t)=>{Xo.init(e,t);const r=e._zod.parse;de(e._zod,"propValues",()=>{const o={};for(const s of t.options){const a=s._zod.propValues;if(!a||Object.keys(a).length===0)throw new Error(`Invalid discriminated union option at index "${t.options.indexOf(s)}"`);for(const[i,c]of Object.entries(a)){o[i]||(o[i]=new Set);for(const m of c)o[i].add(m)}}return o});const n=Ut(()=>{const o=t.options,s=new Map;for(const a of o){const i=a._zod.propValues?.[t.discriminator];if(!i||i.size===0)throw new Error(`Invalid discriminated union option at index "${t.options.indexOf(a)}"`);for(const c of i){if(s.has(c))throw new Error(`Duplicate discriminator value "${String(c)}"`);s.set(c,a)}}return s});e._zod.parse=(o,s)=>{const a=o.value;if(!Tt(a))return o.issues.push({code:"invalid_type",expected:"object",input:a,inst:e}),o;const i=n.value.get(a?.[t.discriminator]);return i?i._zod.run(o,s):t.unionFallback?r(o,s):(o.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",discriminator:t.discriminator,input:a,path:[t.discriminator],inst:e}),o)}}),Qu=z("$ZodIntersection",(e,t)=>{fe.init(e,t),e._zod.parse=(r,n)=>{const o=r.value,s=t.left._zod.run({value:o,issues:[]},n),a=t.right._zod.run({value:o,issues:[]},n);return s instanceof Promise||a instanceof Promise?Promise.all([s,a]).then(([c,m])=>es(r,c,m)):es(r,s,a)}});function hn(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e==+t)return{valid:!0,data:e};if(dt(e)&&dt(t)){const r=Object.keys(t),n=Object.keys(e).filter(s=>r.indexOf(s)!==-1),o={...e,...t};for(const s of n){const a=hn(e[s],t[s]);if(!a.valid)return{valid:!1,mergeErrorPath:[s,...a.mergeErrorPath]};o[s]=a.data}return{valid:!0,data:o}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};const r=[];for(let n=0;n<e.length;n++){const o=e[n],s=t[n],a=hn(o,s);if(!a.valid)return{valid:!1,mergeErrorPath:[n,...a.mergeErrorPath]};r.push(a.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function es(e,t,r){if(t.issues.length&&e.issues.push(...t.issues),r.issues.length&&e.issues.push(...r.issues),ht(e))return e;const n=hn(t.value,r.value);if(!n.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(n.mergeErrorPath)}`);return e.value=n.data,e}const Xu=z("$ZodRecord",(e,t)=>{fe.init(e,t),e._zod.parse=(r,n)=>{const o=r.value;if(!dt(o))return r.issues.push({expected:"record",code:"invalid_type",input:o,inst:e}),r;const s=[],a=t.keyType._zod.values;if(a){r.value={};const i=new Set;for(const m of a)if(typeof m=="string"||typeof m=="number"||typeof m=="symbol"){i.add(typeof m=="number"?m.toString():m);const h=t.valueType._zod.run({value:o[m],issues:[]},n);h instanceof Promise?s.push(h.then(b=>{b.issues.length&&r.issues.push(...mt(m,b.issues)),r.value[m]=b.value})):(h.issues.length&&r.issues.push(...mt(m,h.issues)),r.value[m]=h.value)}let c;for(const m in o)i.has(m)||(c=c??[],c.push(m));c&&c.length>0&&r.issues.push({code:"unrecognized_keys",input:o,inst:e,keys:c})}else{r.value={};for(const i of Reflect.ownKeys(o)){if(i==="__proto__")continue;const c=t.keyType._zod.run({value:i,issues:[]},n);if(c instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(c.issues.length){r.issues.push({code:"invalid_key",origin:"record",issues:c.issues.map(h=>Ye(h,n,Ge())),input:i,path:[i],inst:e}),r.value[c.value]=c.value;continue}const m=t.valueType._zod.run({value:o[i],issues:[]},n);m instanceof Promise?s.push(m.then(h=>{h.issues.length&&r.issues.push(...mt(i,h.issues)),r.value[c.value]=h.value})):(m.issues.length&&r.issues.push(...mt(i,m.issues)),r.value[c.value]=m.value)}}return s.length?Promise.all(s).then(()=>r):r}}),el=z("$ZodEnum",(e,t)=>{fe.init(e,t);const r=sc(t.entries),n=new Set(r);e._zod.values=n,e._zod.pattern=new RegExp(`^(${r.filter(o=>uc.has(typeof o)).map(o=>typeof o=="string"?ft(o):o.toString()).join("|")})$`),e._zod.parse=(o,s)=>{const a=o.value;return n.has(a)||o.issues.push({code:"invalid_value",values:r,input:a,inst:e}),o}}),tl=z("$ZodLiteral",(e,t)=>{if(fe.init(e,t),t.values.length===0)throw new Error("Cannot create literal schema with no valid values");const r=new Set(t.values);e._zod.values=r,e._zod.pattern=new RegExp(`^(${t.values.map(n=>typeof n=="string"?ft(n):n?ft(n.toString()):String(n)).join("|")})$`),e._zod.parse=(n,o)=>{const s=n.value;return r.has(s)||n.issues.push({code:"invalid_value",values:t.values,input:s,inst:e}),n}}),rl=z("$ZodTransform",(e,t)=>{fe.init(e,t),e._zod.parse=(r,n)=>{if(n.direction==="backward")throw new Io(e.constructor.name);const o=t.transform(r.value,r);if(n.async)return(o instanceof Promise?o:Promise.resolve(o)).then(a=>(r.value=a,r));if(o instanceof Promise)throw new lt;return r.value=o,r}});function ts(e,t){return e.issues.length&&t===void 0?{issues:[],value:void 0}:e}const nl=z("$ZodOptional",(e,t)=>{fe.init(e,t),e._zod.optin="optional",e._zod.optout="optional",de(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),de(e._zod,"pattern",()=>{const r=t.innerType._zod.pattern;return r?new RegExp(`^(${cn(r.source)})?$`):void 0}),e._zod.parse=(r,n)=>{if(t.innerType._zod.optin==="optional"){const o=t.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>ts(s,r.value)):ts(o,r.value)}return r.value===void 0?r:t.innerType._zod.run(r,n)}}),ol=z("$ZodNullable",(e,t)=>{fe.init(e,t),de(e._zod,"optin",()=>t.innerType._zod.optin),de(e._zod,"optout",()=>t.innerType._zod.optout),de(e._zod,"pattern",()=>{const r=t.innerType._zod.pattern;return r?new RegExp(`^(${cn(r.source)}|null)$`):void 0}),de(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(r,n)=>r.value===null?r:t.innerType._zod.run(r,n)}),sl=z("$ZodDefault",(e,t)=>{fe.init(e,t),e._zod.optin="optional",de(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,n)=>{if(n.direction==="backward")return t.innerType._zod.run(r,n);if(r.value===void 0)return r.value=t.defaultValue,r;const o=t.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>rs(s,t)):rs(o,t)}});function rs(e,t){return e.value===void 0&&(e.value=t.defaultValue),e}const al=z("$ZodPrefault",(e,t)=>{fe.init(e,t),e._zod.optin="optional",de(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,n)=>(n.direction==="backward"||r.value===void 0&&(r.value=t.defaultValue),t.innerType._zod.run(r,n))}),il=z("$ZodNonOptional",(e,t)=>{fe.init(e,t),de(e._zod,"values",()=>{const r=t.innerType._zod.values;return r?new Set([...r].filter(n=>n!==void 0)):void 0}),e._zod.parse=(r,n)=>{const o=t.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>ns(s,e)):ns(o,e)}});function ns(e,t){return!e.issues.length&&e.value===void 0&&e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}const cl=z("$ZodCatch",(e,t)=>{fe.init(e,t),de(e._zod,"optin",()=>t.innerType._zod.optin),de(e._zod,"optout",()=>t.innerType._zod.optout),de(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,n)=>{if(n.direction==="backward")return t.innerType._zod.run(r,n);const o=t.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>(r.value=s.value,s.issues.length&&(r.value=t.catchValue({...r,error:{issues:s.issues.map(a=>Ye(a,n,Ge()))},input:r.value}),r.issues=[]),r)):(r.value=o.value,o.issues.length&&(r.value=t.catchValue({...r,error:{issues:o.issues.map(s=>Ye(s,n,Ge()))},input:r.value}),r.issues=[]),r)}}),ul=z("$ZodPipe",(e,t)=>{fe.init(e,t),de(e._zod,"values",()=>t.in._zod.values),de(e._zod,"optin",()=>t.in._zod.optin),de(e._zod,"optout",()=>t.out._zod.optout),de(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(r,n)=>{if(n.direction==="backward"){const s=t.out._zod.run(r,n);return s instanceof Promise?s.then(a=>Ht(a,t.in,n)):Ht(s,t.in,n)}const o=t.in._zod.run(r,n);return o instanceof Promise?o.then(s=>Ht(s,t.out,n)):Ht(o,t.out,n)}});function Ht(e,t,r){return e.issues.length?(e.aborted=!0,e):t._zod.run({value:e.value,issues:e.issues},r)}const ll=z("$ZodReadonly",(e,t)=>{fe.init(e,t),de(e._zod,"propValues",()=>t.innerType._zod.propValues),de(e._zod,"values",()=>t.innerType._zod.values),de(e._zod,"optin",()=>t.innerType?._zod?.optin),de(e._zod,"optout",()=>t.innerType?._zod?.optout),e._zod.parse=(r,n)=>{if(n.direction==="backward")return t.innerType._zod.run(r,n);const o=t.innerType._zod.run(r,n);return o instanceof Promise?o.then(os):os(o)}});function os(e){return e.value=Object.freeze(e.value),e}const dl=z("$ZodCustom",(e,t)=>{Oe.init(e,t),fe.init(e,t),e._zod.parse=(r,n)=>r,e._zod.check=r=>{const n=r.value,o=t.fn(n);if(o instanceof Promise)return o.then(s=>ss(s,r,n,e));ss(o,r,n,e)}});function ss(e,t,r,n){if(!e){const o={code:"custom",input:r,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(o.params=n._zod.def.params),t.issues.push(At(o))}}var as;class fl{constructor(){this._map=new WeakMap,this._idmap=new Map}add(t,...r){const n=r[0];if(this._map.set(t,n),n&&typeof n=="object"&&"id"in n){if(this._idmap.has(n.id))throw new Error(`ID ${n.id} already exists in the registry`);this._idmap.set(n.id,t)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(t){const r=this._map.get(t);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(t),this}get(t){const r=t._zod.parent;if(r){const n={...this.get(r)??{}};delete n.id;const o={...n,...this._map.get(t)};return Object.keys(o).length?o:void 0}return this._map.get(t)}has(t){return this._map.has(t)}}function hl(){return new fl}(as=globalThis).__zod_globalRegistry??(as.__zod_globalRegistry=hl());const Kt=globalThis.__zod_globalRegistry;function ml(e,t){return new e({type:"string",...K(t)})}function pl(e,t){return new e({type:"string",format:"email",check:"string_format",abort:!1,...K(t)})}function is(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...K(t)})}function gl(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,...K(t)})}function _l(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...K(t)})}function vl(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...K(t)})}function yl(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...K(t)})}function cs(e,t){return new e({type:"string",format:"url",check:"string_format",abort:!1,...K(t)})}function wl(e,t){return new e({type:"string",format:"emoji",check:"string_format",abort:!1,...K(t)})}function bl(e,t){return new e({type:"string",format:"nanoid",check:"string_format",abort:!1,...K(t)})}function $l(e,t){return new e({type:"string",format:"cuid",check:"string_format",abort:!1,...K(t)})}function kl(e,t){return new e({type:"string",format:"cuid2",check:"string_format",abort:!1,...K(t)})}function Sl(e,t){return new e({type:"string",format:"ulid",check:"string_format",abort:!1,...K(t)})}function El(e,t){return new e({type:"string",format:"xid",check:"string_format",abort:!1,...K(t)})}function Pl(e,t){return new e({type:"string",format:"ksuid",check:"string_format",abort:!1,...K(t)})}function Tl(e,t){return new e({type:"string",format:"ipv4",check:"string_format",abort:!1,...K(t)})}function Al(e,t){return new e({type:"string",format:"ipv6",check:"string_format",abort:!1,...K(t)})}function Rl(e,t){return new e({type:"string",format:"cidrv4",check:"string_format",abort:!1,...K(t)})}function Il(e,t){return new e({type:"string",format:"cidrv6",check:"string_format",abort:!1,...K(t)})}function Ol(e,t){return new e({type:"string",format:"base64",check:"string_format",abort:!1,...K(t)})}function Cl(e,t){return new e({type:"string",format:"base64url",check:"string_format",abort:!1,...K(t)})}function Nl(e,t){return new e({type:"string",format:"e164",check:"string_format",abort:!1,...K(t)})}function zl(e,t){return new e({type:"string",format:"jwt",check:"string_format",abort:!1,...K(t)})}function jl(e,t){return new e({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...K(t)})}function ql(e,t){return new e({type:"string",format:"date",check:"string_format",...K(t)})}function Ml(e,t){return new e({type:"string",format:"time",check:"string_format",precision:null,...K(t)})}function xl(e,t){return new e({type:"string",format:"duration",check:"string_format",...K(t)})}function Ul(e,t){return new e({type:"number",checks:[],...K(t)})}function Dl(e,t){return new e({type:"number",coerce:!0,checks:[],...K(t)})}function Vl(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"safeint",...K(t)})}function Zl(e,t){return new e({type:"boolean",...K(t)})}function Ll(e,t){return new e({type:"null",...K(t)})}function Fl(e){return new e({type:"any"})}function Hl(e){return new e({type:"unknown"})}function Kl(e,t){return new e({type:"never",...K(t)})}function us(e,t){return new Ho({check:"less_than",...K(t),value:e,inclusive:!1})}function mn(e,t){return new Ho({check:"less_than",...K(t),value:e,inclusive:!0})}function ls(e,t){return new Ko({check:"greater_than",...K(t),value:e,inclusive:!1})}function pn(e,t){return new Ko({check:"greater_than",...K(t),value:e,inclusive:!0})}function ds(e,t){return new nu({check:"multiple_of",...K(t),value:e})}function fs(e,t){return new su({check:"max_length",...K(t),maximum:e})}function Wt(e,t){return new au({check:"min_length",...K(t),minimum:e})}function hs(e,t){return new iu({check:"length_equals",...K(t),length:e})}function Wl(e,t){return new cu({check:"string_format",format:"regex",...K(t),pattern:e})}function Bl(e){return new uu({check:"string_format",format:"lowercase",...K(e)})}function Gl(e){return new lu({check:"string_format",format:"uppercase",...K(e)})}function Jl(e,t){return new du({check:"string_format",format:"includes",...K(t),includes:e})}function Yl(e,t){return new fu({check:"string_format",format:"starts_with",...K(t),prefix:e})}function Ql(e,t){return new hu({check:"string_format",format:"ends_with",...K(t),suffix:e})}function pt(e){return new mu({check:"overwrite",tx:e})}function Xl(e){return pt(t=>t.normalize(e))}function ed(){return pt(e=>e.trim())}function td(){return pt(e=>e.toLowerCase())}function rd(){return pt(e=>e.toUpperCase())}function nd(){return pt(e=>ic(e))}function od(e,t,r){return new e({type:"array",element:t,...K(r)})}function sd(e,t,r){const n=K(r);return n.abort??(n.abort=!0),new e({type:"custom",check:"custom",fn:t,...n})}function ad(e,t,r){return new e({type:"custom",check:"custom",fn:t,...K(r)})}function id(e){const t=cd(r=>(r.addIssue=n=>{if(typeof n=="string")r.issues.push(At(n,r.value,t._zod.def));else{const o=n;o.fatal&&(o.continue=!1),o.code??(o.code="custom"),o.input??(o.input=r.value),o.inst??(o.inst=t),o.continue??(o.continue=!t._zod.def.abort),r.issues.push(At(o))}},e(r.value,r)));return t}function cd(e,t){const r=new Oe({check:"custom",...K(t)});return r._zod.check=e,r}const ud=z("ZodISODateTime",(e,t)=>{Au.init(e,t),ve.init(e,t)});function ms(e){return jl(ud,e)}const ld=z("ZodISODate",(e,t)=>{Ru.init(e,t),ve.init(e,t)});function dd(e){return ql(ld,e)}const fd=z("ZodISOTime",(e,t)=>{Iu.init(e,t),ve.init(e,t)});function hd(e){return Ml(fd,e)}const md=z("ZodISODuration",(e,t)=>{Ou.init(e,t),ve.init(e,t)});function pd(e){return xl(md,e)}const ps=(e,t)=>{Mo.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:r=>wc(e,r)},flatten:{value:r=>yc(e,r)},addIssue:{value:r=>{e.issues.push(r),e.message=JSON.stringify(e.issues,sn,2)}},addIssues:{value:r=>{e.issues.push(...r),e.message=JSON.stringify(e.issues,sn,2)}},isEmpty:{get(){return e.issues.length===0}}})},gd=z("ZodError",ps),Me=z("ZodError",ps,{Parent:Error}),_d=ln(Me),vd=dn(Me),yd=Vt(Me),wd=Zt(Me),bd=$c(Me),$d=kc(Me),kd=Sc(Me),Sd=Ec(Me),Ed=Pc(Me),Pd=Tc(Me),Td=Ac(Me),Ad=Rc(Me),pe=z("ZodType",(e,t)=>(fe.init(e,t),e.def=t,e.type=t.type,Object.defineProperty(e,"_def",{value:t}),e.check=(...r)=>e.clone(ot(t,{checks:[...t.checks??[],...r.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]})),e.clone=(r,n)=>Je(e,r,n),e.brand=()=>e,e.register=((r,n)=>(r.add(e,n),e)),e.parse=(r,n)=>_d(e,r,n,{callee:e.parse}),e.safeParse=(r,n)=>yd(e,r,n),e.parseAsync=async(r,n)=>vd(e,r,n,{callee:e.parseAsync}),e.safeParseAsync=async(r,n)=>wd(e,r,n),e.spa=e.safeParseAsync,e.encode=(r,n)=>bd(e,r,n),e.decode=(r,n)=>$d(e,r,n),e.encodeAsync=async(r,n)=>kd(e,r,n),e.decodeAsync=async(r,n)=>Sd(e,r,n),e.safeEncode=(r,n)=>Ed(e,r,n),e.safeDecode=(r,n)=>Pd(e,r,n),e.safeEncodeAsync=async(r,n)=>Td(e,r,n),e.safeDecodeAsync=async(r,n)=>Ad(e,r,n),e.refine=(r,n)=>e.check(wf(r,n)),e.superRefine=r=>e.check(bf(r)),e.overwrite=r=>e.check(pt(r)),e.optional=()=>G(e),e.nullable=()=>Ps(e),e.nullish=()=>G(Ps(e)),e.nonoptional=r=>hf(e,r),e.array=()=>H(e),e.or=r=>ge([e,r]),e.and=r=>_n(e,r),e.transform=r=>yn(e,Ss(r)),e.default=r=>lf(e,r),e.prefault=r=>ff(e,r),e.catch=r=>pf(e,r),e.pipe=r=>yn(e,r),e.readonly=()=>vf(e),e.describe=r=>{const n=e.clone();return Kt.add(n,{description:r}),n},Object.defineProperty(e,"description",{get(){return Kt.get(e)?.description},configurable:!0}),e.meta=(...r)=>{if(r.length===0)return Kt.get(e);const n=e.clone();return Kt.add(n,r[0]),n},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e)),gs=z("_ZodString",(e,t)=>{fn.init(e,t),pe.init(e,t);const r=e._zod.bag;e.format=r.format??null,e.minLength=r.minimum??null,e.maxLength=r.maximum??null,e.regex=(...n)=>e.check(Wl(...n)),e.includes=(...n)=>e.check(Jl(...n)),e.startsWith=(...n)=>e.check(Yl(...n)),e.endsWith=(...n)=>e.check(Ql(...n)),e.min=(...n)=>e.check(Wt(...n)),e.max=(...n)=>e.check(fs(...n)),e.length=(...n)=>e.check(hs(...n)),e.nonempty=(...n)=>e.check(Wt(1,...n)),e.lowercase=n=>e.check(Bl(n)),e.uppercase=n=>e.check(Gl(n)),e.trim=()=>e.check(ed()),e.normalize=(...n)=>e.check(Xl(...n)),e.toLowerCase=()=>e.check(td()),e.toUpperCase=()=>e.check(rd()),e.slugify=()=>e.check(nd())}),Rd=z("ZodString",(e,t)=>{fn.init(e,t),gs.init(e,t),e.email=r=>e.check(pl(Id,r)),e.url=r=>e.check(cs(vs,r)),e.jwt=r=>e.check(zl(Kd,r)),e.emoji=r=>e.check(wl(Cd,r)),e.guid=r=>e.check(is(_s,r)),e.uuid=r=>e.check(gl(Bt,r)),e.uuidv4=r=>e.check(_l(Bt,r)),e.uuidv6=r=>e.check(vl(Bt,r)),e.uuidv7=r=>e.check(yl(Bt,r)),e.nanoid=r=>e.check(bl(Nd,r)),e.guid=r=>e.check(is(_s,r)),e.cuid=r=>e.check($l(zd,r)),e.cuid2=r=>e.check(kl(jd,r)),e.ulid=r=>e.check(Sl(qd,r)),e.base64=r=>e.check(Ol(Ld,r)),e.base64url=r=>e.check(Cl(Fd,r)),e.xid=r=>e.check(El(Md,r)),e.ksuid=r=>e.check(Pl(xd,r)),e.ipv4=r=>e.check(Tl(Ud,r)),e.ipv6=r=>e.check(Al(Dd,r)),e.cidrv4=r=>e.check(Rl(Vd,r)),e.cidrv6=r=>e.check(Il(Zd,r)),e.e164=r=>e.check(Nl(Hd,r)),e.datetime=r=>e.check(ms(r)),e.date=r=>e.check(dd(r)),e.time=r=>e.check(hd(r)),e.duration=r=>e.check(pd(r))});function P(e){return ml(Rd,e)}const ve=z("ZodStringFormat",(e,t)=>{me.init(e,t),gs.init(e,t)}),Id=z("ZodEmail",(e,t)=>{yu.init(e,t),ve.init(e,t)}),_s=z("ZodGUID",(e,t)=>{_u.init(e,t),ve.init(e,t)}),Bt=z("ZodUUID",(e,t)=>{vu.init(e,t),ve.init(e,t)}),vs=z("ZodURL",(e,t)=>{wu.init(e,t),ve.init(e,t)});function Od(e){return cs(vs,e)}const Cd=z("ZodEmoji",(e,t)=>{bu.init(e,t),ve.init(e,t)}),Nd=z("ZodNanoID",(e,t)=>{$u.init(e,t),ve.init(e,t)}),zd=z("ZodCUID",(e,t)=>{ku.init(e,t),ve.init(e,t)}),jd=z("ZodCUID2",(e,t)=>{Su.init(e,t),ve.init(e,t)}),qd=z("ZodULID",(e,t)=>{Eu.init(e,t),ve.init(e,t)}),Md=z("ZodXID",(e,t)=>{Pu.init(e,t),ve.init(e,t)}),xd=z("ZodKSUID",(e,t)=>{Tu.init(e,t),ve.init(e,t)}),Ud=z("ZodIPv4",(e,t)=>{Cu.init(e,t),ve.init(e,t)}),Dd=z("ZodIPv6",(e,t)=>{Nu.init(e,t),ve.init(e,t)}),Vd=z("ZodCIDRv4",(e,t)=>{zu.init(e,t),ve.init(e,t)}),Zd=z("ZodCIDRv6",(e,t)=>{ju.init(e,t),ve.init(e,t)}),Ld=z("ZodBase64",(e,t)=>{qu.init(e,t),ve.init(e,t)}),Fd=z("ZodBase64URL",(e,t)=>{xu.init(e,t),ve.init(e,t)}),Hd=z("ZodE164",(e,t)=>{Uu.init(e,t),ve.init(e,t)}),Kd=z("ZodJWT",(e,t)=>{Vu.init(e,t),ve.init(e,t)}),gn=z("ZodNumber",(e,t)=>{Bo.init(e,t),pe.init(e,t),e.gt=(n,o)=>e.check(ls(n,o)),e.gte=(n,o)=>e.check(pn(n,o)),e.min=(n,o)=>e.check(pn(n,o)),e.lt=(n,o)=>e.check(us(n,o)),e.lte=(n,o)=>e.check(mn(n,o)),e.max=(n,o)=>e.check(mn(n,o)),e.int=n=>e.check(ys(n)),e.safe=n=>e.check(ys(n)),e.positive=n=>e.check(ls(0,n)),e.nonnegative=n=>e.check(pn(0,n)),e.negative=n=>e.check(us(0,n)),e.nonpositive=n=>e.check(mn(0,n)),e.multipleOf=(n,o)=>e.check(ds(n,o)),e.step=(n,o)=>e.check(ds(n,o)),e.finite=()=>e;const r=e._zod.bag;e.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,e.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,e.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),e.isFinite=!0,e.format=r.format??null});function ue(e){return Ul(gn,e)}const Wd=z("ZodNumberFormat",(e,t)=>{Zu.init(e,t),gn.init(e,t)});function ys(e){return Vl(Wd,e)}const Bd=z("ZodBoolean",(e,t)=>{Lu.init(e,t),pe.init(e,t)});function he(e){return Zl(Bd,e)}const Gd=z("ZodNull",(e,t)=>{Fu.init(e,t),pe.init(e,t)});function ws(e){return Ll(Gd,e)}const Jd=z("ZodAny",(e,t)=>{Hu.init(e,t),pe.init(e,t)});function Yd(){return Fl(Jd)}const Qd=z("ZodUnknown",(e,t)=>{Ku.init(e,t),pe.init(e,t)});function ye(){return Hl(Qd)}const Xd=z("ZodNever",(e,t)=>{Wu.init(e,t),pe.init(e,t)});function ef(e){return Kl(Xd,e)}const tf=z("ZodArray",(e,t)=>{Bu.init(e,t),pe.init(e,t),e.element=t.element,e.min=(r,n)=>e.check(Wt(r,n)),e.nonempty=r=>e.check(Wt(1,r)),e.max=(r,n)=>e.check(fs(r,n)),e.length=(r,n)=>e.check(hs(r,n)),e.unwrap=()=>e.element});function H(e,t){return od(tf,e,t)}const bs=z("ZodObject",(e,t)=>{Ju.init(e,t),pe.init(e,t),de(e,"shape",()=>t.shape),e.keyof=()=>Ae(Object.keys(e._zod.def.shape)),e.catchall=r=>e.clone({...e._zod.def,catchall:r}),e.passthrough=()=>e.clone({...e._zod.def,catchall:ye()}),e.loose=()=>e.clone({...e._zod.def,catchall:ye()}),e.strict=()=>e.clone({...e._zod.def,catchall:ef()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=r=>mc(e,r),e.safeExtend=r=>pc(e,r),e.merge=r=>gc(e,r),e.pick=r=>fc(e,r),e.omit=r=>hc(e,r),e.partial=(...r)=>_c(Es,e,r[0]),e.required=(...r)=>vc(Ts,e,r[0])});function V(e,t){const r={type:"object",shape:e??{},...K(t)};return new bs(r)}function Ce(e,t){return new bs({type:"object",shape:e,catchall:ye(),...K(t)})}const $s=z("ZodUnion",(e,t)=>{Xo.init(e,t),pe.init(e,t),e.options=t.options});function ge(e,t){return new $s({type:"union",options:e,...K(t)})}const rf=z("ZodDiscriminatedUnion",(e,t)=>{$s.init(e,t),Yu.init(e,t)});function ks(e,t,r){return new rf({type:"union",options:t,discriminator:e,...K(r)})}const nf=z("ZodIntersection",(e,t)=>{Qu.init(e,t),pe.init(e,t)});function _n(e,t){return new nf({type:"intersection",left:e,right:t})}const of=z("ZodRecord",(e,t)=>{Xu.init(e,t),pe.init(e,t),e.keyType=t.keyType,e.valueType=t.valueType});function we(e,t,r){return new of({type:"record",keyType:e,valueType:t,...K(r)})}const vn=z("ZodEnum",(e,t)=>{el.init(e,t),pe.init(e,t),e.enum=t.entries,e.options=Object.values(t.entries);const r=new Set(Object.keys(t.entries));e.extract=(n,o)=>{const s={};for(const a of n)if(r.has(a))s[a]=t.entries[a];else throw new Error(`Key ${a} not found in enum`);return new vn({...t,checks:[],...K(o),entries:s})},e.exclude=(n,o)=>{const s={...t.entries};for(const a of n)if(r.has(a))delete s[a];else throw new Error(`Key ${a} not found in enum`);return new vn({...t,checks:[],...K(o),entries:s})}});function Ae(e,t){const r=Array.isArray(e)?Object.fromEntries(e.map(n=>[n,n])):e;return new vn({type:"enum",entries:r,...K(t)})}const sf=z("ZodLiteral",(e,t)=>{tl.init(e,t),pe.init(e,t),e.values=new Set(t.values),Object.defineProperty(e,"value",{get(){if(t.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return t.values[0]}})});function B(e,t){return new sf({type:"literal",values:Array.isArray(e)?e:[e],...K(t)})}const af=z("ZodTransform",(e,t)=>{rl.init(e,t),pe.init(e,t),e._zod.parse=(r,n)=>{if(n.direction==="backward")throw new Io(e.constructor.name);r.addIssue=s=>{if(typeof s=="string")r.issues.push(At(s,r.value,t));else{const a=s;a.fatal&&(a.continue=!1),a.code??(a.code="custom"),a.input??(a.input=r.value),a.inst??(a.inst=e),r.issues.push(At(a))}};const o=t.transform(r.value,r);return o instanceof Promise?o.then(s=>(r.value=s,r)):(r.value=o,r)}});function Ss(e){return new af({type:"transform",transform:e})}const Es=z("ZodOptional",(e,t)=>{nl.init(e,t),pe.init(e,t),e.unwrap=()=>e._zod.def.innerType});function G(e){return new Es({type:"optional",innerType:e})}const cf=z("ZodNullable",(e,t)=>{ol.init(e,t),pe.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Ps(e){return new cf({type:"nullable",innerType:e})}const uf=z("ZodDefault",(e,t)=>{sl.init(e,t),pe.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});function lf(e,t){return new uf({type:"default",innerType:e,get defaultValue(){return typeof t=="function"?t():jo(t)}})}const df=z("ZodPrefault",(e,t)=>{al.init(e,t),pe.init(e,t),e.unwrap=()=>e._zod.def.innerType});function ff(e,t){return new df({type:"prefault",innerType:e,get defaultValue(){return typeof t=="function"?t():jo(t)}})}const Ts=z("ZodNonOptional",(e,t)=>{il.init(e,t),pe.init(e,t),e.unwrap=()=>e._zod.def.innerType});function hf(e,t){return new Ts({type:"nonoptional",innerType:e,...K(t)})}const mf=z("ZodCatch",(e,t)=>{cl.init(e,t),pe.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});function pf(e,t){return new mf({type:"catch",innerType:e,catchValue:typeof t=="function"?t:()=>t})}const gf=z("ZodPipe",(e,t)=>{ul.init(e,t),pe.init(e,t),e.in=t.in,e.out=t.out});function yn(e,t){return new gf({type:"pipe",in:e,out:t})}const _f=z("ZodReadonly",(e,t)=>{ll.init(e,t),pe.init(e,t),e.unwrap=()=>e._zod.def.innerType});function vf(e){return new _f({type:"readonly",innerType:e})}const As=z("ZodCustom",(e,t)=>{dl.init(e,t),pe.init(e,t)});function yf(e,t){return sd(As,e??(()=>!0),t)}function wf(e,t={}){return ad(As,e,t)}function bf(e){return id(e)}function Rs(e,t){return yn(Ss(e),t)}const $f={custom:"custom"};function Is(e){return Dl(gn,e)}const Os={BASE_URL:"/",BROWSER:"chrome",CHROME:!0,COMMAND:"build",DEV:!1,EDGE:!1,ENTRYPOINT:"background",FIREFOX:!1,MANIFEST_VERSION:3,MODE:"production",OPERA:!1,PROD:!0,SAFARI:!1,SSR:!1,VITE_PUBLIC_POSTHOG_HOST:"https://us.i.posthog.com",VITE_PUBLIC_POSTHOG_KEY:"phc_PRrpVnBMVJgUumvaXzUnwKZ1dDs3L8MSICLhTdnc8jC",VITE_PUBLIC_SENTRY_DSN:"https://c11f91ce24dee77bae485bebf646cd29@o4510545525932032.ingest.us.sentry.io/4510550615261184",VITE_USER_NODE_ENV:"production"},Cs=V({VITE_BROWSEROS_AGENT_PORT:Is().optional(),VITE_PUBLIC_POSTHOG_KEY:P().optional(),VITE_PUBLIC_POSTHOG_HOST:P().optional(),VITE_PUBLIC_SENTRY_DSN:P().optional(),PROD:he()});try{Cs.parse(Os)}catch(e){if(e instanceof gd){let t=`Missing required values in .env:
`;for(const n of e.issues)t+=`${n.path.join(".")}
`;const r=new Error(t);throw r.stack="",r}throw console.error(e),e}Cs.parse(Os);const Ns={AGENT_PORT:"browseros.server.agent_port",MCP_PORT:"browseros.server.mcp_port",PROVIDERS:"browseros.providers",THIRD_PARTY_LLM_PROVIDERS:"browseros.third_party_llm.providers",THIRD_PARTY_LLM_SELECTED:"browseros.third_party_llm.selected_provider",ALLOW_REMOTE_MCP:"browseros.server.allow_remote_in_mcp",RESTART_SERVER:"browseros.server.restart_requested"};class kf extends Error{constructor(){super("MCP server port not configured."),this.name="McpPortError"}}async function zs(){try{const t=await Ao().getPref(Ns.MCP_PORT);if(t?.value&&typeof t.value=="number")return t.value}catch{}throw new kf}async function Sf(){return`http://127.0.0.1:${await zs()}/mcp`}async function Ef(){return`http://127.0.0.1:${await zs()}/health`}async function Pf(e){return await chrome.sidePanel.browserosIsOpen({tabId:e})?{opened:!0}:await chrome.sidePanel.browserosToggle({tabId:e})}async function Tf(e){return await chrome.sidePanel.browserosToggle({tabId:e})}var js=Object.prototype.hasOwnProperty;function wn(e,t){var r,n;if(e===t)return!0;if(e&&t&&(r=e.constructor)===t.constructor){if(r===Date)return e.getTime()===t.getTime();if(r===RegExp)return e.toString()===t.toString();if(r===Array){if((n=e.length)===t.length)for(;n--&&wn(e[n],t[n]););return n===-1}if(!r||typeof e=="object"){n=0;for(r in e)if(js.call(e,r)&&++n&&!js.call(t,r)||!(r in t)||!wn(e[r],t[r]))return!1;return Object.keys(t).length===n}}return e!==e&&t!==t}const Af=new Error("request for lock canceled");var Rf=function(e,t,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function i(h){try{m(n.next(h))}catch(b){a(b)}}function c(h){try{m(n.throw(h))}catch(b){a(b)}}function m(h){h.done?s(h.value):o(h.value).then(i,c)}m((n=n.apply(e,t||[])).next())})};class If{constructor(t,r=Af){this._value=t,this._cancelError=r,this._queue=[],this._weightedWaiters=[]}acquire(t=1,r=0){if(t<=0)throw new Error(`invalid weight ${t}: must be positive`);return new Promise((n,o)=>{const s={resolve:n,reject:o,weight:t,priority:r},a=qs(this._queue,i=>r<=i.priority);a===-1&&t<=this._value?this._dispatchItem(s):this._queue.splice(a+1,0,s)})}runExclusive(t){return Rf(this,arguments,void 0,function*(r,n=1,o=0){const[s,a]=yield this.acquire(n,o);try{return yield r(s)}finally{a()}})}waitForUnlock(t=1,r=0){if(t<=0)throw new Error(`invalid weight ${t}: must be positive`);return this._couldLockImmediately(t,r)?Promise.resolve():new Promise(n=>{this._weightedWaiters[t-1]||(this._weightedWaiters[t-1]=[]),Of(this._weightedWaiters[t-1],{resolve:n,priority:r})})}isLocked(){return this._value<=0}getValue(){return this._value}setValue(t){this._value=t,this._dispatchQueue()}release(t=1){if(t<=0)throw new Error(`invalid weight ${t}: must be positive`);this._value+=t,this._dispatchQueue()}cancel(){this._queue.forEach(t=>t.reject(this._cancelError)),this._queue=[]}_dispatchQueue(){for(this._drainUnlockWaiters();this._queue.length>0&&this._queue[0].weight<=this._value;)this._dispatchItem(this._queue.shift()),this._drainUnlockWaiters()}_dispatchItem(t){const r=this._value;this._value-=t.weight,t.resolve([r,this._newReleaser(t.weight)])}_newReleaser(t){let r=!1;return()=>{r||(r=!0,this.release(t))}}_drainUnlockWaiters(){if(this._queue.length===0)for(let t=this._value;t>0;t--){const r=this._weightedWaiters[t-1];r&&(r.forEach(n=>n.resolve()),this._weightedWaiters[t-1]=[])}else{const t=this._queue[0].priority;for(let r=this._value;r>0;r--){const n=this._weightedWaiters[r-1];if(!n)continue;const o=n.findIndex(s=>s.priority<=t);(o===-1?n:n.splice(0,o)).forEach((s=>s.resolve()))}}}_couldLockImmediately(t,r){return(this._queue.length===0||this._queue[0].priority<r)&&t<=this._value}}function Of(e,t){const r=qs(e,n=>t.priority<=n.priority);e.splice(r+1,0,t)}function qs(e,t){for(let r=e.length-1;r>=0;r--)if(t(e[r]))return r;return-1}var Cf=function(e,t,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function i(h){try{m(n.next(h))}catch(b){a(b)}}function c(h){try{m(n.throw(h))}catch(b){a(b)}}function m(h){h.done?s(h.value):o(h.value).then(i,c)}m((n=n.apply(e,t||[])).next())})};class Nf{constructor(t){this._semaphore=new If(1,t)}acquire(){return Cf(this,arguments,void 0,function*(t=0){const[,r]=yield this._semaphore.acquire(1,t);return r})}runExclusive(t,r=0){return this._semaphore.runExclusive(()=>t(),1,r)}isLocked(){return this._semaphore.isLocked()}waitForUnlock(t=0){return this._semaphore.waitForUnlock(1,t)}release(){this._semaphore.isLocked()&&this._semaphore.release()}cancel(){return this._semaphore.cancel()}}const Gt=globalThis.browser?.runtime?.id?globalThis.browser:globalThis.chrome,bn=zf();function zf(){const e={local:Jt("local"),session:Jt("session"),sync:Jt("sync"),managed:Jt("managed")},t=_=>{const l=e[_];if(l==null){const d=Object.keys(e).join(", ");throw Error(`Invalid area "${_}". Options: ${d}`)}return l},r=_=>{const l=_.indexOf(":"),d=_.substring(0,l),u=_.substring(l+1);if(u==null)throw Error(`Storage key should be in the form of "area:key", but received "${_}"`);return{driverArea:d,driverKey:u,driver:t(d)}},n=_=>_+"$",o=(_,l)=>{const d={..._};return Object.entries(l).forEach(([u,f])=>{f==null?delete d[u]:d[u]=f}),d},s=(_,l)=>_??l??null,a=_=>typeof _=="object"&&!Array.isArray(_)?_:{},i=async(_,l,d)=>{const u=await _.getItem(l);return s(u,d?.fallback??d?.defaultValue)},c=async(_,l)=>{const d=n(l),u=await _.getItem(d);return a(u)},m=async(_,l,d)=>{await _.setItem(l,d??null)},h=async(_,l,d)=>{const u=n(l),f=a(await _.getItem(u));await _.setItem(u,o(f,d))},b=async(_,l,d)=>{if(await _.removeItem(l),d?.removeMeta){const u=n(l);await _.removeItem(u)}},y=async(_,l,d)=>{const u=n(l);if(d==null)await _.removeItem(u);else{const f=a(await _.getItem(u));[d].flat().forEach(v=>delete f[v]),await _.setItem(u,f)}},$=(_,l,d)=>_.watch(l,d);return{getItem:async(_,l)=>{const{driver:d,driverKey:u}=r(_);return await i(d,u,l)},getItems:async _=>{const l=new Map,d=new Map,u=[];_.forEach(v=>{let p,g;typeof v=="string"?p=v:"getValue"in v?(p=v.key,g={fallback:v.fallback}):(p=v.key,g=v.options),u.push(p);const{driverArea:S,driverKey:T}=r(p),R=l.get(S)??[];l.set(S,R.concat(T)),d.set(p,g)});const f=new Map;return await Promise.all(Array.from(l.entries()).map(async([v,p])=>{(await e[v].getItems(p)).forEach(S=>{const T=`${v}:${S.key}`,R=d.get(T),q=s(S.value,R?.fallback??R?.defaultValue);f.set(T,q)})})),u.map(v=>({key:v,value:f.get(v)}))},getMeta:async _=>{const{driver:l,driverKey:d}=r(_);return await c(l,d)},getMetas:async _=>{const l=_.map(f=>{const v=typeof f=="string"?f:f.key,{driverArea:p,driverKey:g}=r(v);return{key:v,driverArea:p,driverKey:g,driverMetaKey:n(g)}}),d=l.reduce((f,v)=>(f[v.driverArea]??=[],f[v.driverArea].push(v),f),{}),u={};return await Promise.all(Object.entries(d).map(async([f,v])=>{const p=await Gt.storage[f].get(v.map(g=>g.driverMetaKey));v.forEach(g=>{u[g.key]=p[g.driverMetaKey]??{}})})),l.map(f=>({key:f.key,meta:u[f.key]}))},setItem:async(_,l)=>{const{driver:d,driverKey:u}=r(_);await m(d,u,l)},setItems:async _=>{const l={};_.forEach(d=>{const{driverArea:u,driverKey:f}=r("key"in d?d.key:d.item.key);l[u]??=[],l[u].push({key:f,value:d.value})}),await Promise.all(Object.entries(l).map(async([d,u])=>{await t(d).setItems(u)}))},setMeta:async(_,l)=>{const{driver:d,driverKey:u}=r(_);await h(d,u,l)},setMetas:async _=>{const l={};_.forEach(d=>{const{driverArea:u,driverKey:f}=r("key"in d?d.key:d.item.key);l[u]??=[],l[u].push({key:f,properties:d.meta})}),await Promise.all(Object.entries(l).map(async([d,u])=>{const f=t(d),v=u.map(({key:T})=>n(T)),p=await f.getItems(v),g=Object.fromEntries(p.map(({key:T,value:R})=>[T,a(R)])),S=u.map(({key:T,properties:R})=>{const q=n(T);return{key:q,value:o(g[q]??{},R)}});await f.setItems(S)}))},removeItem:async(_,l)=>{const{driver:d,driverKey:u}=r(_);await b(d,u,l)},removeItems:async _=>{const l={};_.forEach(d=>{let u,f;typeof d=="string"?u=d:"getValue"in d?u=d.key:"item"in d?(u=d.item.key,f=d.options):(u=d.key,f=d.options);const{driverArea:v,driverKey:p}=r(u);l[v]??=[],l[v].push(p),f?.removeMeta&&l[v].push(n(p))}),await Promise.all(Object.entries(l).map(async([d,u])=>{await t(d).removeItems(u)}))},clear:async _=>{await t(_).clear()},removeMeta:async(_,l)=>{const{driver:d,driverKey:u}=r(_);await y(d,u,l)},snapshot:async(_,l)=>{const u=await t(_).snapshot();return l?.excludeKeys?.forEach(f=>{delete u[f],delete u[n(f)]}),u},restoreSnapshot:async(_,l)=>{await t(_).restoreSnapshot(l)},watch:(_,l)=>{const{driver:d,driverKey:u}=r(_);return $(d,u,l)},unwatch(){Object.values(e).forEach(_=>{_.unwatch()})},defineItem:(_,l)=>{const{driver:d,driverKey:u}=r(_),{version:f=1,migrations:v={},onMigrationComplete:p,debug:g=!1}=l??{};if(f<1)throw Error("Storage item version cannot be less than 1. Initial versions should be set to 1, not 0.");const S=async()=>{const x=n(u),[{value:M},{value:F}]=await d.getItems([u,x]);if(M==null)return;const Y=F?.v??1;if(Y>f)throw Error(`Version downgrade detected (v${Y} -> v${f}) for "${_}"`);if(Y===f)return;g===!0&&console.debug(`[@wxt-dev/storage] Running storage migration for ${_}: v${Y} -> v${f}`);const _e=Array.from({length:f-Y},(ee,be)=>Y+be+1);let le=M;for(const ee of _e)try{le=await v?.[ee]?.(le)??le,g===!0&&console.debug(`[@wxt-dev/storage] Storage migration processed for version: v${ee}`)}catch(be){throw new jf(_,ee,{cause:be})}await d.setItems([{key:u,value:le},{key:x,value:{...F,v:f}}]),g===!0&&console.debug(`[@wxt-dev/storage] Storage migration completed for ${_} v${f}`,{migratedValue:le}),p?.(le,f)},T=l?.migrations==null?Promise.resolve():S().catch(x=>{console.error(`[@wxt-dev/storage] Migration failed for ${_}`,x)}),R=new Nf,q=()=>l?.fallback??l?.defaultValue??null,N=()=>R.runExclusive(async()=>{const x=await d.getItem(u);if(x!=null||l?.init==null)return x;const M=await l.init();return await d.setItem(u,M),M});return T.then(N),{key:_,get defaultValue(){return q()},get fallback(){return q()},getValue:async()=>(await T,l?.init?await N():await i(d,u,l)),getMeta:async()=>(await T,await c(d,u)),setValue:async x=>(await T,await m(d,u,x)),setMeta:async x=>(await T,await h(d,u,x)),removeValue:async x=>(await T,await b(d,u,x)),removeMeta:async x=>(await T,await y(d,u,x)),watch:x=>$(d,u,(M,F)=>x(M??q(),F??q())),migrate:S}}}}function Jt(e){const t=()=>{if(Gt.runtime==null)throw Error(["'wxt/storage' must be loaded in a web extension environment",`
 - If thrown during a build, see https://github.com/wxt-dev/wxt/issues/371`,` - If thrown during tests, mock 'wxt/browser' correctly. See https://wxt.dev/guide/go-further/testing.html
`].join(`
`));if(Gt.storage==null)throw Error("You must add the 'storage' permission to your manifest to use 'wxt/storage'");const n=Gt.storage[e];if(n==null)throw Error(`"browser.storage.${e}" is undefined`);return n},r=new Set;return{getItem:async n=>(await t().get(n))[n],getItems:async n=>{const o=await t().get(n);return n.map(s=>({key:s,value:o[s]??null}))},setItem:async(n,o)=>{o==null?await t().remove(n):await t().set({[n]:o})},setItems:async n=>{const o=n.reduce((s,{key:a,value:i})=>(s[a]=i,s),{});await t().set(o)},removeItem:async n=>{await t().remove(n)},removeItems:async n=>{await t().remove(n)},clear:async()=>{await t().clear()},snapshot:async()=>await t().get(),restoreSnapshot:async n=>{await t().set(n)},watch(n,o){const s=a=>{const i=a[n];i!=null&&(wn(i.newValue,i.oldValue)||o(i.newValue??null,i.oldValue??null))};return t().onChanged.addListener(s),r.add(s),()=>{t().onChanged.removeListener(s),r.delete(s)}},unwatch(){r.forEach(n=>{t().onChanged.removeListener(n)}),r.clear()}}}class jf extends Error{constructor(t,r,n){super(`v${r} migration failed for "${t}"`,n),this.key=t,this.version=r}}const qf="browseros",Mf=bn.defineItem("local:llm-providers");async function xf(e){try{await Ao().setPref(Ns.PROVIDERS,JSON.stringify(e))}catch{}}function Uf(){return Mf.watch(async t=>{if(t){const r=await Df.getValue();await xf({defaultProviderId:r,providers:t})}})}const Df=bn.defineItem("local:default-provider-id",{fallback:qf});function Yt(e){return!!e._zod}function Qe(e,t){return Yt(e)?Uo(e,t):e.safeParse(t)}function Ms(e){var t,r;if(!e)return;let n;if(Yt(e)?n=(r=(t=e._zod)===null||t===void 0?void 0:t.def)===null||r===void 0?void 0:r.shape:n=e.shape,!!n){if(typeof n=="function")try{return n()}catch{return}return n}}function Vf(e){var t;if(Yt(e)){const a=(t=e._zod)===null||t===void 0?void 0:t.def;if(a){if(a.value!==void 0)return a.value;if(Array.isArray(a.values)&&a.values.length>0)return a.values[0]}}const n=e._def;if(n){if(n.value!==void 0)return n.value;if(Array.isArray(n.values)&&n.values.length>0)return n.values[0]}const o=e.value;if(o!==void 0)return o}const Qt="2025-11-25",Zf=[Qt,"2025-06-18","2025-03-26","2024-11-05","2024-10-07"],He="io.modelcontextprotocol/related-task",Xt="2.0",Fe=yf(e=>e!==null&&(typeof e=="object"||typeof e=="function")),xs=ge([P(),ue().int()]),Us=P(),Lf=Ce({ttl:ge([ue(),ws()]).optional(),pollInterval:ue().optional()}),$n=Ce({taskId:P()}),Ff=Ce({progressToken:xs.optional(),[He]:$n.optional()}),Ne=Ce({task:Lf.optional(),_meta:Ff.optional()}),ke=V({method:P(),params:Ne.optional()}),st=Ce({_meta:V({[He]:G($n)}).passthrough().optional()}),xe=V({method:P(),params:st.optional()}),Re=Ce({_meta:Ce({[He]:$n.optional()}).optional()}),er=ge([P(),ue().int()]),Ds=V({jsonrpc:B(Xt),id:er,...ke.shape}).strict(),kn=e=>Ds.safeParse(e).success,Vs=V({jsonrpc:B(Xt),...xe.shape}).strict(),Hf=e=>Vs.safeParse(e).success,Zs=V({jsonrpc:B(Xt),id:er,result:Re}).strict(),Rt=e=>Zs.safeParse(e).success;var te;(function(e){e[e.ConnectionClosed=-32e3]="ConnectionClosed",e[e.RequestTimeout=-32001]="RequestTimeout",e[e.ParseError=-32700]="ParseError",e[e.InvalidRequest=-32600]="InvalidRequest",e[e.MethodNotFound=-32601]="MethodNotFound",e[e.InvalidParams=-32602]="InvalidParams",e[e.InternalError=-32603]="InternalError",e[e.UrlElicitationRequired=-32042]="UrlElicitationRequired"})(te||(te={}));const Ls=V({jsonrpc:B(Xt),id:er,error:V({code:ue().int(),message:P(),data:G(ye())})}).strict(),Kf=e=>Ls.safeParse(e).success,Sn=ge([Ds,Vs,Zs,Ls]),gt=Re.strict(),Wf=st.extend({requestId:er,reason:P().optional()}),En=xe.extend({method:B("notifications/cancelled"),params:Wf}),Bf=V({src:P(),mimeType:P().optional(),sizes:H(P()).optional()}),It=V({icons:H(Bf).optional()}),_t=V({name:P(),title:P().optional()}),Fs=_t.extend({..._t.shape,...It.shape,version:P(),websiteUrl:P().optional()}),Gf=_n(V({applyDefaults:he().optional()}),we(P(),ye())),Jf=Rs(e=>e&&typeof e=="object"&&!Array.isArray(e)&&Object.keys(e).length===0?{form:{}}:e,_n(V({form:Gf.optional(),url:Fe.optional()}),we(P(),ye()).optional())),Yf=V({list:G(V({}).passthrough()),cancel:G(V({}).passthrough()),requests:G(V({sampling:G(V({createMessage:G(V({}).passthrough())}).passthrough()),elicitation:G(V({create:G(V({}).passthrough())}).passthrough())}).passthrough())}).passthrough(),Qf=V({list:G(V({}).passthrough()),cancel:G(V({}).passthrough()),requests:G(V({tools:G(V({call:G(V({}).passthrough())}).passthrough())}).passthrough())}).passthrough(),Xf=V({experimental:we(P(),Fe).optional(),sampling:V({context:Fe.optional(),tools:Fe.optional()}).optional(),elicitation:Jf.optional(),roots:V({listChanged:he().optional()}).optional(),tasks:G(Yf)}),eh=Ne.extend({protocolVersion:P(),capabilities:Xf,clientInfo:Fs}),th=ke.extend({method:B("initialize"),params:eh}),rh=V({experimental:we(P(),Fe).optional(),logging:Fe.optional(),completions:Fe.optional(),prompts:G(V({listChanged:G(he())})),resources:V({subscribe:he().optional(),listChanged:he().optional()}).optional(),tools:V({listChanged:he().optional()}).optional(),tasks:G(Qf)}).passthrough(),Hs=Re.extend({protocolVersion:P(),capabilities:rh,serverInfo:Fs,instructions:P().optional()}),Ks=xe.extend({method:B("notifications/initialized")}),nh=e=>Ks.safeParse(e).success,Pn=ke.extend({method:B("ping")}),oh=V({progress:ue(),total:G(ue()),message:G(P())}),sh=V({...st.shape,...oh.shape,progressToken:xs}),Tn=xe.extend({method:B("notifications/progress"),params:sh}),ah=Ne.extend({cursor:Us.optional()}),Ot=ke.extend({params:ah.optional()}),Ct=Re.extend({nextCursor:G(Us)}),Nt=V({taskId:P(),status:Ae(["working","input_required","completed","failed","cancelled"]),ttl:ge([ue(),ws()]),createdAt:P(),lastUpdatedAt:P(),pollInterval:G(ue()),statusMessage:G(P())}),zt=Re.extend({task:Nt}),ih=st.merge(Nt),tr=xe.extend({method:B("notifications/tasks/status"),params:ih}),An=ke.extend({method:B("tasks/get"),params:Ne.extend({taskId:P()})}),Rn=Re.merge(Nt),In=ke.extend({method:B("tasks/result"),params:Ne.extend({taskId:P()})}),On=Ot.extend({method:B("tasks/list")}),Cn=Ct.extend({tasks:H(Nt)}),ch=ke.extend({method:B("tasks/cancel"),params:Ne.extend({taskId:P()})}),uh=Re.merge(Nt),Ws=V({uri:P(),mimeType:G(P()),_meta:we(P(),ye()).optional()}),Bs=Ws.extend({text:P()}),Nn=P().refine(e=>{try{return atob(e),!0}catch{return!1}},{message:"Invalid Base64 string"}),Gs=Ws.extend({blob:Nn}),vt=V({audience:H(Ae(["user","assistant"])).optional(),priority:ue().min(0).max(1).optional(),lastModified:ms({offset:!0}).optional()}),Js=V({..._t.shape,...It.shape,uri:P(),description:G(P()),mimeType:G(P()),annotations:vt.optional(),_meta:G(Ce({}))}),lh=V({..._t.shape,...It.shape,uriTemplate:P(),description:G(P()),mimeType:G(P()),annotations:vt.optional(),_meta:G(Ce({}))}),dh=Ot.extend({method:B("resources/list")}),Ys=Ct.extend({resources:H(Js)}),fh=Ot.extend({method:B("resources/templates/list")}),Qs=Ct.extend({resourceTemplates:H(lh)}),zn=Ne.extend({uri:P()}),hh=zn,mh=ke.extend({method:B("resources/read"),params:hh}),Xs=Re.extend({contents:H(ge([Bs,Gs]))}),ph=xe.extend({method:B("notifications/resources/list_changed")}),gh=zn,_h=ke.extend({method:B("resources/subscribe"),params:gh}),vh=zn,yh=ke.extend({method:B("resources/unsubscribe"),params:vh}),wh=st.extend({uri:P()}),bh=xe.extend({method:B("notifications/resources/updated"),params:wh}),$h=V({name:P(),description:G(P()),required:G(he())}),kh=V({..._t.shape,...It.shape,description:G(P()),arguments:G(H($h)),_meta:G(Ce({}))}),Sh=Ot.extend({method:B("prompts/list")}),ea=Ct.extend({prompts:H(kh)}),Eh=Ne.extend({name:P(),arguments:we(P(),P()).optional()}),Ph=ke.extend({method:B("prompts/get"),params:Eh}),jn=V({type:B("text"),text:P(),annotations:vt.optional(),_meta:we(P(),ye()).optional()}),qn=V({type:B("image"),data:Nn,mimeType:P(),annotations:vt.optional(),_meta:we(P(),ye()).optional()}),Mn=V({type:B("audio"),data:Nn,mimeType:P(),annotations:vt.optional(),_meta:we(P(),ye()).optional()}),Th=V({type:B("tool_use"),name:P(),id:P(),input:V({}).passthrough(),_meta:G(V({}).passthrough())}).passthrough(),Ah=V({type:B("resource"),resource:ge([Bs,Gs]),annotations:vt.optional(),_meta:we(P(),ye()).optional()}),Rh=Js.extend({type:B("resource_link")}),xn=ge([jn,qn,Mn,Rh,Ah]),Ih=V({role:Ae(["user","assistant"]),content:xn}),ta=Re.extend({description:G(P()),messages:H(Ih)}),Oh=xe.extend({method:B("notifications/prompts/list_changed")}),Ch=V({title:P().optional(),readOnlyHint:he().optional(),destructiveHint:he().optional(),idempotentHint:he().optional(),openWorldHint:he().optional()}),Nh=V({taskSupport:Ae(["required","optional","forbidden"]).optional()}),ra=V({..._t.shape,...It.shape,description:P().optional(),inputSchema:V({type:B("object"),properties:we(P(),Fe).optional(),required:H(P()).optional()}).catchall(ye()),outputSchema:V({type:B("object"),properties:we(P(),Fe).optional(),required:H(P()).optional()}).catchall(ye()).optional(),annotations:G(Ch),execution:G(Nh),_meta:we(P(),ye()).optional()}),zh=Ot.extend({method:B("tools/list")}),na=Ct.extend({tools:H(ra)}),rr=Re.extend({content:H(xn).default([]),structuredContent:we(P(),ye()).optional(),isError:G(he())});rr.or(Re.extend({toolResult:ye()}));const jh=Ne.extend({name:P(),arguments:G(we(P(),ye()))}),qh=ke.extend({method:B("tools/call"),params:jh}),Mh=xe.extend({method:B("notifications/tools/list_changed")}),oa=Ae(["debug","info","notice","warning","error","critical","alert","emergency"]),xh=Ne.extend({level:oa}),Uh=ke.extend({method:B("logging/setLevel"),params:xh}),Dh=st.extend({level:oa,logger:P().optional(),data:ye()}),Vh=xe.extend({method:B("notifications/message"),params:Dh}),Zh=V({name:P().optional()}),Lh=V({hints:G(H(Zh)),costPriority:G(ue().min(0).max(1)),speedPriority:G(ue().min(0).max(1)),intelligencePriority:G(ue().min(0).max(1))}),Fh=V({mode:G(Ae(["auto","required","none"]))}),Hh=V({type:B("tool_result"),toolUseId:P().describe("The unique identifier for the corresponding tool call."),content:H(xn).default([]),structuredContent:V({}).passthrough().optional(),isError:G(he()),_meta:G(V({}).passthrough())}).passthrough(),Kh=ks("type",[jn,qn,Mn]),nr=ks("type",[jn,qn,Mn,Th,Hh]),Wh=V({role:Ae(["user","assistant"]),content:ge([nr,H(nr)]),_meta:G(V({}).passthrough())}).passthrough(),Bh=Ne.extend({messages:H(Wh),modelPreferences:Lh.optional(),systemPrompt:P().optional(),includeContext:Ae(["none","thisServer","allServers"]).optional(),temperature:ue().optional(),maxTokens:ue().int(),stopSequences:H(P()).optional(),metadata:Fe.optional(),tools:G(H(ra)),toolChoice:G(Fh)}),sa=ke.extend({method:B("sampling/createMessage"),params:Bh}),aa=Re.extend({model:P(),stopReason:G(Ae(["endTurn","stopSequence","maxTokens"]).or(P())),role:Ae(["user","assistant"]),content:Kh}),Gh=Re.extend({model:P(),stopReason:G(Ae(["endTurn","stopSequence","maxTokens","toolUse"]).or(P())),role:Ae(["user","assistant"]),content:ge([nr,H(nr)])}),Jh=V({type:B("boolean"),title:P().optional(),description:P().optional(),default:he().optional()}),Yh=V({type:B("string"),title:P().optional(),description:P().optional(),minLength:ue().optional(),maxLength:ue().optional(),format:Ae(["email","uri","date","date-time"]).optional(),default:P().optional()}),Qh=V({type:Ae(["number","integer"]),title:P().optional(),description:P().optional(),minimum:ue().optional(),maximum:ue().optional(),default:ue().optional()}),Xh=V({type:B("string"),title:P().optional(),description:P().optional(),enum:H(P()),default:P().optional()}),em=V({type:B("string"),title:P().optional(),description:P().optional(),oneOf:H(V({const:P(),title:P()})),default:P().optional()}),tm=V({type:B("string"),title:P().optional(),description:P().optional(),enum:H(P()),enumNames:H(P()).optional(),default:P().optional()}),rm=ge([Xh,em]),nm=V({type:B("array"),title:P().optional(),description:P().optional(),minItems:ue().optional(),maxItems:ue().optional(),items:V({type:B("string"),enum:H(P())}),default:H(P()).optional()}),om=V({type:B("array"),title:P().optional(),description:P().optional(),minItems:ue().optional(),maxItems:ue().optional(),items:V({anyOf:H(V({const:P(),title:P()}))}),default:H(P()).optional()}),sm=ge([nm,om]),am=ge([tm,rm,sm]),im=ge([am,Jh,Yh,Qh]),cm=Ne.extend({mode:B("form").optional(),message:P(),requestedSchema:V({type:B("object"),properties:we(P(),im),required:H(P()).optional()})}),um=Ne.extend({mode:B("url"),message:P(),elicitationId:P(),url:P().url()}),lm=ge([cm,um]),ia=ke.extend({method:B("elicitation/create"),params:lm}),dm=st.extend({elicitationId:P()}),fm=xe.extend({method:B("notifications/elicitation/complete"),params:dm}),ca=Re.extend({action:Ae(["accept","decline","cancel"]),content:Rs(e=>e===null?void 0:e,we(P(),ge([P(),ue(),he(),H(P())])).optional())}),hm=V({type:B("ref/resource"),uri:P()}),mm=V({type:B("ref/prompt"),name:P()}),pm=Ne.extend({ref:ge([mm,hm]),argument:V({name:P(),value:P()}),context:V({arguments:we(P(),P()).optional()}).optional()}),gm=ke.extend({method:B("completion/complete"),params:pm}),ua=Re.extend({completion:Ce({values:H(P()).max(100),total:G(ue().int()),hasMore:G(he())})}),_m=V({uri:P().startsWith("file://"),name:P().optional(),_meta:we(P(),ye()).optional()}),vm=ke.extend({method:B("roots/list")}),ym=Re.extend({roots:H(_m)}),wm=xe.extend({method:B("notifications/roots/list_changed")});ge([Pn,th,gm,Uh,Ph,Sh,dh,fh,mh,_h,yh,qh,zh,An,In,On]),ge([En,Tn,Ks,wm,tr]),ge([gt,aa,Gh,ca,ym,Rn,Cn,zt]),ge([Pn,sa,ia,vm,An,In,On]),ge([En,Tn,Vh,bh,ph,Mh,Oh,tr,fm]),ge([gt,Hs,ua,ta,ea,Ys,Qs,Xs,rr,na,Rn,Cn,zt]);class X extends Error{constructor(t,r,n){super(`MCP error ${t}: ${r}`),this.code=t,this.data=n,this.name="McpError"}static fromError(t,r,n){if(t===te.UrlElicitationRequired&&n){const o=n;if(o.elicitations)return new bm(o.elicitations,r)}return new X(t,r,n)}}class bm extends X{constructor(t,r=`URL elicitation${t.length>1?"s":""} required`){super(te.UrlElicitationRequired,r,{elicitations:t})}get elicitations(){var t,r;return(r=(t=this.data)===null||t===void 0?void 0:t.elicitations)!==null&&r!==void 0?r:[]}}function at(e){return e==="completed"||e==="failed"||e==="cancelled"}new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function la(e){const t=Ms(e),r=t?.method;if(!r)throw new Error("Schema is missing a method literal");const n=Vf(r);if(typeof n!="string")throw new Error("Schema method literal must be a string");return n}function da(e,t){const r=Qe(e,t);if(!r.success)throw r.error;return r.data}const $m=6e4;class km{constructor(t){this._options=t,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this._pendingDebouncedNotifications=new Set,this._taskProgressTokens=new Map,this._requestResolvers=new Map,this.setNotificationHandler(En,r=>{this._oncancel(r)}),this.setNotificationHandler(Tn,r=>{this._onprogress(r)}),this.setRequestHandler(Pn,r=>({})),this._taskStore=t?.taskStore,this._taskMessageQueue=t?.taskMessageQueue,this._taskStore&&(this.setRequestHandler(An,async(r,n)=>{const o=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!o)throw new X(te.InvalidParams,"Failed to retrieve task: Task not found");return{...o}}),this.setRequestHandler(In,async(r,n)=>{const o=async()=>{var s;const a=r.params.taskId;if(this._taskMessageQueue){let c;for(;c=await this._taskMessageQueue.dequeue(a,n.sessionId);){if(c.type==="response"||c.type==="error"){const m=c.message,h=m.id,b=this._requestResolvers.get(h);if(b)if(this._requestResolvers.delete(h),c.type==="response")b(m);else{const y=m,$=new X(y.error.code,y.error.message,y.error.data);b($)}else{const y=c.type==="response"?"Response":"Error";this._onerror(new Error(`${y} handler missing for request ${h}`))}continue}await((s=this._transport)===null||s===void 0?void 0:s.send(c.message,{relatedRequestId:n.requestId}))}}const i=await this._taskStore.getTask(a,n.sessionId);if(!i)throw new X(te.InvalidParams,`Task not found: ${a}`);if(!at(i.status))return await this._waitForTaskUpdate(a,n.signal),await o();if(at(i.status)){const c=await this._taskStore.getTaskResult(a,n.sessionId);return this._clearTaskQueue(a),{...c,_meta:{...c._meta,[He]:{taskId:a}}}}return await o()};return await o()}),this.setRequestHandler(On,async(r,n)=>{var o;try{const{tasks:s,nextCursor:a}=await this._taskStore.listTasks((o=r.params)===null||o===void 0?void 0:o.cursor,n.sessionId);return{tasks:s,nextCursor:a,_meta:{}}}catch(s){throw new X(te.InvalidParams,`Failed to list tasks: ${s instanceof Error?s.message:String(s)}`)}}),this.setRequestHandler(ch,async(r,n)=>{try{const o=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!o)throw new X(te.InvalidParams,`Task not found: ${r.params.taskId}`);if(at(o.status))throw new X(te.InvalidParams,`Cannot cancel task in terminal status: ${o.status}`);await this._taskStore.updateTaskStatus(r.params.taskId,"cancelled","Client cancelled task execution.",n.sessionId),this._clearTaskQueue(r.params.taskId);const s=await this._taskStore.getTask(r.params.taskId,n.sessionId);if(!s)throw new X(te.InvalidParams,`Task not found after cancellation: ${r.params.taskId}`);return{_meta:{},...s}}catch(o){throw o instanceof X?o:new X(te.InvalidRequest,`Failed to cancel task: ${o instanceof Error?o.message:String(o)}`)}}))}async _oncancel(t){const r=this._requestHandlerAbortControllers.get(t.params.requestId);r?.abort(t.params.reason)}_setupTimeout(t,r,n,o,s=!1){this._timeoutInfo.set(t,{timeoutId:setTimeout(o,r),startTime:Date.now(),timeout:r,maxTotalTimeout:n,resetTimeoutOnProgress:s,onTimeout:o})}_resetTimeout(t){const r=this._timeoutInfo.get(t);if(!r)return!1;const n=Date.now()-r.startTime;if(r.maxTotalTimeout&&n>=r.maxTotalTimeout)throw this._timeoutInfo.delete(t),X.fromError(te.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:r.maxTotalTimeout,totalElapsed:n});return clearTimeout(r.timeoutId),r.timeoutId=setTimeout(r.onTimeout,r.timeout),!0}_cleanupTimeout(t){const r=this._timeoutInfo.get(t);r&&(clearTimeout(r.timeoutId),this._timeoutInfo.delete(t))}async connect(t){var r,n,o;this._transport=t;const s=(r=this.transport)===null||r===void 0?void 0:r.onclose;this._transport.onclose=()=>{s?.(),this._onclose()};const a=(n=this.transport)===null||n===void 0?void 0:n.onerror;this._transport.onerror=c=>{a?.(c),this._onerror(c)};const i=(o=this._transport)===null||o===void 0?void 0:o.onmessage;this._transport.onmessage=(c,m)=>{i?.(c,m),Rt(c)||Kf(c)?this._onresponse(c):kn(c)?this._onrequest(c,m):Hf(c)?this._onnotification(c):this._onerror(new Error(`Unknown message type: ${JSON.stringify(c)}`))},await this._transport.start()}_onclose(){var t;const r=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._taskProgressTokens.clear(),this._pendingDebouncedNotifications.clear();const n=X.fromError(te.ConnectionClosed,"Connection closed");this._transport=void 0,(t=this.onclose)===null||t===void 0||t.call(this);for(const o of r.values())o(n)}_onerror(t){var r;(r=this.onerror)===null||r===void 0||r.call(this,t)}_onnotification(t){var r;const n=(r=this._notificationHandlers.get(t.method))!==null&&r!==void 0?r:this.fallbackNotificationHandler;n!==void 0&&Promise.resolve().then(()=>n(t)).catch(o=>this._onerror(new Error(`Uncaught error in notification handler: ${o}`)))}_onrequest(t,r){var n,o,s,a,i,c;const m=(n=this._requestHandlers.get(t.method))!==null&&n!==void 0?n:this.fallbackRequestHandler,h=this._transport,b=(a=(s=(o=t.params)===null||o===void 0?void 0:o._meta)===null||s===void 0?void 0:s[He])===null||a===void 0?void 0:a.taskId;if(m===void 0){const l={jsonrpc:"2.0",id:t.id,error:{code:te.MethodNotFound,message:"Method not found"}};b&&this._taskMessageQueue?this._enqueueTaskMessage(b,{type:"error",message:l,timestamp:Date.now()},h?.sessionId).catch(d=>this._onerror(new Error(`Failed to enqueue error response: ${d}`))):h?.send(l).catch(d=>this._onerror(new Error(`Failed to send an error response: ${d}`)));return}const y=new AbortController;this._requestHandlerAbortControllers.set(t.id,y);const $=(i=t.params)===null||i===void 0?void 0:i.task,w=this._taskStore?this.requestTaskStore(t,h?.sessionId):void 0,_={signal:y.signal,sessionId:h?.sessionId,_meta:(c=t.params)===null||c===void 0?void 0:c._meta,sendNotification:async l=>{const d={relatedRequestId:t.id};b&&(d.relatedTask={taskId:b}),await this.notification(l,d)},sendRequest:async(l,d,u)=>{var f,v;const p={...u,relatedRequestId:t.id};b&&!p.relatedTask&&(p.relatedTask={taskId:b});const g=(v=(f=p.relatedTask)===null||f===void 0?void 0:f.taskId)!==null&&v!==void 0?v:b;return g&&w&&await w.updateTaskStatus(g,"input_required"),await this.request(l,d,p)},authInfo:r?.authInfo,requestId:t.id,requestInfo:r?.requestInfo,taskId:b,taskStore:w,taskRequestedTtl:$?.ttl,closeSSEStream:r?.closeSSEStream,closeStandaloneSSEStream:r?.closeStandaloneSSEStream};Promise.resolve().then(()=>{$&&this.assertTaskHandlerCapability(t.method)}).then(()=>m(t,_)).then(async l=>{if(y.signal.aborted)return;const d={result:l,jsonrpc:"2.0",id:t.id};b&&this._taskMessageQueue?await this._enqueueTaskMessage(b,{type:"response",message:d,timestamp:Date.now()},h?.sessionId):await h?.send(d)},async l=>{var d;if(y.signal.aborted)return;const u={jsonrpc:"2.0",id:t.id,error:{code:Number.isSafeInteger(l.code)?l.code:te.InternalError,message:(d=l.message)!==null&&d!==void 0?d:"Internal error",...l.data!==void 0&&{data:l.data}}};b&&this._taskMessageQueue?await this._enqueueTaskMessage(b,{type:"error",message:u,timestamp:Date.now()},h?.sessionId):await h?.send(u)}).catch(l=>this._onerror(new Error(`Failed to send response: ${l}`))).finally(()=>{this._requestHandlerAbortControllers.delete(t.id)})}_onprogress(t){const{progressToken:r,...n}=t.params,o=Number(r),s=this._progressHandlers.get(o);if(!s){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(t)}`));return}const a=this._responseHandlers.get(o),i=this._timeoutInfo.get(o);if(i&&a&&i.resetTimeoutOnProgress)try{this._resetTimeout(o)}catch(c){this._responseHandlers.delete(o),this._progressHandlers.delete(o),this._cleanupTimeout(o),a(c);return}s(n)}_onresponse(t){const r=Number(t.id),n=this._requestResolvers.get(r);if(n){if(this._requestResolvers.delete(r),Rt(t))n(t);else{const a=new X(t.error.code,t.error.message,t.error.data);n(a)}return}const o=this._responseHandlers.get(r);if(o===void 0){this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(t)}`));return}this._responseHandlers.delete(r),this._cleanupTimeout(r);let s=!1;if(Rt(t)&&t.result&&typeof t.result=="object"){const a=t.result;if(a.task&&typeof a.task=="object"){const i=a.task;typeof i.taskId=="string"&&(s=!0,this._taskProgressTokens.set(i.taskId,r))}}if(s||this._progressHandlers.delete(r),Rt(t))o(t);else{const a=X.fromError(t.error.code,t.error.message,t.error.data);o(a)}}get transport(){return this._transport}async close(){var t;await((t=this._transport)===null||t===void 0?void 0:t.close())}async*requestStream(t,r,n){var o,s,a,i;const{task:c}=n??{};if(!c){try{yield{type:"result",result:await this.request(t,r,n)}}catch(h){yield{type:"error",error:h instanceof X?h:new X(te.InternalError,String(h))}}return}let m;try{const h=await this.request(t,zt,n);if(h.task)m=h.task.taskId,yield{type:"taskCreated",task:h.task};else throw new X(te.InternalError,"Task creation did not return a task");for(;;){const b=await this.getTask({taskId:m},n);if(yield{type:"taskStatus",task:b},at(b.status)){b.status==="completed"?yield{type:"result",result:await this.getTaskResult({taskId:m},r,n)}:b.status==="failed"?yield{type:"error",error:new X(te.InternalError,`Task ${m} failed`)}:b.status==="cancelled"&&(yield{type:"error",error:new X(te.InternalError,`Task ${m} was cancelled`)});return}if(b.status==="input_required"){yield{type:"result",result:await this.getTaskResult({taskId:m},r,n)};return}const y=(a=(o=b.pollInterval)!==null&&o!==void 0?o:(s=this._options)===null||s===void 0?void 0:s.defaultTaskPollInterval)!==null&&a!==void 0?a:1e3;await new Promise($=>setTimeout($,y)),(i=n?.signal)===null||i===void 0||i.throwIfAborted()}}catch(h){yield{type:"error",error:h instanceof X?h:new X(te.InternalError,String(h))}}}request(t,r,n){const{relatedRequestId:o,resumptionToken:s,onresumptiontoken:a,task:i,relatedTask:c}=n??{};return new Promise((m,h)=>{var b,y,$,w,_,l,d;const u=R=>{h(R)};if(!this._transport){u(new Error("Not connected"));return}if(((b=this._options)===null||b===void 0?void 0:b.enforceStrictCapabilities)===!0)try{this.assertCapabilityForMethod(t.method),i&&this.assertTaskCapability(t.method)}catch(R){u(R);return}(y=n?.signal)===null||y===void 0||y.throwIfAborted();const f=this._requestMessageId++,v={...t,jsonrpc:"2.0",id:f};n?.onprogress&&(this._progressHandlers.set(f,n.onprogress),v.params={...t.params,_meta:{...(($=t.params)===null||$===void 0?void 0:$._meta)||{},progressToken:f}}),i&&(v.params={...v.params,task:i}),c&&(v.params={...v.params,_meta:{...((w=v.params)===null||w===void 0?void 0:w._meta)||{},[He]:c}});const p=R=>{var q;this._responseHandlers.delete(f),this._progressHandlers.delete(f),this._cleanupTimeout(f),(q=this._transport)===null||q===void 0||q.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:f,reason:String(R)}},{relatedRequestId:o,resumptionToken:s,onresumptiontoken:a}).catch(x=>this._onerror(new Error(`Failed to send cancellation: ${x}`)));const N=R instanceof X?R:new X(te.RequestTimeout,String(R));h(N)};this._responseHandlers.set(f,R=>{var q;if(!(!((q=n?.signal)===null||q===void 0)&&q.aborted)){if(R instanceof Error)return h(R);try{const N=Qe(r,R.result);N.success?m(N.data):h(N.error)}catch(N){h(N)}}}),(_=n?.signal)===null||_===void 0||_.addEventListener("abort",()=>{var R;p((R=n?.signal)===null||R===void 0?void 0:R.reason)});const g=(l=n?.timeout)!==null&&l!==void 0?l:$m,S=()=>p(X.fromError(te.RequestTimeout,"Request timed out",{timeout:g}));this._setupTimeout(f,g,n?.maxTotalTimeout,S,(d=n?.resetTimeoutOnProgress)!==null&&d!==void 0?d:!1);const T=c?.taskId;if(T){const R=q=>{const N=this._responseHandlers.get(f);N?N(q):this._onerror(new Error(`Response handler missing for side-channeled request ${f}`))};this._requestResolvers.set(f,R),this._enqueueTaskMessage(T,{type:"request",message:v,timestamp:Date.now()}).catch(q=>{this._cleanupTimeout(f),h(q)})}else this._transport.send(v,{relatedRequestId:o,resumptionToken:s,onresumptiontoken:a}).catch(R=>{this._cleanupTimeout(f),h(R)})})}async getTask(t,r){return this.request({method:"tasks/get",params:t},Rn,r)}async getTaskResult(t,r,n){return this.request({method:"tasks/result",params:t},r,n)}async listTasks(t,r){return this.request({method:"tasks/list",params:t},Cn,r)}async cancelTask(t,r){return this.request({method:"tasks/cancel",params:t},uh,r)}async notification(t,r){var n,o,s,a,i;if(!this._transport)throw new Error("Not connected");this.assertNotificationCapability(t.method);const c=(n=r?.relatedTask)===null||n===void 0?void 0:n.taskId;if(c){const y={...t,jsonrpc:"2.0",params:{...t.params,_meta:{...((o=t.params)===null||o===void 0?void 0:o._meta)||{},[He]:r.relatedTask}}};await this._enqueueTaskMessage(c,{type:"notification",message:y,timestamp:Date.now()});return}if(((a=(s=this._options)===null||s===void 0?void 0:s.debouncedNotificationMethods)!==null&&a!==void 0?a:[]).includes(t.method)&&!t.params&&!r?.relatedRequestId&&!r?.relatedTask){if(this._pendingDebouncedNotifications.has(t.method))return;this._pendingDebouncedNotifications.add(t.method),Promise.resolve().then(()=>{var y,$;if(this._pendingDebouncedNotifications.delete(t.method),!this._transport)return;let w={...t,jsonrpc:"2.0"};r?.relatedTask&&(w={...w,params:{...w.params,_meta:{...((y=w.params)===null||y===void 0?void 0:y._meta)||{},[He]:r.relatedTask}}}),($=this._transport)===null||$===void 0||$.send(w,r).catch(_=>this._onerror(_))});return}let b={...t,jsonrpc:"2.0"};r?.relatedTask&&(b={...b,params:{...b.params,_meta:{...((i=b.params)===null||i===void 0?void 0:i._meta)||{},[He]:r.relatedTask}}}),await this._transport.send(b,r)}setRequestHandler(t,r){const n=la(t);this.assertRequestHandlerCapability(n),this._requestHandlers.set(n,(o,s)=>{const a=da(t,o);return Promise.resolve(r(a,s))})}removeRequestHandler(t){this._requestHandlers.delete(t)}assertCanSetRequestHandler(t){if(this._requestHandlers.has(t))throw new Error(`A request handler for ${t} already exists, which would be overridden`)}setNotificationHandler(t,r){const n=la(t);this._notificationHandlers.set(n,o=>{const s=da(t,o);return Promise.resolve(r(s))})}removeNotificationHandler(t){this._notificationHandlers.delete(t)}_cleanupTaskProgressHandler(t){const r=this._taskProgressTokens.get(t);r!==void 0&&(this._progressHandlers.delete(r),this._taskProgressTokens.delete(t))}async _enqueueTaskMessage(t,r,n){var o;if(!this._taskStore||!this._taskMessageQueue)throw new Error("Cannot enqueue task message: taskStore and taskMessageQueue are not configured");const s=(o=this._options)===null||o===void 0?void 0:o.maxTaskQueueSize;await this._taskMessageQueue.enqueue(t,r,n,s)}async _clearTaskQueue(t,r){if(this._taskMessageQueue){const n=await this._taskMessageQueue.dequeueAll(t,r);for(const o of n)if(o.type==="request"&&kn(o.message)){const s=o.message.id,a=this._requestResolvers.get(s);a?(a(new X(te.InternalError,"Task cancelled or completed")),this._requestResolvers.delete(s)):this._onerror(new Error(`Resolver missing for request ${s} during task ${t} cleanup`))}}}async _waitForTaskUpdate(t,r){var n,o,s;let a=(o=(n=this._options)===null||n===void 0?void 0:n.defaultTaskPollInterval)!==null&&o!==void 0?o:1e3;try{const i=await((s=this._taskStore)===null||s===void 0?void 0:s.getTask(t));i?.pollInterval&&(a=i.pollInterval)}catch{}return new Promise((i,c)=>{if(r.aborted){c(new X(te.InvalidRequest,"Request cancelled"));return}const m=setTimeout(i,a);r.addEventListener("abort",()=>{clearTimeout(m),c(new X(te.InvalidRequest,"Request cancelled"))},{once:!0})})}requestTaskStore(t,r){const n=this._taskStore;if(!n)throw new Error("No task store configured");return{createTask:async o=>{if(!t)throw new Error("No request provided");return await n.createTask(o,t.id,{method:t.method,params:t.params},r)},getTask:async o=>{const s=await n.getTask(o,r);if(!s)throw new X(te.InvalidParams,"Failed to retrieve task: Task not found");return s},storeTaskResult:async(o,s,a)=>{await n.storeTaskResult(o,s,a,r);const i=await n.getTask(o,r);if(i){const c=tr.parse({method:"notifications/tasks/status",params:i});await this.notification(c),at(i.status)&&this._cleanupTaskProgressHandler(o)}},getTaskResult:o=>n.getTaskResult(o,r),updateTaskStatus:async(o,s,a)=>{const i=await n.getTask(o,r);if(!i)throw new X(te.InvalidParams,`Task "${o}" not found - it may have been cleaned up`);if(at(i.status))throw new X(te.InvalidParams,`Cannot update task "${o}" from terminal status "${i.status}" to "${s}". Terminal states (completed, failed, cancelled) cannot transition to other states.`);await n.updateTaskStatus(o,s,a,r);const c=await n.getTask(o,r);if(c){const m=tr.parse({method:"notifications/tasks/status",params:c});await this.notification(m),at(c.status)&&this._cleanupTaskProgressHandler(o)}},listTasks:o=>n.listTasks(o,r)}}}function fa(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}function Sm(e,t){const r={...e};for(const n in t){const o=n,s=t[o];if(s===void 0)continue;const a=r[o];fa(a)&&fa(s)?r[o]={...a,...s}:r[o]=s}return r}function ha(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var or={exports:{}},Un={},Ke={},it={},Dn={},Vn={},Zn={},ma;function sr(){return ma||(ma=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.regexpCode=e.getEsmExportName=e.getProperty=e.safeStringify=e.stringify=e.strConcat=e.addCodeArg=e.str=e._=e.nil=e._Code=e.Name=e.IDENTIFIER=e._CodeOrName=void 0;class t{}e._CodeOrName=t,e.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class r extends t{constructor(u){if(super(),!e.IDENTIFIER.test(u))throw new Error("CodeGen: name must be a valid identifier");this.str=u}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}e.Name=r;class n extends t{constructor(u){super(),this._items=typeof u=="string"?[u]:u}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const u=this._items[0];return u===""||u==='""'}get str(){var u;return(u=this._str)!==null&&u!==void 0?u:this._str=this._items.reduce((f,v)=>`${f}${v}`,"")}get names(){var u;return(u=this._names)!==null&&u!==void 0?u:this._names=this._items.reduce((f,v)=>(v instanceof r&&(f[v.str]=(f[v.str]||0)+1),f),{})}}e._Code=n,e.nil=new n("");function o(d,...u){const f=[d[0]];let v=0;for(;v<u.length;)i(f,u[v]),f.push(d[++v]);return new n(f)}e._=o;const s=new n("+");function a(d,...u){const f=[$(d[0])];let v=0;for(;v<u.length;)f.push(s),i(f,u[v]),f.push(s,$(d[++v]));return c(f),new n(f)}e.str=a;function i(d,u){u instanceof n?d.push(...u._items):u instanceof r?d.push(u):d.push(b(u))}e.addCodeArg=i;function c(d){let u=1;for(;u<d.length-1;){if(d[u]===s){const f=m(d[u-1],d[u+1]);if(f!==void 0){d.splice(u-1,3,f);continue}d[u++]="+"}u++}}function m(d,u){if(u==='""')return d;if(d==='""')return u;if(typeof d=="string")return u instanceof r||d[d.length-1]!=='"'?void 0:typeof u!="string"?`${d.slice(0,-1)}${u}"`:u[0]==='"'?d.slice(0,-1)+u.slice(1):void 0;if(typeof u=="string"&&u[0]==='"'&&!(d instanceof r))return`"${d}${u.slice(1)}`}function h(d,u){return u.emptyStr()?d:d.emptyStr()?u:a`${d}${u}`}e.strConcat=h;function b(d){return typeof d=="number"||typeof d=="boolean"||d===null?d:$(Array.isArray(d)?d.join(","):d)}function y(d){return new n($(d))}e.stringify=y;function $(d){return JSON.stringify(d).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}e.safeStringify=$;function w(d){return typeof d=="string"&&e.IDENTIFIER.test(d)?new n(`.${d}`):o`[${d}]`}e.getProperty=w;function _(d){if(typeof d=="string"&&e.IDENTIFIER.test(d))return new n(`${d}`);throw new Error(`CodeGen: invalid export name: ${d}, use explicit $id name mapping`)}e.getEsmExportName=_;function l(d){return new n(d.toString())}e.regexpCode=l})(Zn)),Zn}var Ln={},pa;function ga(){return pa||(pa=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ValueScope=e.ValueScopeName=e.Scope=e.varKinds=e.UsedValueState=void 0;const t=sr();class r extends Error{constructor(m){super(`CodeGen: "code" for ${m} not defined`),this.value=m.value}}var n;(function(c){c[c.Started=0]="Started",c[c.Completed=1]="Completed"})(n||(e.UsedValueState=n={})),e.varKinds={const:new t.Name("const"),let:new t.Name("let"),var:new t.Name("var")};class o{constructor({prefixes:m,parent:h}={}){this._names={},this._prefixes=m,this._parent=h}toName(m){return m instanceof t.Name?m:this.name(m)}name(m){return new t.Name(this._newName(m))}_newName(m){const h=this._names[m]||this._nameGroup(m);return`${m}${h.index++}`}_nameGroup(m){var h,b;if(!((b=(h=this._parent)===null||h===void 0?void 0:h._prefixes)===null||b===void 0)&&b.has(m)||this._prefixes&&!this._prefixes.has(m))throw new Error(`CodeGen: prefix "${m}" is not allowed in this scope`);return this._names[m]={prefix:m,index:0}}}e.Scope=o;class s extends t.Name{constructor(m,h){super(h),this.prefix=m}setValue(m,{property:h,itemIndex:b}){this.value=m,this.scopePath=(0,t._)`.${new t.Name(h)}[${b}]`}}e.ValueScopeName=s;const a=(0,t._)`\n`;class i extends o{constructor(m){super(m),this._values={},this._scope=m.scope,this.opts={...m,_n:m.lines?a:t.nil}}get(){return this._scope}name(m){return new s(m,this._newName(m))}value(m,h){var b;if(h.ref===void 0)throw new Error("CodeGen: ref must be passed in value");const y=this.toName(m),{prefix:$}=y,w=(b=h.key)!==null&&b!==void 0?b:h.ref;let _=this._values[$];if(_){const u=_.get(w);if(u)return u}else _=this._values[$]=new Map;_.set(w,y);const l=this._scope[$]||(this._scope[$]=[]),d=l.length;return l[d]=h.ref,y.setValue(h,{property:$,itemIndex:d}),y}getValue(m,h){const b=this._values[m];if(b)return b.get(h)}scopeRefs(m,h=this._values){return this._reduceValues(h,b=>{if(b.scopePath===void 0)throw new Error(`CodeGen: name "${b}" has no value`);return(0,t._)`${m}${b.scopePath}`})}scopeCode(m=this._values,h,b){return this._reduceValues(m,y=>{if(y.value===void 0)throw new Error(`CodeGen: name "${y}" has no value`);return y.value.code},h,b)}_reduceValues(m,h,b={},y){let $=t.nil;for(const w in m){const _=m[w];if(!_)continue;const l=b[w]=b[w]||new Map;_.forEach(d=>{if(l.has(d))return;l.set(d,n.Started);let u=h(d);if(u){const f=this.opts.es5?e.varKinds.var:e.varKinds.const;$=(0,t._)`${$}${f} ${d} = ${u};${this.opts._n}`}else if(u=y?.(d))$=(0,t._)`${$}${u}${this.opts._n}`;else throw new r(d);l.set(d,n.Completed)})}return $}}e.ValueScope=i})(Ln)),Ln}var _a;function re(){return _a||(_a=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.or=e.and=e.not=e.CodeGen=e.operators=e.varKinds=e.ValueScopeName=e.ValueScope=e.Scope=e.Name=e.regexpCode=e.stringify=e.getProperty=e.nil=e.strConcat=e.str=e._=void 0;const t=sr(),r=ga();var n=sr();Object.defineProperty(e,"_",{enumerable:!0,get:function(){return n._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return n.str}}),Object.defineProperty(e,"strConcat",{enumerable:!0,get:function(){return n.strConcat}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return n.nil}}),Object.defineProperty(e,"getProperty",{enumerable:!0,get:function(){return n.getProperty}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return n.stringify}}),Object.defineProperty(e,"regexpCode",{enumerable:!0,get:function(){return n.regexpCode}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return n.Name}});var o=ga();Object.defineProperty(e,"Scope",{enumerable:!0,get:function(){return o.Scope}}),Object.defineProperty(e,"ValueScope",{enumerable:!0,get:function(){return o.ValueScope}}),Object.defineProperty(e,"ValueScopeName",{enumerable:!0,get:function(){return o.ValueScopeName}}),Object.defineProperty(e,"varKinds",{enumerable:!0,get:function(){return o.varKinds}}),e.operators={GT:new t._Code(">"),GTE:new t._Code(">="),LT:new t._Code("<"),LTE:new t._Code("<="),EQ:new t._Code("==="),NEQ:new t._Code("!=="),NOT:new t._Code("!"),OR:new t._Code("||"),AND:new t._Code("&&"),ADD:new t._Code("+")};class s{optimizeNodes(){return this}optimizeNames(k,E){return this}}class a extends s{constructor(k,E,j){super(),this.varKind=k,this.name=E,this.rhs=j}render({es5:k,_n:E}){const j=k?r.varKinds.var:this.varKind,W=this.rhs===void 0?"":` = ${this.rhs}`;return`${j} ${this.name}${W};`+E}optimizeNames(k,E){if(k[this.name.str])return this.rhs&&(this.rhs=F(this.rhs,k,E)),this}get names(){return this.rhs instanceof t._CodeOrName?this.rhs.names:{}}}class i extends s{constructor(k,E,j){super(),this.lhs=k,this.rhs=E,this.sideEffects=j}render({_n:k}){return`${this.lhs} = ${this.rhs};`+k}optimizeNames(k,E){if(!(this.lhs instanceof t.Name&&!k[this.lhs.str]&&!this.sideEffects))return this.rhs=F(this.rhs,k,E),this}get names(){const k=this.lhs instanceof t.Name?{}:{...this.lhs.names};return M(k,this.rhs)}}class c extends i{constructor(k,E,j,W){super(k,j,W),this.op=E}render({_n:k}){return`${this.lhs} ${this.op}= ${this.rhs};`+k}}class m extends s{constructor(k){super(),this.label=k,this.names={}}render({_n:k}){return`${this.label}:`+k}}class h extends s{constructor(k){super(),this.label=k,this.names={}}render({_n:k}){return`break${this.label?` ${this.label}`:""};`+k}}class b extends s{constructor(k){super(),this.error=k}render({_n:k}){return`throw ${this.error};`+k}get names(){return this.error.names}}class y extends s{constructor(k){super(),this.code=k}render({_n:k}){return`${this.code};`+k}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(k,E){return this.code=F(this.code,k,E),this}get names(){return this.code instanceof t._CodeOrName?this.code.names:{}}}class $ extends s{constructor(k=[]){super(),this.nodes=k}render(k){return this.nodes.reduce((E,j)=>E+j.render(k),"")}optimizeNodes(){const{nodes:k}=this;let E=k.length;for(;E--;){const j=k[E].optimizeNodes();Array.isArray(j)?k.splice(E,1,...j):j?k[E]=j:k.splice(E,1)}return k.length>0?this:void 0}optimizeNames(k,E){const{nodes:j}=this;let W=j.length;for(;W--;){const Q=j[W];Q.optimizeNames(k,E)||(Y(k,Q.names),j.splice(W,1))}return j.length>0?this:void 0}get names(){return this.nodes.reduce((k,E)=>x(k,E.names),{})}}class w extends ${render(k){return"{"+k._n+super.render(k)+"}"+k._n}}class _ extends ${}class l extends w{}l.kind="else";class d extends w{constructor(k,E){super(E),this.condition=k}render(k){let E=`if(${this.condition})`+super.render(k);return this.else&&(E+="else "+this.else.render(k)),E}optimizeNodes(){super.optimizeNodes();const k=this.condition;if(k===!0)return this.nodes;let E=this.else;if(E){const j=E.optimizeNodes();E=this.else=Array.isArray(j)?new l(j):j}if(E)return k===!1?E instanceof d?E:E.nodes:this.nodes.length?this:new d(_e(k),E instanceof d?[E]:E.nodes);if(!(k===!1||!this.nodes.length))return this}optimizeNames(k,E){var j;if(this.else=(j=this.else)===null||j===void 0?void 0:j.optimizeNames(k,E),!!(super.optimizeNames(k,E)||this.else))return this.condition=F(this.condition,k,E),this}get names(){const k=super.names;return M(k,this.condition),this.else&&x(k,this.else.names),k}}d.kind="if";class u extends w{}u.kind="for";class f extends u{constructor(k){super(),this.iteration=k}render(k){return`for(${this.iteration})`+super.render(k)}optimizeNames(k,E){if(super.optimizeNames(k,E))return this.iteration=F(this.iteration,k,E),this}get names(){return x(super.names,this.iteration.names)}}class v extends u{constructor(k,E,j,W){super(),this.varKind=k,this.name=E,this.from=j,this.to=W}render(k){const E=k.es5?r.varKinds.var:this.varKind,{name:j,from:W,to:Q}=this;return`for(${E} ${j}=${W}; ${j}<${Q}; ${j}++)`+super.render(k)}get names(){const k=M(super.names,this.from);return M(k,this.to)}}class p extends u{constructor(k,E,j,W){super(),this.loop=k,this.varKind=E,this.name=j,this.iterable=W}render(k){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(k)}optimizeNames(k,E){if(super.optimizeNames(k,E))return this.iterable=F(this.iterable,k,E),this}get names(){return x(super.names,this.iterable.names)}}class g extends w{constructor(k,E,j){super(),this.name=k,this.args=E,this.async=j}render(k){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(k)}}g.kind="func";class S extends ${render(k){return"return "+super.render(k)}}S.kind="return";class T extends w{render(k){let E="try"+super.render(k);return this.catch&&(E+=this.catch.render(k)),this.finally&&(E+=this.finally.render(k)),E}optimizeNodes(){var k,E;return super.optimizeNodes(),(k=this.catch)===null||k===void 0||k.optimizeNodes(),(E=this.finally)===null||E===void 0||E.optimizeNodes(),this}optimizeNames(k,E){var j,W;return super.optimizeNames(k,E),(j=this.catch)===null||j===void 0||j.optimizeNames(k,E),(W=this.finally)===null||W===void 0||W.optimizeNames(k,E),this}get names(){const k=super.names;return this.catch&&x(k,this.catch.names),this.finally&&x(k,this.finally.names),k}}class R extends w{constructor(k){super(),this.error=k}render(k){return`catch(${this.error})`+super.render(k)}}R.kind="catch";class q extends w{render(k){return"finally"+super.render(k)}}q.kind="finally";class N{constructor(k,E={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...E,_n:E.lines?`
`:""},this._extScope=k,this._scope=new r.Scope({parent:k}),this._nodes=[new _]}toString(){return this._root.render(this.opts)}name(k){return this._scope.name(k)}scopeName(k){return this._extScope.name(k)}scopeValue(k,E){const j=this._extScope.value(k,E);return(this._values[j.prefix]||(this._values[j.prefix]=new Set)).add(j),j}getScopeValue(k,E){return this._extScope.getValue(k,E)}scopeRefs(k){return this._extScope.scopeRefs(k,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(k,E,j,W){const Q=this._scope.toName(E);return j!==void 0&&W&&(this._constants[Q.str]=j),this._leafNode(new a(k,Q,j)),Q}const(k,E,j){return this._def(r.varKinds.const,k,E,j)}let(k,E,j){return this._def(r.varKinds.let,k,E,j)}var(k,E,j){return this._def(r.varKinds.var,k,E,j)}assign(k,E,j){return this._leafNode(new i(k,E,j))}add(k,E){return this._leafNode(new c(k,e.operators.ADD,E))}code(k){return typeof k=="function"?k():k!==t.nil&&this._leafNode(new y(k)),this}object(...k){const E=["{"];for(const[j,W]of k)E.length>1&&E.push(","),E.push(j),(j!==W||this.opts.es5)&&(E.push(":"),(0,t.addCodeArg)(E,W));return E.push("}"),new t._Code(E)}if(k,E,j){if(this._blockNode(new d(k)),E&&j)this.code(E).else().code(j).endIf();else if(E)this.code(E).endIf();else if(j)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(k){return this._elseNode(new d(k))}else(){return this._elseNode(new l)}endIf(){return this._endBlockNode(d,l)}_for(k,E){return this._blockNode(k),E&&this.code(E).endFor(),this}for(k,E){return this._for(new f(k),E)}forRange(k,E,j,W,Q=this.opts.es5?r.varKinds.var:r.varKinds.let){const ie=this._scope.toName(k);return this._for(new v(Q,ie,E,j),()=>W(ie))}forOf(k,E,j,W=r.varKinds.const){const Q=this._scope.toName(k);if(this.opts.es5){const ie=E instanceof t.Name?E:this.var("_arr",E);return this.forRange("_i",0,(0,t._)`${ie}.length`,se=>{this.var(Q,(0,t._)`${ie}[${se}]`),j(Q)})}return this._for(new p("of",W,Q,E),()=>j(Q))}forIn(k,E,j,W=this.opts.es5?r.varKinds.var:r.varKinds.const){if(this.opts.ownProperties)return this.forOf(k,(0,t._)`Object.keys(${E})`,j);const Q=this._scope.toName(k);return this._for(new p("in",W,Q,E),()=>j(Q))}endFor(){return this._endBlockNode(u)}label(k){return this._leafNode(new m(k))}break(k){return this._leafNode(new h(k))}return(k){const E=new S;if(this._blockNode(E),this.code(k),E.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(S)}try(k,E,j){if(!E&&!j)throw new Error('CodeGen: "try" without "catch" and "finally"');const W=new T;if(this._blockNode(W),this.code(k),E){const Q=this.name("e");this._currNode=W.catch=new R(Q),E(Q)}return j&&(this._currNode=W.finally=new q,this.code(j)),this._endBlockNode(R,q)}throw(k){return this._leafNode(new b(k))}block(k,E){return this._blockStarts.push(this._nodes.length),k&&this.code(k).endBlock(E),this}endBlock(k){const E=this._blockStarts.pop();if(E===void 0)throw new Error("CodeGen: not in self-balancing block");const j=this._nodes.length-E;if(j<0||k!==void 0&&j!==k)throw new Error(`CodeGen: wrong number of nodes: ${j} vs ${k} expected`);return this._nodes.length=E,this}func(k,E=t.nil,j,W){return this._blockNode(new g(k,E,j)),W&&this.code(W).endFunc(),this}endFunc(){return this._endBlockNode(g)}optimize(k=1){for(;k-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(k){return this._currNode.nodes.push(k),this}_blockNode(k){this._currNode.nodes.push(k),this._nodes.push(k)}_endBlockNode(k,E){const j=this._currNode;if(j instanceof k||E&&j instanceof E)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${E?`${k.kind}/${E.kind}`:k.kind}"`)}_elseNode(k){const E=this._currNode;if(!(E instanceof d))throw new Error('CodeGen: "else" without "if"');return this._currNode=E.else=k,this}get _root(){return this._nodes[0]}get _currNode(){const k=this._nodes;return k[k.length-1]}set _currNode(k){const E=this._nodes;E[E.length-1]=k}}e.CodeGen=N;function x(C,k){for(const E in k)C[E]=(C[E]||0)+(k[E]||0);return C}function M(C,k){return k instanceof t._CodeOrName?x(C,k.names):C}function F(C,k,E){if(C instanceof t.Name)return j(C);if(!W(C))return C;return new t._Code(C._items.reduce((Q,ie)=>(ie instanceof t.Name&&(ie=j(ie)),ie instanceof t._Code?Q.push(...ie._items):Q.push(ie),Q),[]));function j(Q){const ie=E[Q.str];return ie===void 0||k[Q.str]!==1?Q:(delete k[Q.str],ie)}function W(Q){return Q instanceof t._Code&&Q._items.some(ie=>ie instanceof t.Name&&k[ie.str]===1&&E[ie.str]!==void 0)}}function Y(C,k){for(const E in k)C[E]=(C[E]||0)-(k[E]||0)}function _e(C){return typeof C=="boolean"||typeof C=="number"||C===null?!C:(0,t._)`!${D(C)}`}e.not=_e;const le=I(e.operators.AND);function ee(...C){return C.reduce(le)}e.and=ee;const be=I(e.operators.OR);function Z(...C){return C.reduce(be)}e.or=Z;function I(C){return(k,E)=>k===t.nil?E:E===t.nil?k:(0,t._)`${D(k)} ${C} ${D(E)}`}function D(C){return C instanceof t.Name?C:(0,t._)`(${C})`}})(Vn)),Vn}var ne={},va;function ae(){if(va)return ne;va=1,Object.defineProperty(ne,"__esModule",{value:!0}),ne.checkStrictMode=ne.getErrorPath=ne.Type=ne.useFunc=ne.setEvaluated=ne.evaluatedPropsToName=ne.mergeEvaluated=ne.eachItem=ne.unescapeJsonPointer=ne.escapeJsonPointer=ne.escapeFragment=ne.unescapeFragment=ne.schemaRefOrVal=ne.schemaHasRulesButRef=ne.schemaHasRules=ne.checkUnknownRules=ne.alwaysValidSchema=ne.toHash=void 0;const e=re(),t=sr();function r(p){const g={};for(const S of p)g[S]=!0;return g}ne.toHash=r;function n(p,g){return typeof g=="boolean"?g:Object.keys(g).length===0?!0:(o(p,g),!s(g,p.self.RULES.all))}ne.alwaysValidSchema=n;function o(p,g=p.schema){const{opts:S,self:T}=p;if(!S.strictSchema||typeof g=="boolean")return;const R=T.RULES.keywords;for(const q in g)R[q]||v(p,`unknown keyword: "${q}"`)}ne.checkUnknownRules=o;function s(p,g){if(typeof p=="boolean")return!p;for(const S in p)if(g[S])return!0;return!1}ne.schemaHasRules=s;function a(p,g){if(typeof p=="boolean")return!p;for(const S in p)if(S!=="$ref"&&g.all[S])return!0;return!1}ne.schemaHasRulesButRef=a;function i({topSchemaRef:p,schemaPath:g},S,T,R){if(!R){if(typeof S=="number"||typeof S=="boolean")return S;if(typeof S=="string")return(0,e._)`${S}`}return(0,e._)`${p}${g}${(0,e.getProperty)(T)}`}ne.schemaRefOrVal=i;function c(p){return b(decodeURIComponent(p))}ne.unescapeFragment=c;function m(p){return encodeURIComponent(h(p))}ne.escapeFragment=m;function h(p){return typeof p=="number"?`${p}`:p.replace(/~/g,"~0").replace(/\//g,"~1")}ne.escapeJsonPointer=h;function b(p){return p.replace(/~1/g,"/").replace(/~0/g,"~")}ne.unescapeJsonPointer=b;function y(p,g){if(Array.isArray(p))for(const S of p)g(S);else g(p)}ne.eachItem=y;function $({mergeNames:p,mergeToName:g,mergeValues:S,resultToName:T}){return(R,q,N,x)=>{const M=N===void 0?q:N instanceof e.Name?(q instanceof e.Name?p(R,q,N):g(R,q,N),N):q instanceof e.Name?(g(R,N,q),q):S(q,N);return x===e.Name&&!(M instanceof e.Name)?T(R,M):M}}ne.mergeEvaluated={props:$({mergeNames:(p,g,S)=>p.if((0,e._)`${S} !== true && ${g} !== undefined`,()=>{p.if((0,e._)`${g} === true`,()=>p.assign(S,!0),()=>p.assign(S,(0,e._)`${S} || {}`).code((0,e._)`Object.assign(${S}, ${g})`))}),mergeToName:(p,g,S)=>p.if((0,e._)`${S} !== true`,()=>{g===!0?p.assign(S,!0):(p.assign(S,(0,e._)`${S} || {}`),_(p,S,g))}),mergeValues:(p,g)=>p===!0?!0:{...p,...g},resultToName:w}),items:$({mergeNames:(p,g,S)=>p.if((0,e._)`${S} !== true && ${g} !== undefined`,()=>p.assign(S,(0,e._)`${g} === true ? true : ${S} > ${g} ? ${S} : ${g}`)),mergeToName:(p,g,S)=>p.if((0,e._)`${S} !== true`,()=>p.assign(S,g===!0?!0:(0,e._)`${S} > ${g} ? ${S} : ${g}`)),mergeValues:(p,g)=>p===!0?!0:Math.max(p,g),resultToName:(p,g)=>p.var("items",g)})};function w(p,g){if(g===!0)return p.var("props",!0);const S=p.var("props",(0,e._)`{}`);return g!==void 0&&_(p,S,g),S}ne.evaluatedPropsToName=w;function _(p,g,S){Object.keys(S).forEach(T=>p.assign((0,e._)`${g}${(0,e.getProperty)(T)}`,!0))}ne.setEvaluated=_;const l={};function d(p,g){return p.scopeValue("func",{ref:g,code:l[g.code]||(l[g.code]=new t._Code(g.code))})}ne.useFunc=d;var u;(function(p){p[p.Num=0]="Num",p[p.Str=1]="Str"})(u||(ne.Type=u={}));function f(p,g,S){if(p instanceof e.Name){const T=g===u.Num;return S?T?(0,e._)`"[" + ${p} + "]"`:(0,e._)`"['" + ${p} + "']"`:T?(0,e._)`"/" + ${p}`:(0,e._)`"/" + ${p}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return S?(0,e.getProperty)(p).toString():"/"+h(p)}ne.getErrorPath=f;function v(p,g,S=p.opts.strictSchema){if(S){if(g=`strict mode: ${g}`,S===!0)throw new Error(g);p.self.logger.warn(g)}}return ne.checkStrictMode=v,ne}var ar={},ya;function Xe(){if(ya)return ar;ya=1,Object.defineProperty(ar,"__esModule",{value:!0});const e=re(),t={data:new e.Name("data"),valCxt:new e.Name("valCxt"),instancePath:new e.Name("instancePath"),parentData:new e.Name("parentData"),parentDataProperty:new e.Name("parentDataProperty"),rootData:new e.Name("rootData"),dynamicAnchors:new e.Name("dynamicAnchors"),vErrors:new e.Name("vErrors"),errors:new e.Name("errors"),this:new e.Name("this"),self:new e.Name("self"),scope:new e.Name("scope"),json:new e.Name("json"),jsonPos:new e.Name("jsonPos"),jsonLen:new e.Name("jsonLen"),jsonPart:new e.Name("jsonPart")};return ar.default=t,ar}var wa;function ir(){return wa||(wa=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.extendErrors=e.resetErrorsCount=e.reportExtraError=e.reportError=e.keyword$DataError=e.keywordError=void 0;const t=re(),r=ae(),n=Xe();e.keywordError={message:({keyword:l})=>(0,t.str)`must pass "${l}" keyword validation`},e.keyword$DataError={message:({keyword:l,schemaType:d})=>d?(0,t.str)`"${l}" keyword must be ${d} ($data)`:(0,t.str)`"${l}" keyword is invalid ($data)`};function o(l,d=e.keywordError,u,f){const{it:v}=l,{gen:p,compositeRule:g,allErrors:S}=v,T=b(l,d,u);f??(g||S)?c(p,T):m(v,(0,t._)`[${T}]`)}e.reportError=o;function s(l,d=e.keywordError,u){const{it:f}=l,{gen:v,compositeRule:p,allErrors:g}=f,S=b(l,d,u);c(v,S),p||g||m(f,n.default.vErrors)}e.reportExtraError=s;function a(l,d){l.assign(n.default.errors,d),l.if((0,t._)`${n.default.vErrors} !== null`,()=>l.if(d,()=>l.assign((0,t._)`${n.default.vErrors}.length`,d),()=>l.assign(n.default.vErrors,null)))}e.resetErrorsCount=a;function i({gen:l,keyword:d,schemaValue:u,data:f,errsCount:v,it:p}){if(v===void 0)throw new Error("ajv implementation error");const g=l.name("err");l.forRange("i",v,n.default.errors,S=>{l.const(g,(0,t._)`${n.default.vErrors}[${S}]`),l.if((0,t._)`${g}.instancePath === undefined`,()=>l.assign((0,t._)`${g}.instancePath`,(0,t.strConcat)(n.default.instancePath,p.errorPath))),l.assign((0,t._)`${g}.schemaPath`,(0,t.str)`${p.errSchemaPath}/${d}`),p.opts.verbose&&(l.assign((0,t._)`${g}.schema`,u),l.assign((0,t._)`${g}.data`,f))})}e.extendErrors=i;function c(l,d){const u=l.const("err",d);l.if((0,t._)`${n.default.vErrors} === null`,()=>l.assign(n.default.vErrors,(0,t._)`[${u}]`),(0,t._)`${n.default.vErrors}.push(${u})`),l.code((0,t._)`${n.default.errors}++`)}function m(l,d){const{gen:u,validateName:f,schemaEnv:v}=l;v.$async?u.throw((0,t._)`new ${l.ValidationError}(${d})`):(u.assign((0,t._)`${f}.errors`,d),u.return(!1))}const h={keyword:new t.Name("keyword"),schemaPath:new t.Name("schemaPath"),params:new t.Name("params"),propertyName:new t.Name("propertyName"),message:new t.Name("message"),schema:new t.Name("schema"),parentSchema:new t.Name("parentSchema")};function b(l,d,u){const{createErrors:f}=l.it;return f===!1?(0,t._)`{}`:y(l,d,u)}function y(l,d,u={}){const{gen:f,it:v}=l,p=[$(v,u),w(l,u)];return _(l,d,p),f.object(...p)}function $({errorPath:l},{instancePath:d}){const u=d?(0,t.str)`${l}${(0,r.getErrorPath)(d,r.Type.Str)}`:l;return[n.default.instancePath,(0,t.strConcat)(n.default.instancePath,u)]}function w({keyword:l,it:{errSchemaPath:d}},{schemaPath:u,parentSchema:f}){let v=f?d:(0,t.str)`${d}/${l}`;return u&&(v=(0,t.str)`${v}${(0,r.getErrorPath)(u,r.Type.Str)}`),[h.schemaPath,v]}function _(l,{params:d,message:u},f){const{keyword:v,data:p,schemaValue:g,it:S}=l,{opts:T,propertyName:R,topSchemaRef:q,schemaPath:N}=S;f.push([h.keyword,v],[h.params,typeof d=="function"?d(l):d||(0,t._)`{}`]),T.messages&&f.push([h.message,typeof u=="function"?u(l):u]),T.verbose&&f.push([h.schema,g],[h.parentSchema,(0,t._)`${q}${N}`],[n.default.data,p]),R&&f.push([h.propertyName,R])}})(Dn)),Dn}var ba;function Em(){if(ba)return it;ba=1,Object.defineProperty(it,"__esModule",{value:!0}),it.boolOrEmptySchema=it.topBoolOrEmptySchema=void 0;const e=ir(),t=re(),r=Xe(),n={message:"boolean schema is false"};function o(i){const{gen:c,schema:m,validateName:h}=i;m===!1?a(i,!1):typeof m=="object"&&m.$async===!0?c.return(r.default.data):(c.assign((0,t._)`${h}.errors`,null),c.return(!0))}it.topBoolOrEmptySchema=o;function s(i,c){const{gen:m,schema:h}=i;h===!1?(m.var(c,!1),a(i)):m.var(c,!0)}it.boolOrEmptySchema=s;function a(i,c){const{gen:m,data:h}=i,b={gen:m,keyword:"false schema",data:h,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:i};(0,e.reportError)(b,n,void 0,c)}return it}var Se={},ct={},$a;function ka(){if($a)return ct;$a=1,Object.defineProperty(ct,"__esModule",{value:!0}),ct.getRules=ct.isJSONType=void 0;const e=["string","number","integer","boolean","null","object","array"],t=new Set(e);function r(o){return typeof o=="string"&&t.has(o)}ct.isJSONType=r;function n(){const o={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...o,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},o.number,o.string,o.array,o.object],post:{rules:[]},all:{},keywords:{}}}return ct.getRules=n,ct}var We={},Sa;function Ea(){if(Sa)return We;Sa=1,Object.defineProperty(We,"__esModule",{value:!0}),We.shouldUseRule=We.shouldUseGroup=We.schemaHasRulesForType=void 0;function e({schema:n,self:o},s){const a=o.RULES.types[s];return a&&a!==!0&&t(n,a)}We.schemaHasRulesForType=e;function t(n,o){return o.rules.some(s=>r(n,s))}We.shouldUseGroup=t;function r(n,o){var s;return n[o.keyword]!==void 0||((s=o.definition.implements)===null||s===void 0?void 0:s.some(a=>n[a]!==void 0))}return We.shouldUseRule=r,We}var Pa;function cr(){if(Pa)return Se;Pa=1,Object.defineProperty(Se,"__esModule",{value:!0}),Se.reportTypeError=Se.checkDataTypes=Se.checkDataType=Se.coerceAndCheckDataType=Se.getJSONTypes=Se.getSchemaTypes=Se.DataType=void 0;const e=ka(),t=Ea(),r=ir(),n=re(),o=ae();var s;(function(u){u[u.Correct=0]="Correct",u[u.Wrong=1]="Wrong"})(s||(Se.DataType=s={}));function a(u){const f=i(u.type);if(f.includes("null")){if(u.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!f.length&&u.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');u.nullable===!0&&f.push("null")}return f}Se.getSchemaTypes=a;function i(u){const f=Array.isArray(u)?u:u?[u]:[];if(f.every(e.isJSONType))return f;throw new Error("type must be JSONType or JSONType[]: "+f.join(","))}Se.getJSONTypes=i;function c(u,f){const{gen:v,data:p,opts:g}=u,S=h(f,g.coerceTypes),T=f.length>0&&!(S.length===0&&f.length===1&&(0,t.schemaHasRulesForType)(u,f[0]));if(T){const R=w(f,p,g.strictNumbers,s.Wrong);v.if(R,()=>{S.length?b(u,f,S):l(u)})}return T}Se.coerceAndCheckDataType=c;const m=new Set(["string","number","integer","boolean","null"]);function h(u,f){return f?u.filter(v=>m.has(v)||f==="array"&&v==="array"):[]}function b(u,f,v){const{gen:p,data:g,opts:S}=u,T=p.let("dataType",(0,n._)`typeof ${g}`),R=p.let("coerced",(0,n._)`undefined`);S.coerceTypes==="array"&&p.if((0,n._)`${T} == 'object' && Array.isArray(${g}) && ${g}.length == 1`,()=>p.assign(g,(0,n._)`${g}[0]`).assign(T,(0,n._)`typeof ${g}`).if(w(f,g,S.strictNumbers),()=>p.assign(R,g))),p.if((0,n._)`${R} !== undefined`);for(const N of v)(m.has(N)||N==="array"&&S.coerceTypes==="array")&&q(N);p.else(),l(u),p.endIf(),p.if((0,n._)`${R} !== undefined`,()=>{p.assign(g,R),y(u,R)});function q(N){switch(N){case"string":p.elseIf((0,n._)`${T} == "number" || ${T} == "boolean"`).assign(R,(0,n._)`"" + ${g}`).elseIf((0,n._)`${g} === null`).assign(R,(0,n._)`""`);return;case"number":p.elseIf((0,n._)`${T} == "boolean" || ${g} === null
              || (${T} == "string" && ${g} && ${g} == +${g})`).assign(R,(0,n._)`+${g}`);return;case"integer":p.elseIf((0,n._)`${T} === "boolean" || ${g} === null
              || (${T} === "string" && ${g} && ${g} == +${g} && !(${g} % 1))`).assign(R,(0,n._)`+${g}`);return;case"boolean":p.elseIf((0,n._)`${g} === "false" || ${g} === 0 || ${g} === null`).assign(R,!1).elseIf((0,n._)`${g} === "true" || ${g} === 1`).assign(R,!0);return;case"null":p.elseIf((0,n._)`${g} === "" || ${g} === 0 || ${g} === false`),p.assign(R,null);return;case"array":p.elseIf((0,n._)`${T} === "string" || ${T} === "number"
              || ${T} === "boolean" || ${g} === null`).assign(R,(0,n._)`[${g}]`)}}}function y({gen:u,parentData:f,parentDataProperty:v},p){u.if((0,n._)`${f} !== undefined`,()=>u.assign((0,n._)`${f}[${v}]`,p))}function $(u,f,v,p=s.Correct){const g=p===s.Correct?n.operators.EQ:n.operators.NEQ;let S;switch(u){case"null":return(0,n._)`${f} ${g} null`;case"array":S=(0,n._)`Array.isArray(${f})`;break;case"object":S=(0,n._)`${f} && typeof ${f} == "object" && !Array.isArray(${f})`;break;case"integer":S=T((0,n._)`!(${f} % 1) && !isNaN(${f})`);break;case"number":S=T();break;default:return(0,n._)`typeof ${f} ${g} ${u}`}return p===s.Correct?S:(0,n.not)(S);function T(R=n.nil){return(0,n.and)((0,n._)`typeof ${f} == "number"`,R,v?(0,n._)`isFinite(${f})`:n.nil)}}Se.checkDataType=$;function w(u,f,v,p){if(u.length===1)return $(u[0],f,v,p);let g;const S=(0,o.toHash)(u);if(S.array&&S.object){const T=(0,n._)`typeof ${f} != "object"`;g=S.null?T:(0,n._)`!${f} || ${T}`,delete S.null,delete S.array,delete S.object}else g=n.nil;S.number&&delete S.integer;for(const T in S)g=(0,n.and)(g,$(T,f,v,p));return g}Se.checkDataTypes=w;const _={message:({schema:u})=>`must be ${u}`,params:({schema:u,schemaValue:f})=>typeof u=="string"?(0,n._)`{type: ${u}}`:(0,n._)`{type: ${f}}`};function l(u){const f=d(u);(0,r.reportError)(f,_)}Se.reportTypeError=l;function d(u){const{gen:f,data:v,schema:p}=u,g=(0,o.schemaRefOrVal)(u,p,"type");return{gen:f,keyword:"type",data:v,schema:p.type,schemaCode:g,schemaValue:g,parentSchema:p,params:{},it:u}}return Se}var jt={},Ta;function Pm(){if(Ta)return jt;Ta=1,Object.defineProperty(jt,"__esModule",{value:!0}),jt.assignDefaults=void 0;const e=re(),t=ae();function r(o,s){const{properties:a,items:i}=o.schema;if(s==="object"&&a)for(const c in a)n(o,c,a[c].default);else s==="array"&&Array.isArray(i)&&i.forEach((c,m)=>n(o,m,c.default))}jt.assignDefaults=r;function n(o,s,a){const{gen:i,compositeRule:c,data:m,opts:h}=o;if(a===void 0)return;const b=(0,e._)`${m}${(0,e.getProperty)(s)}`;if(c){(0,t.checkStrictMode)(o,`default is ignored for: ${b}`);return}let y=(0,e._)`${b} === undefined`;h.useDefaults==="empty"&&(y=(0,e._)`${y} || ${b} === null || ${b} === ""`),i.if(y,(0,e._)`${b} = ${(0,e.stringify)(a)}`)}return jt}var De={},ce={},Aa;function Ve(){if(Aa)return ce;Aa=1,Object.defineProperty(ce,"__esModule",{value:!0}),ce.validateUnion=ce.validateArray=ce.usePattern=ce.callValidateCode=ce.schemaProperties=ce.allSchemaProperties=ce.noPropertyInData=ce.propertyInData=ce.isOwnProperty=ce.hasPropFunc=ce.reportMissingProp=ce.checkMissingProp=ce.checkReportMissingProp=void 0;const e=re(),t=ae(),r=Xe(),n=ae();function o(u,f){const{gen:v,data:p,it:g}=u;v.if(h(v,p,f,g.opts.ownProperties),()=>{u.setParams({missingProperty:(0,e._)`${f}`},!0),u.error()})}ce.checkReportMissingProp=o;function s({gen:u,data:f,it:{opts:v}},p,g){return(0,e.or)(...p.map(S=>(0,e.and)(h(u,f,S,v.ownProperties),(0,e._)`${g} = ${S}`)))}ce.checkMissingProp=s;function a(u,f){u.setParams({missingProperty:f},!0),u.error()}ce.reportMissingProp=a;function i(u){return u.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,e._)`Object.prototype.hasOwnProperty`})}ce.hasPropFunc=i;function c(u,f,v){return(0,e._)`${i(u)}.call(${f}, ${v})`}ce.isOwnProperty=c;function m(u,f,v,p){const g=(0,e._)`${f}${(0,e.getProperty)(v)} !== undefined`;return p?(0,e._)`${g} && ${c(u,f,v)}`:g}ce.propertyInData=m;function h(u,f,v,p){const g=(0,e._)`${f}${(0,e.getProperty)(v)} === undefined`;return p?(0,e.or)(g,(0,e.not)(c(u,f,v))):g}ce.noPropertyInData=h;function b(u){return u?Object.keys(u).filter(f=>f!=="__proto__"):[]}ce.allSchemaProperties=b;function y(u,f){return b(f).filter(v=>!(0,t.alwaysValidSchema)(u,f[v]))}ce.schemaProperties=y;function $({schemaCode:u,data:f,it:{gen:v,topSchemaRef:p,schemaPath:g,errorPath:S},it:T},R,q,N){const x=N?(0,e._)`${u}, ${f}, ${p}${g}`:f,M=[[r.default.instancePath,(0,e.strConcat)(r.default.instancePath,S)],[r.default.parentData,T.parentData],[r.default.parentDataProperty,T.parentDataProperty],[r.default.rootData,r.default.rootData]];T.opts.dynamicRef&&M.push([r.default.dynamicAnchors,r.default.dynamicAnchors]);const F=(0,e._)`${x}, ${v.object(...M)}`;return q!==e.nil?(0,e._)`${R}.call(${q}, ${F})`:(0,e._)`${R}(${F})`}ce.callValidateCode=$;const w=(0,e._)`new RegExp`;function _({gen:u,it:{opts:f}},v){const p=f.unicodeRegExp?"u":"",{regExp:g}=f.code,S=g(v,p);return u.scopeValue("pattern",{key:S.toString(),ref:S,code:(0,e._)`${g.code==="new RegExp"?w:(0,n.useFunc)(u,g)}(${v}, ${p})`})}ce.usePattern=_;function l(u){const{gen:f,data:v,keyword:p,it:g}=u,S=f.name("valid");if(g.allErrors){const R=f.let("valid",!0);return T(()=>f.assign(R,!1)),R}return f.var(S,!0),T(()=>f.break()),S;function T(R){const q=f.const("len",(0,e._)`${v}.length`);f.forRange("i",0,q,N=>{u.subschema({keyword:p,dataProp:N,dataPropType:t.Type.Num},S),f.if((0,e.not)(S),R)})}}ce.validateArray=l;function d(u){const{gen:f,schema:v,keyword:p,it:g}=u;if(!Array.isArray(v))throw new Error("ajv implementation error");if(v.some(q=>(0,t.alwaysValidSchema)(g,q))&&!g.opts.unevaluated)return;const T=f.let("valid",!1),R=f.name("_valid");f.block(()=>v.forEach((q,N)=>{const x=u.subschema({keyword:p,schemaProp:N,compositeRule:!0},R);f.assign(T,(0,e._)`${T} || ${R}`),u.mergeValidEvaluated(x,R)||f.if((0,e.not)(T))})),u.result(T,()=>u.reset(),()=>u.error(!0))}return ce.validateUnion=d,ce}var Ra;function Tm(){if(Ra)return De;Ra=1,Object.defineProperty(De,"__esModule",{value:!0}),De.validateKeywordUsage=De.validSchemaType=De.funcKeywordCode=De.macroKeywordCode=void 0;const e=re(),t=Xe(),r=Ve(),n=ir();function o(y,$){const{gen:w,keyword:_,schema:l,parentSchema:d,it:u}=y,f=$.macro.call(u.self,l,d,u),v=m(w,_,f);u.opts.validateSchema!==!1&&u.self.validateSchema(f,!0);const p=w.name("valid");y.subschema({schema:f,schemaPath:e.nil,errSchemaPath:`${u.errSchemaPath}/${_}`,topSchemaRef:v,compositeRule:!0},p),y.pass(p,()=>y.error(!0))}De.macroKeywordCode=o;function s(y,$){var w;const{gen:_,keyword:l,schema:d,parentSchema:u,$data:f,it:v}=y;c(v,$);const p=!f&&$.compile?$.compile.call(v.self,d,u,v):$.validate,g=m(_,l,p),S=_.let("valid");y.block$data(S,T),y.ok((w=$.valid)!==null&&w!==void 0?w:S);function T(){if($.errors===!1)N(),$.modifying&&a(y),x(()=>y.error());else{const M=$.async?R():q();$.modifying&&a(y),x(()=>i(y,M))}}function R(){const M=_.let("ruleErrs",null);return _.try(()=>N((0,e._)`await `),F=>_.assign(S,!1).if((0,e._)`${F} instanceof ${v.ValidationError}`,()=>_.assign(M,(0,e._)`${F}.errors`),()=>_.throw(F))),M}function q(){const M=(0,e._)`${g}.errors`;return _.assign(M,null),N(e.nil),M}function N(M=$.async?(0,e._)`await `:e.nil){const F=v.opts.passContext?t.default.this:t.default.self,Y=!("compile"in $&&!f||$.schema===!1);_.assign(S,(0,e._)`${M}${(0,r.callValidateCode)(y,g,F,Y)}`,$.modifying)}function x(M){var F;_.if((0,e.not)((F=$.valid)!==null&&F!==void 0?F:S),M)}}De.funcKeywordCode=s;function a(y){const{gen:$,data:w,it:_}=y;$.if(_.parentData,()=>$.assign(w,(0,e._)`${_.parentData}[${_.parentDataProperty}]`))}function i(y,$){const{gen:w}=y;w.if((0,e._)`Array.isArray(${$})`,()=>{w.assign(t.default.vErrors,(0,e._)`${t.default.vErrors} === null ? ${$} : ${t.default.vErrors}.concat(${$})`).assign(t.default.errors,(0,e._)`${t.default.vErrors}.length`),(0,n.extendErrors)(y)},()=>y.error())}function c({schemaEnv:y},$){if($.async&&!y.$async)throw new Error("async keyword in sync schema")}function m(y,$,w){if(w===void 0)throw new Error(`keyword "${$}" failed to compile`);return y.scopeValue("keyword",typeof w=="function"?{ref:w}:{ref:w,code:(0,e.stringify)(w)})}function h(y,$,w=!1){return!$.length||$.some(_=>_==="array"?Array.isArray(y):_==="object"?y&&typeof y=="object"&&!Array.isArray(y):typeof y==_||w&&typeof y>"u")}De.validSchemaType=h;function b({schema:y,opts:$,self:w,errSchemaPath:_},l,d){if(Array.isArray(l.keyword)?!l.keyword.includes(d):l.keyword!==d)throw new Error("ajv implementation error");const u=l.dependencies;if(u?.some(f=>!Object.prototype.hasOwnProperty.call(y,f)))throw new Error(`parent schema must have dependencies of ${d}: ${u.join(",")}`);if(l.validateSchema&&!l.validateSchema(y[d])){const v=`keyword "${d}" value is invalid at path "${_}": `+w.errorsText(l.validateSchema.errors);if($.validateSchema==="log")w.logger.error(v);else throw new Error(v)}}return De.validateKeywordUsage=b,De}var Be={},Ia;function Am(){if(Ia)return Be;Ia=1,Object.defineProperty(Be,"__esModule",{value:!0}),Be.extendSubschemaMode=Be.extendSubschemaData=Be.getSubschema=void 0;const e=re(),t=ae();function r(s,{keyword:a,schemaProp:i,schema:c,schemaPath:m,errSchemaPath:h,topSchemaRef:b}){if(a!==void 0&&c!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(a!==void 0){const y=s.schema[a];return i===void 0?{schema:y,schemaPath:(0,e._)`${s.schemaPath}${(0,e.getProperty)(a)}`,errSchemaPath:`${s.errSchemaPath}/${a}`}:{schema:y[i],schemaPath:(0,e._)`${s.schemaPath}${(0,e.getProperty)(a)}${(0,e.getProperty)(i)}`,errSchemaPath:`${s.errSchemaPath}/${a}/${(0,t.escapeFragment)(i)}`}}if(c!==void 0){if(m===void 0||h===void 0||b===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:c,schemaPath:m,topSchemaRef:b,errSchemaPath:h}}throw new Error('either "keyword" or "schema" must be passed')}Be.getSubschema=r;function n(s,a,{dataProp:i,dataPropType:c,data:m,dataTypes:h,propertyName:b}){if(m!==void 0&&i!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:y}=a;if(i!==void 0){const{errorPath:w,dataPathArr:_,opts:l}=a,d=y.let("data",(0,e._)`${a.data}${(0,e.getProperty)(i)}`,!0);$(d),s.errorPath=(0,e.str)`${w}${(0,t.getErrorPath)(i,c,l.jsPropertySyntax)}`,s.parentDataProperty=(0,e._)`${i}`,s.dataPathArr=[..._,s.parentDataProperty]}if(m!==void 0){const w=m instanceof e.Name?m:y.let("data",m,!0);$(w),b!==void 0&&(s.propertyName=b)}h&&(s.dataTypes=h);function $(w){s.data=w,s.dataLevel=a.dataLevel+1,s.dataTypes=[],a.definedProperties=new Set,s.parentData=a.data,s.dataNames=[...a.dataNames,w]}}Be.extendSubschemaData=n;function o(s,{jtdDiscriminator:a,jtdMetadata:i,compositeRule:c,createErrors:m,allErrors:h}){c!==void 0&&(s.compositeRule=c),m!==void 0&&(s.createErrors=m),h!==void 0&&(s.allErrors=h),s.jtdDiscriminator=a,s.jtdMetadata=i}return Be.extendSubschemaMode=o,Be}var Ie={},Fn,Oa;function Ca(){return Oa||(Oa=1,Fn=function e(t,r){if(t===r)return!0;if(t&&r&&typeof t=="object"&&typeof r=="object"){if(t.constructor!==r.constructor)return!1;var n,o,s;if(Array.isArray(t)){if(n=t.length,n!=r.length)return!1;for(o=n;o--!==0;)if(!e(t[o],r[o]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if(s=Object.keys(t),n=s.length,n!==Object.keys(r).length)return!1;for(o=n;o--!==0;)if(!Object.prototype.hasOwnProperty.call(r,s[o]))return!1;for(o=n;o--!==0;){var a=s[o];if(!e(t[a],r[a]))return!1}return!0}return t!==t&&r!==r}),Fn}var Hn={exports:{}},Na;function Rm(){if(Na)return Hn.exports;Na=1;var e=Hn.exports=function(n,o,s){typeof o=="function"&&(s=o,o={}),s=o.cb||s;var a=typeof s=="function"?s:s.pre||function(){},i=s.post||function(){};t(o,a,i,n,"",n)};e.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},e.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},e.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},e.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function t(n,o,s,a,i,c,m,h,b,y){if(a&&typeof a=="object"&&!Array.isArray(a)){o(a,i,c,m,h,b,y);for(var $ in a){var w=a[$];if(Array.isArray(w)){if($ in e.arrayKeywords)for(var _=0;_<w.length;_++)t(n,o,s,w[_],i+"/"+$+"/"+_,c,i,$,a,_)}else if($ in e.propsKeywords){if(w&&typeof w=="object")for(var l in w)t(n,o,s,w[l],i+"/"+$+"/"+r(l),c,i,$,a,l)}else($ in e.keywords||n.allKeys&&!($ in e.skipKeywords))&&t(n,o,s,w,i+"/"+$,c,i,$,a)}s(a,i,c,m,h,b,y)}}function r(n){return n.replace(/~/g,"~0").replace(/\//g,"~1")}return Hn.exports}var za;function ur(){if(za)return Ie;za=1,Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.getSchemaRefs=Ie.resolveUrl=Ie.normalizeId=Ie._getFullPath=Ie.getFullPath=Ie.inlineRef=void 0;const e=ae(),t=Ca(),r=Rm(),n=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function o(_,l=!0){return typeof _=="boolean"?!0:l===!0?!a(_):l?i(_)<=l:!1}Ie.inlineRef=o;const s=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function a(_){for(const l in _){if(s.has(l))return!0;const d=_[l];if(Array.isArray(d)&&d.some(a)||typeof d=="object"&&a(d))return!0}return!1}function i(_){let l=0;for(const d in _){if(d==="$ref")return 1/0;if(l++,!n.has(d)&&(typeof _[d]=="object"&&(0,e.eachItem)(_[d],u=>l+=i(u)),l===1/0))return 1/0}return l}function c(_,l="",d){d!==!1&&(l=b(l));const u=_.parse(l);return m(_,u)}Ie.getFullPath=c;function m(_,l){return _.serialize(l).split("#")[0]+"#"}Ie._getFullPath=m;const h=/#\/?$/;function b(_){return _?_.replace(h,""):""}Ie.normalizeId=b;function y(_,l,d){return d=b(d),_.resolve(l,d)}Ie.resolveUrl=y;const $=/^[a-z_][-a-z0-9._]*$/i;function w(_,l){if(typeof _=="boolean")return{};const{schemaId:d,uriResolver:u}=this.opts,f=b(_[d]||l),v={"":f},p=c(u,f,!1),g={},S=new Set;return r(_,{allKeys:!0},(q,N,x,M)=>{if(M===void 0)return;const F=p+N;let Y=v[M];typeof q[d]=="string"&&(Y=_e.call(this,q[d])),le.call(this,q.$anchor),le.call(this,q.$dynamicAnchor),v[N]=Y;function _e(ee){const be=this.opts.uriResolver.resolve;if(ee=b(Y?be(Y,ee):ee),S.has(ee))throw R(ee);S.add(ee);let Z=this.refs[ee];return typeof Z=="string"&&(Z=this.refs[Z]),typeof Z=="object"?T(q,Z.schema,ee):ee!==b(F)&&(ee[0]==="#"?(T(q,g[ee],ee),g[ee]=q):this.refs[ee]=F),ee}function le(ee){if(typeof ee=="string"){if(!$.test(ee))throw new Error(`invalid anchor "${ee}"`);_e.call(this,`#${ee}`)}}}),g;function T(q,N,x){if(N!==void 0&&!t(q,N))throw R(x)}function R(q){return new Error(`reference "${q}" resolves to more than one schema`)}}return Ie.getSchemaRefs=w,Ie}var ja;function lr(){if(ja)return Ke;ja=1,Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.getData=Ke.KeywordCxt=Ke.validateFunctionCode=void 0;const e=Em(),t=cr(),r=Ea(),n=cr(),o=Pm(),s=Tm(),a=Am(),i=re(),c=Xe(),m=ur(),h=ae(),b=ir();function y(A){if(p(A)&&(S(A),v(A))){l(A);return}$(A,()=>(0,e.topBoolOrEmptySchema)(A))}Ke.validateFunctionCode=y;function $({gen:A,validateName:O,schema:U,schemaEnv:L,opts:J},oe){J.code.es5?A.func(O,(0,i._)`${c.default.data}, ${c.default.valCxt}`,L.$async,()=>{A.code((0,i._)`"use strict"; ${u(U,J)}`),_(A,J),A.code(oe)}):A.func(O,(0,i._)`${c.default.data}, ${w(J)}`,L.$async,()=>A.code(u(U,J)).code(oe))}function w(A){return(0,i._)`{${c.default.instancePath}="", ${c.default.parentData}, ${c.default.parentDataProperty}, ${c.default.rootData}=${c.default.data}${A.dynamicRef?(0,i._)`, ${c.default.dynamicAnchors}={}`:i.nil}}={}`}function _(A,O){A.if(c.default.valCxt,()=>{A.var(c.default.instancePath,(0,i._)`${c.default.valCxt}.${c.default.instancePath}`),A.var(c.default.parentData,(0,i._)`${c.default.valCxt}.${c.default.parentData}`),A.var(c.default.parentDataProperty,(0,i._)`${c.default.valCxt}.${c.default.parentDataProperty}`),A.var(c.default.rootData,(0,i._)`${c.default.valCxt}.${c.default.rootData}`),O.dynamicRef&&A.var(c.default.dynamicAnchors,(0,i._)`${c.default.valCxt}.${c.default.dynamicAnchors}`)},()=>{A.var(c.default.instancePath,(0,i._)`""`),A.var(c.default.parentData,(0,i._)`undefined`),A.var(c.default.parentDataProperty,(0,i._)`undefined`),A.var(c.default.rootData,c.default.data),O.dynamicRef&&A.var(c.default.dynamicAnchors,(0,i._)`{}`)})}function l(A){const{schema:O,opts:U,gen:L}=A;$(A,()=>{U.$comment&&O.$comment&&M(A),q(A),L.let(c.default.vErrors,null),L.let(c.default.errors,0),U.unevaluated&&d(A),T(A),F(A)})}function d(A){const{gen:O,validateName:U}=A;A.evaluated=O.const("evaluated",(0,i._)`${U}.evaluated`),O.if((0,i._)`${A.evaluated}.dynamicProps`,()=>O.assign((0,i._)`${A.evaluated}.props`,(0,i._)`undefined`)),O.if((0,i._)`${A.evaluated}.dynamicItems`,()=>O.assign((0,i._)`${A.evaluated}.items`,(0,i._)`undefined`))}function u(A,O){const U=typeof A=="object"&&A[O.schemaId];return U&&(O.code.source||O.code.process)?(0,i._)`/*# sourceURL=${U} */`:i.nil}function f(A,O){if(p(A)&&(S(A),v(A))){g(A,O);return}(0,e.boolOrEmptySchema)(A,O)}function v({schema:A,self:O}){if(typeof A=="boolean")return!A;for(const U in A)if(O.RULES.all[U])return!0;return!1}function p(A){return typeof A.schema!="boolean"}function g(A,O){const{schema:U,gen:L,opts:J}=A;J.$comment&&U.$comment&&M(A),N(A),x(A);const oe=L.const("_errs",c.default.errors);T(A,oe),L.var(O,(0,i._)`${oe} === ${c.default.errors}`)}function S(A){(0,h.checkUnknownRules)(A),R(A)}function T(A,O){if(A.opts.jtd)return _e(A,[],!1,O);const U=(0,t.getSchemaTypes)(A.schema),L=(0,t.coerceAndCheckDataType)(A,U);_e(A,U,!L,O)}function R(A){const{schema:O,errSchemaPath:U,opts:L,self:J}=A;O.$ref&&L.ignoreKeywordsWithRef&&(0,h.schemaHasRulesButRef)(O,J.RULES)&&J.logger.warn(`$ref: keywords ignored in schema at path "${U}"`)}function q(A){const{schema:O,opts:U}=A;O.default!==void 0&&U.useDefaults&&U.strictSchema&&(0,h.checkStrictMode)(A,"default is ignored in the schema root")}function N(A){const O=A.schema[A.opts.schemaId];O&&(A.baseId=(0,m.resolveUrl)(A.opts.uriResolver,A.baseId,O))}function x(A){if(A.schema.$async&&!A.schemaEnv.$async)throw new Error("async schema in sync schema")}function M({gen:A,schemaEnv:O,schema:U,errSchemaPath:L,opts:J}){const oe=U.$comment;if(J.$comment===!0)A.code((0,i._)`${c.default.self}.logger.log(${oe})`);else if(typeof J.$comment=="function"){const Pe=(0,i.str)`${L}/$comment`,Ze=A.scopeValue("root",{ref:O.root});A.code((0,i._)`${c.default.self}.opts.$comment(${oe}, ${Pe}, ${Ze}.schema)`)}}function F(A){const{gen:O,schemaEnv:U,validateName:L,ValidationError:J,opts:oe}=A;U.$async?O.if((0,i._)`${c.default.errors} === 0`,()=>O.return(c.default.data),()=>O.throw((0,i._)`new ${J}(${c.default.vErrors})`)):(O.assign((0,i._)`${L}.errors`,c.default.vErrors),oe.unevaluated&&Y(A),O.return((0,i._)`${c.default.errors} === 0`))}function Y({gen:A,evaluated:O,props:U,items:L}){U instanceof i.Name&&A.assign((0,i._)`${O}.props`,U),L instanceof i.Name&&A.assign((0,i._)`${O}.items`,L)}function _e(A,O,U,L){const{gen:J,schema:oe,data:Pe,allErrors:Ze,opts:ze,self:je}=A,{RULES:Te}=je;if(oe.$ref&&(ze.ignoreKeywordsWithRef||!(0,h.schemaHasRulesButRef)(oe,Te))){J.block(()=>W(A,"$ref",Te.all.$ref.definition));return}ze.jtd||ee(A,O),J.block(()=>{for(const Ue of Te.rules)St(Ue);St(Te.post)});function St(Ue){(0,r.shouldUseGroup)(oe,Ue)&&(Ue.type?(J.if((0,n.checkDataType)(Ue.type,Pe,ze.strictNumbers)),le(A,Ue),O.length===1&&O[0]===Ue.type&&U&&(J.else(),(0,n.reportTypeError)(A)),J.endIf()):le(A,Ue),Ze||J.if((0,i._)`${c.default.errors} === ${L||0}`))}}function le(A,O){const{gen:U,schema:L,opts:{useDefaults:J}}=A;J&&(0,o.assignDefaults)(A,O.type),U.block(()=>{for(const oe of O.rules)(0,r.shouldUseRule)(L,oe)&&W(A,oe.keyword,oe.definition,O.type)})}function ee(A,O){A.schemaEnv.meta||!A.opts.strictTypes||(be(A,O),A.opts.allowUnionTypes||Z(A,O),I(A,A.dataTypes))}function be(A,O){if(O.length){if(!A.dataTypes.length){A.dataTypes=O;return}O.forEach(U=>{C(A.dataTypes,U)||E(A,`type "${U}" not allowed by context "${A.dataTypes.join(",")}"`)}),k(A,O)}}function Z(A,O){O.length>1&&!(O.length===2&&O.includes("null"))&&E(A,"use allowUnionTypes to allow union type keyword")}function I(A,O){const U=A.self.RULES.all;for(const L in U){const J=U[L];if(typeof J=="object"&&(0,r.shouldUseRule)(A.schema,J)){const{type:oe}=J.definition;oe.length&&!oe.some(Pe=>D(O,Pe))&&E(A,`missing type "${oe.join(",")}" for keyword "${L}"`)}}}function D(A,O){return A.includes(O)||O==="number"&&A.includes("integer")}function C(A,O){return A.includes(O)||O==="integer"&&A.includes("number")}function k(A,O){const U=[];for(const L of A.dataTypes)C(O,L)?U.push(L):O.includes("integer")&&L==="number"&&U.push("integer");A.dataTypes=U}function E(A,O){const U=A.schemaEnv.baseId+A.errSchemaPath;O+=` at "${U}" (strictTypes)`,(0,h.checkStrictMode)(A,O,A.opts.strictTypes)}class j{constructor(O,U,L){if((0,s.validateKeywordUsage)(O,U,L),this.gen=O.gen,this.allErrors=O.allErrors,this.keyword=L,this.data=O.data,this.schema=O.schema[L],this.$data=U.$data&&O.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,h.schemaRefOrVal)(O,this.schema,L,this.$data),this.schemaType=U.schemaType,this.parentSchema=O.schema,this.params={},this.it=O,this.def=U,this.$data)this.schemaCode=O.gen.const("vSchema",se(this.$data,O));else if(this.schemaCode=this.schemaValue,!(0,s.validSchemaType)(this.schema,U.schemaType,U.allowUndefined))throw new Error(`${L} value must be ${JSON.stringify(U.schemaType)}`);("code"in U?U.trackErrors:U.errors!==!1)&&(this.errsCount=O.gen.const("_errs",c.default.errors))}result(O,U,L){this.failResult((0,i.not)(O),U,L)}failResult(O,U,L){this.gen.if(O),L?L():this.error(),U?(this.gen.else(),U(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(O,U){this.failResult((0,i.not)(O),void 0,U)}fail(O){if(O===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(O),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(O){if(!this.$data)return this.fail(O);const{schemaCode:U}=this;this.fail((0,i._)`${U} !== undefined && (${(0,i.or)(this.invalid$data(),O)})`)}error(O,U,L){if(U){this.setParams(U),this._error(O,L),this.setParams({});return}this._error(O,L)}_error(O,U){(O?b.reportExtraError:b.reportError)(this,this.def.error,U)}$dataError(){(0,b.reportError)(this,this.def.$dataError||b.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,b.resetErrorsCount)(this.gen,this.errsCount)}ok(O){this.allErrors||this.gen.if(O)}setParams(O,U){U?Object.assign(this.params,O):this.params=O}block$data(O,U,L=i.nil){this.gen.block(()=>{this.check$data(O,L),U()})}check$data(O=i.nil,U=i.nil){if(!this.$data)return;const{gen:L,schemaCode:J,schemaType:oe,def:Pe}=this;L.if((0,i.or)((0,i._)`${J} === undefined`,U)),O!==i.nil&&L.assign(O,!0),(oe.length||Pe.validateSchema)&&(L.elseIf(this.invalid$data()),this.$dataError(),O!==i.nil&&L.assign(O,!1)),L.else()}invalid$data(){const{gen:O,schemaCode:U,schemaType:L,def:J,it:oe}=this;return(0,i.or)(Pe(),Ze());function Pe(){if(L.length){if(!(U instanceof i.Name))throw new Error("ajv implementation error");const ze=Array.isArray(L)?L:[L];return(0,i._)`${(0,n.checkDataTypes)(ze,U,oe.opts.strictNumbers,n.DataType.Wrong)}`}return i.nil}function Ze(){if(J.validateSchema){const ze=O.scopeValue("validate$data",{ref:J.validateSchema});return(0,i._)`!${ze}(${U})`}return i.nil}}subschema(O,U){const L=(0,a.getSubschema)(this.it,O);(0,a.extendSubschemaData)(L,this.it,O),(0,a.extendSubschemaMode)(L,O);const J={...this.it,...L,items:void 0,props:void 0};return f(J,U),J}mergeEvaluated(O,U){const{it:L,gen:J}=this;L.opts.unevaluated&&(L.props!==!0&&O.props!==void 0&&(L.props=h.mergeEvaluated.props(J,O.props,L.props,U)),L.items!==!0&&O.items!==void 0&&(L.items=h.mergeEvaluated.items(J,O.items,L.items,U)))}mergeValidEvaluated(O,U){const{it:L,gen:J}=this;if(L.opts.unevaluated&&(L.props!==!0||L.items!==!0))return J.if(U,()=>this.mergeEvaluated(O,i.Name)),!0}}Ke.KeywordCxt=j;function W(A,O,U,L){const J=new j(A,U,O);"code"in U?U.code(J,L):J.$data&&U.validate?(0,s.funcKeywordCode)(J,U):"macro"in U?(0,s.macroKeywordCode)(J,U):(U.compile||U.validate)&&(0,s.funcKeywordCode)(J,U)}const Q=/^\/(?:[^~]|~0|~1)*$/,ie=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function se(A,{dataLevel:O,dataNames:U,dataPathArr:L}){let J,oe;if(A==="")return c.default.rootData;if(A[0]==="/"){if(!Q.test(A))throw new Error(`Invalid JSON-pointer: ${A}`);J=A,oe=c.default.rootData}else{const je=ie.exec(A);if(!je)throw new Error(`Invalid JSON-pointer: ${A}`);const Te=+je[1];if(J=je[2],J==="#"){if(Te>=O)throw new Error(ze("property/index",Te));return L[O-Te]}if(Te>O)throw new Error(ze("data",Te));if(oe=U[O-Te],!J)return oe}let Pe=oe;const Ze=J.split("/");for(const je of Ze)je&&(oe=(0,i._)`${oe}${(0,i.getProperty)((0,h.unescapeJsonPointer)(je))}`,Pe=(0,i._)`${Pe} && ${oe}`);return Pe;function ze(je,Te){return`Cannot access ${je} ${Te} levels up, current level is ${O}`}}return Ke.getData=se,Ke}var dr={},qa;function Kn(){if(qa)return dr;qa=1,Object.defineProperty(dr,"__esModule",{value:!0});class e extends Error{constructor(r){super("validation failed"),this.errors=r,this.ajv=this.validation=!0}}return dr.default=e,dr}var fr={},Ma;function hr(){if(Ma)return fr;Ma=1,Object.defineProperty(fr,"__esModule",{value:!0});const e=ur();class t extends Error{constructor(n,o,s,a){super(a||`can't resolve reference ${s} from id ${o}`),this.missingRef=(0,e.resolveUrl)(n,o,s),this.missingSchema=(0,e.normalizeId)((0,e.getFullPath)(n,this.missingRef))}}return fr.default=t,fr}var qe={},xa;function Wn(){if(xa)return qe;xa=1,Object.defineProperty(qe,"__esModule",{value:!0}),qe.resolveSchema=qe.getCompilingSchema=qe.resolveRef=qe.compileSchema=qe.SchemaEnv=void 0;const e=re(),t=Kn(),r=Xe(),n=ur(),o=ae(),s=lr();class a{constructor(d){var u;this.refs={},this.dynamicAnchors={};let f;typeof d.schema=="object"&&(f=d.schema),this.schema=d.schema,this.schemaId=d.schemaId,this.root=d.root||this,this.baseId=(u=d.baseId)!==null&&u!==void 0?u:(0,n.normalizeId)(f?.[d.schemaId||"$id"]),this.schemaPath=d.schemaPath,this.localRefs=d.localRefs,this.meta=d.meta,this.$async=f?.$async,this.refs={}}}qe.SchemaEnv=a;function i(l){const d=h.call(this,l);if(d)return d;const u=(0,n.getFullPath)(this.opts.uriResolver,l.root.baseId),{es5:f,lines:v}=this.opts.code,{ownProperties:p}=this.opts,g=new e.CodeGen(this.scope,{es5:f,lines:v,ownProperties:p});let S;l.$async&&(S=g.scopeValue("Error",{ref:t.default,code:(0,e._)`require("ajv/dist/runtime/validation_error").default`}));const T=g.scopeName("validate");l.validateName=T;const R={gen:g,allErrors:this.opts.allErrors,data:r.default.data,parentData:r.default.parentData,parentDataProperty:r.default.parentDataProperty,dataNames:[r.default.data],dataPathArr:[e.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:g.scopeValue("schema",this.opts.code.source===!0?{ref:l.schema,code:(0,e.stringify)(l.schema)}:{ref:l.schema}),validateName:T,ValidationError:S,schema:l.schema,schemaEnv:l,rootId:u,baseId:l.baseId||u,schemaPath:e.nil,errSchemaPath:l.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,e._)`""`,opts:this.opts,self:this};let q;try{this._compilations.add(l),(0,s.validateFunctionCode)(R),g.optimize(this.opts.code.optimize);const N=g.toString();q=`${g.scopeRefs(r.default.scope)}return ${N}`,this.opts.code.process&&(q=this.opts.code.process(q,l));const M=new Function(`${r.default.self}`,`${r.default.scope}`,q)(this,this.scope.get());if(this.scope.value(T,{ref:M}),M.errors=null,M.schema=l.schema,M.schemaEnv=l,l.$async&&(M.$async=!0),this.opts.code.source===!0&&(M.source={validateName:T,validateCode:N,scopeValues:g._values}),this.opts.unevaluated){const{props:F,items:Y}=R;M.evaluated={props:F instanceof e.Name?void 0:F,items:Y instanceof e.Name?void 0:Y,dynamicProps:F instanceof e.Name,dynamicItems:Y instanceof e.Name},M.source&&(M.source.evaluated=(0,e.stringify)(M.evaluated))}return l.validate=M,l}catch(N){throw delete l.validate,delete l.validateName,q&&this.logger.error("Error compiling schema, function code:",q),N}finally{this._compilations.delete(l)}}qe.compileSchema=i;function c(l,d,u){var f;u=(0,n.resolveUrl)(this.opts.uriResolver,d,u);const v=l.refs[u];if(v)return v;let p=y.call(this,l,u);if(p===void 0){const g=(f=l.localRefs)===null||f===void 0?void 0:f[u],{schemaId:S}=this.opts;g&&(p=new a({schema:g,schemaId:S,root:l,baseId:d}))}if(p!==void 0)return l.refs[u]=m.call(this,p)}qe.resolveRef=c;function m(l){return(0,n.inlineRef)(l.schema,this.opts.inlineRefs)?l.schema:l.validate?l:i.call(this,l)}function h(l){for(const d of this._compilations)if(b(d,l))return d}qe.getCompilingSchema=h;function b(l,d){return l.schema===d.schema&&l.root===d.root&&l.baseId===d.baseId}function y(l,d){let u;for(;typeof(u=this.refs[d])=="string";)d=u;return u||this.schemas[d]||$.call(this,l,d)}function $(l,d){const u=this.opts.uriResolver.parse(d),f=(0,n._getFullPath)(this.opts.uriResolver,u);let v=(0,n.getFullPath)(this.opts.uriResolver,l.baseId,void 0);if(Object.keys(l.schema).length>0&&f===v)return _.call(this,u,l);const p=(0,n.normalizeId)(f),g=this.refs[p]||this.schemas[p];if(typeof g=="string"){const S=$.call(this,l,g);return typeof S?.schema!="object"?void 0:_.call(this,u,S)}if(typeof g?.schema=="object"){if(g.validate||i.call(this,g),p===(0,n.normalizeId)(d)){const{schema:S}=g,{schemaId:T}=this.opts,R=S[T];return R&&(v=(0,n.resolveUrl)(this.opts.uriResolver,v,R)),new a({schema:S,schemaId:T,root:l,baseId:v})}return _.call(this,u,g)}}qe.resolveSchema=$;const w=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function _(l,{baseId:d,schema:u,root:f}){var v;if(((v=l.fragment)===null||v===void 0?void 0:v[0])!=="/")return;for(const S of l.fragment.slice(1).split("/")){if(typeof u=="boolean")return;const T=u[(0,o.unescapeFragment)(S)];if(T===void 0)return;u=T;const R=typeof u=="object"&&u[this.opts.schemaId];!w.has(S)&&R&&(d=(0,n.resolveUrl)(this.opts.uriResolver,d,R))}let p;if(typeof u!="boolean"&&u.$ref&&!(0,o.schemaHasRulesButRef)(u,this.RULES)){const S=(0,n.resolveUrl)(this.opts.uriResolver,d,u.$ref);p=$.call(this,f,S)}const{schemaId:g}=this.opts;if(p=p||new a({schema:u,schemaId:g,root:f,baseId:d}),p.schema!==p.root.schema)return p}return qe}const Im={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1};var mr={},qt={exports:{}},Bn,Ua;function Da(){if(Ua)return Bn;Ua=1;const e=RegExp.prototype.test.bind(/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu),t=RegExp.prototype.test.bind(/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u);function r(y){let $="",w=0,_=0;for(_=0;_<y.length;_++)if(w=y[_].charCodeAt(0),w!==48){if(!(w>=48&&w<=57||w>=65&&w<=70||w>=97&&w<=102))return"";$+=y[_];break}for(_+=1;_<y.length;_++){if(w=y[_].charCodeAt(0),!(w>=48&&w<=57||w>=65&&w<=70||w>=97&&w<=102))return"";$+=y[_]}return $}const n=RegExp.prototype.test.bind(/[^!"$&'()*+,\-.;=_`a-z{}~]/u);function o(y){return y.length=0,!0}function s(y,$,w){if(y.length){const _=r(y);if(_!=="")$.push(_);else return w.error=!0,!1;y.length=0}return!0}function a(y){let $=0;const w={error:!1,address:"",zone:""},_=[],l=[];let d=!1,u=!1,f=s;for(let v=0;v<y.length;v++){const p=y[v];if(!(p==="["||p==="]"))if(p===":"){if(d===!0&&(u=!0),!f(l,_,w))break;if(++$>7){w.error=!0;break}v>0&&y[v-1]===":"&&(d=!0),_.push(":");continue}else if(p==="%"){if(!f(l,_,w))break;f=o}else{l.push(p);continue}}return l.length&&(f===o?w.zone=l.join(""):u?_.push(l.join("")):_.push(r(l))),w.address=_.join(""),w}function i(y){if(c(y,":")<2)return{host:y,isIPV6:!1};const $=a(y);if($.error)return{host:y,isIPV6:!1};{let w=$.address,_=$.address;return $.zone&&(w+="%"+$.zone,_+="%25"+$.zone),{host:w,isIPV6:!0,escapedHost:_}}}function c(y,$){let w=0;for(let _=0;_<y.length;_++)y[_]===$&&w++;return w}function m(y){let $=y;const w=[];let _=-1,l=0;for(;l=$.length;){if(l===1){if($===".")break;if($==="/"){w.push("/");break}else{w.push($);break}}else if(l===2){if($[0]==="."){if($[1]===".")break;if($[1]==="/"){$=$.slice(2);continue}}else if($[0]==="/"&&($[1]==="."||$[1]==="/")){w.push("/");break}}else if(l===3&&$==="/.."){w.length!==0&&w.pop(),w.push("/");break}if($[0]==="."){if($[1]==="."){if($[2]==="/"){$=$.slice(3);continue}}else if($[1]==="/"){$=$.slice(2);continue}}else if($[0]==="/"&&$[1]==="."){if($[2]==="/"){$=$.slice(2);continue}else if($[2]==="."&&$[3]==="/"){$=$.slice(3),w.length!==0&&w.pop();continue}}if((_=$.indexOf("/",1))===-1){w.push($);break}else w.push($.slice(0,_)),$=$.slice(_)}return w.join("")}function h(y,$){const w=$!==!0?escape:unescape;return y.scheme!==void 0&&(y.scheme=w(y.scheme)),y.userinfo!==void 0&&(y.userinfo=w(y.userinfo)),y.host!==void 0&&(y.host=w(y.host)),y.path!==void 0&&(y.path=w(y.path)),y.query!==void 0&&(y.query=w(y.query)),y.fragment!==void 0&&(y.fragment=w(y.fragment)),y}function b(y){const $=[];if(y.userinfo!==void 0&&($.push(y.userinfo),$.push("@")),y.host!==void 0){let w=unescape(y.host);if(!t(w)){const _=i(w);_.isIPV6===!0?w=`[${_.escapedHost}]`:w=y.host}$.push(w)}return(typeof y.port=="number"||typeof y.port=="string")&&($.push(":"),$.push(String(y.port))),$.length?$.join(""):void 0}return Bn={nonSimpleDomain:n,recomposeAuthority:b,normalizeComponentEncoding:h,removeDotSegments:m,isIPv4:t,isUUID:e,normalizeIPv6:i,stringArrayToHexStripped:r},Bn}var Gn,Va;function Om(){if(Va)return Gn;Va=1;const{isUUID:e}=Da(),t=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu,r=["http","https","ws","wss","urn","urn:uuid"];function n(p){return r.indexOf(p)!==-1}function o(p){return p.secure===!0?!0:p.secure===!1?!1:p.scheme?p.scheme.length===3&&(p.scheme[0]==="w"||p.scheme[0]==="W")&&(p.scheme[1]==="s"||p.scheme[1]==="S")&&(p.scheme[2]==="s"||p.scheme[2]==="S"):!1}function s(p){return p.host||(p.error=p.error||"HTTP URIs must have a host."),p}function a(p){const g=String(p.scheme).toLowerCase()==="https";return(p.port===(g?443:80)||p.port==="")&&(p.port=void 0),p.path||(p.path="/"),p}function i(p){return p.secure=o(p),p.resourceName=(p.path||"/")+(p.query?"?"+p.query:""),p.path=void 0,p.query=void 0,p}function c(p){if((p.port===(o(p)?443:80)||p.port==="")&&(p.port=void 0),typeof p.secure=="boolean"&&(p.scheme=p.secure?"wss":"ws",p.secure=void 0),p.resourceName){const[g,S]=p.resourceName.split("?");p.path=g&&g!=="/"?g:void 0,p.query=S,p.resourceName=void 0}return p.fragment=void 0,p}function m(p,g){if(!p.path)return p.error="URN can not be parsed",p;const S=p.path.match(t);if(S){const T=g.scheme||p.scheme||"urn";p.nid=S[1].toLowerCase(),p.nss=S[2];const R=`${T}:${g.nid||p.nid}`,q=v(R);p.path=void 0,q&&(p=q.parse(p,g))}else p.error=p.error||"URN can not be parsed.";return p}function h(p,g){if(p.nid===void 0)throw new Error("URN without nid cannot be serialized");const S=g.scheme||p.scheme||"urn",T=p.nid.toLowerCase(),R=`${S}:${g.nid||T}`,q=v(R);q&&(p=q.serialize(p,g));const N=p,x=p.nss;return N.path=`${T||g.nid}:${x}`,g.skipEscape=!0,N}function b(p,g){const S=p;return S.uuid=S.nss,S.nss=void 0,!g.tolerant&&(!S.uuid||!e(S.uuid))&&(S.error=S.error||"UUID is not valid."),S}function y(p){const g=p;return g.nss=(p.uuid||"").toLowerCase(),g}const $={scheme:"http",domainHost:!0,parse:s,serialize:a},w={scheme:"https",domainHost:$.domainHost,parse:s,serialize:a},_={scheme:"ws",domainHost:!0,parse:i,serialize:c},l={scheme:"wss",domainHost:_.domainHost,parse:_.parse,serialize:_.serialize},f={http:$,https:w,ws:_,wss:l,urn:{scheme:"urn",parse:m,serialize:h,skipNormalize:!0},"urn:uuid":{scheme:"urn:uuid",parse:b,serialize:y,skipNormalize:!0}};Object.setPrototypeOf(f,null);function v(p){return p&&(f[p]||f[p.toLowerCase()])||void 0}return Gn={wsIsSecure:o,SCHEMES:f,isValidSchemeName:n,getSchemeHandler:v},Gn}var Za;function Cm(){if(Za)return qt.exports;Za=1;const{normalizeIPv6:e,removeDotSegments:t,recomposeAuthority:r,normalizeComponentEncoding:n,isIPv4:o,nonSimpleDomain:s}=Da(),{SCHEMES:a,getSchemeHandler:i}=Om();function c(l,d){return typeof l=="string"?l=y(w(l,d),d):typeof l=="object"&&(l=w(y(l,d),d)),l}function m(l,d,u){const f=u?Object.assign({scheme:"null"},u):{scheme:"null"},v=h(w(l,f),w(d,f),f,!0);return f.skipEscape=!0,y(v,f)}function h(l,d,u,f){const v={};return f||(l=w(y(l,u),u),d=w(y(d,u),u)),u=u||{},!u.tolerant&&d.scheme?(v.scheme=d.scheme,v.userinfo=d.userinfo,v.host=d.host,v.port=d.port,v.path=t(d.path||""),v.query=d.query):(d.userinfo!==void 0||d.host!==void 0||d.port!==void 0?(v.userinfo=d.userinfo,v.host=d.host,v.port=d.port,v.path=t(d.path||""),v.query=d.query):(d.path?(d.path[0]==="/"?v.path=t(d.path):((l.userinfo!==void 0||l.host!==void 0||l.port!==void 0)&&!l.path?v.path="/"+d.path:l.path?v.path=l.path.slice(0,l.path.lastIndexOf("/")+1)+d.path:v.path=d.path,v.path=t(v.path)),v.query=d.query):(v.path=l.path,d.query!==void 0?v.query=d.query:v.query=l.query),v.userinfo=l.userinfo,v.host=l.host,v.port=l.port),v.scheme=l.scheme),v.fragment=d.fragment,v}function b(l,d,u){return typeof l=="string"?(l=unescape(l),l=y(n(w(l,u),!0),{...u,skipEscape:!0})):typeof l=="object"&&(l=y(n(l,!0),{...u,skipEscape:!0})),typeof d=="string"?(d=unescape(d),d=y(n(w(d,u),!0),{...u,skipEscape:!0})):typeof d=="object"&&(d=y(n(d,!0),{...u,skipEscape:!0})),l.toLowerCase()===d.toLowerCase()}function y(l,d){const u={host:l.host,scheme:l.scheme,userinfo:l.userinfo,port:l.port,path:l.path,query:l.query,nid:l.nid,nss:l.nss,uuid:l.uuid,fragment:l.fragment,reference:l.reference,resourceName:l.resourceName,secure:l.secure,error:""},f=Object.assign({},d),v=[],p=i(f.scheme||u.scheme);p&&p.serialize&&p.serialize(u,f),u.path!==void 0&&(f.skipEscape?u.path=unescape(u.path):(u.path=escape(u.path),u.scheme!==void 0&&(u.path=u.path.split("%3A").join(":")))),f.reference!=="suffix"&&u.scheme&&v.push(u.scheme,":");const g=r(u);if(g!==void 0&&(f.reference!=="suffix"&&v.push("//"),v.push(g),u.path&&u.path[0]!=="/"&&v.push("/")),u.path!==void 0){let S=u.path;!f.absolutePath&&(!p||!p.absolutePath)&&(S=t(S)),g===void 0&&S[0]==="/"&&S[1]==="/"&&(S="/%2F"+S.slice(2)),v.push(S)}return u.query!==void 0&&v.push("?",u.query),u.fragment!==void 0&&v.push("#",u.fragment),v.join("")}const $=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function w(l,d){const u=Object.assign({},d),f={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0};let v=!1;u.reference==="suffix"&&(u.scheme?l=u.scheme+":"+l:l="//"+l);const p=l.match($);if(p){if(f.scheme=p[1],f.userinfo=p[3],f.host=p[4],f.port=parseInt(p[5],10),f.path=p[6]||"",f.query=p[7],f.fragment=p[8],isNaN(f.port)&&(f.port=p[5]),f.host)if(o(f.host)===!1){const T=e(f.host);f.host=T.host.toLowerCase(),v=T.isIPV6}else v=!0;f.scheme===void 0&&f.userinfo===void 0&&f.host===void 0&&f.port===void 0&&f.query===void 0&&!f.path?f.reference="same-document":f.scheme===void 0?f.reference="relative":f.fragment===void 0?f.reference="absolute":f.reference="uri",u.reference&&u.reference!=="suffix"&&u.reference!==f.reference&&(f.error=f.error||"URI is not a "+u.reference+" reference.");const g=i(u.scheme||f.scheme);if(!u.unicodeSupport&&(!g||!g.unicodeSupport)&&f.host&&(u.domainHost||g&&g.domainHost)&&v===!1&&s(f.host))try{f.host=URL.domainToASCII(f.host.toLowerCase())}catch(S){f.error=f.error||"Host's domain name can not be converted to ASCII: "+S}(!g||g&&!g.skipNormalize)&&(l.indexOf("%")!==-1&&(f.scheme!==void 0&&(f.scheme=unescape(f.scheme)),f.host!==void 0&&(f.host=unescape(f.host))),f.path&&(f.path=escape(unescape(f.path))),f.fragment&&(f.fragment=encodeURI(decodeURIComponent(f.fragment)))),g&&g.parse&&g.parse(f,u)}else f.error=f.error||"URI can not be parsed.";return f}const _={SCHEMES:a,normalize:c,resolve:m,resolveComponent:h,equal:b,serialize:y,parse:w};return qt.exports=_,qt.exports.default=_,qt.exports.fastUri=_,qt.exports}var La;function Nm(){if(La)return mr;La=1,Object.defineProperty(mr,"__esModule",{value:!0});const e=Cm();return e.code='require("ajv/dist/runtime/uri").default',mr.default=e,mr}var Fa;function zm(){return Fa||(Fa=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=void 0;var t=lr();Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return t.KeywordCxt}});var r=re();Object.defineProperty(e,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return r.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return r.CodeGen}});const n=Kn(),o=hr(),s=ka(),a=Wn(),i=re(),c=ur(),m=cr(),h=ae(),b=Im,y=Nm(),$=(Z,I)=>new RegExp(Z,I);$.code="new RegExp";const w=["removeAdditional","useDefaults","coerceTypes"],_=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),l={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},d={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},u=200;function f(Z){var I,D,C,k,E,j,W,Q,ie,se,A,O,U,L,J,oe,Pe,Ze,ze,je,Te,St,Ue,Eo,Po;const xt=Z.strict,To=(I=Z.code)===null||I===void 0?void 0:I.optimize,ec=To===!0||To===void 0?1:To||0,tc=(C=(D=Z.code)===null||D===void 0?void 0:D.regExp)!==null&&C!==void 0?C:$,Ug=(k=Z.uriResolver)!==null&&k!==void 0?k:y.default;return{strictSchema:(j=(E=Z.strictSchema)!==null&&E!==void 0?E:xt)!==null&&j!==void 0?j:!0,strictNumbers:(Q=(W=Z.strictNumbers)!==null&&W!==void 0?W:xt)!==null&&Q!==void 0?Q:!0,strictTypes:(se=(ie=Z.strictTypes)!==null&&ie!==void 0?ie:xt)!==null&&se!==void 0?se:"log",strictTuples:(O=(A=Z.strictTuples)!==null&&A!==void 0?A:xt)!==null&&O!==void 0?O:"log",strictRequired:(L=(U=Z.strictRequired)!==null&&U!==void 0?U:xt)!==null&&L!==void 0?L:!1,code:Z.code?{...Z.code,optimize:ec,regExp:tc}:{optimize:ec,regExp:tc},loopRequired:(J=Z.loopRequired)!==null&&J!==void 0?J:u,loopEnum:(oe=Z.loopEnum)!==null&&oe!==void 0?oe:u,meta:(Pe=Z.meta)!==null&&Pe!==void 0?Pe:!0,messages:(Ze=Z.messages)!==null&&Ze!==void 0?Ze:!0,inlineRefs:(ze=Z.inlineRefs)!==null&&ze!==void 0?ze:!0,schemaId:(je=Z.schemaId)!==null&&je!==void 0?je:"$id",addUsedSchema:(Te=Z.addUsedSchema)!==null&&Te!==void 0?Te:!0,validateSchema:(St=Z.validateSchema)!==null&&St!==void 0?St:!0,validateFormats:(Ue=Z.validateFormats)!==null&&Ue!==void 0?Ue:!0,unicodeRegExp:(Eo=Z.unicodeRegExp)!==null&&Eo!==void 0?Eo:!0,int32range:(Po=Z.int32range)!==null&&Po!==void 0?Po:!0,uriResolver:Ug}}class v{constructor(I={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,I=this.opts={...I,...f(I)};const{es5:D,lines:C}=this.opts.code;this.scope=new i.ValueScope({scope:{},prefixes:_,es5:D,lines:C}),this.logger=x(I.logger);const k=I.validateFormats;I.validateFormats=!1,this.RULES=(0,s.getRules)(),p.call(this,l,I,"NOT SUPPORTED"),p.call(this,d,I,"DEPRECATED","warn"),this._metaOpts=q.call(this),I.formats&&T.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),I.keywords&&R.call(this,I.keywords),typeof I.meta=="object"&&this.addMetaSchema(I.meta),S.call(this),I.validateFormats=k}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:I,meta:D,schemaId:C}=this.opts;let k=b;C==="id"&&(k={...b},k.id=k.$id,delete k.$id),D&&I&&this.addMetaSchema(k,k[C],!1)}defaultMeta(){const{meta:I,schemaId:D}=this.opts;return this.opts.defaultMeta=typeof I=="object"?I[D]||I:void 0}validate(I,D){let C;if(typeof I=="string"){if(C=this.getSchema(I),!C)throw new Error(`no schema with key or ref "${I}"`)}else C=this.compile(I);const k=C(D);return"$async"in C||(this.errors=C.errors),k}compile(I,D){const C=this._addSchema(I,D);return C.validate||this._compileSchemaEnv(C)}compileAsync(I,D){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");const{loadSchema:C}=this.opts;return k.call(this,I,D);async function k(se,A){await E.call(this,se.$schema);const O=this._addSchema(se,A);return O.validate||j.call(this,O)}async function E(se){se&&!this.getSchema(se)&&await k.call(this,{$ref:se},!0)}async function j(se){try{return this._compileSchemaEnv(se)}catch(A){if(!(A instanceof o.default))throw A;return W.call(this,A),await Q.call(this,A.missingSchema),j.call(this,se)}}function W({missingSchema:se,missingRef:A}){if(this.refs[se])throw new Error(`AnySchema ${se} is loaded but ${A} cannot be resolved`)}async function Q(se){const A=await ie.call(this,se);this.refs[se]||await E.call(this,A.$schema),this.refs[se]||this.addSchema(A,se,D)}async function ie(se){const A=this._loading[se];if(A)return A;try{return await(this._loading[se]=C(se))}finally{delete this._loading[se]}}}addSchema(I,D,C,k=this.opts.validateSchema){if(Array.isArray(I)){for(const j of I)this.addSchema(j,void 0,C,k);return this}let E;if(typeof I=="object"){const{schemaId:j}=this.opts;if(E=I[j],E!==void 0&&typeof E!="string")throw new Error(`schema ${j} must be string`)}return D=(0,c.normalizeId)(D||E),this._checkUnique(D),this.schemas[D]=this._addSchema(I,C,D,k,!0),this}addMetaSchema(I,D,C=this.opts.validateSchema){return this.addSchema(I,D,!0,C),this}validateSchema(I,D){if(typeof I=="boolean")return!0;let C;if(C=I.$schema,C!==void 0&&typeof C!="string")throw new Error("$schema must be a string");if(C=C||this.opts.defaultMeta||this.defaultMeta(),!C)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const k=this.validate(C,I);if(!k&&D){const E="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(E);else throw new Error(E)}return k}getSchema(I){let D;for(;typeof(D=g.call(this,I))=="string";)I=D;if(D===void 0){const{schemaId:C}=this.opts,k=new a.SchemaEnv({schema:{},schemaId:C});if(D=a.resolveSchema.call(this,k,I),!D)return;this.refs[I]=D}return D.validate||this._compileSchemaEnv(D)}removeSchema(I){if(I instanceof RegExp)return this._removeAllSchemas(this.schemas,I),this._removeAllSchemas(this.refs,I),this;switch(typeof I){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const D=g.call(this,I);return typeof D=="object"&&this._cache.delete(D.schema),delete this.schemas[I],delete this.refs[I],this}case"object":{const D=I;this._cache.delete(D);let C=I[this.opts.schemaId];return C&&(C=(0,c.normalizeId)(C),delete this.schemas[C],delete this.refs[C]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(I){for(const D of I)this.addKeyword(D);return this}addKeyword(I,D){let C;if(typeof I=="string")C=I,typeof D=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),D.keyword=C);else if(typeof I=="object"&&D===void 0){if(D=I,C=D.keyword,Array.isArray(C)&&!C.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(F.call(this,C,D),!D)return(0,h.eachItem)(C,E=>Y.call(this,E)),this;le.call(this,D);const k={...D,type:(0,m.getJSONTypes)(D.type),schemaType:(0,m.getJSONTypes)(D.schemaType)};return(0,h.eachItem)(C,k.type.length===0?E=>Y.call(this,E,k):E=>k.type.forEach(j=>Y.call(this,E,k,j))),this}getKeyword(I){const D=this.RULES.all[I];return typeof D=="object"?D.definition:!!D}removeKeyword(I){const{RULES:D}=this;delete D.keywords[I],delete D.all[I];for(const C of D.rules){const k=C.rules.findIndex(E=>E.keyword===I);k>=0&&C.rules.splice(k,1)}return this}addFormat(I,D){return typeof D=="string"&&(D=new RegExp(D)),this.formats[I]=D,this}errorsText(I=this.errors,{separator:D=", ",dataVar:C="data"}={}){return!I||I.length===0?"No errors":I.map(k=>`${C}${k.instancePath} ${k.message}`).reduce((k,E)=>k+D+E)}$dataMetaSchema(I,D){const C=this.RULES.all;I=JSON.parse(JSON.stringify(I));for(const k of D){const E=k.split("/").slice(1);let j=I;for(const W of E)j=j[W];for(const W in C){const Q=C[W];if(typeof Q!="object")continue;const{$data:ie}=Q.definition,se=j[W];ie&&se&&(j[W]=be(se))}}return I}_removeAllSchemas(I,D){for(const C in I){const k=I[C];(!D||D.test(C))&&(typeof k=="string"?delete I[C]:k&&!k.meta&&(this._cache.delete(k.schema),delete I[C]))}}_addSchema(I,D,C,k=this.opts.validateSchema,E=this.opts.addUsedSchema){let j;const{schemaId:W}=this.opts;if(typeof I=="object")j=I[W];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof I!="boolean")throw new Error("schema must be object or boolean")}let Q=this._cache.get(I);if(Q!==void 0)return Q;C=(0,c.normalizeId)(j||C);const ie=c.getSchemaRefs.call(this,I,C);return Q=new a.SchemaEnv({schema:I,schemaId:W,meta:D,baseId:C,localRefs:ie}),this._cache.set(Q.schema,Q),E&&!C.startsWith("#")&&(C&&this._checkUnique(C),this.refs[C]=Q),k&&this.validateSchema(I,!0),Q}_checkUnique(I){if(this.schemas[I]||this.refs[I])throw new Error(`schema with key or id "${I}" already exists`)}_compileSchemaEnv(I){if(I.meta?this._compileMetaSchema(I):a.compileSchema.call(this,I),!I.validate)throw new Error("ajv implementation error");return I.validate}_compileMetaSchema(I){const D=this.opts;this.opts=this._metaOpts;try{a.compileSchema.call(this,I)}finally{this.opts=D}}}v.ValidationError=n.default,v.MissingRefError=o.default,e.default=v;function p(Z,I,D,C="error"){for(const k in Z){const E=k;E in I&&this.logger[C](`${D}: option ${k}. ${Z[E]}`)}}function g(Z){return Z=(0,c.normalizeId)(Z),this.schemas[Z]||this.refs[Z]}function S(){const Z=this.opts.schemas;if(Z)if(Array.isArray(Z))this.addSchema(Z);else for(const I in Z)this.addSchema(Z[I],I)}function T(){for(const Z in this.opts.formats){const I=this.opts.formats[Z];I&&this.addFormat(Z,I)}}function R(Z){if(Array.isArray(Z)){this.addVocabulary(Z);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const I in Z){const D=Z[I];D.keyword||(D.keyword=I),this.addKeyword(D)}}function q(){const Z={...this.opts};for(const I of w)delete Z[I];return Z}const N={log(){},warn(){},error(){}};function x(Z){if(Z===!1)return N;if(Z===void 0)return console;if(Z.log&&Z.warn&&Z.error)return Z;throw new Error("logger must implement log, warn and error methods")}const M=/^[a-z_$][a-z0-9_$:-]*$/i;function F(Z,I){const{RULES:D}=this;if((0,h.eachItem)(Z,C=>{if(D.keywords[C])throw new Error(`Keyword ${C} is already defined`);if(!M.test(C))throw new Error(`Keyword ${C} has invalid name`)}),!!I&&I.$data&&!("code"in I||"validate"in I))throw new Error('$data keyword must have "code" or "validate" function')}function Y(Z,I,D){var C;const k=I?.post;if(D&&k)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:E}=this;let j=k?E.post:E.rules.find(({type:Q})=>Q===D);if(j||(j={type:D,rules:[]},E.rules.push(j)),E.keywords[Z]=!0,!I)return;const W={keyword:Z,definition:{...I,type:(0,m.getJSONTypes)(I.type),schemaType:(0,m.getJSONTypes)(I.schemaType)}};I.before?_e.call(this,j,W,I.before):j.rules.push(W),E.all[Z]=W,(C=I.implements)===null||C===void 0||C.forEach(Q=>this.addKeyword(Q))}function _e(Z,I,D){const C=Z.rules.findIndex(k=>k.keyword===D);C>=0?Z.rules.splice(C,0,I):(Z.rules.push(I),this.logger.warn(`rule ${D} is not defined`))}function le(Z){let{metaSchema:I}=Z;I!==void 0&&(Z.$data&&this.opts.$data&&(I=be(I)),Z.validateSchema=this.compile(I,!0))}const ee={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function be(Z){return{anyOf:[Z,ee]}}})(Un)),Un}var pr={},gr={},_r={},Ha;function jm(){if(Ha)return _r;Ha=1,Object.defineProperty(_r,"__esModule",{value:!0});const e={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};return _r.default=e,_r}var et={},Ka;function qm(){if(Ka)return et;Ka=1,Object.defineProperty(et,"__esModule",{value:!0}),et.callRef=et.getValidate=void 0;const e=hr(),t=Ve(),r=re(),n=Xe(),o=Wn(),s=ae(),a={keyword:"$ref",schemaType:"string",code(m){const{gen:h,schema:b,it:y}=m,{baseId:$,schemaEnv:w,validateName:_,opts:l,self:d}=y,{root:u}=w;if((b==="#"||b==="#/")&&$===u.baseId)return v();const f=o.resolveRef.call(d,u,$,b);if(f===void 0)throw new e.default(y.opts.uriResolver,$,b);if(f instanceof o.SchemaEnv)return p(f);return g(f);function v(){if(w===u)return c(m,_,w,w.$async);const S=h.scopeValue("root",{ref:u});return c(m,(0,r._)`${S}.validate`,u,u.$async)}function p(S){const T=i(m,S);c(m,T,S,S.$async)}function g(S){const T=h.scopeValue("schema",l.code.source===!0?{ref:S,code:(0,r.stringify)(S)}:{ref:S}),R=h.name("valid"),q=m.subschema({schema:S,dataTypes:[],schemaPath:r.nil,topSchemaRef:T,errSchemaPath:b},R);m.mergeEvaluated(q),m.ok(R)}}};function i(m,h){const{gen:b}=m;return h.validate?b.scopeValue("validate",{ref:h.validate}):(0,r._)`${b.scopeValue("wrapper",{ref:h})}.validate`}et.getValidate=i;function c(m,h,b,y){const{gen:$,it:w}=m,{allErrors:_,schemaEnv:l,opts:d}=w,u=d.passContext?n.default.this:r.nil;y?f():v();function f(){if(!l.$async)throw new Error("async schema referenced by sync schema");const S=$.let("valid");$.try(()=>{$.code((0,r._)`await ${(0,t.callValidateCode)(m,h,u)}`),g(h),_||$.assign(S,!0)},T=>{$.if((0,r._)`!(${T} instanceof ${w.ValidationError})`,()=>$.throw(T)),p(T),_||$.assign(S,!1)}),m.ok(S)}function v(){m.result((0,t.callValidateCode)(m,h,u),()=>g(h),()=>p(h))}function p(S){const T=(0,r._)`${S}.errors`;$.assign(n.default.vErrors,(0,r._)`${n.default.vErrors} === null ? ${T} : ${n.default.vErrors}.concat(${T})`),$.assign(n.default.errors,(0,r._)`${n.default.vErrors}.length`)}function g(S){var T;if(!w.opts.unevaluated)return;const R=(T=b?.validate)===null||T===void 0?void 0:T.evaluated;if(w.props!==!0)if(R&&!R.dynamicProps)R.props!==void 0&&(w.props=s.mergeEvaluated.props($,R.props,w.props));else{const q=$.var("props",(0,r._)`${S}.evaluated.props`);w.props=s.mergeEvaluated.props($,q,w.props,r.Name)}if(w.items!==!0)if(R&&!R.dynamicItems)R.items!==void 0&&(w.items=s.mergeEvaluated.items($,R.items,w.items));else{const q=$.var("items",(0,r._)`${S}.evaluated.items`);w.items=s.mergeEvaluated.items($,q,w.items,r.Name)}}}return et.callRef=c,et.default=a,et}var Wa;function Mm(){if(Wa)return gr;Wa=1,Object.defineProperty(gr,"__esModule",{value:!0});const e=jm(),t=qm(),r=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",e.default,t.default];return gr.default=r,gr}var vr={},yr={},Ba;function xm(){if(Ba)return yr;Ba=1,Object.defineProperty(yr,"__esModule",{value:!0});const e=re(),t=e.operators,r={maximum:{okStr:"<=",ok:t.LTE,fail:t.GT},minimum:{okStr:">=",ok:t.GTE,fail:t.LT},exclusiveMaximum:{okStr:"<",ok:t.LT,fail:t.GTE},exclusiveMinimum:{okStr:">",ok:t.GT,fail:t.LTE}},n={message:({keyword:s,schemaCode:a})=>(0,e.str)`must be ${r[s].okStr} ${a}`,params:({keyword:s,schemaCode:a})=>(0,e._)`{comparison: ${r[s].okStr}, limit: ${a}}`},o={keyword:Object.keys(r),type:"number",schemaType:"number",$data:!0,error:n,code(s){const{keyword:a,data:i,schemaCode:c}=s;s.fail$data((0,e._)`${i} ${r[a].fail} ${c} || isNaN(${i})`)}};return yr.default=o,yr}var wr={},Ga;function Um(){if(Ga)return wr;Ga=1,Object.defineProperty(wr,"__esModule",{value:!0});const e=re(),r={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:{message:({schemaCode:n})=>(0,e.str)`must be multiple of ${n}`,params:({schemaCode:n})=>(0,e._)`{multipleOf: ${n}}`},code(n){const{gen:o,data:s,schemaCode:a,it:i}=n,c=i.opts.multipleOfPrecision,m=o.let("res"),h=c?(0,e._)`Math.abs(Math.round(${m}) - ${m}) > 1e-${c}`:(0,e._)`${m} !== parseInt(${m})`;n.fail$data((0,e._)`(${a} === 0 || (${m} = ${s}/${a}, ${h}))`)}};return wr.default=r,wr}var br={},$r={},Ja;function Dm(){if(Ja)return $r;Ja=1,Object.defineProperty($r,"__esModule",{value:!0});function e(t){const r=t.length;let n=0,o=0,s;for(;o<r;)n++,s=t.charCodeAt(o++),s>=55296&&s<=56319&&o<r&&(s=t.charCodeAt(o),(s&64512)===56320&&o++);return n}return $r.default=e,e.code='require("ajv/dist/runtime/ucs2length").default',$r}var Ya;function Vm(){if(Ya)return br;Ya=1,Object.defineProperty(br,"__esModule",{value:!0});const e=re(),t=ae(),r=Dm(),o={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:{message({keyword:s,schemaCode:a}){const i=s==="maxLength"?"more":"fewer";return(0,e.str)`must NOT have ${i} than ${a} characters`},params:({schemaCode:s})=>(0,e._)`{limit: ${s}}`},code(s){const{keyword:a,data:i,schemaCode:c,it:m}=s,h=a==="maxLength"?e.operators.GT:e.operators.LT,b=m.opts.unicode===!1?(0,e._)`${i}.length`:(0,e._)`${(0,t.useFunc)(s.gen,r.default)}(${i})`;s.fail$data((0,e._)`${b} ${h} ${c}`)}};return br.default=o,br}var kr={},Qa;function Zm(){if(Qa)return kr;Qa=1,Object.defineProperty(kr,"__esModule",{value:!0});const e=Ve(),t=re(),n={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:{message:({schemaCode:o})=>(0,t.str)`must match pattern "${o}"`,params:({schemaCode:o})=>(0,t._)`{pattern: ${o}}`},code(o){const{data:s,$data:a,schema:i,schemaCode:c,it:m}=o,h=m.opts.unicodeRegExp?"u":"",b=a?(0,t._)`(new RegExp(${c}, ${h}))`:(0,e.usePattern)(o,i);o.fail$data((0,t._)`!${b}.test(${s})`)}};return kr.default=n,kr}var Sr={},Xa;function Lm(){if(Xa)return Sr;Xa=1,Object.defineProperty(Sr,"__esModule",{value:!0});const e=re(),r={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:{message({keyword:n,schemaCode:o}){const s=n==="maxProperties"?"more":"fewer";return(0,e.str)`must NOT have ${s} than ${o} properties`},params:({schemaCode:n})=>(0,e._)`{limit: ${n}}`},code(n){const{keyword:o,data:s,schemaCode:a}=n,i=o==="maxProperties"?e.operators.GT:e.operators.LT;n.fail$data((0,e._)`Object.keys(${s}).length ${i} ${a}`)}};return Sr.default=r,Sr}var Er={},ei;function Fm(){if(ei)return Er;ei=1,Object.defineProperty(Er,"__esModule",{value:!0});const e=Ve(),t=re(),r=ae(),o={keyword:"required",type:"object",schemaType:"array",$data:!0,error:{message:({params:{missingProperty:s}})=>(0,t.str)`must have required property '${s}'`,params:({params:{missingProperty:s}})=>(0,t._)`{missingProperty: ${s}}`},code(s){const{gen:a,schema:i,schemaCode:c,data:m,$data:h,it:b}=s,{opts:y}=b;if(!h&&i.length===0)return;const $=i.length>=y.loopRequired;if(b.allErrors?w():_(),y.strictRequired){const u=s.parentSchema.properties,{definedProperties:f}=s.it;for(const v of i)if(u?.[v]===void 0&&!f.has(v)){const p=b.schemaEnv.baseId+b.errSchemaPath,g=`required property "${v}" is not defined at "${p}" (strictRequired)`;(0,r.checkStrictMode)(b,g,b.opts.strictRequired)}}function w(){if($||h)s.block$data(t.nil,l);else for(const u of i)(0,e.checkReportMissingProp)(s,u)}function _(){const u=a.let("missing");if($||h){const f=a.let("valid",!0);s.block$data(f,()=>d(u,f)),s.ok(f)}else a.if((0,e.checkMissingProp)(s,i,u)),(0,e.reportMissingProp)(s,u),a.else()}function l(){a.forOf("prop",c,u=>{s.setParams({missingProperty:u}),a.if((0,e.noPropertyInData)(a,m,u,y.ownProperties),()=>s.error())})}function d(u,f){s.setParams({missingProperty:u}),a.forOf(u,c,()=>{a.assign(f,(0,e.propertyInData)(a,m,u,y.ownProperties)),a.if((0,t.not)(f),()=>{s.error(),a.break()})},t.nil)}}};return Er.default=o,Er}var Pr={},ti;function Hm(){if(ti)return Pr;ti=1,Object.defineProperty(Pr,"__esModule",{value:!0});const e=re(),r={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:{message({keyword:n,schemaCode:o}){const s=n==="maxItems"?"more":"fewer";return(0,e.str)`must NOT have ${s} than ${o} items`},params:({schemaCode:n})=>(0,e._)`{limit: ${n}}`},code(n){const{keyword:o,data:s,schemaCode:a}=n,i=o==="maxItems"?e.operators.GT:e.operators.LT;n.fail$data((0,e._)`${s}.length ${i} ${a}`)}};return Pr.default=r,Pr}var Tr={},Ar={},ri;function Jn(){if(ri)return Ar;ri=1,Object.defineProperty(Ar,"__esModule",{value:!0});const e=Ca();return e.code='require("ajv/dist/runtime/equal").default',Ar.default=e,Ar}var ni;function Km(){if(ni)return Tr;ni=1,Object.defineProperty(Tr,"__esModule",{value:!0});const e=cr(),t=re(),r=ae(),n=Jn(),s={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:{message:({params:{i:a,j:i}})=>(0,t.str)`must NOT have duplicate items (items ## ${i} and ${a} are identical)`,params:({params:{i:a,j:i}})=>(0,t._)`{i: ${a}, j: ${i}}`},code(a){const{gen:i,data:c,$data:m,schema:h,parentSchema:b,schemaCode:y,it:$}=a;if(!m&&!h)return;const w=i.let("valid"),_=b.items?(0,e.getSchemaTypes)(b.items):[];a.block$data(w,l,(0,t._)`${y} === false`),a.ok(w);function l(){const v=i.let("i",(0,t._)`${c}.length`),p=i.let("j");a.setParams({i:v,j:p}),i.assign(w,!0),i.if((0,t._)`${v} > 1`,()=>(d()?u:f)(v,p))}function d(){return _.length>0&&!_.some(v=>v==="object"||v==="array")}function u(v,p){const g=i.name("item"),S=(0,e.checkDataTypes)(_,g,$.opts.strictNumbers,e.DataType.Wrong),T=i.const("indices",(0,t._)`{}`);i.for((0,t._)`;${v}--;`,()=>{i.let(g,(0,t._)`${c}[${v}]`),i.if(S,(0,t._)`continue`),_.length>1&&i.if((0,t._)`typeof ${g} == "string"`,(0,t._)`${g} += "_"`),i.if((0,t._)`typeof ${T}[${g}] == "number"`,()=>{i.assign(p,(0,t._)`${T}[${g}]`),a.error(),i.assign(w,!1).break()}).code((0,t._)`${T}[${g}] = ${v}`)})}function f(v,p){const g=(0,r.useFunc)(i,n.default),S=i.name("outer");i.label(S).for((0,t._)`;${v}--;`,()=>i.for((0,t._)`${p} = ${v}; ${p}--;`,()=>i.if((0,t._)`${g}(${c}[${v}], ${c}[${p}])`,()=>{a.error(),i.assign(w,!1).break(S)})))}}};return Tr.default=s,Tr}var Rr={},oi;function Wm(){if(oi)return Rr;oi=1,Object.defineProperty(Rr,"__esModule",{value:!0});const e=re(),t=ae(),r=Jn(),o={keyword:"const",$data:!0,error:{message:"must be equal to constant",params:({schemaCode:s})=>(0,e._)`{allowedValue: ${s}}`},code(s){const{gen:a,data:i,$data:c,schemaCode:m,schema:h}=s;c||h&&typeof h=="object"?s.fail$data((0,e._)`!${(0,t.useFunc)(a,r.default)}(${i}, ${m})`):s.fail((0,e._)`${h} !== ${i}`)}};return Rr.default=o,Rr}var Ir={},si;function Bm(){if(si)return Ir;si=1,Object.defineProperty(Ir,"__esModule",{value:!0});const e=re(),t=ae(),r=Jn(),o={keyword:"enum",schemaType:"array",$data:!0,error:{message:"must be equal to one of the allowed values",params:({schemaCode:s})=>(0,e._)`{allowedValues: ${s}}`},code(s){const{gen:a,data:i,$data:c,schema:m,schemaCode:h,it:b}=s;if(!c&&m.length===0)throw new Error("enum must have non-empty array");const y=m.length>=b.opts.loopEnum;let $;const w=()=>$??($=(0,t.useFunc)(a,r.default));let _;if(y||c)_=a.let("valid"),s.block$data(_,l);else{if(!Array.isArray(m))throw new Error("ajv implementation error");const u=a.const("vSchema",h);_=(0,e.or)(...m.map((f,v)=>d(u,v)))}s.pass(_);function l(){a.assign(_,!1),a.forOf("v",h,u=>a.if((0,e._)`${w()}(${i}, ${u})`,()=>a.assign(_,!0).break()))}function d(u,f){const v=m[f];return typeof v=="object"&&v!==null?(0,e._)`${w()}(${i}, ${u}[${f}])`:(0,e._)`${i} === ${v}`}}};return Ir.default=o,Ir}var ai;function Gm(){if(ai)return vr;ai=1,Object.defineProperty(vr,"__esModule",{value:!0});const e=xm(),t=Um(),r=Vm(),n=Zm(),o=Lm(),s=Fm(),a=Hm(),i=Km(),c=Wm(),m=Bm(),h=[e.default,t.default,r.default,n.default,o.default,s.default,a.default,i.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},c.default,m.default];return vr.default=h,vr}var Or={},yt={},ii;function ci(){if(ii)return yt;ii=1,Object.defineProperty(yt,"__esModule",{value:!0}),yt.validateAdditionalItems=void 0;const e=re(),t=ae(),n={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:{message:({params:{len:s}})=>(0,e.str)`must NOT have more than ${s} items`,params:({params:{len:s}})=>(0,e._)`{limit: ${s}}`},code(s){const{parentSchema:a,it:i}=s,{items:c}=a;if(!Array.isArray(c)){(0,t.checkStrictMode)(i,'"additionalItems" is ignored when "items" is not an array of schemas');return}o(s,c)}};function o(s,a){const{gen:i,schema:c,data:m,keyword:h,it:b}=s;b.items=!0;const y=i.const("len",(0,e._)`${m}.length`);if(c===!1)s.setParams({len:a.length}),s.pass((0,e._)`${y} <= ${a.length}`);else if(typeof c=="object"&&!(0,t.alwaysValidSchema)(b,c)){const w=i.var("valid",(0,e._)`${y} <= ${a.length}`);i.if((0,e.not)(w),()=>$(w)),s.ok(w)}function $(w){i.forRange("i",a.length,y,_=>{s.subschema({keyword:h,dataProp:_,dataPropType:t.Type.Num},w),b.allErrors||i.if((0,e.not)(w),()=>i.break())})}}return yt.validateAdditionalItems=o,yt.default=n,yt}var Cr={},wt={},ui;function li(){if(ui)return wt;ui=1,Object.defineProperty(wt,"__esModule",{value:!0}),wt.validateTuple=void 0;const e=re(),t=ae(),r=Ve(),n={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(s){const{schema:a,it:i}=s;if(Array.isArray(a))return o(s,"additionalItems",a);i.items=!0,!(0,t.alwaysValidSchema)(i,a)&&s.ok((0,r.validateArray)(s))}};function o(s,a,i=s.schema){const{gen:c,parentSchema:m,data:h,keyword:b,it:y}=s;_(m),y.opts.unevaluated&&i.length&&y.items!==!0&&(y.items=t.mergeEvaluated.items(c,i.length,y.items));const $=c.name("valid"),w=c.const("len",(0,e._)`${h}.length`);i.forEach((l,d)=>{(0,t.alwaysValidSchema)(y,l)||(c.if((0,e._)`${w} > ${d}`,()=>s.subschema({keyword:b,schemaProp:d,dataProp:d},$)),s.ok($))});function _(l){const{opts:d,errSchemaPath:u}=y,f=i.length,v=f===l.minItems&&(f===l.maxItems||l[a]===!1);if(d.strictTuples&&!v){const p=`"${b}" is ${f}-tuple, but minItems or maxItems/${a} are not specified or different at path "${u}"`;(0,t.checkStrictMode)(y,p,d.strictTuples)}}}return wt.validateTuple=o,wt.default=n,wt}var di;function Jm(){if(di)return Cr;di=1,Object.defineProperty(Cr,"__esModule",{value:!0});const e=li(),t={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:r=>(0,e.validateTuple)(r,"items")};return Cr.default=t,Cr}var Nr={},fi;function Ym(){if(fi)return Nr;fi=1,Object.defineProperty(Nr,"__esModule",{value:!0});const e=re(),t=ae(),r=Ve(),n=ci(),s={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:{message:({params:{len:a}})=>(0,e.str)`must NOT have more than ${a} items`,params:({params:{len:a}})=>(0,e._)`{limit: ${a}}`},code(a){const{schema:i,parentSchema:c,it:m}=a,{prefixItems:h}=c;m.items=!0,!(0,t.alwaysValidSchema)(m,i)&&(h?(0,n.validateAdditionalItems)(a,h):a.ok((0,r.validateArray)(a)))}};return Nr.default=s,Nr}var zr={},hi;function Qm(){if(hi)return zr;hi=1,Object.defineProperty(zr,"__esModule",{value:!0});const e=re(),t=ae(),n={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:{message:({params:{min:o,max:s}})=>s===void 0?(0,e.str)`must contain at least ${o} valid item(s)`:(0,e.str)`must contain at least ${o} and no more than ${s} valid item(s)`,params:({params:{min:o,max:s}})=>s===void 0?(0,e._)`{minContains: ${o}}`:(0,e._)`{minContains: ${o}, maxContains: ${s}}`},code(o){const{gen:s,schema:a,parentSchema:i,data:c,it:m}=o;let h,b;const{minContains:y,maxContains:$}=i;m.opts.next?(h=y===void 0?1:y,b=$):h=1;const w=s.const("len",(0,e._)`${c}.length`);if(o.setParams({min:h,max:b}),b===void 0&&h===0){(0,t.checkStrictMode)(m,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(b!==void 0&&h>b){(0,t.checkStrictMode)(m,'"minContains" > "maxContains" is always invalid'),o.fail();return}if((0,t.alwaysValidSchema)(m,a)){let f=(0,e._)`${w} >= ${h}`;b!==void 0&&(f=(0,e._)`${f} && ${w} <= ${b}`),o.pass(f);return}m.items=!0;const _=s.name("valid");b===void 0&&h===1?d(_,()=>s.if(_,()=>s.break())):h===0?(s.let(_,!0),b!==void 0&&s.if((0,e._)`${c}.length > 0`,l)):(s.let(_,!1),l()),o.result(_,()=>o.reset());function l(){const f=s.name("_valid"),v=s.let("count",0);d(f,()=>s.if(f,()=>u(v)))}function d(f,v){s.forRange("i",0,w,p=>{o.subschema({keyword:"contains",dataProp:p,dataPropType:t.Type.Num,compositeRule:!0},f),v()})}function u(f){s.code((0,e._)`${f}++`),b===void 0?s.if((0,e._)`${f} >= ${h}`,()=>s.assign(_,!0).break()):(s.if((0,e._)`${f} > ${b}`,()=>s.assign(_,!1).break()),h===1?s.assign(_,!0):s.if((0,e._)`${f} >= ${h}`,()=>s.assign(_,!0)))}}};return zr.default=n,zr}var Yn={},mi;function Xm(){return mi||(mi=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.validateSchemaDeps=e.validatePropertyDeps=e.error=void 0;const t=re(),r=ae(),n=Ve();e.error={message:({params:{property:c,depsCount:m,deps:h}})=>{const b=m===1?"property":"properties";return(0,t.str)`must have ${b} ${h} when property ${c} is present`},params:({params:{property:c,depsCount:m,deps:h,missingProperty:b}})=>(0,t._)`{property: ${c},
    missingProperty: ${b},
    depsCount: ${m},
    deps: ${h}}`};const o={keyword:"dependencies",type:"object",schemaType:"object",error:e.error,code(c){const[m,h]=s(c);a(c,m),i(c,h)}};function s({schema:c}){const m={},h={};for(const b in c){if(b==="__proto__")continue;const y=Array.isArray(c[b])?m:h;y[b]=c[b]}return[m,h]}function a(c,m=c.schema){const{gen:h,data:b,it:y}=c;if(Object.keys(m).length===0)return;const $=h.let("missing");for(const w in m){const _=m[w];if(_.length===0)continue;const l=(0,n.propertyInData)(h,b,w,y.opts.ownProperties);c.setParams({property:w,depsCount:_.length,deps:_.join(", ")}),y.allErrors?h.if(l,()=>{for(const d of _)(0,n.checkReportMissingProp)(c,d)}):(h.if((0,t._)`${l} && (${(0,n.checkMissingProp)(c,_,$)})`),(0,n.reportMissingProp)(c,$),h.else())}}e.validatePropertyDeps=a;function i(c,m=c.schema){const{gen:h,data:b,keyword:y,it:$}=c,w=h.name("valid");for(const _ in m)(0,r.alwaysValidSchema)($,m[_])||(h.if((0,n.propertyInData)(h,b,_,$.opts.ownProperties),()=>{const l=c.subschema({keyword:y,schemaProp:_},w);c.mergeValidEvaluated(l,w)},()=>h.var(w,!0)),c.ok(w))}e.validateSchemaDeps=i,e.default=o})(Yn)),Yn}var jr={},pi;function ep(){if(pi)return jr;pi=1,Object.defineProperty(jr,"__esModule",{value:!0});const e=re(),t=ae(),n={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:{message:"property name must be valid",params:({params:o})=>(0,e._)`{propertyName: ${o.propertyName}}`},code(o){const{gen:s,schema:a,data:i,it:c}=o;if((0,t.alwaysValidSchema)(c,a))return;const m=s.name("valid");s.forIn("key",i,h=>{o.setParams({propertyName:h}),o.subschema({keyword:"propertyNames",data:h,dataTypes:["string"],propertyName:h,compositeRule:!0},m),s.if((0,e.not)(m),()=>{o.error(!0),c.allErrors||s.break()})}),o.ok(m)}};return jr.default=n,jr}var qr={},gi;function _i(){if(gi)return qr;gi=1,Object.defineProperty(qr,"__esModule",{value:!0});const e=Ve(),t=re(),r=Xe(),n=ae(),s={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:{message:"must NOT have additional properties",params:({params:a})=>(0,t._)`{additionalProperty: ${a.additionalProperty}}`},code(a){const{gen:i,schema:c,parentSchema:m,data:h,errsCount:b,it:y}=a;if(!b)throw new Error("ajv implementation error");const{allErrors:$,opts:w}=y;if(y.props=!0,w.removeAdditional!=="all"&&(0,n.alwaysValidSchema)(y,c))return;const _=(0,e.allSchemaProperties)(m.properties),l=(0,e.allSchemaProperties)(m.patternProperties);d(),a.ok((0,t._)`${b} === ${r.default.errors}`);function d(){i.forIn("key",h,g=>{!_.length&&!l.length?v(g):i.if(u(g),()=>v(g))})}function u(g){let S;if(_.length>8){const T=(0,n.schemaRefOrVal)(y,m.properties,"properties");S=(0,e.isOwnProperty)(i,T,g)}else _.length?S=(0,t.or)(..._.map(T=>(0,t._)`${g} === ${T}`)):S=t.nil;return l.length&&(S=(0,t.or)(S,...l.map(T=>(0,t._)`${(0,e.usePattern)(a,T)}.test(${g})`))),(0,t.not)(S)}function f(g){i.code((0,t._)`delete ${h}[${g}]`)}function v(g){if(w.removeAdditional==="all"||w.removeAdditional&&c===!1){f(g);return}if(c===!1){a.setParams({additionalProperty:g}),a.error(),$||i.break();return}if(typeof c=="object"&&!(0,n.alwaysValidSchema)(y,c)){const S=i.name("valid");w.removeAdditional==="failing"?(p(g,S,!1),i.if((0,t.not)(S),()=>{a.reset(),f(g)})):(p(g,S),$||i.if((0,t.not)(S),()=>i.break()))}}function p(g,S,T){const R={keyword:"additionalProperties",dataProp:g,dataPropType:n.Type.Str};T===!1&&Object.assign(R,{compositeRule:!0,createErrors:!1,allErrors:!1}),a.subschema(R,S)}}};return qr.default=s,qr}var Mr={},vi;function tp(){if(vi)return Mr;vi=1,Object.defineProperty(Mr,"__esModule",{value:!0});const e=lr(),t=Ve(),r=ae(),n=_i(),o={keyword:"properties",type:"object",schemaType:"object",code(s){const{gen:a,schema:i,parentSchema:c,data:m,it:h}=s;h.opts.removeAdditional==="all"&&c.additionalProperties===void 0&&n.default.code(new e.KeywordCxt(h,n.default,"additionalProperties"));const b=(0,t.allSchemaProperties)(i);for(const l of b)h.definedProperties.add(l);h.opts.unevaluated&&b.length&&h.props!==!0&&(h.props=r.mergeEvaluated.props(a,(0,r.toHash)(b),h.props));const y=b.filter(l=>!(0,r.alwaysValidSchema)(h,i[l]));if(y.length===0)return;const $=a.name("valid");for(const l of y)w(l)?_(l):(a.if((0,t.propertyInData)(a,m,l,h.opts.ownProperties)),_(l),h.allErrors||a.else().var($,!0),a.endIf()),s.it.definedProperties.add(l),s.ok($);function w(l){return h.opts.useDefaults&&!h.compositeRule&&i[l].default!==void 0}function _(l){s.subschema({keyword:"properties",schemaProp:l,dataProp:l},$)}}};return Mr.default=o,Mr}var xr={},yi;function rp(){if(yi)return xr;yi=1,Object.defineProperty(xr,"__esModule",{value:!0});const e=Ve(),t=re(),r=ae(),n=ae(),o={keyword:"patternProperties",type:"object",schemaType:"object",code(s){const{gen:a,schema:i,data:c,parentSchema:m,it:h}=s,{opts:b}=h,y=(0,e.allSchemaProperties)(i),$=y.filter(v=>(0,r.alwaysValidSchema)(h,i[v]));if(y.length===0||$.length===y.length&&(!h.opts.unevaluated||h.props===!0))return;const w=b.strictSchema&&!b.allowMatchingProperties&&m.properties,_=a.name("valid");h.props!==!0&&!(h.props instanceof t.Name)&&(h.props=(0,n.evaluatedPropsToName)(a,h.props));const{props:l}=h;d();function d(){for(const v of y)w&&u(v),h.allErrors?f(v):(a.var(_,!0),f(v),a.if(_))}function u(v){for(const p in w)new RegExp(v).test(p)&&(0,r.checkStrictMode)(h,`property ${p} matches pattern ${v} (use allowMatchingProperties)`)}function f(v){a.forIn("key",c,p=>{a.if((0,t._)`${(0,e.usePattern)(s,v)}.test(${p})`,()=>{const g=$.includes(v);g||s.subschema({keyword:"patternProperties",schemaProp:v,dataProp:p,dataPropType:n.Type.Str},_),h.opts.unevaluated&&l!==!0?a.assign((0,t._)`${l}[${p}]`,!0):!g&&!h.allErrors&&a.if((0,t.not)(_),()=>a.break())})})}}};return xr.default=o,xr}var Ur={},wi;function np(){if(wi)return Ur;wi=1,Object.defineProperty(Ur,"__esModule",{value:!0});const e=ae(),t={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(r){const{gen:n,schema:o,it:s}=r;if((0,e.alwaysValidSchema)(s,o)){r.fail();return}const a=n.name("valid");r.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},a),r.failResult(a,()=>r.reset(),()=>r.error())},error:{message:"must NOT be valid"}};return Ur.default=t,Ur}var Dr={},bi;function op(){if(bi)return Dr;bi=1,Object.defineProperty(Dr,"__esModule",{value:!0});const t={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:Ve().validateUnion,error:{message:"must match a schema in anyOf"}};return Dr.default=t,Dr}var Vr={},$i;function sp(){if($i)return Vr;$i=1,Object.defineProperty(Vr,"__esModule",{value:!0});const e=re(),t=ae(),n={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:{message:"must match exactly one schema in oneOf",params:({params:o})=>(0,e._)`{passingSchemas: ${o.passing}}`},code(o){const{gen:s,schema:a,parentSchema:i,it:c}=o;if(!Array.isArray(a))throw new Error("ajv implementation error");if(c.opts.discriminator&&i.discriminator)return;const m=a,h=s.let("valid",!1),b=s.let("passing",null),y=s.name("_valid");o.setParams({passing:b}),s.block($),o.result(h,()=>o.reset(),()=>o.error(!0));function $(){m.forEach((w,_)=>{let l;(0,t.alwaysValidSchema)(c,w)?s.var(y,!0):l=o.subschema({keyword:"oneOf",schemaProp:_,compositeRule:!0},y),_>0&&s.if((0,e._)`${y} && ${h}`).assign(h,!1).assign(b,(0,e._)`[${b}, ${_}]`).else(),s.if(y,()=>{s.assign(h,!0),s.assign(b,_),l&&o.mergeEvaluated(l,e.Name)})})}}};return Vr.default=n,Vr}var Zr={},ki;function ap(){if(ki)return Zr;ki=1,Object.defineProperty(Zr,"__esModule",{value:!0});const e=ae(),t={keyword:"allOf",schemaType:"array",code(r){const{gen:n,schema:o,it:s}=r;if(!Array.isArray(o))throw new Error("ajv implementation error");const a=n.name("valid");o.forEach((i,c)=>{if((0,e.alwaysValidSchema)(s,i))return;const m=r.subschema({keyword:"allOf",schemaProp:c},a);r.ok(a),r.mergeEvaluated(m)})}};return Zr.default=t,Zr}var Lr={},Si;function ip(){if(Si)return Lr;Si=1,Object.defineProperty(Lr,"__esModule",{value:!0});const e=re(),t=ae(),n={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:{message:({params:s})=>(0,e.str)`must match "${s.ifClause}" schema`,params:({params:s})=>(0,e._)`{failingKeyword: ${s.ifClause}}`},code(s){const{gen:a,parentSchema:i,it:c}=s;i.then===void 0&&i.else===void 0&&(0,t.checkStrictMode)(c,'"if" without "then" and "else" is ignored');const m=o(c,"then"),h=o(c,"else");if(!m&&!h)return;const b=a.let("valid",!0),y=a.name("_valid");if($(),s.reset(),m&&h){const _=a.let("ifClause");s.setParams({ifClause:_}),a.if(y,w("then",_),w("else",_))}else m?a.if(y,w("then")):a.if((0,e.not)(y),w("else"));s.pass(b,()=>s.error(!0));function $(){const _=s.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},y);s.mergeEvaluated(_)}function w(_,l){return()=>{const d=s.subschema({keyword:_},y);a.assign(b,y),s.mergeValidEvaluated(d,b),l?a.assign(l,(0,e._)`${_}`):s.setParams({ifClause:_})}}}};function o(s,a){const i=s.schema[a];return i!==void 0&&!(0,t.alwaysValidSchema)(s,i)}return Lr.default=n,Lr}var Fr={},Ei;function cp(){if(Ei)return Fr;Ei=1,Object.defineProperty(Fr,"__esModule",{value:!0});const e=ae(),t={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:r,parentSchema:n,it:o}){n.if===void 0&&(0,e.checkStrictMode)(o,`"${r}" without "if" is ignored`)}};return Fr.default=t,Fr}var Pi;function up(){if(Pi)return Or;Pi=1,Object.defineProperty(Or,"__esModule",{value:!0});const e=ci(),t=Jm(),r=li(),n=Ym(),o=Qm(),s=Xm(),a=ep(),i=_i(),c=tp(),m=rp(),h=np(),b=op(),y=sp(),$=ap(),w=ip(),_=cp();function l(d=!1){const u=[h.default,b.default,y.default,$.default,w.default,_.default,a.default,i.default,s.default,c.default,m.default];return d?u.push(t.default,n.default):u.push(e.default,r.default),u.push(o.default),u}return Or.default=l,Or}var Hr={},Kr={},Ti;function lp(){if(Ti)return Kr;Ti=1,Object.defineProperty(Kr,"__esModule",{value:!0});const e=re(),r={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:{message:({schemaCode:n})=>(0,e.str)`must match format "${n}"`,params:({schemaCode:n})=>(0,e._)`{format: ${n}}`},code(n,o){const{gen:s,data:a,$data:i,schema:c,schemaCode:m,it:h}=n,{opts:b,errSchemaPath:y,schemaEnv:$,self:w}=h;if(!b.validateFormats)return;i?_():l();function _(){const d=s.scopeValue("formats",{ref:w.formats,code:b.code.formats}),u=s.const("fDef",(0,e._)`${d}[${m}]`),f=s.let("fType"),v=s.let("format");s.if((0,e._)`typeof ${u} == "object" && !(${u} instanceof RegExp)`,()=>s.assign(f,(0,e._)`${u}.type || "string"`).assign(v,(0,e._)`${u}.validate`),()=>s.assign(f,(0,e._)`"string"`).assign(v,u)),n.fail$data((0,e.or)(p(),g()));function p(){return b.strictSchema===!1?e.nil:(0,e._)`${m} && !${v}`}function g(){const S=$.$async?(0,e._)`(${u}.async ? await ${v}(${a}) : ${v}(${a}))`:(0,e._)`${v}(${a})`,T=(0,e._)`(typeof ${v} == "function" ? ${S} : ${v}.test(${a}))`;return(0,e._)`${v} && ${v} !== true && ${f} === ${o} && !${T}`}}function l(){const d=w.formats[c];if(!d){p();return}if(d===!0)return;const[u,f,v]=g(d);u===o&&n.pass(S());function p(){if(b.strictSchema===!1){w.logger.warn(T());return}throw new Error(T());function T(){return`unknown format "${c}" ignored in schema at path "${y}"`}}function g(T){const R=T instanceof RegExp?(0,e.regexpCode)(T):b.code.formats?(0,e._)`${b.code.formats}${(0,e.getProperty)(c)}`:void 0,q=s.scopeValue("formats",{key:c,ref:T,code:R});return typeof T=="object"&&!(T instanceof RegExp)?[T.type||"string",T.validate,(0,e._)`${q}.validate`]:["string",T,q]}function S(){if(typeof d=="object"&&!(d instanceof RegExp)&&d.async){if(!$.$async)throw new Error("async format in sync schema");return(0,e._)`await ${v}(${a})`}return typeof f=="function"?(0,e._)`${v}(${a})`:(0,e._)`${v}.test(${a})`}}}};return Kr.default=r,Kr}var Ai;function dp(){if(Ai)return Hr;Ai=1,Object.defineProperty(Hr,"__esModule",{value:!0});const t=[lp().default];return Hr.default=t,Hr}var ut={},Ri;function fp(){return Ri||(Ri=1,Object.defineProperty(ut,"__esModule",{value:!0}),ut.contentVocabulary=ut.metadataVocabulary=void 0,ut.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],ut.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]),ut}var Ii;function hp(){if(Ii)return pr;Ii=1,Object.defineProperty(pr,"__esModule",{value:!0});const e=Mm(),t=Gm(),r=up(),n=dp(),o=fp(),s=[e.default,t.default,(0,r.default)(),n.default,o.metadataVocabulary,o.contentVocabulary];return pr.default=s,pr}var Wr={},Mt={},Oi;function mp(){if(Oi)return Mt;Oi=1,Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.DiscrError=void 0;var e;return(function(t){t.Tag="tag",t.Mapping="mapping"})(e||(Mt.DiscrError=e={})),Mt}var Ci;function pp(){if(Ci)return Wr;Ci=1,Object.defineProperty(Wr,"__esModule",{value:!0});const e=re(),t=mp(),r=Wn(),n=hr(),o=ae(),a={keyword:"discriminator",type:"object",schemaType:"object",error:{message:({params:{discrError:i,tagName:c}})=>i===t.DiscrError.Tag?`tag "${c}" must be string`:`value of tag "${c}" must be in oneOf`,params:({params:{discrError:i,tag:c,tagName:m}})=>(0,e._)`{error: ${i}, tag: ${m}, tagValue: ${c}}`},code(i){const{gen:c,data:m,schema:h,parentSchema:b,it:y}=i,{oneOf:$}=b;if(!y.opts.discriminator)throw new Error("discriminator: requires discriminator option");const w=h.propertyName;if(typeof w!="string")throw new Error("discriminator: requires propertyName");if(h.mapping)throw new Error("discriminator: mapping is not supported");if(!$)throw new Error("discriminator: requires oneOf keyword");const _=c.let("valid",!1),l=c.const("tag",(0,e._)`${m}${(0,e.getProperty)(w)}`);c.if((0,e._)`typeof ${l} == "string"`,()=>d(),()=>i.error(!1,{discrError:t.DiscrError.Tag,tag:l,tagName:w})),i.ok(_);function d(){const v=f();c.if(!1);for(const p in v)c.elseIf((0,e._)`${l} === ${p}`),c.assign(_,u(v[p]));c.else(),i.error(!1,{discrError:t.DiscrError.Mapping,tag:l,tagName:w}),c.endIf()}function u(v){const p=c.name("valid"),g=i.subschema({keyword:"oneOf",schemaProp:v},p);return i.mergeEvaluated(g,e.Name),p}function f(){var v;const p={},g=T(b);let S=!0;for(let N=0;N<$.length;N++){let x=$[N];if(x?.$ref&&!(0,o.schemaHasRulesButRef)(x,y.self.RULES)){const F=x.$ref;if(x=r.resolveRef.call(y.self,y.schemaEnv.root,y.baseId,F),x instanceof r.SchemaEnv&&(x=x.schema),x===void 0)throw new n.default(y.opts.uriResolver,y.baseId,F)}const M=(v=x?.properties)===null||v===void 0?void 0:v[w];if(typeof M!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${w}"`);S=S&&(g||T(x)),R(M,N)}if(!S)throw new Error(`discriminator: "${w}" must be required`);return p;function T({required:N}){return Array.isArray(N)&&N.includes(w)}function R(N,x){if(N.const)q(N.const,x);else if(N.enum)for(const M of N.enum)q(M,x);else throw new Error(`discriminator: "properties/${w}" must have "const" or "enum"`)}function q(N,x){if(typeof N!="string"||N in p)throw new Error(`discriminator: "${w}" values must be unique strings`);p[N]=x}}}};return Wr.default=a,Wr}const gp={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0};var Ni;function zi(){return Ni||(Ni=1,(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRefError=t.ValidationError=t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=t.Ajv=void 0;const r=zm(),n=hp(),o=pp(),s=gp,a=["/properties"],i="http://json-schema.org/draft-07/schema";class c extends r.default{_addVocabularies(){super._addVocabularies(),n.default.forEach(w=>this.addVocabulary(w)),this.opts.discriminator&&this.addKeyword(o.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const w=this.opts.$data?this.$dataMetaSchema(s,a):s;this.addMetaSchema(w,i,!1),this.refs["http://json-schema.org/schema"]=i}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(i)?i:void 0)}}t.Ajv=c,e.exports=t=c,e.exports.Ajv=c,Object.defineProperty(t,"__esModule",{value:!0}),t.default=c;var m=lr();Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return m.KeywordCxt}});var h=re();Object.defineProperty(t,"_",{enumerable:!0,get:function(){return h._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return h.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return h.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return h.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return h.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return h.CodeGen}});var b=Kn();Object.defineProperty(t,"ValidationError",{enumerable:!0,get:function(){return b.default}});var y=hr();Object.defineProperty(t,"MissingRefError",{enumerable:!0,get:function(){return y.default}})})(or,or.exports)),or.exports}var _p=zi(),Br={exports:{}},Qn={},ji;function vp(){return ji||(ji=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.formatNames=e.fastFormats=e.fullFormats=void 0;function t(N,x){return{validate:N,compare:x}}e.fullFormats={date:t(s,a),time:t(c(!0),m),"date-time":t(y(!0),$),"iso-time":t(c(),h),"iso-date-time":t(y(),w),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:d,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:q,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:f,int32:{type:"number",validate:g},int64:{type:"number",validate:S},float:{type:"number",validate:T},double:{type:"number",validate:T},password:!0,binary:!0},e.fastFormats={...e.fullFormats,date:t(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,a),time:t(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,m),"date-time":t(/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,$),"iso-time":t(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,h),"iso-date-time":t(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,w),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i},e.formatNames=Object.keys(e.fullFormats);function r(N){return N%4===0&&(N%100!==0||N%400===0)}const n=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,o=[0,31,28,31,30,31,30,31,31,30,31,30,31];function s(N){const x=n.exec(N);if(!x)return!1;const M=+x[1],F=+x[2],Y=+x[3];return F>=1&&F<=12&&Y>=1&&Y<=(F===2&&r(M)?29:o[F])}function a(N,x){if(N&&x)return N>x?1:N<x?-1:0}const i=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function c(N){return function(M){const F=i.exec(M);if(!F)return!1;const Y=+F[1],_e=+F[2],le=+F[3],ee=F[4],be=F[5]==="-"?-1:1,Z=+(F[6]||0),I=+(F[7]||0);if(Z>23||I>59||N&&!ee)return!1;if(Y<=23&&_e<=59&&le<60)return!0;const D=_e-I*be,C=Y-Z*be-(D<0?1:0);return(C===23||C===-1)&&(D===59||D===-1)&&le<61}}function m(N,x){if(!(N&&x))return;const M=new Date("2020-01-01T"+N).valueOf(),F=new Date("2020-01-01T"+x).valueOf();if(M&&F)return M-F}function h(N,x){if(!(N&&x))return;const M=i.exec(N),F=i.exec(x);if(M&&F)return N=M[1]+M[2]+M[3],x=F[1]+F[2]+F[3],N>x?1:N<x?-1:0}const b=/t|\s/i;function y(N){const x=c(N);return function(F){const Y=F.split(b);return Y.length===2&&s(Y[0])&&x(Y[1])}}function $(N,x){if(!(N&&x))return;const M=new Date(N).valueOf(),F=new Date(x).valueOf();if(M&&F)return M-F}function w(N,x){if(!(N&&x))return;const[M,F]=N.split(b),[Y,_e]=x.split(b),le=a(M,Y);if(le!==void 0)return le||m(F,_e)}const _=/\/|:/,l=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function d(N){return _.test(N)&&l.test(N)}const u=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function f(N){return u.lastIndex=0,u.test(N)}const v=-2147483648,p=2**31-1;function g(N){return Number.isInteger(N)&&N<=p&&N>=v}function S(N){return Number.isInteger(N)}function T(){return!0}const R=/[^\\]\\Z/;function q(N){if(R.test(N))return!1;try{return new RegExp(N),!0}catch{return!1}}})(Qn)),Qn}var Xn={},qi;function yp(){return qi||(qi=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.formatLimitDefinition=void 0;const t=zi(),r=re(),n=r.operators,o={formatMaximum:{okStr:"<=",ok:n.LTE,fail:n.GT},formatMinimum:{okStr:">=",ok:n.GTE,fail:n.LT},formatExclusiveMaximum:{okStr:"<",ok:n.LT,fail:n.GTE},formatExclusiveMinimum:{okStr:">",ok:n.GT,fail:n.LTE}},s={message:({keyword:i,schemaCode:c})=>(0,r.str)`should be ${o[i].okStr} ${c}`,params:({keyword:i,schemaCode:c})=>(0,r._)`{comparison: ${o[i].okStr}, limit: ${c}}`};e.formatLimitDefinition={keyword:Object.keys(o),type:"string",schemaType:"string",$data:!0,error:s,code(i){const{gen:c,data:m,schemaCode:h,keyword:b,it:y}=i,{opts:$,self:w}=y;if(!$.validateFormats)return;const _=new t.KeywordCxt(y,w.RULES.all.format.definition,"format");_.$data?l():d();function l(){const f=c.scopeValue("formats",{ref:w.formats,code:$.code.formats}),v=c.const("fmt",(0,r._)`${f}[${_.schemaCode}]`);i.fail$data((0,r.or)((0,r._)`typeof ${v} != "object"`,(0,r._)`${v} instanceof RegExp`,(0,r._)`typeof ${v}.compare != "function"`,u(v)))}function d(){const f=_.schema,v=w.formats[f];if(!v||v===!0)return;if(typeof v!="object"||v instanceof RegExp||typeof v.compare!="function")throw new Error(`"${b}": format "${f}" does not define "compare" function`);const p=c.scopeValue("formats",{key:f,ref:v,code:$.code.formats?(0,r._)`${$.code.formats}${(0,r.getProperty)(f)}`:void 0});i.fail$data(u(p))}function u(f){return(0,r._)`${f}.compare(${m}, ${h}) ${o[b].fail} 0`}},dependencies:["format"]};const a=i=>(i.addKeyword(e.formatLimitDefinition),i);e.default=a})(Xn)),Xn}var Mi;function wp(){return Mi||(Mi=1,(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=vp(),n=yp(),o=re(),s=new o.Name("fullFormats"),a=new o.Name("fastFormats"),i=(m,h={keywords:!0})=>{if(Array.isArray(h))return c(m,h,r.fullFormats,s),m;const[b,y]=h.mode==="fast"?[r.fastFormats,a]:[r.fullFormats,s],$=h.formats||r.formatNames;return c(m,$,b,y),h.keywords&&(0,n.default)(m),m};i.get=(m,h="full")=>{const y=(h==="fast"?r.fastFormats:r.fullFormats)[m];if(!y)throw new Error(`Unknown format "${m}"`);return y};function c(m,h,b,y){var $,w;($=(w=m.opts.code).formats)!==null&&$!==void 0||(w.formats=(0,o._)`require("ajv-formats/dist/formats").${y}`);for(const _ of h)m.addFormat(_,b[_])}e.exports=t=i,Object.defineProperty(t,"__esModule",{value:!0}),t.default=i})(Br,Br.exports)),Br.exports}var bp=wp();const $p=ha(bp);function kp(){const e=new _p.Ajv({strict:!1,validateFormats:!0,validateSchema:!1,allErrors:!0});return $p(e),e}class Sp{constructor(t){this._ajv=t??kp()}getValidator(t){var r;const n="$id"in t&&typeof t.$id=="string"?(r=this._ajv.getSchema(t.$id))!==null&&r!==void 0?r:this._ajv.compile(t):this._ajv.compile(t);return o=>n(o)?{valid:!0,data:o,errorMessage:void 0}:{valid:!1,data:void 0,errorMessage:this._ajv.errorsText(n.errors)}}}class Ep{constructor(t){this._client=t}async*callToolStream(t,r=rr,n){var o;const s=this._client,a={...n,task:(o=n?.task)!==null&&o!==void 0?o:s.isToolTask(t.name)?{}:void 0},i=s.requestStream({method:"tools/call",params:t},r,a),c=s.getToolOutputValidator(t.name);for await(const m of i){if(m.type==="result"&&c){const h=m.result;if(!h.structuredContent&&!h.isError){yield{type:"error",error:new X(te.InvalidRequest,`Tool ${t.name} has an output schema but did not return structured content`)};return}if(h.structuredContent)try{const b=c(h.structuredContent);if(!b.valid){yield{type:"error",error:new X(te.InvalidParams,`Structured content does not match the tool's output schema: ${b.errorMessage}`)};return}}catch(b){if(b instanceof X){yield{type:"error",error:b};return}yield{type:"error",error:new X(te.InvalidParams,`Failed to validate structured content: ${b instanceof Error?b.message:String(b)}`)};return}}yield m}}async getTask(t,r){return this._client.getTask({taskId:t},r)}async getTaskResult(t,r,n){return this._client.getTaskResult({taskId:t},r,n)}async listTasks(t,r){return this._client.listTasks(t?{cursor:t}:void 0,r)}async cancelTask(t,r){return this._client.cancelTask({taskId:t},r)}requestStream(t,r,n){return this._client.requestStream(t,r,n)}}function Pp(e,t,r){var n;if(!e)throw new Error(`${r} does not support task creation (required for ${t})`);switch(t){case"tools/call":if(!(!((n=e.tools)===null||n===void 0)&&n.call))throw new Error(`${r} does not support task creation for tools/call (required for ${t})`);break}}function Tp(e,t,r){var n,o;if(!e)throw new Error(`${r} does not support task creation (required for ${t})`);switch(t){case"sampling/createMessage":if(!(!((n=e.sampling)===null||n===void 0)&&n.createMessage))throw new Error(`${r} does not support task creation for sampling/createMessage (required for ${t})`);break;case"elicitation/create":if(!(!((o=e.elicitation)===null||o===void 0)&&o.create))throw new Error(`${r} does not support task creation for elicitation/create (required for ${t})`);break}}function Gr(e,t){if(!(!e||t===null||typeof t!="object")){if(e.type==="object"&&e.properties&&typeof e.properties=="object"){const r=t,n=e.properties;for(const o of Object.keys(n)){const s=n[o];r[o]===void 0&&Object.prototype.hasOwnProperty.call(s,"default")&&(r[o]=s.default),r[o]!==void 0&&Gr(s,r[o])}}if(Array.isArray(e.anyOf))for(const r of e.anyOf)Gr(r,t);if(Array.isArray(e.oneOf))for(const r of e.oneOf)Gr(r,t)}}function Ap(e){if(!e)return{supportsFormMode:!1,supportsUrlMode:!1};const t=e.form!==void 0,r=e.url!==void 0;return{supportsFormMode:t||!t&&!r,supportsUrlMode:r}}class Rp extends km{constructor(t,r){var n,o;super(r),this._clientInfo=t,this._cachedToolOutputValidators=new Map,this._cachedKnownTaskTools=new Set,this._cachedRequiredTaskTools=new Set,this._capabilities=(n=r?.capabilities)!==null&&n!==void 0?n:{},this._jsonSchemaValidator=(o=r?.jsonSchemaValidator)!==null&&o!==void 0?o:new Sp}get experimental(){return this._experimental||(this._experimental={tasks:new Ep(this)}),this._experimental}registerCapabilities(t){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=Sm(this._capabilities,t)}setRequestHandler(t,r){var n,o,s;const a=Ms(t),i=a?.method;if(!i)throw new Error("Schema is missing a method literal");let c;if(Yt(i)){const h=i,b=(n=h._zod)===null||n===void 0?void 0:n.def;c=(o=b?.value)!==null&&o!==void 0?o:h.value}else{const h=i,b=h._def;c=(s=b?.value)!==null&&s!==void 0?s:h.value}if(typeof c!="string")throw new Error("Schema method literal must be a string");const m=c;if(m==="elicitation/create"){const h=async(b,y)=>{var $,w,_;const l=Qe(ia,b);if(!l.success){const R=l.error instanceof Error?l.error.message:String(l.error);throw new X(te.InvalidParams,`Invalid elicitation request: ${R}`)}const{params:d}=l.data,u=($=d.mode)!==null&&$!==void 0?$:"form",{supportsFormMode:f,supportsUrlMode:v}=Ap(this._capabilities.elicitation);if(u==="form"&&!f)throw new X(te.InvalidParams,"Client does not support form-mode elicitation requests");if(u==="url"&&!v)throw new X(te.InvalidParams,"Client does not support URL-mode elicitation requests");const p=await Promise.resolve(r(b,y));if(d.task){const R=Qe(zt,p);if(!R.success){const q=R.error instanceof Error?R.error.message:String(R.error);throw new X(te.InvalidParams,`Invalid task creation result: ${q}`)}return R.data}const g=Qe(ca,p);if(!g.success){const R=g.error instanceof Error?g.error.message:String(g.error);throw new X(te.InvalidParams,`Invalid elicitation result: ${R}`)}const S=g.data,T=u==="form"?d.requestedSchema:void 0;if(u==="form"&&S.action==="accept"&&S.content&&T&&!((_=(w=this._capabilities.elicitation)===null||w===void 0?void 0:w.form)===null||_===void 0)&&_.applyDefaults)try{Gr(T,S.content)}catch{}return S};return super.setRequestHandler(t,h)}if(m==="sampling/createMessage"){const h=async(b,y)=>{const $=Qe(sa,b);if(!$.success){const d=$.error instanceof Error?$.error.message:String($.error);throw new X(te.InvalidParams,`Invalid sampling request: ${d}`)}const{params:w}=$.data,_=await Promise.resolve(r(b,y));if(w.task){const d=Qe(zt,_);if(!d.success){const u=d.error instanceof Error?d.error.message:String(d.error);throw new X(te.InvalidParams,`Invalid task creation result: ${u}`)}return d.data}const l=Qe(aa,_);if(!l.success){const d=l.error instanceof Error?l.error.message:String(l.error);throw new X(te.InvalidParams,`Invalid sampling result: ${d}`)}return l.data};return super.setRequestHandler(t,h)}return super.setRequestHandler(t,r)}assertCapability(t,r){var n;if(!(!((n=this._serverCapabilities)===null||n===void 0)&&n[t]))throw new Error(`Server does not support ${t} (required for ${r})`)}async connect(t,r){if(await super.connect(t),t.sessionId===void 0)try{const n=await this.request({method:"initialize",params:{protocolVersion:Qt,capabilities:this._capabilities,clientInfo:this._clientInfo}},Hs,r);if(n===void 0)throw new Error(`Server sent invalid initialize result: ${n}`);if(!Zf.includes(n.protocolVersion))throw new Error(`Server's protocol version is not supported: ${n.protocolVersion}`);this._serverCapabilities=n.capabilities,this._serverVersion=n.serverInfo,t.setProtocolVersion&&t.setProtocolVersion(n.protocolVersion),this._instructions=n.instructions,await this.notification({method:"notifications/initialized"})}catch(n){throw this.close(),n}}getServerCapabilities(){return this._serverCapabilities}getServerVersion(){return this._serverVersion}getInstructions(){return this._instructions}assertCapabilityForMethod(t){var r,n,o,s,a;switch(t){case"logging/setLevel":if(!(!((r=this._serverCapabilities)===null||r===void 0)&&r.logging))throw new Error(`Server does not support logging (required for ${t})`);break;case"prompts/get":case"prompts/list":if(!(!((n=this._serverCapabilities)===null||n===void 0)&&n.prompts))throw new Error(`Server does not support prompts (required for ${t})`);break;case"resources/list":case"resources/templates/list":case"resources/read":case"resources/subscribe":case"resources/unsubscribe":if(!(!((o=this._serverCapabilities)===null||o===void 0)&&o.resources))throw new Error(`Server does not support resources (required for ${t})`);if(t==="resources/subscribe"&&!this._serverCapabilities.resources.subscribe)throw new Error(`Server does not support resource subscriptions (required for ${t})`);break;case"tools/call":case"tools/list":if(!(!((s=this._serverCapabilities)===null||s===void 0)&&s.tools))throw new Error(`Server does not support tools (required for ${t})`);break;case"completion/complete":if(!(!((a=this._serverCapabilities)===null||a===void 0)&&a.completions))throw new Error(`Server does not support completions (required for ${t})`);break}}assertNotificationCapability(t){var r;switch(t){case"notifications/roots/list_changed":if(!(!((r=this._capabilities.roots)===null||r===void 0)&&r.listChanged))throw new Error(`Client does not support roots list changed notifications (required for ${t})`);break}}assertRequestHandlerCapability(t){if(this._capabilities)switch(t){case"sampling/createMessage":if(!this._capabilities.sampling)throw new Error(`Client does not support sampling capability (required for ${t})`);break;case"elicitation/create":if(!this._capabilities.elicitation)throw new Error(`Client does not support elicitation capability (required for ${t})`);break;case"roots/list":if(!this._capabilities.roots)throw new Error(`Client does not support roots capability (required for ${t})`);break;case"tasks/get":case"tasks/list":case"tasks/result":case"tasks/cancel":if(!this._capabilities.tasks)throw new Error(`Client does not support tasks capability (required for ${t})`);break}}assertTaskCapability(t){var r,n;Pp((n=(r=this._serverCapabilities)===null||r===void 0?void 0:r.tasks)===null||n===void 0?void 0:n.requests,t,"Server")}assertTaskHandlerCapability(t){var r;this._capabilities&&Tp((r=this._capabilities.tasks)===null||r===void 0?void 0:r.requests,t,"Client")}async ping(t){return this.request({method:"ping"},gt,t)}async complete(t,r){return this.request({method:"completion/complete",params:t},ua,r)}async setLoggingLevel(t,r){return this.request({method:"logging/setLevel",params:{level:t}},gt,r)}async getPrompt(t,r){return this.request({method:"prompts/get",params:t},ta,r)}async listPrompts(t,r){return this.request({method:"prompts/list",params:t},ea,r)}async listResources(t,r){return this.request({method:"resources/list",params:t},Ys,r)}async listResourceTemplates(t,r){return this.request({method:"resources/templates/list",params:t},Qs,r)}async readResource(t,r){return this.request({method:"resources/read",params:t},Xs,r)}async subscribeResource(t,r){return this.request({method:"resources/subscribe",params:t},gt,r)}async unsubscribeResource(t,r){return this.request({method:"resources/unsubscribe",params:t},gt,r)}async callTool(t,r=rr,n){if(this.isToolTaskRequired(t.name))throw new X(te.InvalidRequest,`Tool "${t.name}" requires task-based execution. Use client.experimental.tasks.callToolStream() instead.`);const o=await this.request({method:"tools/call",params:t},r,n),s=this.getToolOutputValidator(t.name);if(s){if(!o.structuredContent&&!o.isError)throw new X(te.InvalidRequest,`Tool ${t.name} has an output schema but did not return structured content`);if(o.structuredContent)try{const a=s(o.structuredContent);if(!a.valid)throw new X(te.InvalidParams,`Structured content does not match the tool's output schema: ${a.errorMessage}`)}catch(a){throw a instanceof X?a:new X(te.InvalidParams,`Failed to validate structured content: ${a instanceof Error?a.message:String(a)}`)}}return o}isToolTask(t){var r,n,o,s;return!((s=(o=(n=(r=this._serverCapabilities)===null||r===void 0?void 0:r.tasks)===null||n===void 0?void 0:n.requests)===null||o===void 0?void 0:o.tools)===null||s===void 0)&&s.call?this._cachedKnownTaskTools.has(t):!1}isToolTaskRequired(t){return this._cachedRequiredTaskTools.has(t)}cacheToolMetadata(t){var r;this._cachedToolOutputValidators.clear(),this._cachedKnownTaskTools.clear(),this._cachedRequiredTaskTools.clear();for(const n of t){if(n.outputSchema){const s=this._jsonSchemaValidator.getValidator(n.outputSchema);this._cachedToolOutputValidators.set(n.name,s)}const o=(r=n.execution)===null||r===void 0?void 0:r.taskSupport;(o==="required"||o==="optional")&&this._cachedKnownTaskTools.add(n.name),o==="required"&&this._cachedRequiredTaskTools.add(n.name)}}getToolOutputValidator(t){return this._cachedToolOutputValidators.get(t)}async listTools(t,r){const n=await this.request({method:"tools/list",params:t},na,r);return this.cacheToolMetadata(n.tools),n}async sendRootsListChanged(){return this.notification({method:"notifications/roots/list_changed"})}}function eo(e){return e?e instanceof Headers?Object.fromEntries(e.entries()):Array.isArray(e)?Object.fromEntries(e):{...e}:{}}function Ip(e=fetch,t){return t?async(r,n)=>{const o={...t,...n,headers:n?.headers?{...eo(t.headers),...eo(n.headers)}:t.headers};return e(r,o)}:e}let to;to=globalThis.crypto;async function Op(e){return(await to).getRandomValues(new Uint8Array(e))}async function Cp(e){const t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-._~",r=Math.pow(2,8)-Math.pow(2,8)%t.length;let n="";for(;n.length<e;){const o=await Op(e-n.length);for(const s of o)s<r&&(n+=t[s%t.length])}return n}async function Np(e){return await Cp(e)}async function zp(e){const t=await(await to).subtle.digest("SHA-256",new TextEncoder().encode(e));return btoa(String.fromCharCode(...new Uint8Array(t))).replace(/\//g,"_").replace(/\+/g,"-").replace(/=/g,"")}async function jp(e){if(e||(e=43),e<43||e>128)throw`Expected a length between 43 and 128. Received ${e}.`;const t=await Np(e),r=await zp(t);return{code_verifier:t,code_challenge:r}}const Ee=Od().superRefine((e,t)=>{if(!URL.canParse(e))return t.addIssue({code:$f.custom,message:"URL must be parseable",fatal:!0}),oc}).refine(e=>{const t=new URL(e);return t.protocol!=="javascript:"&&t.protocol!=="data:"&&t.protocol!=="vbscript:"},{message:"URL cannot use javascript:, data:, or vbscript: scheme"}),qp=Ce({resource:P().url(),authorization_servers:H(Ee).optional(),jwks_uri:P().url().optional(),scopes_supported:H(P()).optional(),bearer_methods_supported:H(P()).optional(),resource_signing_alg_values_supported:H(P()).optional(),resource_name:P().optional(),resource_documentation:P().optional(),resource_policy_uri:P().url().optional(),resource_tos_uri:P().url().optional(),tls_client_certificate_bound_access_tokens:he().optional(),authorization_details_types_supported:H(P()).optional(),dpop_signing_alg_values_supported:H(P()).optional(),dpop_bound_access_tokens_required:he().optional()}),xi=Ce({issuer:P(),authorization_endpoint:Ee,token_endpoint:Ee,registration_endpoint:Ee.optional(),scopes_supported:H(P()).optional(),response_types_supported:H(P()),response_modes_supported:H(P()).optional(),grant_types_supported:H(P()).optional(),token_endpoint_auth_methods_supported:H(P()).optional(),token_endpoint_auth_signing_alg_values_supported:H(P()).optional(),service_documentation:Ee.optional(),revocation_endpoint:Ee.optional(),revocation_endpoint_auth_methods_supported:H(P()).optional(),revocation_endpoint_auth_signing_alg_values_supported:H(P()).optional(),introspection_endpoint:P().optional(),introspection_endpoint_auth_methods_supported:H(P()).optional(),introspection_endpoint_auth_signing_alg_values_supported:H(P()).optional(),code_challenge_methods_supported:H(P()).optional(),client_id_metadata_document_supported:he().optional()}),Mp=Ce({issuer:P(),authorization_endpoint:Ee,token_endpoint:Ee,userinfo_endpoint:Ee.optional(),jwks_uri:Ee,registration_endpoint:Ee.optional(),scopes_supported:H(P()).optional(),response_types_supported:H(P()),response_modes_supported:H(P()).optional(),grant_types_supported:H(P()).optional(),acr_values_supported:H(P()).optional(),subject_types_supported:H(P()),id_token_signing_alg_values_supported:H(P()),id_token_encryption_alg_values_supported:H(P()).optional(),id_token_encryption_enc_values_supported:H(P()).optional(),userinfo_signing_alg_values_supported:H(P()).optional(),userinfo_encryption_alg_values_supported:H(P()).optional(),userinfo_encryption_enc_values_supported:H(P()).optional(),request_object_signing_alg_values_supported:H(P()).optional(),request_object_encryption_alg_values_supported:H(P()).optional(),request_object_encryption_enc_values_supported:H(P()).optional(),token_endpoint_auth_methods_supported:H(P()).optional(),token_endpoint_auth_signing_alg_values_supported:H(P()).optional(),display_values_supported:H(P()).optional(),claim_types_supported:H(P()).optional(),claims_supported:H(P()).optional(),service_documentation:P().optional(),claims_locales_supported:H(P()).optional(),ui_locales_supported:H(P()).optional(),claims_parameter_supported:he().optional(),request_parameter_supported:he().optional(),request_uri_parameter_supported:he().optional(),require_request_uri_registration:he().optional(),op_policy_uri:Ee.optional(),op_tos_uri:Ee.optional(),client_id_metadata_document_supported:he().optional()}),xp=V({...Mp.shape,...xi.pick({code_challenge_methods_supported:!0}).shape}),Up=V({access_token:P(),id_token:P().optional(),token_type:P(),expires_in:Is().optional(),scope:P().optional(),refresh_token:P().optional()}).strip(),Dp=V({error:P(),error_description:P().optional(),error_uri:P().optional()}),Ui=Ee.optional().or(B("").transform(()=>{})),Vp=V({redirect_uris:H(Ee),token_endpoint_auth_method:P().optional(),grant_types:H(P()).optional(),response_types:H(P()).optional(),client_name:P().optional(),client_uri:Ee.optional(),logo_uri:Ui,scope:P().optional(),contacts:H(P()).optional(),tos_uri:Ui,policy_uri:P().optional(),jwks_uri:Ee.optional(),jwks:Yd().optional(),software_id:P().optional(),software_version:P().optional(),software_statement:P().optional()}).strip(),Zp=V({client_id:P(),client_secret:P().optional(),client_id_issued_at:ue().optional(),client_secret_expires_at:ue().optional()}).strip(),Lp=Vp.merge(Zp);V({error:P(),error_description:P().optional()}).strip(),V({token:P(),token_type_hint:P().optional()}).strip();function Fp(e){const t=typeof e=="string"?new URL(e):new URL(e.href);return t.hash="",t}function Hp({requestedResource:e,configuredResource:t}){const r=typeof e=="string"?new URL(e):new URL(e.href),n=typeof t=="string"?new URL(t):new URL(t.href);if(r.origin!==n.origin||r.pathname.length<n.pathname.length)return!1;const o=r.pathname.endsWith("/")?r.pathname:r.pathname+"/",s=n.pathname.endsWith("/")?n.pathname:n.pathname+"/";return o.startsWith(s)}class $e extends Error{constructor(t,r){super(t),this.errorUri=r,this.name=this.constructor.name}toResponseObject(){const t={error:this.errorCode,error_description:this.message};return this.errorUri&&(t.error_uri=this.errorUri),t}get errorCode(){return this.constructor.errorCode}}class ro extends $e{}ro.errorCode="invalid_request";class Jr extends $e{}Jr.errorCode="invalid_client";class Yr extends $e{}Yr.errorCode="invalid_grant";class Qr extends $e{}Qr.errorCode="unauthorized_client";class no extends $e{}no.errorCode="unsupported_grant_type";class oo extends $e{}oo.errorCode="invalid_scope";class so extends $e{}so.errorCode="access_denied";class bt extends $e{}bt.errorCode="server_error";class ao extends $e{}ao.errorCode="temporarily_unavailable";class io extends $e{}io.errorCode="unsupported_response_type";class co extends $e{}co.errorCode="unsupported_token_type";class uo extends $e{}uo.errorCode="invalid_token";class lo extends $e{}lo.errorCode="method_not_allowed";class fo extends $e{}fo.errorCode="too_many_requests";class Xr extends $e{}Xr.errorCode="invalid_client_metadata";class ho extends $e{}ho.errorCode="insufficient_scope";class mo extends $e{}mo.errorCode="invalid_target";const Kp={[ro.errorCode]:ro,[Jr.errorCode]:Jr,[Yr.errorCode]:Yr,[Qr.errorCode]:Qr,[no.errorCode]:no,[oo.errorCode]:oo,[so.errorCode]:so,[bt.errorCode]:bt,[ao.errorCode]:ao,[io.errorCode]:io,[co.errorCode]:co,[uo.errorCode]:uo,[lo.errorCode]:lo,[fo.errorCode]:fo,[Xr.errorCode]:Xr,[ho.errorCode]:ho,[mo.errorCode]:mo};class $t extends Error{constructor(t){super(t??"Unauthorized")}}function Wp(e){return["client_secret_basic","client_secret_post","none"].includes(e)}const po="code",go="S256";function Bp(e,t){const r=e.client_secret!==void 0;return t.length===0?r?"client_secret_post":"none":"token_endpoint_auth_method"in e&&e.token_endpoint_auth_method&&Wp(e.token_endpoint_auth_method)&&t.includes(e.token_endpoint_auth_method)?e.token_endpoint_auth_method:r&&t.includes("client_secret_basic")?"client_secret_basic":r&&t.includes("client_secret_post")?"client_secret_post":t.includes("none")?"none":r?"client_secret_post":"none"}function Gp(e,t,r,n){const{client_id:o,client_secret:s}=t;switch(e){case"client_secret_basic":Jp(o,s,r);return;case"client_secret_post":Yp(o,s,n);return;case"none":Qp(o,n);return;default:throw new Error(`Unsupported client authentication method: ${e}`)}}function Jp(e,t,r){if(!t)throw new Error("client_secret_basic authentication requires a client_secret");const n=btoa(`${e}:${t}`);r.set("Authorization",`Basic ${n}`)}function Yp(e,t,r){r.set("client_id",e),t&&r.set("client_secret",t)}function Qp(e,t){t.set("client_id",e)}async function Di(e){const t=e instanceof Response?e.status:void 0,r=e instanceof Response?await e.text():e;try{const n=Dp.parse(JSON.parse(r)),{error:o,error_description:s,error_uri:a}=n,i=Kp[o]||bt;return new i(s||"",a)}catch(n){const o=`${t?`HTTP ${t}: `:""}Invalid OAuth error response: ${n}. Raw body: ${r}`;return new bt(o)}}async function en(e,t){var r,n;try{return await _o(e,t)}catch(o){if(o instanceof Jr||o instanceof Qr)return await((r=e.invalidateCredentials)===null||r===void 0?void 0:r.call(e,"all")),await _o(e,t);if(o instanceof Yr)return await((n=e.invalidateCredentials)===null||n===void 0?void 0:n.call(e,"tokens")),await _o(e,t);throw o}}async function _o(e,{serverUrl:t,authorizationCode:r,scope:n,resourceMetadataUrl:o,fetchFn:s}){var a,i;let c,m;try{c=await tg(t,{resourceMetadataUrl:o},s),c.authorization_servers&&c.authorization_servers.length>0&&(m=c.authorization_servers[0])}catch{}m||(m=new URL("/",t));const h=await eg(t,e,c),b=await ag(m,{fetchFn:s});let y=await Promise.resolve(e.clientInformation());if(!y){if(r!==void 0)throw new Error("Existing OAuth client information is required when exchanging an authorization code");const u=b?.client_id_metadata_document_supported===!0,f=e.clientMetadataUrl;if(f&&!Xp(f))throw new Xr(`clientMetadataUrl must be a valid HTTPS URL with a non-root pathname, got: ${f}`);if(u&&f)y={client_id:f},await((a=e.saveClientInformation)===null||a===void 0?void 0:a.call(e,y));else{if(!e.saveClientInformation)throw new Error("OAuth client information must be saveable for dynamic registration");const p=await dg(m,{metadata:b,clientMetadata:e.clientMetadata,fetchFn:s});await e.saveClientInformation(p),y=p}}const $=!e.redirectUrl;if(r!==void 0||$){const u=await lg(e,m,{metadata:b,resource:h,authorizationCode:r,fetchFn:s});return await e.saveTokens(u),"AUTHORIZED"}const w=await e.tokens();if(w?.refresh_token)try{const u=await ug(m,{metadata:b,clientInformation:y,refreshToken:w.refresh_token,resource:h,addClientAuthentication:e.addClientAuthentication,fetchFn:s});return await e.saveTokens(u),"AUTHORIZED"}catch(u){if(!(!(u instanceof $e)||u instanceof bt))throw u}const _=e.state?await e.state():void 0,{authorizationUrl:l,codeVerifier:d}=await ig(m,{metadata:b,clientInformation:y,state:_,redirectUrl:e.redirectUrl,scope:n||((i=c?.scopes_supported)===null||i===void 0?void 0:i.join(" "))||e.clientMetadata.scope,resource:h});return await e.saveCodeVerifier(d),await e.redirectToAuthorization(l),"REDIRECT"}function Xp(e){if(!e)return!1;try{const t=new URL(e);return t.protocol==="https:"&&t.pathname!=="/"}catch{return!1}}async function eg(e,t,r){const n=Fp(e);if(t.validateResourceURL)return await t.validateResourceURL(n,r?.resource);if(r){if(!Hp({requestedResource:n,configuredResource:r.resource}))throw new Error(`Protected resource ${r.resource} does not match expected ${n} (or origin)`);return new URL(r.resource)}}function Vi(e){const t=e.headers.get("WWW-Authenticate");if(!t)return{};const[r,n]=t.split(" ");if(r.toLowerCase()!=="bearer"||!n)return{};const o=vo(e,"resource_metadata")||void 0;let s;if(o)try{s=new URL(o)}catch{}const a=vo(e,"scope")||void 0,i=vo(e,"error")||void 0;return{resourceMetadataUrl:s,scope:a,error:i}}function vo(e,t){const r=e.headers.get("WWW-Authenticate");if(!r)return null;const n=new RegExp(`${t}=(?:"([^"]+)"|([^\\s,]+))`),o=r.match(n);return o?o[1]||o[2]:null}async function tg(e,t,r=fetch){var n,o;const s=await og(e,"oauth-protected-resource",r,{protocolVersion:t?.protocolVersion,metadataUrl:t?.resourceMetadataUrl});if(!s||s.status===404)throw await((n=s?.body)===null||n===void 0?void 0:n.cancel()),new Error("Resource server does not implement OAuth 2.0 Protected Resource Metadata.");if(!s.ok)throw await((o=s.body)===null||o===void 0?void 0:o.cancel()),new Error(`HTTP ${s.status} trying to load well-known OAuth protected resource metadata.`);return qp.parse(await s.json())}async function yo(e,t,r=fetch){try{return await r(e,{headers:t})}catch(n){if(n instanceof TypeError)return t?yo(e,void 0,r):void 0;throw n}}function rg(e,t="",r={}){return t.endsWith("/")&&(t=t.slice(0,-1)),r.prependPathname?`${t}/.well-known/${e}`:`/.well-known/${e}${t}`}async function Zi(e,t,r=fetch){return await yo(e,{"MCP-Protocol-Version":t},r)}function ng(e,t){return!e||e.status>=400&&e.status<500&&t!=="/"}async function og(e,t,r,n){var o,s;const a=new URL(e),i=(o=n?.protocolVersion)!==null&&o!==void 0?o:Qt;let c;if(n?.metadataUrl)c=new URL(n.metadataUrl);else{const h=rg(t,a.pathname);c=new URL(h,(s=n?.metadataServerUrl)!==null&&s!==void 0?s:a),c.search=a.search}let m=await Zi(c,i,r);if(!n?.metadataUrl&&ng(m,a.pathname)){const h=new URL(`/.well-known/${t}`,a);m=await Zi(h,i,r)}return m}function sg(e){const t=typeof e=="string"?new URL(e):e,r=t.pathname!=="/",n=[];if(!r)return n.push({url:new URL("/.well-known/oauth-authorization-server",t.origin),type:"oauth"}),n.push({url:new URL("/.well-known/openid-configuration",t.origin),type:"oidc"}),n;let o=t.pathname;return o.endsWith("/")&&(o=o.slice(0,-1)),n.push({url:new URL(`/.well-known/oauth-authorization-server${o}`,t.origin),type:"oauth"}),n.push({url:new URL(`/.well-known/openid-configuration${o}`,t.origin),type:"oidc"}),n.push({url:new URL(`${o}/.well-known/openid-configuration`,t.origin),type:"oidc"}),n}async function ag(e,{fetchFn:t=fetch,protocolVersion:r=Qt}={}){var n;const o={"MCP-Protocol-Version":r,Accept:"application/json"},s=sg(e);for(const{url:a,type:i}of s){const c=await yo(a,o,t);if(c){if(!c.ok){if(await((n=c.body)===null||n===void 0?void 0:n.cancel()),c.status>=400&&c.status<500)continue;throw new Error(`HTTP ${c.status} trying to load ${i==="oauth"?"OAuth":"OpenID provider"} metadata from ${a}`)}return i==="oauth"?xi.parse(await c.json()):xp.parse(await c.json())}}}async function ig(e,{metadata:t,clientInformation:r,redirectUrl:n,scope:o,state:s,resource:a}){let i;if(t){if(i=new URL(t.authorization_endpoint),!t.response_types_supported.includes(po))throw new Error(`Incompatible auth server: does not support response type ${po}`);if(t.code_challenge_methods_supported&&!t.code_challenge_methods_supported.includes(go))throw new Error(`Incompatible auth server: does not support code challenge method ${go}`)}else i=new URL("/authorize",e);const c=await jp(),m=c.code_verifier,h=c.code_challenge;return i.searchParams.set("response_type",po),i.searchParams.set("client_id",r.client_id),i.searchParams.set("code_challenge",h),i.searchParams.set("code_challenge_method",go),i.searchParams.set("redirect_uri",String(n)),s&&i.searchParams.set("state",s),o&&i.searchParams.set("scope",o),o?.includes("offline_access")&&i.searchParams.append("prompt","consent"),a&&i.searchParams.set("resource",a.href),{authorizationUrl:i,codeVerifier:m}}function cg(e,t,r){return new URLSearchParams({grant_type:"authorization_code",code:e,code_verifier:t,redirect_uri:String(r)})}async function Li(e,{metadata:t,tokenRequestParams:r,clientInformation:n,addClientAuthentication:o,resource:s,fetchFn:a}){var i;const c=t?.token_endpoint?new URL(t.token_endpoint):new URL("/token",e),m=new Headers({"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"});if(s&&r.set("resource",s.href),o)await o(m,r,c,t);else if(n){const b=(i=t?.token_endpoint_auth_methods_supported)!==null&&i!==void 0?i:[],y=Bp(n,b);Gp(y,n,m,r)}const h=await(a??fetch)(c,{method:"POST",headers:m,body:r});if(!h.ok)throw await Di(h);return Up.parse(await h.json())}async function ug(e,{metadata:t,clientInformation:r,refreshToken:n,resource:o,addClientAuthentication:s,fetchFn:a}){const i=new URLSearchParams({grant_type:"refresh_token",refresh_token:n}),c=await Li(e,{metadata:t,tokenRequestParams:i,clientInformation:r,addClientAuthentication:s,resource:o,fetchFn:a});return{refresh_token:n,...c}}async function lg(e,t,{metadata:r,resource:n,authorizationCode:o,fetchFn:s}={}){const a=e.clientMetadata.scope;let i;if(e.prepareTokenRequest&&(i=await e.prepareTokenRequest(a)),!i){if(!o)throw new Error("Either provider.prepareTokenRequest() or authorizationCode is required");if(!e.redirectUrl)throw new Error("redirectUrl is required for authorization_code flow");const m=await e.codeVerifier();i=cg(o,m,e.redirectUrl)}const c=await e.clientInformation();return Li(t,{metadata:r,tokenRequestParams:i,clientInformation:c??void 0,addClientAuthentication:e.addClientAuthentication,resource:n,fetchFn:s})}async function dg(e,{metadata:t,clientMetadata:r,fetchFn:n}){let o;if(t){if(!t.registration_endpoint)throw new Error("Incompatible auth server: does not support dynamic client registration");o=new URL(t.registration_endpoint)}else o=new URL("/register",e);const s=await(n??fetch)(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!s.ok)throw await Di(s);return Lp.parse(await s.json())}class Fi extends Error{constructor(t,r){super(t),this.name="ParseError",this.type=r.type,this.field=r.field,this.value=r.value,this.line=r.line}}function wo(e){}function fg(e){if(typeof e=="function")throw new TypeError("`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?");const{onEvent:t=wo,onError:r=wo,onRetry:n=wo,onComment:o}=e;let s="",a=!0,i,c="",m="";function h(_){const l=a?_.replace(/^\xEF\xBB\xBF/,""):_,[d,u]=hg(`${s}${l}`);for(const f of d)b(f);s=u,a=!1}function b(_){if(_===""){$();return}if(_.startsWith(":")){o&&o(_.slice(_.startsWith(": ")?2:1));return}const l=_.indexOf(":");if(l!==-1){const d=_.slice(0,l),u=_[l+1]===" "?2:1,f=_.slice(l+u);y(d,f,_);return}y(_,"",_)}function y(_,l,d){switch(_){case"event":m=l;break;case"data":c=`${c}${l}
`;break;case"id":i=l.includes("\0")?void 0:l;break;case"retry":/^\d+$/.test(l)?n(parseInt(l,10)):r(new Fi(`Invalid \`retry\` value: "${l}"`,{type:"invalid-retry",value:l,line:d}));break;default:r(new Fi(`Unknown field "${_.length>20?`${_.slice(0,20)}`:_}"`,{type:"unknown-field",field:_,value:l,line:d}));break}}function $(){c.length>0&&t({id:i,event:m||void 0,data:c.endsWith(`
`)?c.slice(0,-1):c}),i=void 0,c="",m=""}function w(_={}){s&&_.consume&&b(s),a=!0,i=void 0,c="",m="",s=""}return{feed:h,reset:w}}function hg(e){const t=[];let r="",n=0;for(;n<e.length;){const o=e.indexOf("\r",n),s=e.indexOf(`
`,n);let a=-1;if(o!==-1&&s!==-1?a=Math.min(o,s):o!==-1?o===e.length-1?a=-1:a=o:s!==-1&&(a=s),a===-1){r=e.slice(n);break}else{const i=e.slice(n,a);t.push(i),n=a+1,e[n-1]==="\r"&&e[n]===`
`&&n++}}return[t,r]}class mg extends TransformStream{constructor({onError:t,onRetry:r,onComment:n}={}){let o;super({start(s){o=fg({onEvent:a=>{s.enqueue(a)},onError(a){t==="terminate"?s.error(a):typeof t=="function"&&t(a)},onRetry:r,onComment:n})},transform(s){o.feed(s)}})}}const pg={initialReconnectionDelay:1e3,maxReconnectionDelay:3e4,reconnectionDelayGrowFactor:1.5,maxRetries:2};class kt extends Error{constructor(t,r){super(`Streamable HTTP error: ${r}`),this.code=t}}class gg{constructor(t,r){var n;this._hasCompletedAuthFlow=!1,this._url=t,this._resourceMetadataUrl=void 0,this._scope=void 0,this._requestInit=r?.requestInit,this._authProvider=r?.authProvider,this._fetch=r?.fetch,this._fetchWithInit=Ip(r?.fetch,r?.requestInit),this._sessionId=r?.sessionId,this._reconnectionOptions=(n=r?.reconnectionOptions)!==null&&n!==void 0?n:pg}async _authThenStart(){var t;if(!this._authProvider)throw new $t("No auth provider");let r;try{r=await en(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl,scope:this._scope,fetchFn:this._fetchWithInit})}catch(n){throw(t=this.onerror)===null||t===void 0||t.call(this,n),n}if(r!=="AUTHORIZED")throw new $t;return await this._startOrAuthSse({resumptionToken:void 0})}async _commonHeaders(){var t;const r={};if(this._authProvider){const o=await this._authProvider.tokens();o&&(r.Authorization=`Bearer ${o.access_token}`)}this._sessionId&&(r["mcp-session-id"]=this._sessionId),this._protocolVersion&&(r["mcp-protocol-version"]=this._protocolVersion);const n=eo((t=this._requestInit)===null||t===void 0?void 0:t.headers);return new Headers({...r,...n})}async _startOrAuthSse(t){var r,n,o,s;const{resumptionToken:a}=t;try{const i=await this._commonHeaders();i.set("Accept","text/event-stream"),a&&i.set("last-event-id",a);const c=await((r=this._fetch)!==null&&r!==void 0?r:fetch)(this._url,{method:"GET",headers:i,signal:(n=this._abortController)===null||n===void 0?void 0:n.signal});if(!c.ok){if(await((o=c.body)===null||o===void 0?void 0:o.cancel()),c.status===401&&this._authProvider)return await this._authThenStart();if(c.status===405)return;throw new kt(c.status,`Failed to open SSE stream: ${c.statusText}`)}this._handleSseStream(c.body,t,!0)}catch(i){throw(s=this.onerror)===null||s===void 0||s.call(this,i),i}}_getNextReconnectionDelay(t){if(this._serverRetryMs!==void 0)return this._serverRetryMs;const r=this._reconnectionOptions.initialReconnectionDelay,n=this._reconnectionOptions.reconnectionDelayGrowFactor,o=this._reconnectionOptions.maxReconnectionDelay;return Math.min(r*Math.pow(n,t),o)}_scheduleReconnection(t,r=0){var n;const o=this._reconnectionOptions.maxRetries;if(r>=o){(n=this.onerror)===null||n===void 0||n.call(this,new Error(`Maximum reconnection attempts (${o}) exceeded.`));return}const s=this._getNextReconnectionDelay(r);this._reconnectionTimeout=setTimeout(()=>{this._startOrAuthSse(t).catch(a=>{var i;(i=this.onerror)===null||i===void 0||i.call(this,new Error(`Failed to reconnect SSE stream: ${a instanceof Error?a.message:String(a)}`)),this._scheduleReconnection(t,r+1)})},s)}_handleSseStream(t,r,n){if(!t)return;const{onresumptiontoken:o,replayMessageId:s}=r;let a,i=!1,c=!1;(async()=>{var h,b,y,$;try{const w=t.pipeThrough(new TextDecoderStream).pipeThrough(new mg({onRetry:d=>{this._serverRetryMs=d}})).getReader();for(;;){const{value:d,done:u}=await w.read();if(u)break;if(d.id&&(a=d.id,i=!0,o?.(d.id)),!!d.data&&(!d.event||d.event==="message"))try{const f=Sn.parse(JSON.parse(d.data));Rt(f)&&(c=!0,s!==void 0&&(f.id=s)),(h=this.onmessage)===null||h===void 0||h.call(this,f)}catch(f){(b=this.onerror)===null||b===void 0||b.call(this,f)}}(n||i)&&!c&&this._abortController&&!this._abortController.signal.aborted&&this._scheduleReconnection({resumptionToken:a,onresumptiontoken:o,replayMessageId:s},0)}catch(w){if((y=this.onerror)===null||y===void 0||y.call(this,new Error(`SSE stream disconnected: ${w}`)),(n||i)&&!c&&this._abortController&&!this._abortController.signal.aborted)try{this._scheduleReconnection({resumptionToken:a,onresumptiontoken:o,replayMessageId:s},0)}catch(d){($=this.onerror)===null||$===void 0||$.call(this,new Error(`Failed to reconnect: ${d instanceof Error?d.message:String(d)}`))}}})()}async start(){if(this._abortController)throw new Error("StreamableHTTPClientTransport already started! If using Client class, note that connect() calls start() automatically.");this._abortController=new AbortController}async finishAuth(t){if(!this._authProvider)throw new $t("No auth provider");if(await en(this._authProvider,{serverUrl:this._url,authorizationCode:t,resourceMetadataUrl:this._resourceMetadataUrl,scope:this._scope,fetchFn:this._fetchWithInit})!=="AUTHORIZED")throw new $t("Failed to authorize")}async close(){var t,r;this._reconnectionTimeout&&(clearTimeout(this._reconnectionTimeout),this._reconnectionTimeout=void 0),(t=this._abortController)===null||t===void 0||t.abort(),(r=this.onclose)===null||r===void 0||r.call(this)}async send(t,r){var n,o,s,a,i,c,m;try{const{resumptionToken:h,onresumptiontoken:b}=r||{};if(h){this._startOrAuthSse({resumptionToken:h,replayMessageId:kn(t)?t.id:void 0}).catch(f=>{var v;return(v=this.onerror)===null||v===void 0?void 0:v.call(this,f)});return}const y=await this._commonHeaders();y.set("content-type","application/json"),y.set("accept","application/json, text/event-stream");const $={...this._requestInit,method:"POST",headers:y,body:JSON.stringify(t),signal:(n=this._abortController)===null||n===void 0?void 0:n.signal},w=await((o=this._fetch)!==null&&o!==void 0?o:fetch)(this._url,$),_=w.headers.get("mcp-session-id");if(_&&(this._sessionId=_),!w.ok){const f=await w.text().catch(()=>null);if(w.status===401&&this._authProvider){if(this._hasCompletedAuthFlow)throw new kt(401,"Server returned 401 after successful authentication");const{resourceMetadataUrl:v,scope:p}=Vi(w);if(this._resourceMetadataUrl=v,this._scope=p,await en(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl,scope:this._scope,fetchFn:this._fetchWithInit})!=="AUTHORIZED")throw new $t;return this._hasCompletedAuthFlow=!0,this.send(t)}if(w.status===403&&this._authProvider){const{resourceMetadataUrl:v,scope:p,error:g}=Vi(w);if(g==="insufficient_scope"){const S=w.headers.get("WWW-Authenticate");if(this._lastUpscopingHeader===S)throw new kt(403,"Server returned 403 after trying upscoping");if(p&&(this._scope=p),v&&(this._resourceMetadataUrl=v),this._lastUpscopingHeader=S??void 0,await en(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl,scope:this._scope,fetchFn:this._fetch})!=="AUTHORIZED")throw new $t;return this.send(t)}}throw new kt(w.status,`Error POSTing to endpoint: ${f}`)}if(this._hasCompletedAuthFlow=!1,this._lastUpscopingHeader=void 0,w.status===202){await((s=w.body)===null||s===void 0?void 0:s.cancel()),nh(t)&&this._startOrAuthSse({resumptionToken:void 0}).catch(f=>{var v;return(v=this.onerror)===null||v===void 0?void 0:v.call(this,f)});return}const d=(Array.isArray(t)?t:[t]).filter(f=>"method"in f&&"id"in f&&f.id!==void 0).length>0,u=w.headers.get("content-type");if(d)if(u?.includes("text/event-stream"))this._handleSseStream(w.body,{onresumptiontoken:b},!1);else if(u?.includes("application/json")){const f=await w.json(),v=Array.isArray(f)?f.map(p=>Sn.parse(p)):[Sn.parse(f)];for(const p of v)(a=this.onmessage)===null||a===void 0||a.call(this,p)}else throw await((i=w.body)===null||i===void 0?void 0:i.cancel()),new kt(-1,`Unexpected content type: ${u}`);else await((c=w.body)===null||c===void 0?void 0:c.cancel())}catch(h){throw(m=this.onerror)===null||m===void 0||m.call(this,h),h}}get sessionId(){return this._sessionId}async terminateSession(){var t,r,n,o;if(this._sessionId)try{const s=await this._commonHeaders(),a={...this._requestInit,method:"DELETE",headers:s,signal:(t=this._abortController)===null||t===void 0?void 0:t.signal},i=await((r=this._fetch)!==null&&r!==void 0?r:fetch)(this._url,a);if(await((n=i.body)===null||n===void 0?void 0:n.cancel()),!i.ok&&i.status!==405)throw new kt(i.status,`Failed to terminate session: ${i.statusText}`);this._sessionId=void 0}catch(s){throw(o=this.onerror)===null||o===void 0||o.call(this,s),s}}setProtocolVersion(t){this._protocolVersion=t}get protocolVersion(){return this._protocolVersion}async resumeStream(t,r){await this._startOrAuthSse({resumptionToken:t,onresumptiontoken:r?.onresumptiontoken})}}async function _g(e){const t=new Rp({name:"browseros-settings",version:"1.0.0"}),r=new gg(new URL(e));try{return await t.connect(r),(await t.listTools()).tools.map(o=>({name:o.name,description:o.description}))}finally{await t.close()}}const vg=[EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError,globalThis.DOMException,globalThis.AssertionError,globalThis.SystemError].filter(Boolean).map(e=>[e.name,e]),yg=new Map(vg);class bo extends Error{name="NonError";constructor(t){super(bo._prepareSuperMessage(t))}static _prepareSuperMessage(t){try{return JSON.stringify(t)}catch{return String(t)}}}const wg=[{property:"name",enumerable:!1},{property:"message",enumerable:!1},{property:"stack",enumerable:!1},{property:"code",enumerable:!0},{property:"cause",enumerable:!1}],$o=new WeakSet,bg=e=>{$o.add(e);const t=e.toJSON();return $o.delete(e),t},Hi=e=>yg.get(e)??Error,ko=({from:e,seen:t,to:r,forceEnumerable:n,maxDepth:o,depth:s,useToJSON:a,serialize:i})=>{if(!r)if(Array.isArray(e))r=[];else if(!i&&Ki(e)){const m=Hi(e.name);r=new m}else r={};if(t.push(e),s>=o)return r;if(a&&typeof e.toJSON=="function"&&!$o.has(e))return bg(e);const c=m=>ko({from:m,seen:[...t],forceEnumerable:n,maxDepth:o,depth:s,useToJSON:a,serialize:i});for(const[m,h]of Object.entries(e)){if(h&&h instanceof Uint8Array&&h.constructor.name==="Buffer"){r[m]="[object Buffer]";continue}if(h!==null&&typeof h=="object"&&typeof h.pipe=="function"){r[m]="[object Stream]";continue}if(typeof h!="function"){if(!h||typeof h!="object"){try{r[m]=h}catch{}continue}if(!t.includes(e[m])){s++,r[m]=c(e[m]);continue}r[m]="[Circular]"}}for(const{property:m,enumerable:h}of wg)typeof e[m]<"u"&&e[m]!==null&&Object.defineProperty(r,m,{value:Ki(e[m])?c(e[m]):e[m],enumerable:n?!0:h,configurable:!0,writable:!0});return r};function $g(e,t={}){const{maxDepth:r=Number.POSITIVE_INFINITY,useToJSON:n=!0}=t;return typeof e=="object"&&e!==null?ko({from:e,seen:[],forceEnumerable:!0,maxDepth:r,depth:0,useToJSON:n,serialize:!0}):typeof e=="function"?`[Function: ${e.name||"anonymous"}]`:e}function kg(e,t={}){const{maxDepth:r=Number.POSITIVE_INFINITY}=t;if(e instanceof Error)return e;if(Sg(e)){const n=Hi(e.name);return ko({from:e,seen:[],to:new n,maxDepth:r,depth:0,serialize:!1})}return new bo(e)}function Ki(e){return!!e&&typeof e=="object"&&"name"in e&&"message"in e&&"stack"in e}function Sg(e){return!!e&&typeof e=="object"&&"message"in e&&!Array.isArray(e)}var Eg=Object.defineProperty,Pg=Object.defineProperties,Tg=Object.getOwnPropertyDescriptors,Wi=Object.getOwnPropertySymbols,Ag=Object.prototype.hasOwnProperty,Rg=Object.prototype.propertyIsEnumerable,Bi=(e,t,r)=>t in e?Eg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Gi=(e,t)=>{for(var r in t||(t={}))Ag.call(t,r)&&Bi(e,r,t[r]);if(Wi)for(var r of Wi(t))Rg.call(t,r)&&Bi(e,r,t[r]);return e},Ji=(e,t)=>Pg(e,Tg(t)),Ig=(e,t,r)=>new Promise((n,o)=>{var s=c=>{try{i(r.next(c))}catch(m){o(m)}},a=c=>{try{i(r.throw(c))}catch(m){o(m)}},i=c=>c.done?n(c.value):Promise.resolve(c.value).then(s,a);i((r=r.apply(e,t)).next())});function Og(e){let t,r={};function n(){Object.entries(r).length===0&&(t?.(),t=void 0)}let o=Math.floor(Math.random()*1e4);function s(){return o++}return{sendMessage(a,i,...c){return Ig(this,null,function*(){var m,h,b,y;const $={id:s(),type:a,data:i,timestamp:Date.now()},w=(h=yield(m=e.verifyMessageData)==null?void 0:m.call(e,$))!=null?h:$;(b=e.logger)==null||b.debug(`[messaging] sendMessage {id=${w.id}} `,w,...c);const _=yield e.sendMessage(w,...c),{res:l,err:d}=_??{err:new Error("No response")};if((y=e.logger)==null||y.debug(`[messaging] sendMessage {id=${w.id}} `,{res:l,err:d}),d!=null)throw kg(d);return l})},onMessage(a,i){var c,m,h;if(t==null&&((c=e.logger)==null||c.debug(`[messaging] "${a}" initialized the message listener for this context`),t=e.addRootListener(b=>{var y,$;if(typeof b.type!="string"||typeof b.timestamp!="number"){if(e.breakError)return;const l=Error(`[messaging] Unknown message format, must include the 'type' & 'timestamp' fields, received: ${JSON.stringify(b)}`);throw(y=e.logger)==null||y.error(l),l}($=e?.logger)==null||$.debug("[messaging] Received message",b);const w=r[b.type];if(w==null)return;const _=w(b);return Promise.resolve(_).then(l=>{var d,u;return(u=(d=e.verifyMessageData)==null?void 0:d.call(e,l))!=null?u:l}).then(l=>{var d;return(d=e?.logger)==null||d.debug(`[messaging] onMessage {id=${b.id}} `,{res:l}),{res:l}}).catch(l=>{var d;return(d=e?.logger)==null||d.debug(`[messaging] onMessage {id=${b.id}} `,{err:l}),{err:$g(l)}})})),r[a]!=null){const b=Error(`[messaging] In this JS context, only one listener can be setup for ${a}`);throw(m=e.logger)==null||m.error(b),b}return r[a]=i,(h=e.logger)==null||h.log(`[messaging] Added listener for ${a}`),()=>{delete r[a],n()}},removeAllListeners(){Object.keys(r).forEach(a=>{delete r[a]}),n()}}}var tn={exports:{}},Cg=tn.exports,Yi;function Ng(){return Yi||(Yi=1,(function(e,t){(function(r,n){n(e)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:Cg,function(r){if(!globalThis.chrome?.runtime?.id)throw new Error("This script should only be loaded in a browser extension.");if(typeof globalThis.browser>"u"||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const n="The message port closed before a response was received.",o=s=>{const a={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(a).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class i extends WeakMap{constructor(S,T=void 0){super(T),this.createItem=S}get(S){return this.has(S)||this.set(S,this.createItem(S)),super.get(S)}}const c=g=>g&&typeof g=="object"&&typeof g.then=="function",m=(g,S)=>(...T)=>{s.runtime.lastError?g.reject(new Error(s.runtime.lastError.message)):S.singleCallbackArg||T.length<=1&&S.singleCallbackArg!==!1?g.resolve(T[0]):g.resolve(T)},h=g=>g==1?"argument":"arguments",b=(g,S)=>function(R,...q){if(q.length<S.minArgs)throw new Error(`Expected at least ${S.minArgs} ${h(S.minArgs)} for ${g}(), got ${q.length}`);if(q.length>S.maxArgs)throw new Error(`Expected at most ${S.maxArgs} ${h(S.maxArgs)} for ${g}(), got ${q.length}`);return new Promise((N,x)=>{if(S.fallbackToNoCallback)try{R[g](...q,m({resolve:N,reject:x},S))}catch(M){console.warn(`${g} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,M),R[g](...q),S.fallbackToNoCallback=!1,S.noCallback=!0,N()}else S.noCallback?(R[g](...q),N()):R[g](...q,m({resolve:N,reject:x},S))})},y=(g,S,T)=>new Proxy(S,{apply(R,q,N){return T.call(q,g,...N)}});let $=Function.call.bind(Object.prototype.hasOwnProperty);const w=(g,S={},T={})=>{let R=Object.create(null),q={has(x,M){return M in g||M in R},get(x,M,F){if(M in R)return R[M];if(!(M in g))return;let Y=g[M];if(typeof Y=="function")if(typeof S[M]=="function")Y=y(g,g[M],S[M]);else if($(T,M)){let _e=b(M,T[M]);Y=y(g,g[M],_e)}else Y=Y.bind(g);else if(typeof Y=="object"&&Y!==null&&($(S,M)||$(T,M)))Y=w(Y,S[M],T[M]);else if($(T,"*"))Y=w(Y,S[M],T["*"]);else return Object.defineProperty(R,M,{configurable:!0,enumerable:!0,get(){return g[M]},set(_e){g[M]=_e}}),Y;return R[M]=Y,Y},set(x,M,F,Y){return M in R?R[M]=F:g[M]=F,!0},defineProperty(x,M,F){return Reflect.defineProperty(R,M,F)},deleteProperty(x,M){return Reflect.deleteProperty(R,M)}},N=Object.create(g);return new Proxy(N,q)},_=g=>({addListener(S,T,...R){S.addListener(g.get(T),...R)},hasListener(S,T){return S.hasListener(g.get(T))},removeListener(S,T){S.removeListener(g.get(T))}}),l=new i(g=>typeof g!="function"?g:function(T){const R=w(T,{},{getContent:{minArgs:0,maxArgs:0}});g(R)}),d=new i(g=>typeof g!="function"?g:function(T,R,q){let N=!1,x,M=new Promise(le=>{x=function(ee){N=!0,le(ee)}}),F;try{F=g(T,R,x)}catch(le){F=Promise.reject(le)}const Y=F!==!0&&c(F);if(F!==!0&&!Y&&!N)return!1;const _e=le=>{le.then(ee=>{q(ee)},ee=>{let be;ee&&(ee instanceof Error||typeof ee.message=="string")?be=ee.message:be="An unexpected error occurred",q({__mozWebExtensionPolyfillReject__:!0,message:be})}).catch(ee=>{console.error("Failed to send onMessage rejected reply",ee)})};return _e(Y?F:M),!0}),u=({reject:g,resolve:S},T)=>{s.runtime.lastError?s.runtime.lastError.message===n?S():g(new Error(s.runtime.lastError.message)):T&&T.__mozWebExtensionPolyfillReject__?g(new Error(T.message)):S(T)},f=(g,S,T,...R)=>{if(R.length<S.minArgs)throw new Error(`Expected at least ${S.minArgs} ${h(S.minArgs)} for ${g}(), got ${R.length}`);if(R.length>S.maxArgs)throw new Error(`Expected at most ${S.maxArgs} ${h(S.maxArgs)} for ${g}(), got ${R.length}`);return new Promise((q,N)=>{const x=u.bind(null,{resolve:q,reject:N});R.push(x),T.sendMessage(...R)})},v={devtools:{network:{onRequestFinished:_(l)}},runtime:{onMessage:_(d),onMessageExternal:_(d),sendMessage:f.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:f.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},p={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return a.privacy={network:{"*":p},services:{"*":p},websites:{"*":p}},w(s,v,a)};r.exports=o(chrome)}else r.exports=globalThis.browser})})(tn)),tn.exports}var zg=Ng();const rn=ha(zg);function Qi(e){return Og(Ji(Gi({},e),{sendMessage(t,r){if(r==null)return rn.runtime.sendMessage(t);const n=typeof r=="number"?{tabId:r}:r;return rn.tabs.sendMessage(n.tabId,t,n.frameId!=null?{frameId:n.frameId}:void 0)},addRootListener(t){const r=(n,o)=>t(typeof n=="object"?Ji(Gi({},n),{sender:o}):n);return rn.runtime.onMessage.addListener(r),()=>rn.runtime.onMessage.removeListener(r)}}))}const{onMessage:Xi}=Qi(),{onMessage:jg}=Qi(),qg=bn.defineItem("local:search-actions"),Mg=Le(async()=>{chrome.sidePanel.setOptions({enabled:!1}),await nc.initialize(),Uf(),chrome.action.onClicked.addListener(async e=>{e.id&&await Tf(e.id)}),jg("open",async e=>{const r=(await chrome.tabs.query({active:!0,currentWindow:!0}))?.[0]?.id;if(r){const{opened:n}=await Pf(r);n&&setTimeout(()=>{qg.setValue(e.data)},500)}}),chrome.runtime.onInstalled.addListener(e=>{e.reason===chrome.runtime.OnInstalledReason.INSTALL&&chrome.tabs.create({url:chrome.runtime.getURL("onboarding.html")})}),Xi("checkHealth",async()=>{try{const e=await Ef();return{healthy:(await fetch(e)).ok}}catch{return{healthy:!1}}}),Xi("fetchMcpTools",async()=>{try{const e=await Sf();return{tools:await _g(e)}}catch(e){return{tools:[],error:e instanceof Error?e.message:"Failed to fetch tools"}}})});function Qg(){}function nn(e,...t){}const xg={debug:(...e)=>nn(console.debug,...e),log:(...e)=>nn(console.log,...e),warn:(...e)=>nn(console.warn,...e),error:(...e)=>nn(console.error,...e)};let So;try{So=Mg.main(),So instanceof Promise&&console.warn("The background's main() function return a promise, but it must be synchronous")}catch(e){throw xg.error("The background crashed on startup!"),e}return So})();
