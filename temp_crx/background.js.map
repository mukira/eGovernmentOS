{"version":3,"file":"background.js","sources":["../../node_modules/wxt/dist/utils/define-background.mjs","../../lib/browseros/adapter.ts","../../lib/browseros/capabilities.ts","../../node_modules/zod/v4/core/core.js","../../node_modules/zod/v4/core/util.js","../../node_modules/zod/v4/core/errors.js","../../node_modules/zod/v4/core/parse.js","../../node_modules/zod/v4/core/regexes.js","../../node_modules/zod/v4/core/checks.js","../../node_modules/zod/v4/core/doc.js","../../node_modules/zod/v4/core/versions.js","../../node_modules/zod/v4/core/schemas.js","../../node_modules/zod/v4/core/registries.js","../../node_modules/zod/v4/core/api.js","../../node_modules/zod/v4/classic/iso.js","../../node_modules/zod/v4/classic/errors.js","../../node_modules/zod/v4/classic/parse.js","../../node_modules/zod/v4/classic/schemas.js","../../node_modules/zod/v4/classic/compat.js","../../node_modules/zod/v4/classic/coerce.js","../../lib/env.ts","../../lib/browseros/prefs.ts","../../lib/browseros/helpers.ts","../../lib/browseros/toggleSidePanel.ts","../../node_modules/dequal/lite/index.mjs","../../node_modules/async-mutex/index.mjs","../../node_modules/@wxt-dev/browser/src/index.mjs","../../node_modules/@wxt-dev/storage/dist/index.mjs","../../lib/llm-providers/storage.ts","../../node_modules/@modelcontextprotocol/sdk/dist/esm/server/zod-compat.js","../../node_modules/@modelcontextprotocol/sdk/dist/esm/types.js","../../node_modules/@modelcontextprotocol/sdk/dist/esm/experimental/tasks/interfaces.js","../../node_modules/zod-to-json-schema/dist/esm/parsers/string.js","../../node_modules/@modelcontextprotocol/sdk/dist/esm/server/zod-json-schema-compat.js","../../node_modules/@modelcontextprotocol/sdk/dist/esm/shared/protocol.js","../../node_modules/ajv/dist/compile/codegen/code.js","../../node_modules/ajv/dist/compile/codegen/scope.js","../../node_modules/ajv/dist/compile/codegen/index.js","../../node_modules/ajv/dist/compile/util.js","../../node_modules/ajv/dist/compile/names.js","../../node_modules/ajv/dist/compile/errors.js","../../node_modules/ajv/dist/compile/validate/boolSchema.js","../../node_modules/ajv/dist/compile/rules.js","../../node_modules/ajv/dist/compile/validate/applicability.js","../../node_modules/ajv/dist/compile/validate/dataType.js","../../node_modules/ajv/dist/compile/validate/defaults.js","../../node_modules/ajv/dist/vocabularies/code.js","../../node_modules/ajv/dist/compile/validate/keyword.js","../../node_modules/ajv/dist/compile/validate/subschema.js","../../node_modules/fast-deep-equal/index.js","../../node_modules/json-schema-traverse/index.js","../../node_modules/ajv/dist/compile/resolve.js","../../node_modules/ajv/dist/compile/validate/index.js","../../node_modules/ajv/dist/runtime/validation_error.js","../../node_modules/ajv/dist/compile/ref_error.js","../../node_modules/ajv/dist/compile/index.js","../../node_modules/fast-uri/lib/utils.js","../../node_modules/fast-uri/lib/schemes.js","../../node_modules/fast-uri/index.js","../../node_modules/ajv/dist/runtime/uri.js","../../node_modules/ajv/dist/core.js","../../node_modules/ajv/dist/vocabularies/core/id.js","../../node_modules/ajv/dist/vocabularies/core/ref.js","../../node_modules/ajv/dist/vocabularies/core/index.js","../../node_modules/ajv/dist/vocabularies/validation/limitNumber.js","../../node_modules/ajv/dist/vocabularies/validation/multipleOf.js","../../node_modules/ajv/dist/runtime/ucs2length.js","../../node_modules/ajv/dist/vocabularies/validation/limitLength.js","../../node_modules/ajv/dist/vocabularies/validation/pattern.js","../../node_modules/ajv/dist/vocabularies/validation/limitProperties.js","../../node_modules/ajv/dist/vocabularies/validation/required.js","../../node_modules/ajv/dist/vocabularies/validation/limitItems.js","../../node_modules/ajv/dist/runtime/equal.js","../../node_modules/ajv/dist/vocabularies/validation/uniqueItems.js","../../node_modules/ajv/dist/vocabularies/validation/const.js","../../node_modules/ajv/dist/vocabularies/validation/enum.js","../../node_modules/ajv/dist/vocabularies/validation/index.js","../../node_modules/ajv/dist/vocabularies/applicator/additionalItems.js","../../node_modules/ajv/dist/vocabularies/applicator/items.js","../../node_modules/ajv/dist/vocabularies/applicator/prefixItems.js","../../node_modules/ajv/dist/vocabularies/applicator/items2020.js","../../node_modules/ajv/dist/vocabularies/applicator/contains.js","../../node_modules/ajv/dist/vocabularies/applicator/dependencies.js","../../node_modules/ajv/dist/vocabularies/applicator/propertyNames.js","../../node_modules/ajv/dist/vocabularies/applicator/additionalProperties.js","../../node_modules/ajv/dist/vocabularies/applicator/properties.js","../../node_modules/ajv/dist/vocabularies/applicator/patternProperties.js","../../node_modules/ajv/dist/vocabularies/applicator/not.js","../../node_modules/ajv/dist/vocabularies/applicator/anyOf.js","../../node_modules/ajv/dist/vocabularies/applicator/oneOf.js","../../node_modules/ajv/dist/vocabularies/applicator/allOf.js","../../node_modules/ajv/dist/vocabularies/applicator/if.js","../../node_modules/ajv/dist/vocabularies/applicator/thenElse.js","../../node_modules/ajv/dist/vocabularies/applicator/index.js","../../node_modules/ajv/dist/vocabularies/format/format.js","../../node_modules/ajv/dist/vocabularies/format/index.js","../../node_modules/ajv/dist/vocabularies/metadata.js","../../node_modules/ajv/dist/vocabularies/draft7.js","../../node_modules/ajv/dist/vocabularies/discriminator/types.js","../../node_modules/ajv/dist/vocabularies/discriminator/index.js","../../node_modules/ajv/dist/ajv.js","../../node_modules/ajv-formats/dist/formats.js","../../node_modules/ajv-formats/dist/limit.js","../../node_modules/ajv-formats/dist/index.js","../../node_modules/@modelcontextprotocol/sdk/dist/esm/validation/ajv-provider.js","../../node_modules/@modelcontextprotocol/sdk/dist/esm/experimental/tasks/client.js","../../node_modules/@modelcontextprotocol/sdk/dist/esm/experimental/tasks/helpers.js","../../node_modules/@modelcontextprotocol/sdk/dist/esm/client/index.js","../../node_modules/@modelcontextprotocol/sdk/dist/esm/shared/transport.js","../../node_modules/pkce-challenge/dist/index.browser.js","../../node_modules/@modelcontextprotocol/sdk/dist/esm/shared/auth.js","../../node_modules/@modelcontextprotocol/sdk/dist/esm/shared/auth-utils.js","../../node_modules/@modelcontextprotocol/sdk/dist/esm/server/auth/errors.js","../../node_modules/@modelcontextprotocol/sdk/dist/esm/client/auth.js","../../node_modules/eventsource-parser/dist/index.js","../../node_modules/eventsource-parser/dist/stream.js","../../node_modules/@modelcontextprotocol/sdk/dist/esm/client/streamableHttp.js","../../lib/mcp/client.ts","../../node_modules/serialize-error/error-constructors.js","../../node_modules/serialize-error/index.js","../../node_modules/@webext-core/messaging/lib/chunk-BQLFSFFZ.js","../../node_modules/webextension-polyfill/dist/browser-polyfill.js","../../node_modules/@webext-core/messaging/lib/index.js","../../lib/messaging/server/serverMessages.ts","../../lib/messaging/sidepanel/openSidepanelWithSearch.ts","../../lib/search-actions/searchActionsStorage.ts","../../entrypoints/background.ts"],"sourcesContent":["export function defineBackground(arg) {\n  if (arg == null || typeof arg === \"function\") return { main: arg };\n  return arg;\n}\n","// biome-ignore-all lint/suspicious/noExplicitAny: Low-level browser API adapter requires flexible types\n/// <reference path=\"./chrome-browser-os.d.ts\" />\n\nexport type InteractiveNode = chrome.browserOS.InteractiveNode\nexport type InteractiveSnapshot = chrome.browserOS.InteractiveSnapshot\nexport type InteractiveSnapshotOptions =\n  chrome.browserOS.InteractiveSnapshotOptions\nexport type InteractiveNodeType = chrome.browserOS.InteractiveNodeType\nexport type PageLoadStatus = chrome.browserOS.PageLoadStatus\nexport type Rect = chrome.browserOS.Rect\nexport type Key = chrome.browserOS.Key\nexport type AccessibilityTree = chrome.browserOS.AccessibilityTree\nexport type SnapshotItem = chrome.browserOS.SnapshotItem\nexport type Snapshot = chrome.browserOS.Snapshot\nexport type SnapshotOptions = chrome.browserOS.SnapshotOptions\nexport type SnapshotContext = chrome.browserOS.SnapshotContext\nexport type PrefObject = chrome.browserOS.PrefObject\n\nexport const SCREENSHOT_SIZES = {\n  small: 512,\n  medium: 768,\n  large: 1028,\n} as const\n\nexport type ScreenshotSizeKey = keyof typeof SCREENSHOT_SIZES\n\nexport class BrowserOSAdapter {\n  private static instance: BrowserOSAdapter | null = null\n\n  private constructor() {}\n\n  static getInstance(): BrowserOSAdapter {\n    if (!BrowserOSAdapter.instance) {\n      BrowserOSAdapter.instance = new BrowserOSAdapter()\n    }\n    return BrowserOSAdapter.instance\n  }\n\n  async getInteractiveSnapshot(\n    tabId: number,\n    options?: InteractiveSnapshotOptions,\n  ): Promise<InteractiveSnapshot> {\n    return new Promise<InteractiveSnapshot>((resolve, reject) => {\n      const callback = (snapshot: InteractiveSnapshot) => {\n        if (chrome.runtime.lastError) {\n          reject(new Error(chrome.runtime.lastError.message || 'Unknown error'))\n        } else {\n          resolve(snapshot)\n        }\n      }\n\n      if (options) {\n        chrome.browserOS.getInteractiveSnapshot(tabId, options, callback)\n      } else {\n        chrome.browserOS.getInteractiveSnapshot(tabId, callback)\n      }\n    })\n  }\n\n  async click(tabId: number, nodeId: number): Promise<void> {\n    return new Promise<void>((resolve, reject) => {\n      chrome.browserOS.click(tabId, nodeId, () => {\n        if (chrome.runtime.lastError) {\n          reject(new Error(chrome.runtime.lastError.message || 'Unknown error'))\n        } else {\n          resolve()\n        }\n      })\n    })\n  }\n\n  async inputText(tabId: number, nodeId: number, text: string): Promise<void> {\n    return new Promise<void>((resolve, reject) => {\n      chrome.browserOS.inputText(tabId, nodeId, text, () => {\n        if (chrome.runtime.lastError) {\n          reject(new Error(chrome.runtime.lastError.message || 'Unknown error'))\n        } else {\n          resolve()\n        }\n      })\n    })\n  }\n\n  async clear(tabId: number, nodeId: number): Promise<void> {\n    return new Promise<void>((resolve, reject) => {\n      chrome.browserOS.clear(tabId, nodeId, () => {\n        if (chrome.runtime.lastError) {\n          reject(new Error(chrome.runtime.lastError.message || 'Unknown error'))\n        } else {\n          resolve()\n        }\n      })\n    })\n  }\n\n  async scrollToNode(tabId: number, nodeId: number): Promise<boolean> {\n    return new Promise<boolean>((resolve, reject) => {\n      chrome.browserOS.scrollToNode(tabId, nodeId, (scrolled: boolean) => {\n        if (chrome.runtime.lastError) {\n          reject(new Error(chrome.runtime.lastError.message || 'Unknown error'))\n        } else {\n          resolve(scrolled)\n        }\n      })\n    })\n  }\n\n  async sendKeys(tabId: number, keys: Key): Promise<void> {\n    return new Promise<void>((resolve, reject) => {\n      chrome.browserOS.sendKeys(tabId, keys, () => {\n        if (chrome.runtime.lastError) {\n          reject(new Error(chrome.runtime.lastError.message || 'Unknown error'))\n        } else {\n          resolve()\n        }\n      })\n    })\n  }\n\n  async getPageLoadStatus(tabId: number): Promise<PageLoadStatus> {\n    return new Promise<PageLoadStatus>((resolve, reject) => {\n      chrome.browserOS.getPageLoadStatus(tabId, (status: PageLoadStatus) => {\n        if (chrome.runtime.lastError) {\n          reject(new Error(chrome.runtime.lastError.message || 'Unknown error'))\n        } else {\n          resolve(status)\n        }\n      })\n    })\n  }\n\n  async getAccessibilityTree(tabId: number): Promise<AccessibilityTree> {\n    return new Promise<AccessibilityTree>((resolve, reject) => {\n      chrome.browserOS.getAccessibilityTree(\n        tabId,\n        (tree: AccessibilityTree) => {\n          if (chrome.runtime.lastError) {\n            reject(\n              new Error(chrome.runtime.lastError.message || 'Unknown error'),\n            )\n          } else {\n            resolve(tree)\n          }\n        },\n      )\n    })\n  }\n\n  async captureScreenshot(\n    tabId: number,\n    size?: ScreenshotSizeKey,\n    showHighlights?: boolean,\n    width?: number,\n    height?: number,\n  ): Promise<string> {\n    return new Promise<string>((resolve, reject) => {\n      const callback = (dataUrl: string) => {\n        if (chrome.runtime.lastError) {\n          reject(new Error(chrome.runtime.lastError.message || 'Unknown error'))\n        } else {\n          resolve(dataUrl)\n        }\n      }\n\n      if (width !== undefined && height !== undefined) {\n        chrome.browserOS.captureScreenshot(\n          tabId,\n          0,\n          showHighlights || false,\n          width,\n          height,\n          callback,\n        )\n      } else if (size !== undefined || showHighlights !== undefined) {\n        const pixelSize = size ? SCREENSHOT_SIZES[size] : 0\n        if (showHighlights !== undefined) {\n          chrome.browserOS.captureScreenshot(\n            tabId,\n            pixelSize,\n            showHighlights,\n            callback,\n          )\n        } else {\n          chrome.browserOS.captureScreenshot(tabId, pixelSize, callback)\n        }\n      } else {\n        chrome.browserOS.captureScreenshot(tabId, callback)\n      }\n    })\n  }\n\n  async getSnapshot(\n    tabId: number,\n    options?: SnapshotOptions,\n  ): Promise<Snapshot> {\n    return new Promise<Snapshot>((resolve, reject) => {\n      const callback = (snapshot: Snapshot) => {\n        if (chrome.runtime.lastError) {\n          reject(new Error(chrome.runtime.lastError.message || 'Unknown error'))\n        } else {\n          resolve(snapshot)\n        }\n      }\n\n      if (options) {\n        chrome.browserOS.getSnapshot(tabId, options, callback)\n      } else {\n        chrome.browserOS.getSnapshot(tabId, callback)\n      }\n    })\n  }\n\n  async getVersion(): Promise<string | null> {\n    return new Promise<string | null>((resolve, reject) => {\n      if (typeof chrome.browserOS.getVersionNumber !== 'function') {\n        resolve(null)\n        return\n      }\n\n      chrome.browserOS.getVersionNumber((version: string) => {\n        if (chrome.runtime.lastError) {\n          reject(new Error(chrome.runtime.lastError.message || 'Unknown error'))\n        } else {\n          resolve(version)\n        }\n      })\n    })\n  }\n\n  async getBrowserosVersion(): Promise<string | null> {\n    return new Promise<string | null>((resolve, reject) => {\n      if (typeof chrome.browserOS.getBrowserosVersionNumber !== 'function') {\n        resolve(null)\n        return\n      }\n\n      chrome.browserOS.getBrowserosVersionNumber((version: string) => {\n        if (chrome.runtime.lastError) {\n          reject(new Error(chrome.runtime.lastError.message || 'Unknown error'))\n        } else {\n          resolve(version)\n        }\n      })\n    })\n  }\n\n  async logMetric(\n    eventName: string,\n    properties?: Record<string, any>,\n  ): Promise<void> {\n    if (typeof chrome.browserOS.logMetric !== 'function') {\n      return\n    }\n\n    return new Promise<void>((resolve, reject) => {\n      const callback = () => {\n        if (chrome.runtime.lastError) {\n          reject(new Error(chrome.runtime.lastError.message || 'Unknown error'))\n        } else {\n          resolve()\n        }\n      }\n\n      if (properties) {\n        chrome.browserOS.logMetric(eventName, properties, callback)\n      } else {\n        chrome.browserOS.logMetric(eventName, callback)\n      }\n    })\n  }\n\n  async executeJavaScript(tabId: number, code: string): Promise<any> {\n    if (typeof chrome.browserOS.executeJavaScript !== 'function') {\n      throw new Error('executeJavaScript API not available')\n    }\n\n    return new Promise<any>((resolve, reject) => {\n      chrome.browserOS.executeJavaScript(tabId, code, (result: any) => {\n        if (chrome.runtime.lastError) {\n          reject(new Error(chrome.runtime.lastError.message || 'Unknown error'))\n        } else {\n          resolve(result)\n        }\n      })\n    })\n  }\n\n  async clickCoordinates(tabId: number, x: number, y: number): Promise<void> {\n    if (typeof chrome.browserOS.clickCoordinates !== 'function') {\n      throw new Error('clickCoordinates API not available')\n    }\n\n    return new Promise<void>((resolve, reject) => {\n      chrome.browserOS.clickCoordinates(tabId, x, y, () => {\n        if (chrome.runtime.lastError) {\n          reject(new Error(chrome.runtime.lastError.message || 'Unknown error'))\n        } else {\n          resolve()\n        }\n      })\n    })\n  }\n\n  async typeAtCoordinates(\n    tabId: number,\n    x: number,\n    y: number,\n    text: string,\n  ): Promise<void> {\n    if (typeof chrome.browserOS.typeAtCoordinates !== 'function') {\n      throw new Error('typeAtCoordinates API not available')\n    }\n\n    return new Promise<void>((resolve, reject) => {\n      chrome.browserOS.typeAtCoordinates(tabId, x, y, text, () => {\n        if (chrome.runtime.lastError) {\n          reject(new Error(chrome.runtime.lastError.message || 'Unknown error'))\n        } else {\n          resolve()\n        }\n      })\n    })\n  }\n\n  async getPref(name: string): Promise<PrefObject> {\n    if (typeof chrome.browserOS?.getPref !== 'function') {\n      throw new Error('getPref API not available')\n    }\n\n    return new Promise<PrefObject>((resolve, reject) => {\n      chrome.browserOS.getPref(name, (pref: PrefObject) => {\n        if (chrome.runtime.lastError) {\n          reject(new Error(chrome.runtime.lastError.message || 'Unknown error'))\n        } else {\n          resolve(pref)\n        }\n      })\n    })\n  }\n\n  async setPref(name: string, value: any, pageId?: string): Promise<boolean> {\n    if (typeof chrome.browserOS?.setPref !== 'function') {\n      throw new Error('setPref API not available')\n    }\n\n    return new Promise<boolean>((resolve, reject) => {\n      const callback = (success: boolean) => {\n        if (chrome.runtime.lastError) {\n          reject(new Error(chrome.runtime.lastError.message || 'Unknown error'))\n        } else {\n          resolve(success)\n        }\n      }\n\n      if (pageId !== undefined) {\n        chrome.browserOS.setPref(name, value, pageId, callback)\n      } else {\n        chrome.browserOS.setPref(name, value, callback)\n      }\n    })\n  }\n\n  async getAllPrefs(): Promise<PrefObject[]> {\n    if (typeof chrome.browserOS?.getAllPrefs !== 'function') {\n      throw new Error('getAllPrefs API not available')\n    }\n\n    return new Promise<PrefObject[]>((resolve, reject) => {\n      chrome.browserOS.getAllPrefs((prefs: PrefObject[]) => {\n        if (chrome.runtime.lastError) {\n          reject(new Error(chrome.runtime.lastError.message || 'Unknown error'))\n        } else {\n          resolve(prefs)\n        }\n      })\n    })\n  }\n\n  isAPIAvailable(method: string): boolean {\n    return method in chrome.browserOS\n  }\n\n  getAvailableAPIs(): string[] {\n    return Object.keys(chrome.browserOS).filter(\n      (key) => typeof (chrome.browserOS as any)[key] === 'function',\n    )\n  }\n}\n\n/** @public */\nexport const getBrowserOSAdapter = () => BrowserOSAdapter.getInstance()\n","import { BrowserOSAdapter } from './adapter'\n\ntype VersionTuple = [number, number, number, number]\n\ntype FeatureConfig =\n  | { minVersion: string; maxVersion?: string }\n  | { minVersion?: string; maxVersion: string }\n\n/**\n * Features gated by BrowserOS version.\n * Add new features here with corresponding config in FEATURE_CONFIG.\n *\n * Note: In development mode, all features are enabled regardless of version.\n * @public\n */\nexport enum Feature {\n  // support for OpenAI-compatible provider\n  OPENAI_COMPATIBLE_SUPPORT = 'OPENAI_COMPATIBLE_SUPPORT',\n  // Managed MCP servers integration\n  MANAGED_MCP_SUPPORT = 'MANAGED_MCP_SUPPORT',\n}\n\n/**\n * Version requirements for each feature.\n * - minVersion: feature enabled when OS >= this version\n * - maxVersion: feature enabled when OS < this version (for deprecation)\n *\n * TypeScript enforces that every Feature has a config entry.\n * Note: In development mode, all features are enabled regardless of version.\n */\nconst FEATURE_CONFIG: { [K in Feature]: FeatureConfig } = {\n  [Feature.OPENAI_COMPATIBLE_SUPPORT]: { minVersion: '0.33.0.1' },\n  [Feature.MANAGED_MCP_SUPPORT]: { minVersion: '0.34.0.0' },\n}\n\nfunction parseVersion(version: string): VersionTuple {\n  const parts = version.split('.').map(Number)\n  if (parts.length !== 4 || parts.some(Number.isNaN)) {\n    throw new Error(`Invalid version format: ${version}`)\n  }\n  return parts as VersionTuple\n}\n\nfunction compareVersions(a: VersionTuple, b: VersionTuple): number {\n  for (let i = 0; i < 4; i++) {\n    if (a[i] < b[i]) return -1\n    if (a[i] > b[i]) return 1\n  }\n  return 0\n}\n\nlet osVersion: VersionTuple | null = null\nlet initialized = false\n\n/**\n * Version-gated feature capabilities.\n * @public\n */\nexport const Capabilities = {\n  async initialize(): Promise<void> {\n    if (initialized) return\n\n    try {\n      const adapter = BrowserOSAdapter.getInstance()\n      const versionStr = await adapter.getBrowserosVersion()\n\n      if (versionStr) {\n        osVersion = parseVersion(versionStr)\n      }\n    } catch {\n      // Version unknown - features will be disabled\n    }\n\n    initialized = true\n  },\n\n  // In development mode, all features are enabled to simplify testing\n  supports(feature: Feature): boolean {\n    if (import.meta.env.DEV) {\n      return true\n    }\n\n    if (!initialized) {\n      throw new Error(\n        'Capabilities.initialize() must be called before supports()',\n      )\n    }\n\n    if (!osVersion) {\n      return false\n    }\n\n    const config = FEATURE_CONFIG[feature]\n    if (!config) {\n      return false\n    }\n\n    if (config.minVersion) {\n      const minTuple = parseVersion(config.minVersion)\n      if (compareVersions(osVersion, minTuple) < 0) {\n        return false\n      }\n    }\n\n    if (config.maxVersion) {\n      const maxTuple = parseVersion(config.maxVersion)\n      if (compareVersions(osVersion, maxTuple) >= 0) {\n        return false\n      }\n    }\n\n    return true\n  },\n\n  getOsVersion(): string | null {\n    if (!osVersion) return null\n    return osVersion.join('.')\n  },\n\n  isInitialized(): boolean {\n    return initialized\n  },\n\n  reset(): void {\n    osVersion = null\n    initialized = false\n  },\n}\n","/** A special constant with type `never` */\nexport const NEVER = Object.freeze({\n    status: \"aborted\",\n});\nexport /*@__NO_SIDE_EFFECTS__*/ function $constructor(name, initializer, params) {\n    function init(inst, def) {\n        if (!inst._zod) {\n            Object.defineProperty(inst, \"_zod\", {\n                value: {\n                    def,\n                    constr: _,\n                    traits: new Set(),\n                },\n                enumerable: false,\n            });\n        }\n        if (inst._zod.traits.has(name)) {\n            return;\n        }\n        inst._zod.traits.add(name);\n        initializer(inst, def);\n        // support prototype modifications\n        const proto = _.prototype;\n        const keys = Object.keys(proto);\n        for (let i = 0; i < keys.length; i++) {\n            const k = keys[i];\n            if (!(k in inst)) {\n                inst[k] = proto[k].bind(inst);\n            }\n        }\n    }\n    // doesn't work if Parent has a constructor with arguments\n    const Parent = params?.Parent ?? Object;\n    class Definition extends Parent {\n    }\n    Object.defineProperty(Definition, \"name\", { value: name });\n    function _(def) {\n        var _a;\n        const inst = params?.Parent ? new Definition() : this;\n        init(inst, def);\n        (_a = inst._zod).deferred ?? (_a.deferred = []);\n        for (const fn of inst._zod.deferred) {\n            fn();\n        }\n        return inst;\n    }\n    Object.defineProperty(_, \"init\", { value: init });\n    Object.defineProperty(_, Symbol.hasInstance, {\n        value: (inst) => {\n            if (params?.Parent && inst instanceof params.Parent)\n                return true;\n            return inst?._zod?.traits?.has(name);\n        },\n    });\n    Object.defineProperty(_, \"name\", { value: name });\n    return _;\n}\n//////////////////////////////   UTILITIES   ///////////////////////////////////////\nexport const $brand = Symbol(\"zod_brand\");\nexport class $ZodAsyncError extends Error {\n    constructor() {\n        super(`Encountered Promise during synchronous parse. Use .parseAsync() instead.`);\n    }\n}\nexport class $ZodEncodeError extends Error {\n    constructor(name) {\n        super(`Encountered unidirectional transform during encode: ${name}`);\n        this.name = \"ZodEncodeError\";\n    }\n}\nexport const globalConfig = {};\nexport function config(newConfig) {\n    if (newConfig)\n        Object.assign(globalConfig, newConfig);\n    return globalConfig;\n}\n","// functions\nexport function assertEqual(val) {\n    return val;\n}\nexport function assertNotEqual(val) {\n    return val;\n}\nexport function assertIs(_arg) { }\nexport function assertNever(_x) {\n    throw new Error();\n}\nexport function assert(_) { }\nexport function getEnumValues(entries) {\n    const numericValues = Object.values(entries).filter((v) => typeof v === \"number\");\n    const values = Object.entries(entries)\n        .filter(([k, _]) => numericValues.indexOf(+k) === -1)\n        .map(([_, v]) => v);\n    return values;\n}\nexport function joinValues(array, separator = \"|\") {\n    return array.map((val) => stringifyPrimitive(val)).join(separator);\n}\nexport function jsonStringifyReplacer(_, value) {\n    if (typeof value === \"bigint\")\n        return value.toString();\n    return value;\n}\nexport function cached(getter) {\n    const set = false;\n    return {\n        get value() {\n            if (!set) {\n                const value = getter();\n                Object.defineProperty(this, \"value\", { value });\n                return value;\n            }\n            throw new Error(\"cached value already set\");\n        },\n    };\n}\nexport function nullish(input) {\n    return input === null || input === undefined;\n}\nexport function cleanRegex(source) {\n    const start = source.startsWith(\"^\") ? 1 : 0;\n    const end = source.endsWith(\"$\") ? source.length - 1 : source.length;\n    return source.slice(start, end);\n}\nexport function floatSafeRemainder(val, step) {\n    const valDecCount = (val.toString().split(\".\")[1] || \"\").length;\n    const stepString = step.toString();\n    let stepDecCount = (stepString.split(\".\")[1] || \"\").length;\n    if (stepDecCount === 0 && /\\d?e-\\d?/.test(stepString)) {\n        const match = stepString.match(/\\d?e-(\\d?)/);\n        if (match?.[1]) {\n            stepDecCount = Number.parseInt(match[1]);\n        }\n    }\n    const decCount = valDecCount > stepDecCount ? valDecCount : stepDecCount;\n    const valInt = Number.parseInt(val.toFixed(decCount).replace(\".\", \"\"));\n    const stepInt = Number.parseInt(step.toFixed(decCount).replace(\".\", \"\"));\n    return (valInt % stepInt) / 10 ** decCount;\n}\nconst EVALUATING = Symbol(\"evaluating\");\nexport function defineLazy(object, key, getter) {\n    let value = undefined;\n    Object.defineProperty(object, key, {\n        get() {\n            if (value === EVALUATING) {\n                // Circular reference detected, return undefined to break the cycle\n                return undefined;\n            }\n            if (value === undefined) {\n                value = EVALUATING;\n                value = getter();\n            }\n            return value;\n        },\n        set(v) {\n            Object.defineProperty(object, key, {\n                value: v,\n                // configurable: true,\n            });\n            // object[key] = v;\n        },\n        configurable: true,\n    });\n}\nexport function objectClone(obj) {\n    return Object.create(Object.getPrototypeOf(obj), Object.getOwnPropertyDescriptors(obj));\n}\nexport function assignProp(target, prop, value) {\n    Object.defineProperty(target, prop, {\n        value,\n        writable: true,\n        enumerable: true,\n        configurable: true,\n    });\n}\nexport function mergeDefs(...defs) {\n    const mergedDescriptors = {};\n    for (const def of defs) {\n        const descriptors = Object.getOwnPropertyDescriptors(def);\n        Object.assign(mergedDescriptors, descriptors);\n    }\n    return Object.defineProperties({}, mergedDescriptors);\n}\nexport function cloneDef(schema) {\n    return mergeDefs(schema._zod.def);\n}\nexport function getElementAtPath(obj, path) {\n    if (!path)\n        return obj;\n    return path.reduce((acc, key) => acc?.[key], obj);\n}\nexport function promiseAllObject(promisesObj) {\n    const keys = Object.keys(promisesObj);\n    const promises = keys.map((key) => promisesObj[key]);\n    return Promise.all(promises).then((results) => {\n        const resolvedObj = {};\n        for (let i = 0; i < keys.length; i++) {\n            resolvedObj[keys[i]] = results[i];\n        }\n        return resolvedObj;\n    });\n}\nexport function randomString(length = 10) {\n    const chars = \"abcdefghijklmnopqrstuvwxyz\";\n    let str = \"\";\n    for (let i = 0; i < length; i++) {\n        str += chars[Math.floor(Math.random() * chars.length)];\n    }\n    return str;\n}\nexport function esc(str) {\n    return JSON.stringify(str);\n}\nexport function slugify(input) {\n    return input\n        .toLowerCase()\n        .trim()\n        .replace(/[^\\w\\s-]/g, \"\")\n        .replace(/[\\s_-]+/g, \"-\")\n        .replace(/^-+|-+$/g, \"\");\n}\nexport const captureStackTrace = (\"captureStackTrace\" in Error ? Error.captureStackTrace : (..._args) => { });\nexport function isObject(data) {\n    return typeof data === \"object\" && data !== null && !Array.isArray(data);\n}\nexport const allowsEval = cached(() => {\n    // @ts-ignore\n    if (typeof navigator !== \"undefined\" && navigator?.userAgent?.includes(\"Cloudflare\")) {\n        return false;\n    }\n    try {\n        const F = Function;\n        new F(\"\");\n        return true;\n    }\n    catch (_) {\n        return false;\n    }\n});\nexport function isPlainObject(o) {\n    if (isObject(o) === false)\n        return false;\n    // modified constructor\n    const ctor = o.constructor;\n    if (ctor === undefined)\n        return true;\n    if (typeof ctor !== \"function\")\n        return true;\n    // modified prototype\n    const prot = ctor.prototype;\n    if (isObject(prot) === false)\n        return false;\n    // ctor doesn't have static `isPrototypeOf`\n    if (Object.prototype.hasOwnProperty.call(prot, \"isPrototypeOf\") === false) {\n        return false;\n    }\n    return true;\n}\nexport function shallowClone(o) {\n    if (isPlainObject(o))\n        return { ...o };\n    if (Array.isArray(o))\n        return [...o];\n    return o;\n}\nexport function numKeys(data) {\n    let keyCount = 0;\n    for (const key in data) {\n        if (Object.prototype.hasOwnProperty.call(data, key)) {\n            keyCount++;\n        }\n    }\n    return keyCount;\n}\nexport const getParsedType = (data) => {\n    const t = typeof data;\n    switch (t) {\n        case \"undefined\":\n            return \"undefined\";\n        case \"string\":\n            return \"string\";\n        case \"number\":\n            return Number.isNaN(data) ? \"nan\" : \"number\";\n        case \"boolean\":\n            return \"boolean\";\n        case \"function\":\n            return \"function\";\n        case \"bigint\":\n            return \"bigint\";\n        case \"symbol\":\n            return \"symbol\";\n        case \"object\":\n            if (Array.isArray(data)) {\n                return \"array\";\n            }\n            if (data === null) {\n                return \"null\";\n            }\n            if (data.then && typeof data.then === \"function\" && data.catch && typeof data.catch === \"function\") {\n                return \"promise\";\n            }\n            if (typeof Map !== \"undefined\" && data instanceof Map) {\n                return \"map\";\n            }\n            if (typeof Set !== \"undefined\" && data instanceof Set) {\n                return \"set\";\n            }\n            if (typeof Date !== \"undefined\" && data instanceof Date) {\n                return \"date\";\n            }\n            // @ts-ignore\n            if (typeof File !== \"undefined\" && data instanceof File) {\n                return \"file\";\n            }\n            return \"object\";\n        default:\n            throw new Error(`Unknown data type: ${t}`);\n    }\n};\nexport const propertyKeyTypes = new Set([\"string\", \"number\", \"symbol\"]);\nexport const primitiveTypes = new Set([\"string\", \"number\", \"bigint\", \"boolean\", \"symbol\", \"undefined\"]);\nexport function escapeRegex(str) {\n    return str.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\");\n}\n// zod-specific utils\nexport function clone(inst, def, params) {\n    const cl = new inst._zod.constr(def ?? inst._zod.def);\n    if (!def || params?.parent)\n        cl._zod.parent = inst;\n    return cl;\n}\nexport function normalizeParams(_params) {\n    const params = _params;\n    if (!params)\n        return {};\n    if (typeof params === \"string\")\n        return { error: () => params };\n    if (params?.message !== undefined) {\n        if (params?.error !== undefined)\n            throw new Error(\"Cannot specify both `message` and `error` params\");\n        params.error = params.message;\n    }\n    delete params.message;\n    if (typeof params.error === \"string\")\n        return { ...params, error: () => params.error };\n    return params;\n}\nexport function createTransparentProxy(getter) {\n    let target;\n    return new Proxy({}, {\n        get(_, prop, receiver) {\n            target ?? (target = getter());\n            return Reflect.get(target, prop, receiver);\n        },\n        set(_, prop, value, receiver) {\n            target ?? (target = getter());\n            return Reflect.set(target, prop, value, receiver);\n        },\n        has(_, prop) {\n            target ?? (target = getter());\n            return Reflect.has(target, prop);\n        },\n        deleteProperty(_, prop) {\n            target ?? (target = getter());\n            return Reflect.deleteProperty(target, prop);\n        },\n        ownKeys(_) {\n            target ?? (target = getter());\n            return Reflect.ownKeys(target);\n        },\n        getOwnPropertyDescriptor(_, prop) {\n            target ?? (target = getter());\n            return Reflect.getOwnPropertyDescriptor(target, prop);\n        },\n        defineProperty(_, prop, descriptor) {\n            target ?? (target = getter());\n            return Reflect.defineProperty(target, prop, descriptor);\n        },\n    });\n}\nexport function stringifyPrimitive(value) {\n    if (typeof value === \"bigint\")\n        return value.toString() + \"n\";\n    if (typeof value === \"string\")\n        return `\"${value}\"`;\n    return `${value}`;\n}\nexport function optionalKeys(shape) {\n    return Object.keys(shape).filter((k) => {\n        return shape[k]._zod.optin === \"optional\" && shape[k]._zod.optout === \"optional\";\n    });\n}\nexport const NUMBER_FORMAT_RANGES = {\n    safeint: [Number.MIN_SAFE_INTEGER, Number.MAX_SAFE_INTEGER],\n    int32: [-2147483648, 2147483647],\n    uint32: [0, 4294967295],\n    float32: [-3.4028234663852886e38, 3.4028234663852886e38],\n    float64: [-Number.MAX_VALUE, Number.MAX_VALUE],\n};\nexport const BIGINT_FORMAT_RANGES = {\n    int64: [/* @__PURE__*/ BigInt(\"-9223372036854775808\"), /* @__PURE__*/ BigInt(\"9223372036854775807\")],\n    uint64: [/* @__PURE__*/ BigInt(0), /* @__PURE__*/ BigInt(\"18446744073709551615\")],\n};\nexport function pick(schema, mask) {\n    const currDef = schema._zod.def;\n    const def = mergeDefs(schema._zod.def, {\n        get shape() {\n            const newShape = {};\n            for (const key in mask) {\n                if (!(key in currDef.shape)) {\n                    throw new Error(`Unrecognized key: \"${key}\"`);\n                }\n                if (!mask[key])\n                    continue;\n                newShape[key] = currDef.shape[key];\n            }\n            assignProp(this, \"shape\", newShape); // self-caching\n            return newShape;\n        },\n        checks: [],\n    });\n    return clone(schema, def);\n}\nexport function omit(schema, mask) {\n    const currDef = schema._zod.def;\n    const def = mergeDefs(schema._zod.def, {\n        get shape() {\n            const newShape = { ...schema._zod.def.shape };\n            for (const key in mask) {\n                if (!(key in currDef.shape)) {\n                    throw new Error(`Unrecognized key: \"${key}\"`);\n                }\n                if (!mask[key])\n                    continue;\n                delete newShape[key];\n            }\n            assignProp(this, \"shape\", newShape); // self-caching\n            return newShape;\n        },\n        checks: [],\n    });\n    return clone(schema, def);\n}\nexport function extend(schema, shape) {\n    if (!isPlainObject(shape)) {\n        throw new Error(\"Invalid input to extend: expected a plain object\");\n    }\n    const checks = schema._zod.def.checks;\n    const hasChecks = checks && checks.length > 0;\n    if (hasChecks) {\n        throw new Error(\"Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.\");\n    }\n    const def = mergeDefs(schema._zod.def, {\n        get shape() {\n            const _shape = { ...schema._zod.def.shape, ...shape };\n            assignProp(this, \"shape\", _shape); // self-caching\n            return _shape;\n        },\n        checks: [],\n    });\n    return clone(schema, def);\n}\nexport function safeExtend(schema, shape) {\n    if (!isPlainObject(shape)) {\n        throw new Error(\"Invalid input to safeExtend: expected a plain object\");\n    }\n    const def = {\n        ...schema._zod.def,\n        get shape() {\n            const _shape = { ...schema._zod.def.shape, ...shape };\n            assignProp(this, \"shape\", _shape); // self-caching\n            return _shape;\n        },\n        checks: schema._zod.def.checks,\n    };\n    return clone(schema, def);\n}\nexport function merge(a, b) {\n    const def = mergeDefs(a._zod.def, {\n        get shape() {\n            const _shape = { ...a._zod.def.shape, ...b._zod.def.shape };\n            assignProp(this, \"shape\", _shape); // self-caching\n            return _shape;\n        },\n        get catchall() {\n            return b._zod.def.catchall;\n        },\n        checks: [], // delete existing checks\n    });\n    return clone(a, def);\n}\nexport function partial(Class, schema, mask) {\n    const def = mergeDefs(schema._zod.def, {\n        get shape() {\n            const oldShape = schema._zod.def.shape;\n            const shape = { ...oldShape };\n            if (mask) {\n                for (const key in mask) {\n                    if (!(key in oldShape)) {\n                        throw new Error(`Unrecognized key: \"${key}\"`);\n                    }\n                    if (!mask[key])\n                        continue;\n                    // if (oldShape[key]!._zod.optin === \"optional\") continue;\n                    shape[key] = Class\n                        ? new Class({\n                            type: \"optional\",\n                            innerType: oldShape[key],\n                        })\n                        : oldShape[key];\n                }\n            }\n            else {\n                for (const key in oldShape) {\n                    // if (oldShape[key]!._zod.optin === \"optional\") continue;\n                    shape[key] = Class\n                        ? new Class({\n                            type: \"optional\",\n                            innerType: oldShape[key],\n                        })\n                        : oldShape[key];\n                }\n            }\n            assignProp(this, \"shape\", shape); // self-caching\n            return shape;\n        },\n        checks: [],\n    });\n    return clone(schema, def);\n}\nexport function required(Class, schema, mask) {\n    const def = mergeDefs(schema._zod.def, {\n        get shape() {\n            const oldShape = schema._zod.def.shape;\n            const shape = { ...oldShape };\n            if (mask) {\n                for (const key in mask) {\n                    if (!(key in shape)) {\n                        throw new Error(`Unrecognized key: \"${key}\"`);\n                    }\n                    if (!mask[key])\n                        continue;\n                    // overwrite with non-optional\n                    shape[key] = new Class({\n                        type: \"nonoptional\",\n                        innerType: oldShape[key],\n                    });\n                }\n            }\n            else {\n                for (const key in oldShape) {\n                    // overwrite with non-optional\n                    shape[key] = new Class({\n                        type: \"nonoptional\",\n                        innerType: oldShape[key],\n                    });\n                }\n            }\n            assignProp(this, \"shape\", shape); // self-caching\n            return shape;\n        },\n        checks: [],\n    });\n    return clone(schema, def);\n}\n// invalid_type | too_big | too_small | invalid_format | not_multiple_of | unrecognized_keys | invalid_union | invalid_key | invalid_element | invalid_value | custom\nexport function aborted(x, startIndex = 0) {\n    if (x.aborted === true)\n        return true;\n    for (let i = startIndex; i < x.issues.length; i++) {\n        if (x.issues[i]?.continue !== true) {\n            return true;\n        }\n    }\n    return false;\n}\nexport function prefixIssues(path, issues) {\n    return issues.map((iss) => {\n        var _a;\n        (_a = iss).path ?? (_a.path = []);\n        iss.path.unshift(path);\n        return iss;\n    });\n}\nexport function unwrapMessage(message) {\n    return typeof message === \"string\" ? message : message?.message;\n}\nexport function finalizeIssue(iss, ctx, config) {\n    const full = { ...iss, path: iss.path ?? [] };\n    // for backwards compatibility\n    if (!iss.message) {\n        const message = unwrapMessage(iss.inst?._zod.def?.error?.(iss)) ??\n            unwrapMessage(ctx?.error?.(iss)) ??\n            unwrapMessage(config.customError?.(iss)) ??\n            unwrapMessage(config.localeError?.(iss)) ??\n            \"Invalid input\";\n        full.message = message;\n    }\n    // delete (full as any).def;\n    delete full.inst;\n    delete full.continue;\n    if (!ctx?.reportInput) {\n        delete full.input;\n    }\n    return full;\n}\nexport function getSizableOrigin(input) {\n    if (input instanceof Set)\n        return \"set\";\n    if (input instanceof Map)\n        return \"map\";\n    // @ts-ignore\n    if (input instanceof File)\n        return \"file\";\n    return \"unknown\";\n}\nexport function getLengthableOrigin(input) {\n    if (Array.isArray(input))\n        return \"array\";\n    if (typeof input === \"string\")\n        return \"string\";\n    return \"unknown\";\n}\nexport function issue(...args) {\n    const [iss, input, inst] = args;\n    if (typeof iss === \"string\") {\n        return {\n            message: iss,\n            code: \"custom\",\n            input,\n            inst,\n        };\n    }\n    return { ...iss };\n}\nexport function cleanEnum(obj) {\n    return Object.entries(obj)\n        .filter(([k, _]) => {\n        // return true if NaN, meaning it's not a number, thus a string key\n        return Number.isNaN(Number.parseInt(k, 10));\n    })\n        .map((el) => el[1]);\n}\n// Codec utility functions\nexport function base64ToUint8Array(base64) {\n    const binaryString = atob(base64);\n    const bytes = new Uint8Array(binaryString.length);\n    for (let i = 0; i < binaryString.length; i++) {\n        bytes[i] = binaryString.charCodeAt(i);\n    }\n    return bytes;\n}\nexport function uint8ArrayToBase64(bytes) {\n    let binaryString = \"\";\n    for (let i = 0; i < bytes.length; i++) {\n        binaryString += String.fromCharCode(bytes[i]);\n    }\n    return btoa(binaryString);\n}\nexport function base64urlToUint8Array(base64url) {\n    const base64 = base64url.replace(/-/g, \"+\").replace(/_/g, \"/\");\n    const padding = \"=\".repeat((4 - (base64.length % 4)) % 4);\n    return base64ToUint8Array(base64 + padding);\n}\nexport function uint8ArrayToBase64url(bytes) {\n    return uint8ArrayToBase64(bytes).replace(/\\+/g, \"-\").replace(/\\//g, \"_\").replace(/=/g, \"\");\n}\nexport function hexToUint8Array(hex) {\n    const cleanHex = hex.replace(/^0x/, \"\");\n    if (cleanHex.length % 2 !== 0) {\n        throw new Error(\"Invalid hex string length\");\n    }\n    const bytes = new Uint8Array(cleanHex.length / 2);\n    for (let i = 0; i < cleanHex.length; i += 2) {\n        bytes[i / 2] = Number.parseInt(cleanHex.slice(i, i + 2), 16);\n    }\n    return bytes;\n}\nexport function uint8ArrayToHex(bytes) {\n    return Array.from(bytes)\n        .map((b) => b.toString(16).padStart(2, \"0\"))\n        .join(\"\");\n}\n// instanceof\nexport class Class {\n    constructor(..._args) { }\n}\n","import { $constructor } from \"./core.js\";\nimport * as util from \"./util.js\";\nconst initializer = (inst, def) => {\n    inst.name = \"$ZodError\";\n    Object.defineProperty(inst, \"_zod\", {\n        value: inst._zod,\n        enumerable: false,\n    });\n    Object.defineProperty(inst, \"issues\", {\n        value: def,\n        enumerable: false,\n    });\n    inst.message = JSON.stringify(def, util.jsonStringifyReplacer, 2);\n    Object.defineProperty(inst, \"toString\", {\n        value: () => inst.message,\n        enumerable: false,\n    });\n};\nexport const $ZodError = $constructor(\"$ZodError\", initializer);\nexport const $ZodRealError = $constructor(\"$ZodError\", initializer, { Parent: Error });\nexport function flattenError(error, mapper = (issue) => issue.message) {\n    const fieldErrors = {};\n    const formErrors = [];\n    for (const sub of error.issues) {\n        if (sub.path.length > 0) {\n            fieldErrors[sub.path[0]] = fieldErrors[sub.path[0]] || [];\n            fieldErrors[sub.path[0]].push(mapper(sub));\n        }\n        else {\n            formErrors.push(mapper(sub));\n        }\n    }\n    return { formErrors, fieldErrors };\n}\nexport function formatError(error, mapper = (issue) => issue.message) {\n    const fieldErrors = { _errors: [] };\n    const processError = (error) => {\n        for (const issue of error.issues) {\n            if (issue.code === \"invalid_union\" && issue.errors.length) {\n                issue.errors.map((issues) => processError({ issues }));\n            }\n            else if (issue.code === \"invalid_key\") {\n                processError({ issues: issue.issues });\n            }\n            else if (issue.code === \"invalid_element\") {\n                processError({ issues: issue.issues });\n            }\n            else if (issue.path.length === 0) {\n                fieldErrors._errors.push(mapper(issue));\n            }\n            else {\n                let curr = fieldErrors;\n                let i = 0;\n                while (i < issue.path.length) {\n                    const el = issue.path[i];\n                    const terminal = i === issue.path.length - 1;\n                    if (!terminal) {\n                        curr[el] = curr[el] || { _errors: [] };\n                    }\n                    else {\n                        curr[el] = curr[el] || { _errors: [] };\n                        curr[el]._errors.push(mapper(issue));\n                    }\n                    curr = curr[el];\n                    i++;\n                }\n            }\n        }\n    };\n    processError(error);\n    return fieldErrors;\n}\nexport function treeifyError(error, mapper = (issue) => issue.message) {\n    const result = { errors: [] };\n    const processError = (error, path = []) => {\n        var _a, _b;\n        for (const issue of error.issues) {\n            if (issue.code === \"invalid_union\" && issue.errors.length) {\n                // regular union error\n                issue.errors.map((issues) => processError({ issues }, issue.path));\n            }\n            else if (issue.code === \"invalid_key\") {\n                processError({ issues: issue.issues }, issue.path);\n            }\n            else if (issue.code === \"invalid_element\") {\n                processError({ issues: issue.issues }, issue.path);\n            }\n            else {\n                const fullpath = [...path, ...issue.path];\n                if (fullpath.length === 0) {\n                    result.errors.push(mapper(issue));\n                    continue;\n                }\n                let curr = result;\n                let i = 0;\n                while (i < fullpath.length) {\n                    const el = fullpath[i];\n                    const terminal = i === fullpath.length - 1;\n                    if (typeof el === \"string\") {\n                        curr.properties ?? (curr.properties = {});\n                        (_a = curr.properties)[el] ?? (_a[el] = { errors: [] });\n                        curr = curr.properties[el];\n                    }\n                    else {\n                        curr.items ?? (curr.items = []);\n                        (_b = curr.items)[el] ?? (_b[el] = { errors: [] });\n                        curr = curr.items[el];\n                    }\n                    if (terminal) {\n                        curr.errors.push(mapper(issue));\n                    }\n                    i++;\n                }\n            }\n        }\n    };\n    processError(error);\n    return result;\n}\n/** Format a ZodError as a human-readable string in the following form.\n *\n * From\n *\n * ```ts\n * ZodError {\n *   issues: [\n *     {\n *       expected: 'string',\n *       code: 'invalid_type',\n *       path: [ 'username' ],\n *       message: 'Invalid input: expected string'\n *     },\n *     {\n *       expected: 'number',\n *       code: 'invalid_type',\n *       path: [ 'favoriteNumbers', 1 ],\n *       message: 'Invalid input: expected number'\n *     }\n *   ];\n * }\n * ```\n *\n * to\n *\n * ```\n * username\n *    Expected number, received string at \"username\n * favoriteNumbers[0]\n *    Invalid input: expected number\n * ```\n */\nexport function toDotPath(_path) {\n    const segs = [];\n    const path = _path.map((seg) => (typeof seg === \"object\" ? seg.key : seg));\n    for (const seg of path) {\n        if (typeof seg === \"number\")\n            segs.push(`[${seg}]`);\n        else if (typeof seg === \"symbol\")\n            segs.push(`[${JSON.stringify(String(seg))}]`);\n        else if (/[^\\w$]/.test(seg))\n            segs.push(`[${JSON.stringify(seg)}]`);\n        else {\n            if (segs.length)\n                segs.push(\".\");\n            segs.push(seg);\n        }\n    }\n    return segs.join(\"\");\n}\nexport function prettifyError(error) {\n    const lines = [];\n    // sort by path length\n    const issues = [...error.issues].sort((a, b) => (a.path ?? []).length - (b.path ?? []).length);\n    // Process each issue\n    for (const issue of issues) {\n        lines.push(` ${issue.message}`);\n        if (issue.path?.length)\n            lines.push(`   at ${toDotPath(issue.path)}`);\n    }\n    // Convert Map to formatted string\n    return lines.join(\"\\n\");\n}\n","import * as core from \"./core.js\";\nimport * as errors from \"./errors.js\";\nimport * as util from \"./util.js\";\nexport const _parse = (_Err) => (schema, value, _ctx, _params) => {\n    const ctx = _ctx ? Object.assign(_ctx, { async: false }) : { async: false };\n    const result = schema._zod.run({ value, issues: [] }, ctx);\n    if (result instanceof Promise) {\n        throw new core.$ZodAsyncError();\n    }\n    if (result.issues.length) {\n        const e = new (_params?.Err ?? _Err)(result.issues.map((iss) => util.finalizeIssue(iss, ctx, core.config())));\n        util.captureStackTrace(e, _params?.callee);\n        throw e;\n    }\n    return result.value;\n};\nexport const parse = /* @__PURE__*/ _parse(errors.$ZodRealError);\nexport const _parseAsync = (_Err) => async (schema, value, _ctx, params) => {\n    const ctx = _ctx ? Object.assign(_ctx, { async: true }) : { async: true };\n    let result = schema._zod.run({ value, issues: [] }, ctx);\n    if (result instanceof Promise)\n        result = await result;\n    if (result.issues.length) {\n        const e = new (params?.Err ?? _Err)(result.issues.map((iss) => util.finalizeIssue(iss, ctx, core.config())));\n        util.captureStackTrace(e, params?.callee);\n        throw e;\n    }\n    return result.value;\n};\nexport const parseAsync = /* @__PURE__*/ _parseAsync(errors.$ZodRealError);\nexport const _safeParse = (_Err) => (schema, value, _ctx) => {\n    const ctx = _ctx ? { ..._ctx, async: false } : { async: false };\n    const result = schema._zod.run({ value, issues: [] }, ctx);\n    if (result instanceof Promise) {\n        throw new core.$ZodAsyncError();\n    }\n    return result.issues.length\n        ? {\n            success: false,\n            error: new (_Err ?? errors.$ZodError)(result.issues.map((iss) => util.finalizeIssue(iss, ctx, core.config()))),\n        }\n        : { success: true, data: result.value };\n};\nexport const safeParse = /* @__PURE__*/ _safeParse(errors.$ZodRealError);\nexport const _safeParseAsync = (_Err) => async (schema, value, _ctx) => {\n    const ctx = _ctx ? Object.assign(_ctx, { async: true }) : { async: true };\n    let result = schema._zod.run({ value, issues: [] }, ctx);\n    if (result instanceof Promise)\n        result = await result;\n    return result.issues.length\n        ? {\n            success: false,\n            error: new _Err(result.issues.map((iss) => util.finalizeIssue(iss, ctx, core.config()))),\n        }\n        : { success: true, data: result.value };\n};\nexport const safeParseAsync = /* @__PURE__*/ _safeParseAsync(errors.$ZodRealError);\nexport const _encode = (_Err) => (schema, value, _ctx) => {\n    const ctx = _ctx ? Object.assign(_ctx, { direction: \"backward\" }) : { direction: \"backward\" };\n    return _parse(_Err)(schema, value, ctx);\n};\nexport const encode = /* @__PURE__*/ _encode(errors.$ZodRealError);\nexport const _decode = (_Err) => (schema, value, _ctx) => {\n    return _parse(_Err)(schema, value, _ctx);\n};\nexport const decode = /* @__PURE__*/ _decode(errors.$ZodRealError);\nexport const _encodeAsync = (_Err) => async (schema, value, _ctx) => {\n    const ctx = _ctx ? Object.assign(_ctx, { direction: \"backward\" }) : { direction: \"backward\" };\n    return _parseAsync(_Err)(schema, value, ctx);\n};\nexport const encodeAsync = /* @__PURE__*/ _encodeAsync(errors.$ZodRealError);\nexport const _decodeAsync = (_Err) => async (schema, value, _ctx) => {\n    return _parseAsync(_Err)(schema, value, _ctx);\n};\nexport const decodeAsync = /* @__PURE__*/ _decodeAsync(errors.$ZodRealError);\nexport const _safeEncode = (_Err) => (schema, value, _ctx) => {\n    const ctx = _ctx ? Object.assign(_ctx, { direction: \"backward\" }) : { direction: \"backward\" };\n    return _safeParse(_Err)(schema, value, ctx);\n};\nexport const safeEncode = /* @__PURE__*/ _safeEncode(errors.$ZodRealError);\nexport const _safeDecode = (_Err) => (schema, value, _ctx) => {\n    return _safeParse(_Err)(schema, value, _ctx);\n};\nexport const safeDecode = /* @__PURE__*/ _safeDecode(errors.$ZodRealError);\nexport const _safeEncodeAsync = (_Err) => async (schema, value, _ctx) => {\n    const ctx = _ctx ? Object.assign(_ctx, { direction: \"backward\" }) : { direction: \"backward\" };\n    return _safeParseAsync(_Err)(schema, value, ctx);\n};\nexport const safeEncodeAsync = /* @__PURE__*/ _safeEncodeAsync(errors.$ZodRealError);\nexport const _safeDecodeAsync = (_Err) => async (schema, value, _ctx) => {\n    return _safeParseAsync(_Err)(schema, value, _ctx);\n};\nexport const safeDecodeAsync = /* @__PURE__*/ _safeDecodeAsync(errors.$ZodRealError);\n","import * as util from \"./util.js\";\nexport const cuid = /^[cC][^\\s-]{8,}$/;\nexport const cuid2 = /^[0-9a-z]+$/;\nexport const ulid = /^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/;\nexport const xid = /^[0-9a-vA-V]{20}$/;\nexport const ksuid = /^[A-Za-z0-9]{27}$/;\nexport const nanoid = /^[a-zA-Z0-9_-]{21}$/;\n/** ISO 8601-1 duration regex. Does not support the 8601-2 extensions like negative durations or fractional/negative components. */\nexport const duration = /^P(?:(\\d+W)|(?!.*W)(?=\\d|T\\d)(\\d+Y)?(\\d+M)?(\\d+D)?(T(?=\\d)(\\d+H)?(\\d+M)?(\\d+([.,]\\d+)?S)?)?)$/;\n/** Implements ISO 8601-2 extensions like explicit +- prefixes, mixing weeks with other units, and fractional/negative components. */\nexport const extendedDuration = /^[-+]?P(?!$)(?:(?:[-+]?\\d+Y)|(?:[-+]?\\d+[.,]\\d+Y$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:(?:[-+]?\\d+W)|(?:[-+]?\\d+[.,]\\d+W$))?(?:(?:[-+]?\\d+D)|(?:[-+]?\\d+[.,]\\d+D$))?(?:T(?=[\\d+-])(?:(?:[-+]?\\d+H)|(?:[-+]?\\d+[.,]\\d+H$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:[-+]?\\d+(?:[.,]\\d+)?S)?)??$/;\n/** A regex for any UUID-like identifier: 8-4-4-4-12 hex pattern */\nexport const guid = /^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/;\n/** Returns a regex for validating an RFC 9562/4122 UUID.\n *\n * @param version Optionally specify a version 1-8. If no version is specified, all versions are supported. */\nexport const uuid = (version) => {\n    if (!version)\n        return /^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/;\n    return new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${version}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`);\n};\nexport const uuid4 = /*@__PURE__*/ uuid(4);\nexport const uuid6 = /*@__PURE__*/ uuid(6);\nexport const uuid7 = /*@__PURE__*/ uuid(7);\n/** Practical email validation */\nexport const email = /^(?!\\.)(?!.*\\.\\.)([A-Za-z0-9_'+\\-\\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\\-]*\\.)+[A-Za-z]{2,}$/;\n/** Equivalent to the HTML5 input[type=email] validation implemented by browsers. Source: https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/email */\nexport const html5Email = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;\n/** The classic emailregex.com regex for RFC 5322-compliant emails */\nexport const rfc5322Email = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n/** A loose regex that allows Unicode characters, enforces length limits, and that's about it. */\nexport const unicodeEmail = /^[^\\s@\"]{1,64}@[^\\s@]{1,255}$/u;\nexport const idnEmail = unicodeEmail;\nexport const browserEmail = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;\n// from https://thekevinscott.com/emojis-in-javascript/#writing-a-regular-expression\nconst _emoji = `^(\\\\p{Extended_Pictographic}|\\\\p{Emoji_Component})+$`;\nexport function emoji() {\n    return new RegExp(_emoji, \"u\");\n}\nexport const ipv4 = /^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/;\nexport const ipv6 = /^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/;\nexport const mac = (delimiter) => {\n    const escapedDelim = util.escapeRegex(delimiter ?? \":\");\n    return new RegExp(`^(?:[0-9A-F]{2}${escapedDelim}){5}[0-9A-F]{2}$|^(?:[0-9a-f]{2}${escapedDelim}){5}[0-9a-f]{2}$`);\n};\nexport const cidrv4 = /^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\/([0-9]|[1-2][0-9]|3[0-2])$/;\nexport const cidrv6 = /^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/;\n// https://stackoverflow.com/questions/7860392/determine-if-string-is-in-base64-using-javascript\nexport const base64 = /^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/;\nexport const base64url = /^[A-Za-z0-9_-]*$/;\n// based on https://stackoverflow.com/questions/106179/regular-expression-to-match-dns-hostname-or-ip-address\n// export const hostname: RegExp = /^([a-zA-Z0-9-]+\\.)*[a-zA-Z0-9-]+$/;\nexport const hostname = /^(?=.{1,253}\\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\\.?$/;\nexport const domain = /^([a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\\.)+[a-zA-Z]{2,}$/;\n// https://blog.stevenlevithan.com/archives/validate-phone-number#r4-3 (regex sans spaces)\nexport const e164 = /^\\+(?:[0-9]){6,14}[0-9]$/;\n// const dateSource = `((\\\\d\\\\d[2468][048]|\\\\d\\\\d[13579][26]|\\\\d\\\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\\\d|30)|(02)-(0[1-9]|1\\\\d|2[0-8])))`;\nconst dateSource = `(?:(?:\\\\d\\\\d[2468][048]|\\\\d\\\\d[13579][26]|\\\\d\\\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\\\d|30)|(?:02)-(?:0[1-9]|1\\\\d|2[0-8])))`;\nexport const date = /*@__PURE__*/ new RegExp(`^${dateSource}$`);\nfunction timeSource(args) {\n    const hhmm = `(?:[01]\\\\d|2[0-3]):[0-5]\\\\d`;\n    const regex = typeof args.precision === \"number\"\n        ? args.precision === -1\n            ? `${hhmm}`\n            : args.precision === 0\n                ? `${hhmm}:[0-5]\\\\d`\n                : `${hhmm}:[0-5]\\\\d\\\\.\\\\d{${args.precision}}`\n        : `${hhmm}(?::[0-5]\\\\d(?:\\\\.\\\\d+)?)?`;\n    return regex;\n}\nexport function time(args) {\n    return new RegExp(`^${timeSource(args)}$`);\n}\n// Adapted from https://stackoverflow.com/a/3143231\nexport function datetime(args) {\n    const time = timeSource({ precision: args.precision });\n    const opts = [\"Z\"];\n    if (args.local)\n        opts.push(\"\");\n    // if (args.offset) opts.push(`([+-]\\\\d{2}:\\\\d{2})`);\n    if (args.offset)\n        opts.push(`([+-](?:[01]\\\\d|2[0-3]):[0-5]\\\\d)`);\n    const timeRegex = `${time}(?:${opts.join(\"|\")})`;\n    return new RegExp(`^${dateSource}T(?:${timeRegex})$`);\n}\nexport const string = (params) => {\n    const regex = params ? `[\\\\s\\\\S]{${params?.minimum ?? 0},${params?.maximum ?? \"\"}}` : `[\\\\s\\\\S]*`;\n    return new RegExp(`^${regex}$`);\n};\nexport const bigint = /^-?\\d+n?$/;\nexport const integer = /^-?\\d+$/;\nexport const number = /^-?\\d+(?:\\.\\d+)?/;\nexport const boolean = /^(?:true|false)$/i;\nconst _null = /^null$/i;\nexport { _null as null };\nconst _undefined = /^undefined$/i;\nexport { _undefined as undefined };\n// regex for string with no uppercase letters\nexport const lowercase = /^[^A-Z]*$/;\n// regex for string with no lowercase letters\nexport const uppercase = /^[^a-z]*$/;\n// regex for hexadecimal strings (any length)\nexport const hex = /^[0-9a-fA-F]*$/;\n// Hash regexes for different algorithms and encodings\n// Helper function to create base64 regex with exact length and padding\nfunction fixedBase64(bodyLength, padding) {\n    return new RegExp(`^[A-Za-z0-9+/]{${bodyLength}}${padding}$`);\n}\n// Helper function to create base64url regex with exact length (no padding)\nfunction fixedBase64url(length) {\n    return new RegExp(`^[A-Za-z0-9_-]{${length}}$`);\n}\n// MD5 (16 bytes): base64 = 24 chars total (22 + \"==\")\nexport const md5_hex = /^[0-9a-fA-F]{32}$/;\nexport const md5_base64 = /*@__PURE__*/ fixedBase64(22, \"==\");\nexport const md5_base64url = /*@__PURE__*/ fixedBase64url(22);\n// SHA1 (20 bytes): base64 = 28 chars total (27 + \"=\")\nexport const sha1_hex = /^[0-9a-fA-F]{40}$/;\nexport const sha1_base64 = /*@__PURE__*/ fixedBase64(27, \"=\");\nexport const sha1_base64url = /*@__PURE__*/ fixedBase64url(27);\n// SHA256 (32 bytes): base64 = 44 chars total (43 + \"=\")\nexport const sha256_hex = /^[0-9a-fA-F]{64}$/;\nexport const sha256_base64 = /*@__PURE__*/ fixedBase64(43, \"=\");\nexport const sha256_base64url = /*@__PURE__*/ fixedBase64url(43);\n// SHA384 (48 bytes): base64 = 64 chars total (no padding)\nexport const sha384_hex = /^[0-9a-fA-F]{96}$/;\nexport const sha384_base64 = /*@__PURE__*/ fixedBase64(64, \"\");\nexport const sha384_base64url = /*@__PURE__*/ fixedBase64url(64);\n// SHA512 (64 bytes): base64 = 88 chars total (86 + \"==\")\nexport const sha512_hex = /^[0-9a-fA-F]{128}$/;\nexport const sha512_base64 = /*@__PURE__*/ fixedBase64(86, \"==\");\nexport const sha512_base64url = /*@__PURE__*/ fixedBase64url(86);\n","// import { $ZodType } from \"./schemas.js\";\nimport * as core from \"./core.js\";\nimport * as regexes from \"./regexes.js\";\nimport * as util from \"./util.js\";\nexport const $ZodCheck = /*@__PURE__*/ core.$constructor(\"$ZodCheck\", (inst, def) => {\n    var _a;\n    inst._zod ?? (inst._zod = {});\n    inst._zod.def = def;\n    (_a = inst._zod).onattach ?? (_a.onattach = []);\n});\nconst numericOriginMap = {\n    number: \"number\",\n    bigint: \"bigint\",\n    object: \"date\",\n};\nexport const $ZodCheckLessThan = /*@__PURE__*/ core.$constructor(\"$ZodCheckLessThan\", (inst, def) => {\n    $ZodCheck.init(inst, def);\n    const origin = numericOriginMap[typeof def.value];\n    inst._zod.onattach.push((inst) => {\n        const bag = inst._zod.bag;\n        const curr = (def.inclusive ? bag.maximum : bag.exclusiveMaximum) ?? Number.POSITIVE_INFINITY;\n        if (def.value < curr) {\n            if (def.inclusive)\n                bag.maximum = def.value;\n            else\n                bag.exclusiveMaximum = def.value;\n        }\n    });\n    inst._zod.check = (payload) => {\n        if (def.inclusive ? payload.value <= def.value : payload.value < def.value) {\n            return;\n        }\n        payload.issues.push({\n            origin,\n            code: \"too_big\",\n            maximum: def.value,\n            input: payload.value,\n            inclusive: def.inclusive,\n            inst,\n            continue: !def.abort,\n        });\n    };\n});\nexport const $ZodCheckGreaterThan = /*@__PURE__*/ core.$constructor(\"$ZodCheckGreaterThan\", (inst, def) => {\n    $ZodCheck.init(inst, def);\n    const origin = numericOriginMap[typeof def.value];\n    inst._zod.onattach.push((inst) => {\n        const bag = inst._zod.bag;\n        const curr = (def.inclusive ? bag.minimum : bag.exclusiveMinimum) ?? Number.NEGATIVE_INFINITY;\n        if (def.value > curr) {\n            if (def.inclusive)\n                bag.minimum = def.value;\n            else\n                bag.exclusiveMinimum = def.value;\n        }\n    });\n    inst._zod.check = (payload) => {\n        if (def.inclusive ? payload.value >= def.value : payload.value > def.value) {\n            return;\n        }\n        payload.issues.push({\n            origin,\n            code: \"too_small\",\n            minimum: def.value,\n            input: payload.value,\n            inclusive: def.inclusive,\n            inst,\n            continue: !def.abort,\n        });\n    };\n});\nexport const $ZodCheckMultipleOf = \n/*@__PURE__*/ core.$constructor(\"$ZodCheckMultipleOf\", (inst, def) => {\n    $ZodCheck.init(inst, def);\n    inst._zod.onattach.push((inst) => {\n        var _a;\n        (_a = inst._zod.bag).multipleOf ?? (_a.multipleOf = def.value);\n    });\n    inst._zod.check = (payload) => {\n        if (typeof payload.value !== typeof def.value)\n            throw new Error(\"Cannot mix number and bigint in multiple_of check.\");\n        const isMultiple = typeof payload.value === \"bigint\"\n            ? payload.value % def.value === BigInt(0)\n            : util.floatSafeRemainder(payload.value, def.value) === 0;\n        if (isMultiple)\n            return;\n        payload.issues.push({\n            origin: typeof payload.value,\n            code: \"not_multiple_of\",\n            divisor: def.value,\n            input: payload.value,\n            inst,\n            continue: !def.abort,\n        });\n    };\n});\nexport const $ZodCheckNumberFormat = /*@__PURE__*/ core.$constructor(\"$ZodCheckNumberFormat\", (inst, def) => {\n    $ZodCheck.init(inst, def); // no format checks\n    def.format = def.format || \"float64\";\n    const isInt = def.format?.includes(\"int\");\n    const origin = isInt ? \"int\" : \"number\";\n    const [minimum, maximum] = util.NUMBER_FORMAT_RANGES[def.format];\n    inst._zod.onattach.push((inst) => {\n        const bag = inst._zod.bag;\n        bag.format = def.format;\n        bag.minimum = minimum;\n        bag.maximum = maximum;\n        if (isInt)\n            bag.pattern = regexes.integer;\n    });\n    inst._zod.check = (payload) => {\n        const input = payload.value;\n        if (isInt) {\n            if (!Number.isInteger(input)) {\n                // invalid_format issue\n                // payload.issues.push({\n                //   expected: def.format,\n                //   format: def.format,\n                //   code: \"invalid_format\",\n                //   input,\n                //   inst,\n                // });\n                // invalid_type issue\n                payload.issues.push({\n                    expected: origin,\n                    format: def.format,\n                    code: \"invalid_type\",\n                    continue: false,\n                    input,\n                    inst,\n                });\n                return;\n                // not_multiple_of issue\n                // payload.issues.push({\n                //   code: \"not_multiple_of\",\n                //   origin: \"number\",\n                //   input,\n                //   inst,\n                //   divisor: 1,\n                // });\n            }\n            if (!Number.isSafeInteger(input)) {\n                if (input > 0) {\n                    // too_big\n                    payload.issues.push({\n                        input,\n                        code: \"too_big\",\n                        maximum: Number.MAX_SAFE_INTEGER,\n                        note: \"Integers must be within the safe integer range.\",\n                        inst,\n                        origin,\n                        continue: !def.abort,\n                    });\n                }\n                else {\n                    // too_small\n                    payload.issues.push({\n                        input,\n                        code: \"too_small\",\n                        minimum: Number.MIN_SAFE_INTEGER,\n                        note: \"Integers must be within the safe integer range.\",\n                        inst,\n                        origin,\n                        continue: !def.abort,\n                    });\n                }\n                return;\n            }\n        }\n        if (input < minimum) {\n            payload.issues.push({\n                origin: \"number\",\n                input,\n                code: \"too_small\",\n                minimum,\n                inclusive: true,\n                inst,\n                continue: !def.abort,\n            });\n        }\n        if (input > maximum) {\n            payload.issues.push({\n                origin: \"number\",\n                input,\n                code: \"too_big\",\n                maximum,\n                inst,\n            });\n        }\n    };\n});\nexport const $ZodCheckBigIntFormat = /*@__PURE__*/ core.$constructor(\"$ZodCheckBigIntFormat\", (inst, def) => {\n    $ZodCheck.init(inst, def); // no format checks\n    const [minimum, maximum] = util.BIGINT_FORMAT_RANGES[def.format];\n    inst._zod.onattach.push((inst) => {\n        const bag = inst._zod.bag;\n        bag.format = def.format;\n        bag.minimum = minimum;\n        bag.maximum = maximum;\n    });\n    inst._zod.check = (payload) => {\n        const input = payload.value;\n        if (input < minimum) {\n            payload.issues.push({\n                origin: \"bigint\",\n                input,\n                code: \"too_small\",\n                minimum: minimum,\n                inclusive: true,\n                inst,\n                continue: !def.abort,\n            });\n        }\n        if (input > maximum) {\n            payload.issues.push({\n                origin: \"bigint\",\n                input,\n                code: \"too_big\",\n                maximum,\n                inst,\n            });\n        }\n    };\n});\nexport const $ZodCheckMaxSize = /*@__PURE__*/ core.$constructor(\"$ZodCheckMaxSize\", (inst, def) => {\n    var _a;\n    $ZodCheck.init(inst, def);\n    (_a = inst._zod.def).when ?? (_a.when = (payload) => {\n        const val = payload.value;\n        return !util.nullish(val) && val.size !== undefined;\n    });\n    inst._zod.onattach.push((inst) => {\n        const curr = (inst._zod.bag.maximum ?? Number.POSITIVE_INFINITY);\n        if (def.maximum < curr)\n            inst._zod.bag.maximum = def.maximum;\n    });\n    inst._zod.check = (payload) => {\n        const input = payload.value;\n        const size = input.size;\n        if (size <= def.maximum)\n            return;\n        payload.issues.push({\n            origin: util.getSizableOrigin(input),\n            code: \"too_big\",\n            maximum: def.maximum,\n            inclusive: true,\n            input,\n            inst,\n            continue: !def.abort,\n        });\n    };\n});\nexport const $ZodCheckMinSize = /*@__PURE__*/ core.$constructor(\"$ZodCheckMinSize\", (inst, def) => {\n    var _a;\n    $ZodCheck.init(inst, def);\n    (_a = inst._zod.def).when ?? (_a.when = (payload) => {\n        const val = payload.value;\n        return !util.nullish(val) && val.size !== undefined;\n    });\n    inst._zod.onattach.push((inst) => {\n        const curr = (inst._zod.bag.minimum ?? Number.NEGATIVE_INFINITY);\n        if (def.minimum > curr)\n            inst._zod.bag.minimum = def.minimum;\n    });\n    inst._zod.check = (payload) => {\n        const input = payload.value;\n        const size = input.size;\n        if (size >= def.minimum)\n            return;\n        payload.issues.push({\n            origin: util.getSizableOrigin(input),\n            code: \"too_small\",\n            minimum: def.minimum,\n            inclusive: true,\n            input,\n            inst,\n            continue: !def.abort,\n        });\n    };\n});\nexport const $ZodCheckSizeEquals = /*@__PURE__*/ core.$constructor(\"$ZodCheckSizeEquals\", (inst, def) => {\n    var _a;\n    $ZodCheck.init(inst, def);\n    (_a = inst._zod.def).when ?? (_a.when = (payload) => {\n        const val = payload.value;\n        return !util.nullish(val) && val.size !== undefined;\n    });\n    inst._zod.onattach.push((inst) => {\n        const bag = inst._zod.bag;\n        bag.minimum = def.size;\n        bag.maximum = def.size;\n        bag.size = def.size;\n    });\n    inst._zod.check = (payload) => {\n        const input = payload.value;\n        const size = input.size;\n        if (size === def.size)\n            return;\n        const tooBig = size > def.size;\n        payload.issues.push({\n            origin: util.getSizableOrigin(input),\n            ...(tooBig ? { code: \"too_big\", maximum: def.size } : { code: \"too_small\", minimum: def.size }),\n            inclusive: true,\n            exact: true,\n            input: payload.value,\n            inst,\n            continue: !def.abort,\n        });\n    };\n});\nexport const $ZodCheckMaxLength = /*@__PURE__*/ core.$constructor(\"$ZodCheckMaxLength\", (inst, def) => {\n    var _a;\n    $ZodCheck.init(inst, def);\n    (_a = inst._zod.def).when ?? (_a.when = (payload) => {\n        const val = payload.value;\n        return !util.nullish(val) && val.length !== undefined;\n    });\n    inst._zod.onattach.push((inst) => {\n        const curr = (inst._zod.bag.maximum ?? Number.POSITIVE_INFINITY);\n        if (def.maximum < curr)\n            inst._zod.bag.maximum = def.maximum;\n    });\n    inst._zod.check = (payload) => {\n        const input = payload.value;\n        const length = input.length;\n        if (length <= def.maximum)\n            return;\n        const origin = util.getLengthableOrigin(input);\n        payload.issues.push({\n            origin,\n            code: \"too_big\",\n            maximum: def.maximum,\n            inclusive: true,\n            input,\n            inst,\n            continue: !def.abort,\n        });\n    };\n});\nexport const $ZodCheckMinLength = /*@__PURE__*/ core.$constructor(\"$ZodCheckMinLength\", (inst, def) => {\n    var _a;\n    $ZodCheck.init(inst, def);\n    (_a = inst._zod.def).when ?? (_a.when = (payload) => {\n        const val = payload.value;\n        return !util.nullish(val) && val.length !== undefined;\n    });\n    inst._zod.onattach.push((inst) => {\n        const curr = (inst._zod.bag.minimum ?? Number.NEGATIVE_INFINITY);\n        if (def.minimum > curr)\n            inst._zod.bag.minimum = def.minimum;\n    });\n    inst._zod.check = (payload) => {\n        const input = payload.value;\n        const length = input.length;\n        if (length >= def.minimum)\n            return;\n        const origin = util.getLengthableOrigin(input);\n        payload.issues.push({\n            origin,\n            code: \"too_small\",\n            minimum: def.minimum,\n            inclusive: true,\n            input,\n            inst,\n            continue: !def.abort,\n        });\n    };\n});\nexport const $ZodCheckLengthEquals = /*@__PURE__*/ core.$constructor(\"$ZodCheckLengthEquals\", (inst, def) => {\n    var _a;\n    $ZodCheck.init(inst, def);\n    (_a = inst._zod.def).when ?? (_a.when = (payload) => {\n        const val = payload.value;\n        return !util.nullish(val) && val.length !== undefined;\n    });\n    inst._zod.onattach.push((inst) => {\n        const bag = inst._zod.bag;\n        bag.minimum = def.length;\n        bag.maximum = def.length;\n        bag.length = def.length;\n    });\n    inst._zod.check = (payload) => {\n        const input = payload.value;\n        const length = input.length;\n        if (length === def.length)\n            return;\n        const origin = util.getLengthableOrigin(input);\n        const tooBig = length > def.length;\n        payload.issues.push({\n            origin,\n            ...(tooBig ? { code: \"too_big\", maximum: def.length } : { code: \"too_small\", minimum: def.length }),\n            inclusive: true,\n            exact: true,\n            input: payload.value,\n            inst,\n            continue: !def.abort,\n        });\n    };\n});\nexport const $ZodCheckStringFormat = /*@__PURE__*/ core.$constructor(\"$ZodCheckStringFormat\", (inst, def) => {\n    var _a, _b;\n    $ZodCheck.init(inst, def);\n    inst._zod.onattach.push((inst) => {\n        const bag = inst._zod.bag;\n        bag.format = def.format;\n        if (def.pattern) {\n            bag.patterns ?? (bag.patterns = new Set());\n            bag.patterns.add(def.pattern);\n        }\n    });\n    if (def.pattern)\n        (_a = inst._zod).check ?? (_a.check = (payload) => {\n            def.pattern.lastIndex = 0;\n            if (def.pattern.test(payload.value))\n                return;\n            payload.issues.push({\n                origin: \"string\",\n                code: \"invalid_format\",\n                format: def.format,\n                input: payload.value,\n                ...(def.pattern ? { pattern: def.pattern.toString() } : {}),\n                inst,\n                continue: !def.abort,\n            });\n        });\n    else\n        (_b = inst._zod).check ?? (_b.check = () => { });\n});\nexport const $ZodCheckRegex = /*@__PURE__*/ core.$constructor(\"$ZodCheckRegex\", (inst, def) => {\n    $ZodCheckStringFormat.init(inst, def);\n    inst._zod.check = (payload) => {\n        def.pattern.lastIndex = 0;\n        if (def.pattern.test(payload.value))\n            return;\n        payload.issues.push({\n            origin: \"string\",\n            code: \"invalid_format\",\n            format: \"regex\",\n            input: payload.value,\n            pattern: def.pattern.toString(),\n            inst,\n            continue: !def.abort,\n        });\n    };\n});\nexport const $ZodCheckLowerCase = /*@__PURE__*/ core.$constructor(\"$ZodCheckLowerCase\", (inst, def) => {\n    def.pattern ?? (def.pattern = regexes.lowercase);\n    $ZodCheckStringFormat.init(inst, def);\n});\nexport const $ZodCheckUpperCase = /*@__PURE__*/ core.$constructor(\"$ZodCheckUpperCase\", (inst, def) => {\n    def.pattern ?? (def.pattern = regexes.uppercase);\n    $ZodCheckStringFormat.init(inst, def);\n});\nexport const $ZodCheckIncludes = /*@__PURE__*/ core.$constructor(\"$ZodCheckIncludes\", (inst, def) => {\n    $ZodCheck.init(inst, def);\n    const escapedRegex = util.escapeRegex(def.includes);\n    const pattern = new RegExp(typeof def.position === \"number\" ? `^.{${def.position}}${escapedRegex}` : escapedRegex);\n    def.pattern = pattern;\n    inst._zod.onattach.push((inst) => {\n        const bag = inst._zod.bag;\n        bag.patterns ?? (bag.patterns = new Set());\n        bag.patterns.add(pattern);\n    });\n    inst._zod.check = (payload) => {\n        if (payload.value.includes(def.includes, def.position))\n            return;\n        payload.issues.push({\n            origin: \"string\",\n            code: \"invalid_format\",\n            format: \"includes\",\n            includes: def.includes,\n            input: payload.value,\n            inst,\n            continue: !def.abort,\n        });\n    };\n});\nexport const $ZodCheckStartsWith = /*@__PURE__*/ core.$constructor(\"$ZodCheckStartsWith\", (inst, def) => {\n    $ZodCheck.init(inst, def);\n    const pattern = new RegExp(`^${util.escapeRegex(def.prefix)}.*`);\n    def.pattern ?? (def.pattern = pattern);\n    inst._zod.onattach.push((inst) => {\n        const bag = inst._zod.bag;\n        bag.patterns ?? (bag.patterns = new Set());\n        bag.patterns.add(pattern);\n    });\n    inst._zod.check = (payload) => {\n        if (payload.value.startsWith(def.prefix))\n            return;\n        payload.issues.push({\n            origin: \"string\",\n            code: \"invalid_format\",\n            format: \"starts_with\",\n            prefix: def.prefix,\n            input: payload.value,\n            inst,\n            continue: !def.abort,\n        });\n    };\n});\nexport const $ZodCheckEndsWith = /*@__PURE__*/ core.$constructor(\"$ZodCheckEndsWith\", (inst, def) => {\n    $ZodCheck.init(inst, def);\n    const pattern = new RegExp(`.*${util.escapeRegex(def.suffix)}$`);\n    def.pattern ?? (def.pattern = pattern);\n    inst._zod.onattach.push((inst) => {\n        const bag = inst._zod.bag;\n        bag.patterns ?? (bag.patterns = new Set());\n        bag.patterns.add(pattern);\n    });\n    inst._zod.check = (payload) => {\n        if (payload.value.endsWith(def.suffix))\n            return;\n        payload.issues.push({\n            origin: \"string\",\n            code: \"invalid_format\",\n            format: \"ends_with\",\n            suffix: def.suffix,\n            input: payload.value,\n            inst,\n            continue: !def.abort,\n        });\n    };\n});\n///////////////////////////////////\n/////    $ZodCheckProperty    /////\n///////////////////////////////////\nfunction handleCheckPropertyResult(result, payload, property) {\n    if (result.issues.length) {\n        payload.issues.push(...util.prefixIssues(property, result.issues));\n    }\n}\nexport const $ZodCheckProperty = /*@__PURE__*/ core.$constructor(\"$ZodCheckProperty\", (inst, def) => {\n    $ZodCheck.init(inst, def);\n    inst._zod.check = (payload) => {\n        const result = def.schema._zod.run({\n            value: payload.value[def.property],\n            issues: [],\n        }, {});\n        if (result instanceof Promise) {\n            return result.then((result) => handleCheckPropertyResult(result, payload, def.property));\n        }\n        handleCheckPropertyResult(result, payload, def.property);\n        return;\n    };\n});\nexport const $ZodCheckMimeType = /*@__PURE__*/ core.$constructor(\"$ZodCheckMimeType\", (inst, def) => {\n    $ZodCheck.init(inst, def);\n    const mimeSet = new Set(def.mime);\n    inst._zod.onattach.push((inst) => {\n        inst._zod.bag.mime = def.mime;\n    });\n    inst._zod.check = (payload) => {\n        if (mimeSet.has(payload.value.type))\n            return;\n        payload.issues.push({\n            code: \"invalid_value\",\n            values: def.mime,\n            input: payload.value.type,\n            inst,\n            continue: !def.abort,\n        });\n    };\n});\nexport const $ZodCheckOverwrite = /*@__PURE__*/ core.$constructor(\"$ZodCheckOverwrite\", (inst, def) => {\n    $ZodCheck.init(inst, def);\n    inst._zod.check = (payload) => {\n        payload.value = def.tx(payload.value);\n    };\n});\n","export class Doc {\n    constructor(args = []) {\n        this.content = [];\n        this.indent = 0;\n        if (this)\n            this.args = args;\n    }\n    indented(fn) {\n        this.indent += 1;\n        fn(this);\n        this.indent -= 1;\n    }\n    write(arg) {\n        if (typeof arg === \"function\") {\n            arg(this, { execution: \"sync\" });\n            arg(this, { execution: \"async\" });\n            return;\n        }\n        const content = arg;\n        const lines = content.split(\"\\n\").filter((x) => x);\n        const minIndent = Math.min(...lines.map((x) => x.length - x.trimStart().length));\n        const dedented = lines.map((x) => x.slice(minIndent)).map((x) => \" \".repeat(this.indent * 2) + x);\n        for (const line of dedented) {\n            this.content.push(line);\n        }\n    }\n    compile() {\n        const F = Function;\n        const args = this?.args;\n        const content = this?.content ?? [``];\n        const lines = [...content.map((x) => `  ${x}`)];\n        // console.log(lines.join(\"\\n\"));\n        return new F(...args, lines.join(\"\\n\"));\n    }\n}\n","export const version = {\n    major: 4,\n    minor: 1,\n    patch: 13,\n};\n","import * as checks from \"./checks.js\";\nimport * as core from \"./core.js\";\nimport { Doc } from \"./doc.js\";\nimport { parse, parseAsync, safeParse, safeParseAsync } from \"./parse.js\";\nimport * as regexes from \"./regexes.js\";\nimport * as util from \"./util.js\";\nimport { version } from \"./versions.js\";\nexport const $ZodType = /*@__PURE__*/ core.$constructor(\"$ZodType\", (inst, def) => {\n    var _a;\n    inst ?? (inst = {});\n    inst._zod.def = def; // set _def property\n    inst._zod.bag = inst._zod.bag || {}; // initialize _bag object\n    inst._zod.version = version;\n    const checks = [...(inst._zod.def.checks ?? [])];\n    // if inst is itself a checks.$ZodCheck, run it as a check\n    if (inst._zod.traits.has(\"$ZodCheck\")) {\n        checks.unshift(inst);\n    }\n    for (const ch of checks) {\n        for (const fn of ch._zod.onattach) {\n            fn(inst);\n        }\n    }\n    if (checks.length === 0) {\n        // deferred initializer\n        // inst._zod.parse is not yet defined\n        (_a = inst._zod).deferred ?? (_a.deferred = []);\n        inst._zod.deferred?.push(() => {\n            inst._zod.run = inst._zod.parse;\n        });\n    }\n    else {\n        const runChecks = (payload, checks, ctx) => {\n            let isAborted = util.aborted(payload);\n            let asyncResult;\n            for (const ch of checks) {\n                if (ch._zod.def.when) {\n                    const shouldRun = ch._zod.def.when(payload);\n                    if (!shouldRun)\n                        continue;\n                }\n                else if (isAborted) {\n                    continue;\n                }\n                const currLen = payload.issues.length;\n                const _ = ch._zod.check(payload);\n                if (_ instanceof Promise && ctx?.async === false) {\n                    throw new core.$ZodAsyncError();\n                }\n                if (asyncResult || _ instanceof Promise) {\n                    asyncResult = (asyncResult ?? Promise.resolve()).then(async () => {\n                        await _;\n                        const nextLen = payload.issues.length;\n                        if (nextLen === currLen)\n                            return;\n                        if (!isAborted)\n                            isAborted = util.aborted(payload, currLen);\n                    });\n                }\n                else {\n                    const nextLen = payload.issues.length;\n                    if (nextLen === currLen)\n                        continue;\n                    if (!isAborted)\n                        isAborted = util.aborted(payload, currLen);\n                }\n            }\n            if (asyncResult) {\n                return asyncResult.then(() => {\n                    return payload;\n                });\n            }\n            return payload;\n        };\n        // const handleChecksResult = (\n        //   checkResult: ParsePayload,\n        //   originalResult: ParsePayload,\n        //   ctx: ParseContextInternal\n        // ): util.MaybeAsync<ParsePayload> => {\n        //   // if the checks mutated the value && there are no issues, re-parse the result\n        //   if (checkResult.value !== originalResult.value && !checkResult.issues.length)\n        //     return inst._zod.parse(checkResult, ctx);\n        //   return originalResult;\n        // };\n        const handleCanaryResult = (canary, payload, ctx) => {\n            // abort if the canary is aborted\n            if (util.aborted(canary)) {\n                canary.aborted = true;\n                return canary;\n            }\n            // run checks first, then\n            const checkResult = runChecks(payload, checks, ctx);\n            if (checkResult instanceof Promise) {\n                if (ctx.async === false)\n                    throw new core.$ZodAsyncError();\n                return checkResult.then((checkResult) => inst._zod.parse(checkResult, ctx));\n            }\n            return inst._zod.parse(checkResult, ctx);\n        };\n        inst._zod.run = (payload, ctx) => {\n            if (ctx.skipChecks) {\n                return inst._zod.parse(payload, ctx);\n            }\n            if (ctx.direction === \"backward\") {\n                // run canary\n                // initial pass (no checks)\n                const canary = inst._zod.parse({ value: payload.value, issues: [] }, { ...ctx, skipChecks: true });\n                if (canary instanceof Promise) {\n                    return canary.then((canary) => {\n                        return handleCanaryResult(canary, payload, ctx);\n                    });\n                }\n                return handleCanaryResult(canary, payload, ctx);\n            }\n            // forward\n            const result = inst._zod.parse(payload, ctx);\n            if (result instanceof Promise) {\n                if (ctx.async === false)\n                    throw new core.$ZodAsyncError();\n                return result.then((result) => runChecks(result, checks, ctx));\n            }\n            return runChecks(result, checks, ctx);\n        };\n    }\n    inst[\"~standard\"] = {\n        validate: (value) => {\n            try {\n                const r = safeParse(inst, value);\n                return r.success ? { value: r.data } : { issues: r.error?.issues };\n            }\n            catch (_) {\n                return safeParseAsync(inst, value).then((r) => (r.success ? { value: r.data } : { issues: r.error?.issues }));\n            }\n        },\n        vendor: \"zod\",\n        version: 1,\n    };\n});\nexport { clone } from \"./util.js\";\nexport const $ZodString = /*@__PURE__*/ core.$constructor(\"$ZodString\", (inst, def) => {\n    $ZodType.init(inst, def);\n    inst._zod.pattern = [...(inst?._zod.bag?.patterns ?? [])].pop() ?? regexes.string(inst._zod.bag);\n    inst._zod.parse = (payload, _) => {\n        if (def.coerce)\n            try {\n                payload.value = String(payload.value);\n            }\n            catch (_) { }\n        if (typeof payload.value === \"string\")\n            return payload;\n        payload.issues.push({\n            expected: \"string\",\n            code: \"invalid_type\",\n            input: payload.value,\n            inst,\n        });\n        return payload;\n    };\n});\nexport const $ZodStringFormat = /*@__PURE__*/ core.$constructor(\"$ZodStringFormat\", (inst, def) => {\n    // check initialization must come first\n    checks.$ZodCheckStringFormat.init(inst, def);\n    $ZodString.init(inst, def);\n});\nexport const $ZodGUID = /*@__PURE__*/ core.$constructor(\"$ZodGUID\", (inst, def) => {\n    def.pattern ?? (def.pattern = regexes.guid);\n    $ZodStringFormat.init(inst, def);\n});\nexport const $ZodUUID = /*@__PURE__*/ core.$constructor(\"$ZodUUID\", (inst, def) => {\n    if (def.version) {\n        const versionMap = {\n            v1: 1,\n            v2: 2,\n            v3: 3,\n            v4: 4,\n            v5: 5,\n            v6: 6,\n            v7: 7,\n            v8: 8,\n        };\n        const v = versionMap[def.version];\n        if (v === undefined)\n            throw new Error(`Invalid UUID version: \"${def.version}\"`);\n        def.pattern ?? (def.pattern = regexes.uuid(v));\n    }\n    else\n        def.pattern ?? (def.pattern = regexes.uuid());\n    $ZodStringFormat.init(inst, def);\n});\nexport const $ZodEmail = /*@__PURE__*/ core.$constructor(\"$ZodEmail\", (inst, def) => {\n    def.pattern ?? (def.pattern = regexes.email);\n    $ZodStringFormat.init(inst, def);\n});\nexport const $ZodURL = /*@__PURE__*/ core.$constructor(\"$ZodURL\", (inst, def) => {\n    $ZodStringFormat.init(inst, def);\n    inst._zod.check = (payload) => {\n        try {\n            // Trim whitespace from input\n            const trimmed = payload.value.trim();\n            // @ts-ignore\n            const url = new URL(trimmed);\n            if (def.hostname) {\n                def.hostname.lastIndex = 0;\n                if (!def.hostname.test(url.hostname)) {\n                    payload.issues.push({\n                        code: \"invalid_format\",\n                        format: \"url\",\n                        note: \"Invalid hostname\",\n                        pattern: def.hostname.source,\n                        input: payload.value,\n                        inst,\n                        continue: !def.abort,\n                    });\n                }\n            }\n            if (def.protocol) {\n                def.protocol.lastIndex = 0;\n                if (!def.protocol.test(url.protocol.endsWith(\":\") ? url.protocol.slice(0, -1) : url.protocol)) {\n                    payload.issues.push({\n                        code: \"invalid_format\",\n                        format: \"url\",\n                        note: \"Invalid protocol\",\n                        pattern: def.protocol.source,\n                        input: payload.value,\n                        inst,\n                        continue: !def.abort,\n                    });\n                }\n            }\n            // Set the output value based on normalize flag\n            if (def.normalize) {\n                // Use normalized URL\n                payload.value = url.href;\n            }\n            else {\n                // Preserve the original input (trimmed)\n                payload.value = trimmed;\n            }\n            return;\n        }\n        catch (_) {\n            payload.issues.push({\n                code: \"invalid_format\",\n                format: \"url\",\n                input: payload.value,\n                inst,\n                continue: !def.abort,\n            });\n        }\n    };\n});\nexport const $ZodEmoji = /*@__PURE__*/ core.$constructor(\"$ZodEmoji\", (inst, def) => {\n    def.pattern ?? (def.pattern = regexes.emoji());\n    $ZodStringFormat.init(inst, def);\n});\nexport const $ZodNanoID = /*@__PURE__*/ core.$constructor(\"$ZodNanoID\", (inst, def) => {\n    def.pattern ?? (def.pattern = regexes.nanoid);\n    $ZodStringFormat.init(inst, def);\n});\nexport const $ZodCUID = /*@__PURE__*/ core.$constructor(\"$ZodCUID\", (inst, def) => {\n    def.pattern ?? (def.pattern = regexes.cuid);\n    $ZodStringFormat.init(inst, def);\n});\nexport const $ZodCUID2 = /*@__PURE__*/ core.$constructor(\"$ZodCUID2\", (inst, def) => {\n    def.pattern ?? (def.pattern = regexes.cuid2);\n    $ZodStringFormat.init(inst, def);\n});\nexport const $ZodULID = /*@__PURE__*/ core.$constructor(\"$ZodULID\", (inst, def) => {\n    def.pattern ?? (def.pattern = regexes.ulid);\n    $ZodStringFormat.init(inst, def);\n});\nexport const $ZodXID = /*@__PURE__*/ core.$constructor(\"$ZodXID\", (inst, def) => {\n    def.pattern ?? (def.pattern = regexes.xid);\n    $ZodStringFormat.init(inst, def);\n});\nexport const $ZodKSUID = /*@__PURE__*/ core.$constructor(\"$ZodKSUID\", (inst, def) => {\n    def.pattern ?? (def.pattern = regexes.ksuid);\n    $ZodStringFormat.init(inst, def);\n});\nexport const $ZodISODateTime = /*@__PURE__*/ core.$constructor(\"$ZodISODateTime\", (inst, def) => {\n    def.pattern ?? (def.pattern = regexes.datetime(def));\n    $ZodStringFormat.init(inst, def);\n});\nexport const $ZodISODate = /*@__PURE__*/ core.$constructor(\"$ZodISODate\", (inst, def) => {\n    def.pattern ?? (def.pattern = regexes.date);\n    $ZodStringFormat.init(inst, def);\n});\nexport const $ZodISOTime = /*@__PURE__*/ core.$constructor(\"$ZodISOTime\", (inst, def) => {\n    def.pattern ?? (def.pattern = regexes.time(def));\n    $ZodStringFormat.init(inst, def);\n});\nexport const $ZodISODuration = /*@__PURE__*/ core.$constructor(\"$ZodISODuration\", (inst, def) => {\n    def.pattern ?? (def.pattern = regexes.duration);\n    $ZodStringFormat.init(inst, def);\n});\nexport const $ZodIPv4 = /*@__PURE__*/ core.$constructor(\"$ZodIPv4\", (inst, def) => {\n    def.pattern ?? (def.pattern = regexes.ipv4);\n    $ZodStringFormat.init(inst, def);\n    inst._zod.bag.format = `ipv4`;\n});\nexport const $ZodIPv6 = /*@__PURE__*/ core.$constructor(\"$ZodIPv6\", (inst, def) => {\n    def.pattern ?? (def.pattern = regexes.ipv6);\n    $ZodStringFormat.init(inst, def);\n    inst._zod.bag.format = `ipv6`;\n    inst._zod.check = (payload) => {\n        try {\n            // @ts-ignore\n            new URL(`http://[${payload.value}]`);\n            // return;\n        }\n        catch {\n            payload.issues.push({\n                code: \"invalid_format\",\n                format: \"ipv6\",\n                input: payload.value,\n                inst,\n                continue: !def.abort,\n            });\n        }\n    };\n});\nexport const $ZodMAC = /*@__PURE__*/ core.$constructor(\"$ZodMAC\", (inst, def) => {\n    def.pattern ?? (def.pattern = regexes.mac(def.delimiter));\n    $ZodStringFormat.init(inst, def);\n    inst._zod.bag.format = `mac`;\n});\nexport const $ZodCIDRv4 = /*@__PURE__*/ core.$constructor(\"$ZodCIDRv4\", (inst, def) => {\n    def.pattern ?? (def.pattern = regexes.cidrv4);\n    $ZodStringFormat.init(inst, def);\n});\nexport const $ZodCIDRv6 = /*@__PURE__*/ core.$constructor(\"$ZodCIDRv6\", (inst, def) => {\n    def.pattern ?? (def.pattern = regexes.cidrv6); // not used for validation\n    $ZodStringFormat.init(inst, def);\n    inst._zod.check = (payload) => {\n        const parts = payload.value.split(\"/\");\n        try {\n            if (parts.length !== 2)\n                throw new Error();\n            const [address, prefix] = parts;\n            if (!prefix)\n                throw new Error();\n            const prefixNum = Number(prefix);\n            if (`${prefixNum}` !== prefix)\n                throw new Error();\n            if (prefixNum < 0 || prefixNum > 128)\n                throw new Error();\n            // @ts-ignore\n            new URL(`http://[${address}]`);\n        }\n        catch {\n            payload.issues.push({\n                code: \"invalid_format\",\n                format: \"cidrv6\",\n                input: payload.value,\n                inst,\n                continue: !def.abort,\n            });\n        }\n    };\n});\n//////////////////////////////   ZodBase64   //////////////////////////////\nexport function isValidBase64(data) {\n    if (data === \"\")\n        return true;\n    if (data.length % 4 !== 0)\n        return false;\n    try {\n        // @ts-ignore\n        atob(data);\n        return true;\n    }\n    catch {\n        return false;\n    }\n}\nexport const $ZodBase64 = /*@__PURE__*/ core.$constructor(\"$ZodBase64\", (inst, def) => {\n    def.pattern ?? (def.pattern = regexes.base64);\n    $ZodStringFormat.init(inst, def);\n    inst._zod.bag.contentEncoding = \"base64\";\n    inst._zod.check = (payload) => {\n        if (isValidBase64(payload.value))\n            return;\n        payload.issues.push({\n            code: \"invalid_format\",\n            format: \"base64\",\n            input: payload.value,\n            inst,\n            continue: !def.abort,\n        });\n    };\n});\n//////////////////////////////   ZodBase64   //////////////////////////////\nexport function isValidBase64URL(data) {\n    if (!regexes.base64url.test(data))\n        return false;\n    const base64 = data.replace(/[-_]/g, (c) => (c === \"-\" ? \"+\" : \"/\"));\n    const padded = base64.padEnd(Math.ceil(base64.length / 4) * 4, \"=\");\n    return isValidBase64(padded);\n}\nexport const $ZodBase64URL = /*@__PURE__*/ core.$constructor(\"$ZodBase64URL\", (inst, def) => {\n    def.pattern ?? (def.pattern = regexes.base64url);\n    $ZodStringFormat.init(inst, def);\n    inst._zod.bag.contentEncoding = \"base64url\";\n    inst._zod.check = (payload) => {\n        if (isValidBase64URL(payload.value))\n            return;\n        payload.issues.push({\n            code: \"invalid_format\",\n            format: \"base64url\",\n            input: payload.value,\n            inst,\n            continue: !def.abort,\n        });\n    };\n});\nexport const $ZodE164 = /*@__PURE__*/ core.$constructor(\"$ZodE164\", (inst, def) => {\n    def.pattern ?? (def.pattern = regexes.e164);\n    $ZodStringFormat.init(inst, def);\n});\n//////////////////////////////   ZodJWT   //////////////////////////////\nexport function isValidJWT(token, algorithm = null) {\n    try {\n        const tokensParts = token.split(\".\");\n        if (tokensParts.length !== 3)\n            return false;\n        const [header] = tokensParts;\n        if (!header)\n            return false;\n        // @ts-ignore\n        const parsedHeader = JSON.parse(atob(header));\n        if (\"typ\" in parsedHeader && parsedHeader?.typ !== \"JWT\")\n            return false;\n        if (!parsedHeader.alg)\n            return false;\n        if (algorithm && (!(\"alg\" in parsedHeader) || parsedHeader.alg !== algorithm))\n            return false;\n        return true;\n    }\n    catch {\n        return false;\n    }\n}\nexport const $ZodJWT = /*@__PURE__*/ core.$constructor(\"$ZodJWT\", (inst, def) => {\n    $ZodStringFormat.init(inst, def);\n    inst._zod.check = (payload) => {\n        if (isValidJWT(payload.value, def.alg))\n            return;\n        payload.issues.push({\n            code: \"invalid_format\",\n            format: \"jwt\",\n            input: payload.value,\n            inst,\n            continue: !def.abort,\n        });\n    };\n});\nexport const $ZodCustomStringFormat = /*@__PURE__*/ core.$constructor(\"$ZodCustomStringFormat\", (inst, def) => {\n    $ZodStringFormat.init(inst, def);\n    inst._zod.check = (payload) => {\n        if (def.fn(payload.value))\n            return;\n        payload.issues.push({\n            code: \"invalid_format\",\n            format: def.format,\n            input: payload.value,\n            inst,\n            continue: !def.abort,\n        });\n    };\n});\nexport const $ZodNumber = /*@__PURE__*/ core.$constructor(\"$ZodNumber\", (inst, def) => {\n    $ZodType.init(inst, def);\n    inst._zod.pattern = inst._zod.bag.pattern ?? regexes.number;\n    inst._zod.parse = (payload, _ctx) => {\n        if (def.coerce)\n            try {\n                payload.value = Number(payload.value);\n            }\n            catch (_) { }\n        const input = payload.value;\n        if (typeof input === \"number\" && !Number.isNaN(input) && Number.isFinite(input)) {\n            return payload;\n        }\n        const received = typeof input === \"number\"\n            ? Number.isNaN(input)\n                ? \"NaN\"\n                : !Number.isFinite(input)\n                    ? \"Infinity\"\n                    : undefined\n            : undefined;\n        payload.issues.push({\n            expected: \"number\",\n            code: \"invalid_type\",\n            input,\n            inst,\n            ...(received ? { received } : {}),\n        });\n        return payload;\n    };\n});\nexport const $ZodNumberFormat = /*@__PURE__*/ core.$constructor(\"$ZodNumberFormat\", (inst, def) => {\n    checks.$ZodCheckNumberFormat.init(inst, def);\n    $ZodNumber.init(inst, def); // no format checks\n});\nexport const $ZodBoolean = /*@__PURE__*/ core.$constructor(\"$ZodBoolean\", (inst, def) => {\n    $ZodType.init(inst, def);\n    inst._zod.pattern = regexes.boolean;\n    inst._zod.parse = (payload, _ctx) => {\n        if (def.coerce)\n            try {\n                payload.value = Boolean(payload.value);\n            }\n            catch (_) { }\n        const input = payload.value;\n        if (typeof input === \"boolean\")\n            return payload;\n        payload.issues.push({\n            expected: \"boolean\",\n            code: \"invalid_type\",\n            input,\n            inst,\n        });\n        return payload;\n    };\n});\nexport const $ZodBigInt = /*@__PURE__*/ core.$constructor(\"$ZodBigInt\", (inst, def) => {\n    $ZodType.init(inst, def);\n    inst._zod.pattern = regexes.bigint;\n    inst._zod.parse = (payload, _ctx) => {\n        if (def.coerce)\n            try {\n                payload.value = BigInt(payload.value);\n            }\n            catch (_) { }\n        if (typeof payload.value === \"bigint\")\n            return payload;\n        payload.issues.push({\n            expected: \"bigint\",\n            code: \"invalid_type\",\n            input: payload.value,\n            inst,\n        });\n        return payload;\n    };\n});\nexport const $ZodBigIntFormat = /*@__PURE__*/ core.$constructor(\"$ZodBigIntFormat\", (inst, def) => {\n    checks.$ZodCheckBigIntFormat.init(inst, def);\n    $ZodBigInt.init(inst, def); // no format checks\n});\nexport const $ZodSymbol = /*@__PURE__*/ core.$constructor(\"$ZodSymbol\", (inst, def) => {\n    $ZodType.init(inst, def);\n    inst._zod.parse = (payload, _ctx) => {\n        const input = payload.value;\n        if (typeof input === \"symbol\")\n            return payload;\n        payload.issues.push({\n            expected: \"symbol\",\n            code: \"invalid_type\",\n            input,\n            inst,\n        });\n        return payload;\n    };\n});\nexport const $ZodUndefined = /*@__PURE__*/ core.$constructor(\"$ZodUndefined\", (inst, def) => {\n    $ZodType.init(inst, def);\n    inst._zod.pattern = regexes.undefined;\n    inst._zod.values = new Set([undefined]);\n    inst._zod.optin = \"optional\";\n    inst._zod.optout = \"optional\";\n    inst._zod.parse = (payload, _ctx) => {\n        const input = payload.value;\n        if (typeof input === \"undefined\")\n            return payload;\n        payload.issues.push({\n            expected: \"undefined\",\n            code: \"invalid_type\",\n            input,\n            inst,\n        });\n        return payload;\n    };\n});\nexport const $ZodNull = /*@__PURE__*/ core.$constructor(\"$ZodNull\", (inst, def) => {\n    $ZodType.init(inst, def);\n    inst._zod.pattern = regexes.null;\n    inst._zod.values = new Set([null]);\n    inst._zod.parse = (payload, _ctx) => {\n        const input = payload.value;\n        if (input === null)\n            return payload;\n        payload.issues.push({\n            expected: \"null\",\n            code: \"invalid_type\",\n            input,\n            inst,\n        });\n        return payload;\n    };\n});\nexport const $ZodAny = /*@__PURE__*/ core.$constructor(\"$ZodAny\", (inst, def) => {\n    $ZodType.init(inst, def);\n    inst._zod.parse = (payload) => payload;\n});\nexport const $ZodUnknown = /*@__PURE__*/ core.$constructor(\"$ZodUnknown\", (inst, def) => {\n    $ZodType.init(inst, def);\n    inst._zod.parse = (payload) => payload;\n});\nexport const $ZodNever = /*@__PURE__*/ core.$constructor(\"$ZodNever\", (inst, def) => {\n    $ZodType.init(inst, def);\n    inst._zod.parse = (payload, _ctx) => {\n        payload.issues.push({\n            expected: \"never\",\n            code: \"invalid_type\",\n            input: payload.value,\n            inst,\n        });\n        return payload;\n    };\n});\nexport const $ZodVoid = /*@__PURE__*/ core.$constructor(\"$ZodVoid\", (inst, def) => {\n    $ZodType.init(inst, def);\n    inst._zod.parse = (payload, _ctx) => {\n        const input = payload.value;\n        if (typeof input === \"undefined\")\n            return payload;\n        payload.issues.push({\n            expected: \"void\",\n            code: \"invalid_type\",\n            input,\n            inst,\n        });\n        return payload;\n    };\n});\nexport const $ZodDate = /*@__PURE__*/ core.$constructor(\"$ZodDate\", (inst, def) => {\n    $ZodType.init(inst, def);\n    inst._zod.parse = (payload, _ctx) => {\n        if (def.coerce) {\n            try {\n                payload.value = new Date(payload.value);\n            }\n            catch (_err) { }\n        }\n        const input = payload.value;\n        const isDate = input instanceof Date;\n        const isValidDate = isDate && !Number.isNaN(input.getTime());\n        if (isValidDate)\n            return payload;\n        payload.issues.push({\n            expected: \"date\",\n            code: \"invalid_type\",\n            input,\n            ...(isDate ? { received: \"Invalid Date\" } : {}),\n            inst,\n        });\n        return payload;\n    };\n});\nfunction handleArrayResult(result, final, index) {\n    if (result.issues.length) {\n        final.issues.push(...util.prefixIssues(index, result.issues));\n    }\n    final.value[index] = result.value;\n}\nexport const $ZodArray = /*@__PURE__*/ core.$constructor(\"$ZodArray\", (inst, def) => {\n    $ZodType.init(inst, def);\n    inst._zod.parse = (payload, ctx) => {\n        const input = payload.value;\n        if (!Array.isArray(input)) {\n            payload.issues.push({\n                expected: \"array\",\n                code: \"invalid_type\",\n                input,\n                inst,\n            });\n            return payload;\n        }\n        payload.value = Array(input.length);\n        const proms = [];\n        for (let i = 0; i < input.length; i++) {\n            const item = input[i];\n            const result = def.element._zod.run({\n                value: item,\n                issues: [],\n            }, ctx);\n            if (result instanceof Promise) {\n                proms.push(result.then((result) => handleArrayResult(result, payload, i)));\n            }\n            else {\n                handleArrayResult(result, payload, i);\n            }\n        }\n        if (proms.length) {\n            return Promise.all(proms).then(() => payload);\n        }\n        return payload; //handleArrayResultsAsync(parseResults, final);\n    };\n});\nfunction handlePropertyResult(result, final, key, input) {\n    if (result.issues.length) {\n        final.issues.push(...util.prefixIssues(key, result.issues));\n    }\n    if (result.value === undefined) {\n        if (key in input) {\n            final.value[key] = undefined;\n        }\n    }\n    else {\n        final.value[key] = result.value;\n    }\n}\nfunction normalizeDef(def) {\n    const keys = Object.keys(def.shape);\n    for (const k of keys) {\n        if (!def.shape?.[k]?._zod?.traits?.has(\"$ZodType\")) {\n            throw new Error(`Invalid element at key \"${k}\": expected a Zod schema`);\n        }\n    }\n    const okeys = util.optionalKeys(def.shape);\n    return {\n        ...def,\n        keys,\n        keySet: new Set(keys),\n        numKeys: keys.length,\n        optionalKeys: new Set(okeys),\n    };\n}\nfunction handleCatchall(proms, input, payload, ctx, def, inst) {\n    const unrecognized = [];\n    // iterate over input keys\n    const keySet = def.keySet;\n    const _catchall = def.catchall._zod;\n    const t = _catchall.def.type;\n    for (const key in input) {\n        if (keySet.has(key))\n            continue;\n        if (t === \"never\") {\n            unrecognized.push(key);\n            continue;\n        }\n        const r = _catchall.run({ value: input[key], issues: [] }, ctx);\n        if (r instanceof Promise) {\n            proms.push(r.then((r) => handlePropertyResult(r, payload, key, input)));\n        }\n        else {\n            handlePropertyResult(r, payload, key, input);\n        }\n    }\n    if (unrecognized.length) {\n        payload.issues.push({\n            code: \"unrecognized_keys\",\n            keys: unrecognized,\n            input,\n            inst,\n        });\n    }\n    if (!proms.length)\n        return payload;\n    return Promise.all(proms).then(() => {\n        return payload;\n    });\n}\nexport const $ZodObject = /*@__PURE__*/ core.$constructor(\"$ZodObject\", (inst, def) => {\n    // requires cast because technically $ZodObject doesn't extend\n    $ZodType.init(inst, def);\n    // const sh = def.shape;\n    const desc = Object.getOwnPropertyDescriptor(def, \"shape\");\n    if (!desc?.get) {\n        const sh = def.shape;\n        Object.defineProperty(def, \"shape\", {\n            get: () => {\n                const newSh = { ...sh };\n                Object.defineProperty(def, \"shape\", {\n                    value: newSh,\n                });\n                return newSh;\n            },\n        });\n    }\n    const _normalized = util.cached(() => normalizeDef(def));\n    util.defineLazy(inst._zod, \"propValues\", () => {\n        const shape = def.shape;\n        const propValues = {};\n        for (const key in shape) {\n            const field = shape[key]._zod;\n            if (field.values) {\n                propValues[key] ?? (propValues[key] = new Set());\n                for (const v of field.values)\n                    propValues[key].add(v);\n            }\n        }\n        return propValues;\n    });\n    const isObject = util.isObject;\n    const catchall = def.catchall;\n    let value;\n    inst._zod.parse = (payload, ctx) => {\n        value ?? (value = _normalized.value);\n        const input = payload.value;\n        if (!isObject(input)) {\n            payload.issues.push({\n                expected: \"object\",\n                code: \"invalid_type\",\n                input,\n                inst,\n            });\n            return payload;\n        }\n        payload.value = {};\n        const proms = [];\n        const shape = value.shape;\n        for (const key of value.keys) {\n            const el = shape[key];\n            const r = el._zod.run({ value: input[key], issues: [] }, ctx);\n            if (r instanceof Promise) {\n                proms.push(r.then((r) => handlePropertyResult(r, payload, key, input)));\n            }\n            else {\n                handlePropertyResult(r, payload, key, input);\n            }\n        }\n        if (!catchall) {\n            return proms.length ? Promise.all(proms).then(() => payload) : payload;\n        }\n        return handleCatchall(proms, input, payload, ctx, _normalized.value, inst);\n    };\n});\nexport const $ZodObjectJIT = /*@__PURE__*/ core.$constructor(\"$ZodObjectJIT\", (inst, def) => {\n    // requires cast because technically $ZodObject doesn't extend\n    $ZodObject.init(inst, def);\n    const superParse = inst._zod.parse;\n    const _normalized = util.cached(() => normalizeDef(def));\n    const generateFastpass = (shape) => {\n        const doc = new Doc([\"shape\", \"payload\", \"ctx\"]);\n        const normalized = _normalized.value;\n        const parseStr = (key) => {\n            const k = util.esc(key);\n            return `shape[${k}]._zod.run({ value: input[${k}], issues: [] }, ctx)`;\n        };\n        doc.write(`const input = payload.value;`);\n        const ids = Object.create(null);\n        let counter = 0;\n        for (const key of normalized.keys) {\n            ids[key] = `key_${counter++}`;\n        }\n        // A: preserve key order {\n        doc.write(`const newResult = {};`);\n        for (const key of normalized.keys) {\n            const id = ids[key];\n            const k = util.esc(key);\n            doc.write(`const ${id} = ${parseStr(key)};`);\n            doc.write(`\n        if (${id}.issues.length) {\n          payload.issues = payload.issues.concat(${id}.issues.map(iss => ({\n            ...iss,\n            path: iss.path ? [${k}, ...iss.path] : [${k}]\n          })));\n        }\n        \n        \n        if (${id}.value === undefined) {\n          if (${k} in input) {\n            newResult[${k}] = undefined;\n          }\n        } else {\n          newResult[${k}] = ${id}.value;\n        }\n        \n      `);\n        }\n        doc.write(`payload.value = newResult;`);\n        doc.write(`return payload;`);\n        const fn = doc.compile();\n        return (payload, ctx) => fn(shape, payload, ctx);\n    };\n    let fastpass;\n    const isObject = util.isObject;\n    const jit = !core.globalConfig.jitless;\n    const allowsEval = util.allowsEval;\n    const fastEnabled = jit && allowsEval.value; // && !def.catchall;\n    const catchall = def.catchall;\n    let value;\n    inst._zod.parse = (payload, ctx) => {\n        value ?? (value = _normalized.value);\n        const input = payload.value;\n        if (!isObject(input)) {\n            payload.issues.push({\n                expected: \"object\",\n                code: \"invalid_type\",\n                input,\n                inst,\n            });\n            return payload;\n        }\n        if (jit && fastEnabled && ctx?.async === false && ctx.jitless !== true) {\n            // always synchronous\n            if (!fastpass)\n                fastpass = generateFastpass(def.shape);\n            payload = fastpass(payload, ctx);\n            if (!catchall)\n                return payload;\n            return handleCatchall([], input, payload, ctx, value, inst);\n        }\n        return superParse(payload, ctx);\n    };\n});\nfunction handleUnionResults(results, final, inst, ctx) {\n    for (const result of results) {\n        if (result.issues.length === 0) {\n            final.value = result.value;\n            return final;\n        }\n    }\n    const nonaborted = results.filter((r) => !util.aborted(r));\n    if (nonaborted.length === 1) {\n        final.value = nonaborted[0].value;\n        return nonaborted[0];\n    }\n    final.issues.push({\n        code: \"invalid_union\",\n        input: final.value,\n        inst,\n        errors: results.map((result) => result.issues.map((iss) => util.finalizeIssue(iss, ctx, core.config()))),\n    });\n    return final;\n}\nexport const $ZodUnion = /*@__PURE__*/ core.$constructor(\"$ZodUnion\", (inst, def) => {\n    $ZodType.init(inst, def);\n    util.defineLazy(inst._zod, \"optin\", () => def.options.some((o) => o._zod.optin === \"optional\") ? \"optional\" : undefined);\n    util.defineLazy(inst._zod, \"optout\", () => def.options.some((o) => o._zod.optout === \"optional\") ? \"optional\" : undefined);\n    util.defineLazy(inst._zod, \"values\", () => {\n        if (def.options.every((o) => o._zod.values)) {\n            return new Set(def.options.flatMap((option) => Array.from(option._zod.values)));\n        }\n        return undefined;\n    });\n    util.defineLazy(inst._zod, \"pattern\", () => {\n        if (def.options.every((o) => o._zod.pattern)) {\n            const patterns = def.options.map((o) => o._zod.pattern);\n            return new RegExp(`^(${patterns.map((p) => util.cleanRegex(p.source)).join(\"|\")})$`);\n        }\n        return undefined;\n    });\n    const single = def.options.length === 1;\n    const first = def.options[0]._zod.run;\n    inst._zod.parse = (payload, ctx) => {\n        if (single) {\n            return first(payload, ctx);\n        }\n        let async = false;\n        const results = [];\n        for (const option of def.options) {\n            const result = option._zod.run({\n                value: payload.value,\n                issues: [],\n            }, ctx);\n            if (result instanceof Promise) {\n                results.push(result);\n                async = true;\n            }\n            else {\n                if (result.issues.length === 0)\n                    return result;\n                results.push(result);\n            }\n        }\n        if (!async)\n            return handleUnionResults(results, payload, inst, ctx);\n        return Promise.all(results).then((results) => {\n            return handleUnionResults(results, payload, inst, ctx);\n        });\n    };\n});\nexport const $ZodDiscriminatedUnion = \n/*@__PURE__*/\ncore.$constructor(\"$ZodDiscriminatedUnion\", (inst, def) => {\n    $ZodUnion.init(inst, def);\n    const _super = inst._zod.parse;\n    util.defineLazy(inst._zod, \"propValues\", () => {\n        const propValues = {};\n        for (const option of def.options) {\n            const pv = option._zod.propValues;\n            if (!pv || Object.keys(pv).length === 0)\n                throw new Error(`Invalid discriminated union option at index \"${def.options.indexOf(option)}\"`);\n            for (const [k, v] of Object.entries(pv)) {\n                if (!propValues[k])\n                    propValues[k] = new Set();\n                for (const val of v) {\n                    propValues[k].add(val);\n                }\n            }\n        }\n        return propValues;\n    });\n    const disc = util.cached(() => {\n        const opts = def.options;\n        const map = new Map();\n        for (const o of opts) {\n            const values = o._zod.propValues?.[def.discriminator];\n            if (!values || values.size === 0)\n                throw new Error(`Invalid discriminated union option at index \"${def.options.indexOf(o)}\"`);\n            for (const v of values) {\n                if (map.has(v)) {\n                    throw new Error(`Duplicate discriminator value \"${String(v)}\"`);\n                }\n                map.set(v, o);\n            }\n        }\n        return map;\n    });\n    inst._zod.parse = (payload, ctx) => {\n        const input = payload.value;\n        if (!util.isObject(input)) {\n            payload.issues.push({\n                code: \"invalid_type\",\n                expected: \"object\",\n                input,\n                inst,\n            });\n            return payload;\n        }\n        const opt = disc.value.get(input?.[def.discriminator]);\n        if (opt) {\n            return opt._zod.run(payload, ctx);\n        }\n        if (def.unionFallback) {\n            return _super(payload, ctx);\n        }\n        // no matching discriminator\n        payload.issues.push({\n            code: \"invalid_union\",\n            errors: [],\n            note: \"No matching discriminator\",\n            discriminator: def.discriminator,\n            input,\n            path: [def.discriminator],\n            inst,\n        });\n        return payload;\n    };\n});\nexport const $ZodIntersection = /*@__PURE__*/ core.$constructor(\"$ZodIntersection\", (inst, def) => {\n    $ZodType.init(inst, def);\n    inst._zod.parse = (payload, ctx) => {\n        const input = payload.value;\n        const left = def.left._zod.run({ value: input, issues: [] }, ctx);\n        const right = def.right._zod.run({ value: input, issues: [] }, ctx);\n        const async = left instanceof Promise || right instanceof Promise;\n        if (async) {\n            return Promise.all([left, right]).then(([left, right]) => {\n                return handleIntersectionResults(payload, left, right);\n            });\n        }\n        return handleIntersectionResults(payload, left, right);\n    };\n});\nfunction mergeValues(a, b) {\n    // const aType = parse.t(a);\n    // const bType = parse.t(b);\n    if (a === b) {\n        return { valid: true, data: a };\n    }\n    if (a instanceof Date && b instanceof Date && +a === +b) {\n        return { valid: true, data: a };\n    }\n    if (util.isPlainObject(a) && util.isPlainObject(b)) {\n        const bKeys = Object.keys(b);\n        const sharedKeys = Object.keys(a).filter((key) => bKeys.indexOf(key) !== -1);\n        const newObj = { ...a, ...b };\n        for (const key of sharedKeys) {\n            const sharedValue = mergeValues(a[key], b[key]);\n            if (!sharedValue.valid) {\n                return {\n                    valid: false,\n                    mergeErrorPath: [key, ...sharedValue.mergeErrorPath],\n                };\n            }\n            newObj[key] = sharedValue.data;\n        }\n        return { valid: true, data: newObj };\n    }\n    if (Array.isArray(a) && Array.isArray(b)) {\n        if (a.length !== b.length) {\n            return { valid: false, mergeErrorPath: [] };\n        }\n        const newArray = [];\n        for (let index = 0; index < a.length; index++) {\n            const itemA = a[index];\n            const itemB = b[index];\n            const sharedValue = mergeValues(itemA, itemB);\n            if (!sharedValue.valid) {\n                return {\n                    valid: false,\n                    mergeErrorPath: [index, ...sharedValue.mergeErrorPath],\n                };\n            }\n            newArray.push(sharedValue.data);\n        }\n        return { valid: true, data: newArray };\n    }\n    return { valid: false, mergeErrorPath: [] };\n}\nfunction handleIntersectionResults(result, left, right) {\n    if (left.issues.length) {\n        result.issues.push(...left.issues);\n    }\n    if (right.issues.length) {\n        result.issues.push(...right.issues);\n    }\n    if (util.aborted(result))\n        return result;\n    const merged = mergeValues(left.value, right.value);\n    if (!merged.valid) {\n        throw new Error(`Unmergable intersection. Error path: ` + `${JSON.stringify(merged.mergeErrorPath)}`);\n    }\n    result.value = merged.data;\n    return result;\n}\nexport const $ZodTuple = /*@__PURE__*/ core.$constructor(\"$ZodTuple\", (inst, def) => {\n    $ZodType.init(inst, def);\n    const items = def.items;\n    inst._zod.parse = (payload, ctx) => {\n        const input = payload.value;\n        if (!Array.isArray(input)) {\n            payload.issues.push({\n                input,\n                inst,\n                expected: \"tuple\",\n                code: \"invalid_type\",\n            });\n            return payload;\n        }\n        payload.value = [];\n        const proms = [];\n        const reversedIndex = [...items].reverse().findIndex((item) => item._zod.optin !== \"optional\");\n        const optStart = reversedIndex === -1 ? 0 : items.length - reversedIndex;\n        if (!def.rest) {\n            const tooBig = input.length > items.length;\n            const tooSmall = input.length < optStart - 1;\n            if (tooBig || tooSmall) {\n                payload.issues.push({\n                    ...(tooBig ? { code: \"too_big\", maximum: items.length } : { code: \"too_small\", minimum: items.length }),\n                    input,\n                    inst,\n                    origin: \"array\",\n                });\n                return payload;\n            }\n        }\n        let i = -1;\n        for (const item of items) {\n            i++;\n            if (i >= input.length)\n                if (i >= optStart)\n                    continue;\n            const result = item._zod.run({\n                value: input[i],\n                issues: [],\n            }, ctx);\n            if (result instanceof Promise) {\n                proms.push(result.then((result) => handleTupleResult(result, payload, i)));\n            }\n            else {\n                handleTupleResult(result, payload, i);\n            }\n        }\n        if (def.rest) {\n            const rest = input.slice(items.length);\n            for (const el of rest) {\n                i++;\n                const result = def.rest._zod.run({\n                    value: el,\n                    issues: [],\n                }, ctx);\n                if (result instanceof Promise) {\n                    proms.push(result.then((result) => handleTupleResult(result, payload, i)));\n                }\n                else {\n                    handleTupleResult(result, payload, i);\n                }\n            }\n        }\n        if (proms.length)\n            return Promise.all(proms).then(() => payload);\n        return payload;\n    };\n});\nfunction handleTupleResult(result, final, index) {\n    if (result.issues.length) {\n        final.issues.push(...util.prefixIssues(index, result.issues));\n    }\n    final.value[index] = result.value;\n}\nexport const $ZodRecord = /*@__PURE__*/ core.$constructor(\"$ZodRecord\", (inst, def) => {\n    $ZodType.init(inst, def);\n    inst._zod.parse = (payload, ctx) => {\n        const input = payload.value;\n        if (!util.isPlainObject(input)) {\n            payload.issues.push({\n                expected: \"record\",\n                code: \"invalid_type\",\n                input,\n                inst,\n            });\n            return payload;\n        }\n        const proms = [];\n        const values = def.keyType._zod.values;\n        if (values) {\n            payload.value = {};\n            const recordKeys = new Set();\n            for (const key of values) {\n                if (typeof key === \"string\" || typeof key === \"number\" || typeof key === \"symbol\") {\n                    recordKeys.add(typeof key === \"number\" ? key.toString() : key);\n                    const result = def.valueType._zod.run({ value: input[key], issues: [] }, ctx);\n                    if (result instanceof Promise) {\n                        proms.push(result.then((result) => {\n                            if (result.issues.length) {\n                                payload.issues.push(...util.prefixIssues(key, result.issues));\n                            }\n                            payload.value[key] = result.value;\n                        }));\n                    }\n                    else {\n                        if (result.issues.length) {\n                            payload.issues.push(...util.prefixIssues(key, result.issues));\n                        }\n                        payload.value[key] = result.value;\n                    }\n                }\n            }\n            let unrecognized;\n            for (const key in input) {\n                if (!recordKeys.has(key)) {\n                    unrecognized = unrecognized ?? [];\n                    unrecognized.push(key);\n                }\n            }\n            if (unrecognized && unrecognized.length > 0) {\n                payload.issues.push({\n                    code: \"unrecognized_keys\",\n                    input,\n                    inst,\n                    keys: unrecognized,\n                });\n            }\n        }\n        else {\n            payload.value = {};\n            for (const key of Reflect.ownKeys(input)) {\n                if (key === \"__proto__\")\n                    continue;\n                const keyResult = def.keyType._zod.run({ value: key, issues: [] }, ctx);\n                if (keyResult instanceof Promise) {\n                    throw new Error(\"Async schemas not supported in object keys currently\");\n                }\n                if (keyResult.issues.length) {\n                    payload.issues.push({\n                        code: \"invalid_key\",\n                        origin: \"record\",\n                        issues: keyResult.issues.map((iss) => util.finalizeIssue(iss, ctx, core.config())),\n                        input: key,\n                        path: [key],\n                        inst,\n                    });\n                    payload.value[keyResult.value] = keyResult.value;\n                    continue;\n                }\n                const result = def.valueType._zod.run({ value: input[key], issues: [] }, ctx);\n                if (result instanceof Promise) {\n                    proms.push(result.then((result) => {\n                        if (result.issues.length) {\n                            payload.issues.push(...util.prefixIssues(key, result.issues));\n                        }\n                        payload.value[keyResult.value] = result.value;\n                    }));\n                }\n                else {\n                    if (result.issues.length) {\n                        payload.issues.push(...util.prefixIssues(key, result.issues));\n                    }\n                    payload.value[keyResult.value] = result.value;\n                }\n            }\n        }\n        if (proms.length) {\n            return Promise.all(proms).then(() => payload);\n        }\n        return payload;\n    };\n});\nexport const $ZodMap = /*@__PURE__*/ core.$constructor(\"$ZodMap\", (inst, def) => {\n    $ZodType.init(inst, def);\n    inst._zod.parse = (payload, ctx) => {\n        const input = payload.value;\n        if (!(input instanceof Map)) {\n            payload.issues.push({\n                expected: \"map\",\n                code: \"invalid_type\",\n                input,\n                inst,\n            });\n            return payload;\n        }\n        const proms = [];\n        payload.value = new Map();\n        for (const [key, value] of input) {\n            const keyResult = def.keyType._zod.run({ value: key, issues: [] }, ctx);\n            const valueResult = def.valueType._zod.run({ value: value, issues: [] }, ctx);\n            if (keyResult instanceof Promise || valueResult instanceof Promise) {\n                proms.push(Promise.all([keyResult, valueResult]).then(([keyResult, valueResult]) => {\n                    handleMapResult(keyResult, valueResult, payload, key, input, inst, ctx);\n                }));\n            }\n            else {\n                handleMapResult(keyResult, valueResult, payload, key, input, inst, ctx);\n            }\n        }\n        if (proms.length)\n            return Promise.all(proms).then(() => payload);\n        return payload;\n    };\n});\nfunction handleMapResult(keyResult, valueResult, final, key, input, inst, ctx) {\n    if (keyResult.issues.length) {\n        if (util.propertyKeyTypes.has(typeof key)) {\n            final.issues.push(...util.prefixIssues(key, keyResult.issues));\n        }\n        else {\n            final.issues.push({\n                code: \"invalid_key\",\n                origin: \"map\",\n                input,\n                inst,\n                issues: keyResult.issues.map((iss) => util.finalizeIssue(iss, ctx, core.config())),\n            });\n        }\n    }\n    if (valueResult.issues.length) {\n        if (util.propertyKeyTypes.has(typeof key)) {\n            final.issues.push(...util.prefixIssues(key, valueResult.issues));\n        }\n        else {\n            final.issues.push({\n                origin: \"map\",\n                code: \"invalid_element\",\n                input,\n                inst,\n                key: key,\n                issues: valueResult.issues.map((iss) => util.finalizeIssue(iss, ctx, core.config())),\n            });\n        }\n    }\n    final.value.set(keyResult.value, valueResult.value);\n}\nexport const $ZodSet = /*@__PURE__*/ core.$constructor(\"$ZodSet\", (inst, def) => {\n    $ZodType.init(inst, def);\n    inst._zod.parse = (payload, ctx) => {\n        const input = payload.value;\n        if (!(input instanceof Set)) {\n            payload.issues.push({\n                input,\n                inst,\n                expected: \"set\",\n                code: \"invalid_type\",\n            });\n            return payload;\n        }\n        const proms = [];\n        payload.value = new Set();\n        for (const item of input) {\n            const result = def.valueType._zod.run({ value: item, issues: [] }, ctx);\n            if (result instanceof Promise) {\n                proms.push(result.then((result) => handleSetResult(result, payload)));\n            }\n            else\n                handleSetResult(result, payload);\n        }\n        if (proms.length)\n            return Promise.all(proms).then(() => payload);\n        return payload;\n    };\n});\nfunction handleSetResult(result, final) {\n    if (result.issues.length) {\n        final.issues.push(...result.issues);\n    }\n    final.value.add(result.value);\n}\nexport const $ZodEnum = /*@__PURE__*/ core.$constructor(\"$ZodEnum\", (inst, def) => {\n    $ZodType.init(inst, def);\n    const values = util.getEnumValues(def.entries);\n    const valuesSet = new Set(values);\n    inst._zod.values = valuesSet;\n    inst._zod.pattern = new RegExp(`^(${values\n        .filter((k) => util.propertyKeyTypes.has(typeof k))\n        .map((o) => (typeof o === \"string\" ? util.escapeRegex(o) : o.toString()))\n        .join(\"|\")})$`);\n    inst._zod.parse = (payload, _ctx) => {\n        const input = payload.value;\n        if (valuesSet.has(input)) {\n            return payload;\n        }\n        payload.issues.push({\n            code: \"invalid_value\",\n            values,\n            input,\n            inst,\n        });\n        return payload;\n    };\n});\nexport const $ZodLiteral = /*@__PURE__*/ core.$constructor(\"$ZodLiteral\", (inst, def) => {\n    $ZodType.init(inst, def);\n    if (def.values.length === 0) {\n        throw new Error(\"Cannot create literal schema with no valid values\");\n    }\n    const values = new Set(def.values);\n    inst._zod.values = values;\n    inst._zod.pattern = new RegExp(`^(${def.values\n        .map((o) => (typeof o === \"string\" ? util.escapeRegex(o) : o ? util.escapeRegex(o.toString()) : String(o)))\n        .join(\"|\")})$`);\n    inst._zod.parse = (payload, _ctx) => {\n        const input = payload.value;\n        if (values.has(input)) {\n            return payload;\n        }\n        payload.issues.push({\n            code: \"invalid_value\",\n            values: def.values,\n            input,\n            inst,\n        });\n        return payload;\n    };\n});\nexport const $ZodFile = /*@__PURE__*/ core.$constructor(\"$ZodFile\", (inst, def) => {\n    $ZodType.init(inst, def);\n    inst._zod.parse = (payload, _ctx) => {\n        const input = payload.value;\n        // @ts-ignore\n        if (input instanceof File)\n            return payload;\n        payload.issues.push({\n            expected: \"file\",\n            code: \"invalid_type\",\n            input,\n            inst,\n        });\n        return payload;\n    };\n});\nexport const $ZodTransform = /*@__PURE__*/ core.$constructor(\"$ZodTransform\", (inst, def) => {\n    $ZodType.init(inst, def);\n    inst._zod.parse = (payload, ctx) => {\n        if (ctx.direction === \"backward\") {\n            throw new core.$ZodEncodeError(inst.constructor.name);\n        }\n        const _out = def.transform(payload.value, payload);\n        if (ctx.async) {\n            const output = _out instanceof Promise ? _out : Promise.resolve(_out);\n            return output.then((output) => {\n                payload.value = output;\n                return payload;\n            });\n        }\n        if (_out instanceof Promise) {\n            throw new core.$ZodAsyncError();\n        }\n        payload.value = _out;\n        return payload;\n    };\n});\nfunction handleOptionalResult(result, input) {\n    if (result.issues.length && input === undefined) {\n        return { issues: [], value: undefined };\n    }\n    return result;\n}\nexport const $ZodOptional = /*@__PURE__*/ core.$constructor(\"$ZodOptional\", (inst, def) => {\n    $ZodType.init(inst, def);\n    inst._zod.optin = \"optional\";\n    inst._zod.optout = \"optional\";\n    util.defineLazy(inst._zod, \"values\", () => {\n        return def.innerType._zod.values ? new Set([...def.innerType._zod.values, undefined]) : undefined;\n    });\n    util.defineLazy(inst._zod, \"pattern\", () => {\n        const pattern = def.innerType._zod.pattern;\n        return pattern ? new RegExp(`^(${util.cleanRegex(pattern.source)})?$`) : undefined;\n    });\n    inst._zod.parse = (payload, ctx) => {\n        if (def.innerType._zod.optin === \"optional\") {\n            const result = def.innerType._zod.run(payload, ctx);\n            if (result instanceof Promise)\n                return result.then((r) => handleOptionalResult(r, payload.value));\n            return handleOptionalResult(result, payload.value);\n        }\n        if (payload.value === undefined) {\n            return payload;\n        }\n        return def.innerType._zod.run(payload, ctx);\n    };\n});\nexport const $ZodNullable = /*@__PURE__*/ core.$constructor(\"$ZodNullable\", (inst, def) => {\n    $ZodType.init(inst, def);\n    util.defineLazy(inst._zod, \"optin\", () => def.innerType._zod.optin);\n    util.defineLazy(inst._zod, \"optout\", () => def.innerType._zod.optout);\n    util.defineLazy(inst._zod, \"pattern\", () => {\n        const pattern = def.innerType._zod.pattern;\n        return pattern ? new RegExp(`^(${util.cleanRegex(pattern.source)}|null)$`) : undefined;\n    });\n    util.defineLazy(inst._zod, \"values\", () => {\n        return def.innerType._zod.values ? new Set([...def.innerType._zod.values, null]) : undefined;\n    });\n    inst._zod.parse = (payload, ctx) => {\n        // Forward direction (decode): allow null to pass through\n        if (payload.value === null)\n            return payload;\n        return def.innerType._zod.run(payload, ctx);\n    };\n});\nexport const $ZodDefault = /*@__PURE__*/ core.$constructor(\"$ZodDefault\", (inst, def) => {\n    $ZodType.init(inst, def);\n    // inst._zod.qin = \"true\";\n    inst._zod.optin = \"optional\";\n    util.defineLazy(inst._zod, \"values\", () => def.innerType._zod.values);\n    inst._zod.parse = (payload, ctx) => {\n        if (ctx.direction === \"backward\") {\n            return def.innerType._zod.run(payload, ctx);\n        }\n        // Forward direction (decode): apply defaults for undefined input\n        if (payload.value === undefined) {\n            payload.value = def.defaultValue;\n            /**\n             * $ZodDefault returns the default value immediately in forward direction.\n             * It doesn't pass the default value into the validator (\"prefault\"). There's no reason to pass the default value through validation. The validity of the default is enforced by TypeScript statically. Otherwise, it's the responsibility of the user to ensure the default is valid. In the case of pipes with divergent in/out types, you can specify the default on the `in` schema of your ZodPipe to set a \"prefault\" for the pipe.   */\n            return payload;\n        }\n        // Forward direction: continue with default handling\n        const result = def.innerType._zod.run(payload, ctx);\n        if (result instanceof Promise) {\n            return result.then((result) => handleDefaultResult(result, def));\n        }\n        return handleDefaultResult(result, def);\n    };\n});\nfunction handleDefaultResult(payload, def) {\n    if (payload.value === undefined) {\n        payload.value = def.defaultValue;\n    }\n    return payload;\n}\nexport const $ZodPrefault = /*@__PURE__*/ core.$constructor(\"$ZodPrefault\", (inst, def) => {\n    $ZodType.init(inst, def);\n    inst._zod.optin = \"optional\";\n    util.defineLazy(inst._zod, \"values\", () => def.innerType._zod.values);\n    inst._zod.parse = (payload, ctx) => {\n        if (ctx.direction === \"backward\") {\n            return def.innerType._zod.run(payload, ctx);\n        }\n        // Forward direction (decode): apply prefault for undefined input\n        if (payload.value === undefined) {\n            payload.value = def.defaultValue;\n        }\n        return def.innerType._zod.run(payload, ctx);\n    };\n});\nexport const $ZodNonOptional = /*@__PURE__*/ core.$constructor(\"$ZodNonOptional\", (inst, def) => {\n    $ZodType.init(inst, def);\n    util.defineLazy(inst._zod, \"values\", () => {\n        const v = def.innerType._zod.values;\n        return v ? new Set([...v].filter((x) => x !== undefined)) : undefined;\n    });\n    inst._zod.parse = (payload, ctx) => {\n        const result = def.innerType._zod.run(payload, ctx);\n        if (result instanceof Promise) {\n            return result.then((result) => handleNonOptionalResult(result, inst));\n        }\n        return handleNonOptionalResult(result, inst);\n    };\n});\nfunction handleNonOptionalResult(payload, inst) {\n    if (!payload.issues.length && payload.value === undefined) {\n        payload.issues.push({\n            code: \"invalid_type\",\n            expected: \"nonoptional\",\n            input: payload.value,\n            inst,\n        });\n    }\n    return payload;\n}\nexport const $ZodSuccess = /*@__PURE__*/ core.$constructor(\"$ZodSuccess\", (inst, def) => {\n    $ZodType.init(inst, def);\n    inst._zod.parse = (payload, ctx) => {\n        if (ctx.direction === \"backward\") {\n            throw new core.$ZodEncodeError(\"ZodSuccess\");\n        }\n        const result = def.innerType._zod.run(payload, ctx);\n        if (result instanceof Promise) {\n            return result.then((result) => {\n                payload.value = result.issues.length === 0;\n                return payload;\n            });\n        }\n        payload.value = result.issues.length === 0;\n        return payload;\n    };\n});\nexport const $ZodCatch = /*@__PURE__*/ core.$constructor(\"$ZodCatch\", (inst, def) => {\n    $ZodType.init(inst, def);\n    util.defineLazy(inst._zod, \"optin\", () => def.innerType._zod.optin);\n    util.defineLazy(inst._zod, \"optout\", () => def.innerType._zod.optout);\n    util.defineLazy(inst._zod, \"values\", () => def.innerType._zod.values);\n    inst._zod.parse = (payload, ctx) => {\n        if (ctx.direction === \"backward\") {\n            return def.innerType._zod.run(payload, ctx);\n        }\n        // Forward direction (decode): apply catch logic\n        const result = def.innerType._zod.run(payload, ctx);\n        if (result instanceof Promise) {\n            return result.then((result) => {\n                payload.value = result.value;\n                if (result.issues.length) {\n                    payload.value = def.catchValue({\n                        ...payload,\n                        error: {\n                            issues: result.issues.map((iss) => util.finalizeIssue(iss, ctx, core.config())),\n                        },\n                        input: payload.value,\n                    });\n                    payload.issues = [];\n                }\n                return payload;\n            });\n        }\n        payload.value = result.value;\n        if (result.issues.length) {\n            payload.value = def.catchValue({\n                ...payload,\n                error: {\n                    issues: result.issues.map((iss) => util.finalizeIssue(iss, ctx, core.config())),\n                },\n                input: payload.value,\n            });\n            payload.issues = [];\n        }\n        return payload;\n    };\n});\nexport const $ZodNaN = /*@__PURE__*/ core.$constructor(\"$ZodNaN\", (inst, def) => {\n    $ZodType.init(inst, def);\n    inst._zod.parse = (payload, _ctx) => {\n        if (typeof payload.value !== \"number\" || !Number.isNaN(payload.value)) {\n            payload.issues.push({\n                input: payload.value,\n                inst,\n                expected: \"nan\",\n                code: \"invalid_type\",\n            });\n            return payload;\n        }\n        return payload;\n    };\n});\nexport const $ZodPipe = /*@__PURE__*/ core.$constructor(\"$ZodPipe\", (inst, def) => {\n    $ZodType.init(inst, def);\n    util.defineLazy(inst._zod, \"values\", () => def.in._zod.values);\n    util.defineLazy(inst._zod, \"optin\", () => def.in._zod.optin);\n    util.defineLazy(inst._zod, \"optout\", () => def.out._zod.optout);\n    util.defineLazy(inst._zod, \"propValues\", () => def.in._zod.propValues);\n    inst._zod.parse = (payload, ctx) => {\n        if (ctx.direction === \"backward\") {\n            const right = def.out._zod.run(payload, ctx);\n            if (right instanceof Promise) {\n                return right.then((right) => handlePipeResult(right, def.in, ctx));\n            }\n            return handlePipeResult(right, def.in, ctx);\n        }\n        const left = def.in._zod.run(payload, ctx);\n        if (left instanceof Promise) {\n            return left.then((left) => handlePipeResult(left, def.out, ctx));\n        }\n        return handlePipeResult(left, def.out, ctx);\n    };\n});\nfunction handlePipeResult(left, next, ctx) {\n    if (left.issues.length) {\n        // prevent further checks\n        left.aborted = true;\n        return left;\n    }\n    return next._zod.run({ value: left.value, issues: left.issues }, ctx);\n}\nexport const $ZodCodec = /*@__PURE__*/ core.$constructor(\"$ZodCodec\", (inst, def) => {\n    $ZodType.init(inst, def);\n    util.defineLazy(inst._zod, \"values\", () => def.in._zod.values);\n    util.defineLazy(inst._zod, \"optin\", () => def.in._zod.optin);\n    util.defineLazy(inst._zod, \"optout\", () => def.out._zod.optout);\n    util.defineLazy(inst._zod, \"propValues\", () => def.in._zod.propValues);\n    inst._zod.parse = (payload, ctx) => {\n        const direction = ctx.direction || \"forward\";\n        if (direction === \"forward\") {\n            const left = def.in._zod.run(payload, ctx);\n            if (left instanceof Promise) {\n                return left.then((left) => handleCodecAResult(left, def, ctx));\n            }\n            return handleCodecAResult(left, def, ctx);\n        }\n        else {\n            const right = def.out._zod.run(payload, ctx);\n            if (right instanceof Promise) {\n                return right.then((right) => handleCodecAResult(right, def, ctx));\n            }\n            return handleCodecAResult(right, def, ctx);\n        }\n    };\n});\nfunction handleCodecAResult(result, def, ctx) {\n    if (result.issues.length) {\n        // prevent further checks\n        result.aborted = true;\n        return result;\n    }\n    const direction = ctx.direction || \"forward\";\n    if (direction === \"forward\") {\n        const transformed = def.transform(result.value, result);\n        if (transformed instanceof Promise) {\n            return transformed.then((value) => handleCodecTxResult(result, value, def.out, ctx));\n        }\n        return handleCodecTxResult(result, transformed, def.out, ctx);\n    }\n    else {\n        const transformed = def.reverseTransform(result.value, result);\n        if (transformed instanceof Promise) {\n            return transformed.then((value) => handleCodecTxResult(result, value, def.in, ctx));\n        }\n        return handleCodecTxResult(result, transformed, def.in, ctx);\n    }\n}\nfunction handleCodecTxResult(left, value, nextSchema, ctx) {\n    // Check if transform added any issues\n    if (left.issues.length) {\n        left.aborted = true;\n        return left;\n    }\n    return nextSchema._zod.run({ value, issues: left.issues }, ctx);\n}\nexport const $ZodReadonly = /*@__PURE__*/ core.$constructor(\"$ZodReadonly\", (inst, def) => {\n    $ZodType.init(inst, def);\n    util.defineLazy(inst._zod, \"propValues\", () => def.innerType._zod.propValues);\n    util.defineLazy(inst._zod, \"values\", () => def.innerType._zod.values);\n    util.defineLazy(inst._zod, \"optin\", () => def.innerType?._zod?.optin);\n    util.defineLazy(inst._zod, \"optout\", () => def.innerType?._zod?.optout);\n    inst._zod.parse = (payload, ctx) => {\n        if (ctx.direction === \"backward\") {\n            return def.innerType._zod.run(payload, ctx);\n        }\n        const result = def.innerType._zod.run(payload, ctx);\n        if (result instanceof Promise) {\n            return result.then(handleReadonlyResult);\n        }\n        return handleReadonlyResult(result);\n    };\n});\nfunction handleReadonlyResult(payload) {\n    payload.value = Object.freeze(payload.value);\n    return payload;\n}\nexport const $ZodTemplateLiteral = /*@__PURE__*/ core.$constructor(\"$ZodTemplateLiteral\", (inst, def) => {\n    $ZodType.init(inst, def);\n    const regexParts = [];\n    for (const part of def.parts) {\n        if (typeof part === \"object\" && part !== null) {\n            // is Zod schema\n            if (!part._zod.pattern) {\n                // if (!source)\n                throw new Error(`Invalid template literal part, no pattern found: ${[...part._zod.traits].shift()}`);\n            }\n            const source = part._zod.pattern instanceof RegExp ? part._zod.pattern.source : part._zod.pattern;\n            if (!source)\n                throw new Error(`Invalid template literal part: ${part._zod.traits}`);\n            const start = source.startsWith(\"^\") ? 1 : 0;\n            const end = source.endsWith(\"$\") ? source.length - 1 : source.length;\n            regexParts.push(source.slice(start, end));\n        }\n        else if (part === null || util.primitiveTypes.has(typeof part)) {\n            regexParts.push(util.escapeRegex(`${part}`));\n        }\n        else {\n            throw new Error(`Invalid template literal part: ${part}`);\n        }\n    }\n    inst._zod.pattern = new RegExp(`^${regexParts.join(\"\")}$`);\n    inst._zod.parse = (payload, _ctx) => {\n        if (typeof payload.value !== \"string\") {\n            payload.issues.push({\n                input: payload.value,\n                inst,\n                expected: \"template_literal\",\n                code: \"invalid_type\",\n            });\n            return payload;\n        }\n        inst._zod.pattern.lastIndex = 0;\n        if (!inst._zod.pattern.test(payload.value)) {\n            payload.issues.push({\n                input: payload.value,\n                inst,\n                code: \"invalid_format\",\n                format: def.format ?? \"template_literal\",\n                pattern: inst._zod.pattern.source,\n            });\n            return payload;\n        }\n        return payload;\n    };\n});\nexport const $ZodFunction = /*@__PURE__*/ core.$constructor(\"$ZodFunction\", (inst, def) => {\n    $ZodType.init(inst, def);\n    inst._def = def;\n    inst._zod.def = def;\n    inst.implement = (func) => {\n        if (typeof func !== \"function\") {\n            throw new Error(\"implement() must be called with a function\");\n        }\n        return function (...args) {\n            const parsedArgs = inst._def.input ? parse(inst._def.input, args) : args;\n            const result = Reflect.apply(func, this, parsedArgs);\n            if (inst._def.output) {\n                return parse(inst._def.output, result);\n            }\n            return result;\n        };\n    };\n    inst.implementAsync = (func) => {\n        if (typeof func !== \"function\") {\n            throw new Error(\"implementAsync() must be called with a function\");\n        }\n        return async function (...args) {\n            const parsedArgs = inst._def.input ? await parseAsync(inst._def.input, args) : args;\n            const result = await Reflect.apply(func, this, parsedArgs);\n            if (inst._def.output) {\n                return await parseAsync(inst._def.output, result);\n            }\n            return result;\n        };\n    };\n    inst._zod.parse = (payload, _ctx) => {\n        if (typeof payload.value !== \"function\") {\n            payload.issues.push({\n                code: \"invalid_type\",\n                expected: \"function\",\n                input: payload.value,\n                inst,\n            });\n            return payload;\n        }\n        // Check if output is a promise type to determine if we should use async implementation\n        const hasPromiseOutput = inst._def.output && inst._def.output._zod.def.type === \"promise\";\n        if (hasPromiseOutput) {\n            payload.value = inst.implementAsync(payload.value);\n        }\n        else {\n            payload.value = inst.implement(payload.value);\n        }\n        return payload;\n    };\n    inst.input = (...args) => {\n        const F = inst.constructor;\n        if (Array.isArray(args[0])) {\n            return new F({\n                type: \"function\",\n                input: new $ZodTuple({\n                    type: \"tuple\",\n                    items: args[0],\n                    rest: args[1],\n                }),\n                output: inst._def.output,\n            });\n        }\n        return new F({\n            type: \"function\",\n            input: args[0],\n            output: inst._def.output,\n        });\n    };\n    inst.output = (output) => {\n        const F = inst.constructor;\n        return new F({\n            type: \"function\",\n            input: inst._def.input,\n            output,\n        });\n    };\n    return inst;\n});\nexport const $ZodPromise = /*@__PURE__*/ core.$constructor(\"$ZodPromise\", (inst, def) => {\n    $ZodType.init(inst, def);\n    inst._zod.parse = (payload, ctx) => {\n        return Promise.resolve(payload.value).then((inner) => def.innerType._zod.run({ value: inner, issues: [] }, ctx));\n    };\n});\nexport const $ZodLazy = /*@__PURE__*/ core.$constructor(\"$ZodLazy\", (inst, def) => {\n    $ZodType.init(inst, def);\n    // let _innerType!: any;\n    // util.defineLazy(def, \"getter\", () => {\n    //   if (!_innerType) {\n    //     _innerType = def.getter();\n    //   }\n    //   return () => _innerType;\n    // });\n    util.defineLazy(inst._zod, \"innerType\", () => def.getter());\n    util.defineLazy(inst._zod, \"pattern\", () => inst._zod.innerType?._zod?.pattern);\n    util.defineLazy(inst._zod, \"propValues\", () => inst._zod.innerType?._zod?.propValues);\n    util.defineLazy(inst._zod, \"optin\", () => inst._zod.innerType?._zod?.optin ?? undefined);\n    util.defineLazy(inst._zod, \"optout\", () => inst._zod.innerType?._zod?.optout ?? undefined);\n    inst._zod.parse = (payload, ctx) => {\n        const inner = inst._zod.innerType;\n        return inner._zod.run(payload, ctx);\n    };\n});\nexport const $ZodCustom = /*@__PURE__*/ core.$constructor(\"$ZodCustom\", (inst, def) => {\n    checks.$ZodCheck.init(inst, def);\n    $ZodType.init(inst, def);\n    inst._zod.parse = (payload, _) => {\n        return payload;\n    };\n    inst._zod.check = (payload) => {\n        const input = payload.value;\n        const r = def.fn(input);\n        if (r instanceof Promise) {\n            return r.then((r) => handleRefineResult(r, payload, input, inst));\n        }\n        handleRefineResult(r, payload, input, inst);\n        return;\n    };\n});\nfunction handleRefineResult(result, payload, input, inst) {\n    if (!result) {\n        const _iss = {\n            code: \"custom\",\n            input,\n            inst, // incorporates params.error into issue reporting\n            path: [...(inst._zod.def.path ?? [])], // incorporates params.error into issue reporting\n            continue: !inst._zod.def.abort,\n            // params: inst._zod.def.params,\n        };\n        if (inst._zod.def.params)\n            _iss.params = inst._zod.def.params;\n        payload.issues.push(util.issue(_iss));\n    }\n}\n","var _a;\nexport const $output = Symbol(\"ZodOutput\");\nexport const $input = Symbol(\"ZodInput\");\nexport class $ZodRegistry {\n    constructor() {\n        this._map = new WeakMap();\n        this._idmap = new Map();\n    }\n    add(schema, ..._meta) {\n        const meta = _meta[0];\n        this._map.set(schema, meta);\n        if (meta && typeof meta === \"object\" && \"id\" in meta) {\n            if (this._idmap.has(meta.id)) {\n                throw new Error(`ID ${meta.id} already exists in the registry`);\n            }\n            this._idmap.set(meta.id, schema);\n        }\n        return this;\n    }\n    clear() {\n        this._map = new WeakMap();\n        this._idmap = new Map();\n        return this;\n    }\n    remove(schema) {\n        const meta = this._map.get(schema);\n        if (meta && typeof meta === \"object\" && \"id\" in meta) {\n            this._idmap.delete(meta.id);\n        }\n        this._map.delete(schema);\n        return this;\n    }\n    get(schema) {\n        // return this._map.get(schema) as any;\n        // inherit metadata\n        const p = schema._zod.parent;\n        if (p) {\n            const pm = { ...(this.get(p) ?? {}) };\n            delete pm.id; // do not inherit id\n            const f = { ...pm, ...this._map.get(schema) };\n            return Object.keys(f).length ? f : undefined;\n        }\n        return this._map.get(schema);\n    }\n    has(schema) {\n        return this._map.has(schema);\n    }\n}\n// registries\nexport function registry() {\n    return new $ZodRegistry();\n}\n(_a = globalThis).__zod_globalRegistry ?? (_a.__zod_globalRegistry = registry());\nexport const globalRegistry = globalThis.__zod_globalRegistry;\n","import * as checks from \"./checks.js\";\nimport * as registries from \"./registries.js\";\nimport * as schemas from \"./schemas.js\";\nimport * as util from \"./util.js\";\nexport function _string(Class, params) {\n    return new Class({\n        type: \"string\",\n        ...util.normalizeParams(params),\n    });\n}\nexport function _coercedString(Class, params) {\n    return new Class({\n        type: \"string\",\n        coerce: true,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _email(Class, params) {\n    return new Class({\n        type: \"string\",\n        format: \"email\",\n        check: \"string_format\",\n        abort: false,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _guid(Class, params) {\n    return new Class({\n        type: \"string\",\n        format: \"guid\",\n        check: \"string_format\",\n        abort: false,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _uuid(Class, params) {\n    return new Class({\n        type: \"string\",\n        format: \"uuid\",\n        check: \"string_format\",\n        abort: false,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _uuidv4(Class, params) {\n    return new Class({\n        type: \"string\",\n        format: \"uuid\",\n        check: \"string_format\",\n        abort: false,\n        version: \"v4\",\n        ...util.normalizeParams(params),\n    });\n}\nexport function _uuidv6(Class, params) {\n    return new Class({\n        type: \"string\",\n        format: \"uuid\",\n        check: \"string_format\",\n        abort: false,\n        version: \"v6\",\n        ...util.normalizeParams(params),\n    });\n}\nexport function _uuidv7(Class, params) {\n    return new Class({\n        type: \"string\",\n        format: \"uuid\",\n        check: \"string_format\",\n        abort: false,\n        version: \"v7\",\n        ...util.normalizeParams(params),\n    });\n}\nexport function _url(Class, params) {\n    return new Class({\n        type: \"string\",\n        format: \"url\",\n        check: \"string_format\",\n        abort: false,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _emoji(Class, params) {\n    return new Class({\n        type: \"string\",\n        format: \"emoji\",\n        check: \"string_format\",\n        abort: false,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _nanoid(Class, params) {\n    return new Class({\n        type: \"string\",\n        format: \"nanoid\",\n        check: \"string_format\",\n        abort: false,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _cuid(Class, params) {\n    return new Class({\n        type: \"string\",\n        format: \"cuid\",\n        check: \"string_format\",\n        abort: false,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _cuid2(Class, params) {\n    return new Class({\n        type: \"string\",\n        format: \"cuid2\",\n        check: \"string_format\",\n        abort: false,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _ulid(Class, params) {\n    return new Class({\n        type: \"string\",\n        format: \"ulid\",\n        check: \"string_format\",\n        abort: false,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _xid(Class, params) {\n    return new Class({\n        type: \"string\",\n        format: \"xid\",\n        check: \"string_format\",\n        abort: false,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _ksuid(Class, params) {\n    return new Class({\n        type: \"string\",\n        format: \"ksuid\",\n        check: \"string_format\",\n        abort: false,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _ipv4(Class, params) {\n    return new Class({\n        type: \"string\",\n        format: \"ipv4\",\n        check: \"string_format\",\n        abort: false,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _ipv6(Class, params) {\n    return new Class({\n        type: \"string\",\n        format: \"ipv6\",\n        check: \"string_format\",\n        abort: false,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _mac(Class, params) {\n    return new Class({\n        type: \"string\",\n        format: \"mac\",\n        check: \"string_format\",\n        abort: false,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _cidrv4(Class, params) {\n    return new Class({\n        type: \"string\",\n        format: \"cidrv4\",\n        check: \"string_format\",\n        abort: false,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _cidrv6(Class, params) {\n    return new Class({\n        type: \"string\",\n        format: \"cidrv6\",\n        check: \"string_format\",\n        abort: false,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _base64(Class, params) {\n    return new Class({\n        type: \"string\",\n        format: \"base64\",\n        check: \"string_format\",\n        abort: false,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _base64url(Class, params) {\n    return new Class({\n        type: \"string\",\n        format: \"base64url\",\n        check: \"string_format\",\n        abort: false,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _e164(Class, params) {\n    return new Class({\n        type: \"string\",\n        format: \"e164\",\n        check: \"string_format\",\n        abort: false,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _jwt(Class, params) {\n    return new Class({\n        type: \"string\",\n        format: \"jwt\",\n        check: \"string_format\",\n        abort: false,\n        ...util.normalizeParams(params),\n    });\n}\nexport const TimePrecision = {\n    Any: null,\n    Minute: -1,\n    Second: 0,\n    Millisecond: 3,\n    Microsecond: 6,\n};\nexport function _isoDateTime(Class, params) {\n    return new Class({\n        type: \"string\",\n        format: \"datetime\",\n        check: \"string_format\",\n        offset: false,\n        local: false,\n        precision: null,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _isoDate(Class, params) {\n    return new Class({\n        type: \"string\",\n        format: \"date\",\n        check: \"string_format\",\n        ...util.normalizeParams(params),\n    });\n}\nexport function _isoTime(Class, params) {\n    return new Class({\n        type: \"string\",\n        format: \"time\",\n        check: \"string_format\",\n        precision: null,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _isoDuration(Class, params) {\n    return new Class({\n        type: \"string\",\n        format: \"duration\",\n        check: \"string_format\",\n        ...util.normalizeParams(params),\n    });\n}\nexport function _number(Class, params) {\n    return new Class({\n        type: \"number\",\n        checks: [],\n        ...util.normalizeParams(params),\n    });\n}\nexport function _coercedNumber(Class, params) {\n    return new Class({\n        type: \"number\",\n        coerce: true,\n        checks: [],\n        ...util.normalizeParams(params),\n    });\n}\nexport function _int(Class, params) {\n    return new Class({\n        type: \"number\",\n        check: \"number_format\",\n        abort: false,\n        format: \"safeint\",\n        ...util.normalizeParams(params),\n    });\n}\nexport function _float32(Class, params) {\n    return new Class({\n        type: \"number\",\n        check: \"number_format\",\n        abort: false,\n        format: \"float32\",\n        ...util.normalizeParams(params),\n    });\n}\nexport function _float64(Class, params) {\n    return new Class({\n        type: \"number\",\n        check: \"number_format\",\n        abort: false,\n        format: \"float64\",\n        ...util.normalizeParams(params),\n    });\n}\nexport function _int32(Class, params) {\n    return new Class({\n        type: \"number\",\n        check: \"number_format\",\n        abort: false,\n        format: \"int32\",\n        ...util.normalizeParams(params),\n    });\n}\nexport function _uint32(Class, params) {\n    return new Class({\n        type: \"number\",\n        check: \"number_format\",\n        abort: false,\n        format: \"uint32\",\n        ...util.normalizeParams(params),\n    });\n}\nexport function _boolean(Class, params) {\n    return new Class({\n        type: \"boolean\",\n        ...util.normalizeParams(params),\n    });\n}\nexport function _coercedBoolean(Class, params) {\n    return new Class({\n        type: \"boolean\",\n        coerce: true,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _bigint(Class, params) {\n    return new Class({\n        type: \"bigint\",\n        ...util.normalizeParams(params),\n    });\n}\nexport function _coercedBigint(Class, params) {\n    return new Class({\n        type: \"bigint\",\n        coerce: true,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _int64(Class, params) {\n    return new Class({\n        type: \"bigint\",\n        check: \"bigint_format\",\n        abort: false,\n        format: \"int64\",\n        ...util.normalizeParams(params),\n    });\n}\nexport function _uint64(Class, params) {\n    return new Class({\n        type: \"bigint\",\n        check: \"bigint_format\",\n        abort: false,\n        format: \"uint64\",\n        ...util.normalizeParams(params),\n    });\n}\nexport function _symbol(Class, params) {\n    return new Class({\n        type: \"symbol\",\n        ...util.normalizeParams(params),\n    });\n}\nexport function _undefined(Class, params) {\n    return new Class({\n        type: \"undefined\",\n        ...util.normalizeParams(params),\n    });\n}\nexport function _null(Class, params) {\n    return new Class({\n        type: \"null\",\n        ...util.normalizeParams(params),\n    });\n}\nexport function _any(Class) {\n    return new Class({\n        type: \"any\",\n    });\n}\nexport function _unknown(Class) {\n    return new Class({\n        type: \"unknown\",\n    });\n}\nexport function _never(Class, params) {\n    return new Class({\n        type: \"never\",\n        ...util.normalizeParams(params),\n    });\n}\nexport function _void(Class, params) {\n    return new Class({\n        type: \"void\",\n        ...util.normalizeParams(params),\n    });\n}\nexport function _date(Class, params) {\n    return new Class({\n        type: \"date\",\n        ...util.normalizeParams(params),\n    });\n}\nexport function _coercedDate(Class, params) {\n    return new Class({\n        type: \"date\",\n        coerce: true,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _nan(Class, params) {\n    return new Class({\n        type: \"nan\",\n        ...util.normalizeParams(params),\n    });\n}\nexport function _lt(value, params) {\n    return new checks.$ZodCheckLessThan({\n        check: \"less_than\",\n        ...util.normalizeParams(params),\n        value,\n        inclusive: false,\n    });\n}\nexport function _lte(value, params) {\n    return new checks.$ZodCheckLessThan({\n        check: \"less_than\",\n        ...util.normalizeParams(params),\n        value,\n        inclusive: true,\n    });\n}\nexport { \n/** @deprecated Use `z.lte()` instead. */\n_lte as _max, };\nexport function _gt(value, params) {\n    return new checks.$ZodCheckGreaterThan({\n        check: \"greater_than\",\n        ...util.normalizeParams(params),\n        value,\n        inclusive: false,\n    });\n}\nexport function _gte(value, params) {\n    return new checks.$ZodCheckGreaterThan({\n        check: \"greater_than\",\n        ...util.normalizeParams(params),\n        value,\n        inclusive: true,\n    });\n}\nexport { \n/** @deprecated Use `z.gte()` instead. */\n_gte as _min, };\nexport function _positive(params) {\n    return _gt(0, params);\n}\n// negative\nexport function _negative(params) {\n    return _lt(0, params);\n}\n// nonpositive\nexport function _nonpositive(params) {\n    return _lte(0, params);\n}\n// nonnegative\nexport function _nonnegative(params) {\n    return _gte(0, params);\n}\nexport function _multipleOf(value, params) {\n    return new checks.$ZodCheckMultipleOf({\n        check: \"multiple_of\",\n        ...util.normalizeParams(params),\n        value,\n    });\n}\nexport function _maxSize(maximum, params) {\n    return new checks.$ZodCheckMaxSize({\n        check: \"max_size\",\n        ...util.normalizeParams(params),\n        maximum,\n    });\n}\nexport function _minSize(minimum, params) {\n    return new checks.$ZodCheckMinSize({\n        check: \"min_size\",\n        ...util.normalizeParams(params),\n        minimum,\n    });\n}\nexport function _size(size, params) {\n    return new checks.$ZodCheckSizeEquals({\n        check: \"size_equals\",\n        ...util.normalizeParams(params),\n        size,\n    });\n}\nexport function _maxLength(maximum, params) {\n    const ch = new checks.$ZodCheckMaxLength({\n        check: \"max_length\",\n        ...util.normalizeParams(params),\n        maximum,\n    });\n    return ch;\n}\nexport function _minLength(minimum, params) {\n    return new checks.$ZodCheckMinLength({\n        check: \"min_length\",\n        ...util.normalizeParams(params),\n        minimum,\n    });\n}\nexport function _length(length, params) {\n    return new checks.$ZodCheckLengthEquals({\n        check: \"length_equals\",\n        ...util.normalizeParams(params),\n        length,\n    });\n}\nexport function _regex(pattern, params) {\n    return new checks.$ZodCheckRegex({\n        check: \"string_format\",\n        format: \"regex\",\n        ...util.normalizeParams(params),\n        pattern,\n    });\n}\nexport function _lowercase(params) {\n    return new checks.$ZodCheckLowerCase({\n        check: \"string_format\",\n        format: \"lowercase\",\n        ...util.normalizeParams(params),\n    });\n}\nexport function _uppercase(params) {\n    return new checks.$ZodCheckUpperCase({\n        check: \"string_format\",\n        format: \"uppercase\",\n        ...util.normalizeParams(params),\n    });\n}\nexport function _includes(includes, params) {\n    return new checks.$ZodCheckIncludes({\n        check: \"string_format\",\n        format: \"includes\",\n        ...util.normalizeParams(params),\n        includes,\n    });\n}\nexport function _startsWith(prefix, params) {\n    return new checks.$ZodCheckStartsWith({\n        check: \"string_format\",\n        format: \"starts_with\",\n        ...util.normalizeParams(params),\n        prefix,\n    });\n}\nexport function _endsWith(suffix, params) {\n    return new checks.$ZodCheckEndsWith({\n        check: \"string_format\",\n        format: \"ends_with\",\n        ...util.normalizeParams(params),\n        suffix,\n    });\n}\nexport function _property(property, schema, params) {\n    return new checks.$ZodCheckProperty({\n        check: \"property\",\n        property,\n        schema,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _mime(types, params) {\n    return new checks.$ZodCheckMimeType({\n        check: \"mime_type\",\n        mime: types,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _overwrite(tx) {\n    return new checks.$ZodCheckOverwrite({\n        check: \"overwrite\",\n        tx,\n    });\n}\n// normalize\nexport function _normalize(form) {\n    return _overwrite((input) => input.normalize(form));\n}\n// trim\nexport function _trim() {\n    return _overwrite((input) => input.trim());\n}\n// toLowerCase\nexport function _toLowerCase() {\n    return _overwrite((input) => input.toLowerCase());\n}\n// toUpperCase\nexport function _toUpperCase() {\n    return _overwrite((input) => input.toUpperCase());\n}\n// slugify\nexport function _slugify() {\n    return _overwrite((input) => util.slugify(input));\n}\nexport function _array(Class, element, params) {\n    return new Class({\n        type: \"array\",\n        element,\n        // get element() {\n        //   return element;\n        // },\n        ...util.normalizeParams(params),\n    });\n}\nexport function _union(Class, options, params) {\n    return new Class({\n        type: \"union\",\n        options,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _discriminatedUnion(Class, discriminator, options, params) {\n    return new Class({\n        type: \"union\",\n        options,\n        discriminator,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _intersection(Class, left, right) {\n    return new Class({\n        type: \"intersection\",\n        left,\n        right,\n    });\n}\n// export function _tuple(\n//   Class: util.SchemaClass<schemas.$ZodTuple>,\n//   items: [],\n//   params?: string | $ZodTupleParams\n// ): schemas.$ZodTuple<[], null>;\nexport function _tuple(Class, items, _paramsOrRest, _params) {\n    const hasRest = _paramsOrRest instanceof schemas.$ZodType;\n    const params = hasRest ? _params : _paramsOrRest;\n    const rest = hasRest ? _paramsOrRest : null;\n    return new Class({\n        type: \"tuple\",\n        items,\n        rest,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _record(Class, keyType, valueType, params) {\n    return new Class({\n        type: \"record\",\n        keyType,\n        valueType,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _map(Class, keyType, valueType, params) {\n    return new Class({\n        type: \"map\",\n        keyType,\n        valueType,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _set(Class, valueType, params) {\n    return new Class({\n        type: \"set\",\n        valueType,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _enum(Class, values, params) {\n    const entries = Array.isArray(values) ? Object.fromEntries(values.map((v) => [v, v])) : values;\n    // if (Array.isArray(values)) {\n    //   for (const value of values) {\n    //     entries[value] = value;\n    //   }\n    // } else {\n    //   Object.assign(entries, values);\n    // }\n    // const entries: util.EnumLike = {};\n    // for (const val of values) {\n    //   entries[val] = val;\n    // }\n    return new Class({\n        type: \"enum\",\n        entries,\n        ...util.normalizeParams(params),\n    });\n}\n/** @deprecated This API has been merged into `z.enum()`. Use `z.enum()` instead.\n *\n * ```ts\n * enum Colors { red, green, blue }\n * z.enum(Colors);\n * ```\n */\nexport function _nativeEnum(Class, entries, params) {\n    return new Class({\n        type: \"enum\",\n        entries,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _literal(Class, value, params) {\n    return new Class({\n        type: \"literal\",\n        values: Array.isArray(value) ? value : [value],\n        ...util.normalizeParams(params),\n    });\n}\nexport function _file(Class, params) {\n    return new Class({\n        type: \"file\",\n        ...util.normalizeParams(params),\n    });\n}\nexport function _transform(Class, fn) {\n    return new Class({\n        type: \"transform\",\n        transform: fn,\n    });\n}\nexport function _optional(Class, innerType) {\n    return new Class({\n        type: \"optional\",\n        innerType,\n    });\n}\nexport function _nullable(Class, innerType) {\n    return new Class({\n        type: \"nullable\",\n        innerType,\n    });\n}\nexport function _default(Class, innerType, defaultValue) {\n    return new Class({\n        type: \"default\",\n        innerType,\n        get defaultValue() {\n            return typeof defaultValue === \"function\" ? defaultValue() : util.shallowClone(defaultValue);\n        },\n    });\n}\nexport function _nonoptional(Class, innerType, params) {\n    return new Class({\n        type: \"nonoptional\",\n        innerType,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _success(Class, innerType) {\n    return new Class({\n        type: \"success\",\n        innerType,\n    });\n}\nexport function _catch(Class, innerType, catchValue) {\n    return new Class({\n        type: \"catch\",\n        innerType,\n        catchValue: (typeof catchValue === \"function\" ? catchValue : () => catchValue),\n    });\n}\nexport function _pipe(Class, in_, out) {\n    return new Class({\n        type: \"pipe\",\n        in: in_,\n        out,\n    });\n}\nexport function _readonly(Class, innerType) {\n    return new Class({\n        type: \"readonly\",\n        innerType,\n    });\n}\nexport function _templateLiteral(Class, parts, params) {\n    return new Class({\n        type: \"template_literal\",\n        parts,\n        ...util.normalizeParams(params),\n    });\n}\nexport function _lazy(Class, getter) {\n    return new Class({\n        type: \"lazy\",\n        getter,\n    });\n}\nexport function _promise(Class, innerType) {\n    return new Class({\n        type: \"promise\",\n        innerType,\n    });\n}\nexport function _custom(Class, fn, _params) {\n    const norm = util.normalizeParams(_params);\n    norm.abort ?? (norm.abort = true); // default to abort:false\n    const schema = new Class({\n        type: \"custom\",\n        check: \"custom\",\n        fn: fn,\n        ...norm,\n    });\n    return schema;\n}\n// same as _custom but defaults to abort:false\nexport function _refine(Class, fn, _params) {\n    const schema = new Class({\n        type: \"custom\",\n        check: \"custom\",\n        fn: fn,\n        ...util.normalizeParams(_params),\n    });\n    return schema;\n}\nexport function _superRefine(fn) {\n    const ch = _check((payload) => {\n        payload.addIssue = (issue) => {\n            if (typeof issue === \"string\") {\n                payload.issues.push(util.issue(issue, payload.value, ch._zod.def));\n            }\n            else {\n                // for Zod 3 backwards compatibility\n                const _issue = issue;\n                if (_issue.fatal)\n                    _issue.continue = false;\n                _issue.code ?? (_issue.code = \"custom\");\n                _issue.input ?? (_issue.input = payload.value);\n                _issue.inst ?? (_issue.inst = ch);\n                _issue.continue ?? (_issue.continue = !ch._zod.def.abort); // abort is always undefined, so this is always true...\n                payload.issues.push(util.issue(_issue));\n            }\n        };\n        return fn(payload.value, payload);\n    });\n    return ch;\n}\nexport function _check(fn, params) {\n    const ch = new checks.$ZodCheck({\n        check: \"custom\",\n        ...util.normalizeParams(params),\n    });\n    ch._zod.check = fn;\n    return ch;\n}\nexport function describe(description) {\n    const ch = new checks.$ZodCheck({ check: \"describe\" });\n    ch._zod.onattach = [\n        (inst) => {\n            const existing = registries.globalRegistry.get(inst) ?? {};\n            registries.globalRegistry.add(inst, { ...existing, description });\n        },\n    ];\n    ch._zod.check = () => { }; // no-op check\n    return ch;\n}\nexport function meta(metadata) {\n    const ch = new checks.$ZodCheck({ check: \"meta\" });\n    ch._zod.onattach = [\n        (inst) => {\n            const existing = registries.globalRegistry.get(inst) ?? {};\n            registries.globalRegistry.add(inst, { ...existing, ...metadata });\n        },\n    ];\n    ch._zod.check = () => { }; // no-op check\n    return ch;\n}\nexport function _stringbool(Classes, _params) {\n    const params = util.normalizeParams(_params);\n    let truthyArray = params.truthy ?? [\"true\", \"1\", \"yes\", \"on\", \"y\", \"enabled\"];\n    let falsyArray = params.falsy ?? [\"false\", \"0\", \"no\", \"off\", \"n\", \"disabled\"];\n    if (params.case !== \"sensitive\") {\n        truthyArray = truthyArray.map((v) => (typeof v === \"string\" ? v.toLowerCase() : v));\n        falsyArray = falsyArray.map((v) => (typeof v === \"string\" ? v.toLowerCase() : v));\n    }\n    const truthySet = new Set(truthyArray);\n    const falsySet = new Set(falsyArray);\n    const _Codec = Classes.Codec ?? schemas.$ZodCodec;\n    const _Boolean = Classes.Boolean ?? schemas.$ZodBoolean;\n    const _String = Classes.String ?? schemas.$ZodString;\n    const stringSchema = new _String({ type: \"string\", error: params.error });\n    const booleanSchema = new _Boolean({ type: \"boolean\", error: params.error });\n    const codec = new _Codec({\n        type: \"pipe\",\n        in: stringSchema,\n        out: booleanSchema,\n        transform: ((input, payload) => {\n            let data = input;\n            if (params.case !== \"sensitive\")\n                data = data.toLowerCase();\n            if (truthySet.has(data)) {\n                return true;\n            }\n            else if (falsySet.has(data)) {\n                return false;\n            }\n            else {\n                payload.issues.push({\n                    code: \"invalid_value\",\n                    expected: \"stringbool\",\n                    values: [...truthySet, ...falsySet],\n                    input: payload.value,\n                    inst: codec,\n                    continue: false,\n                });\n                return {};\n            }\n        }),\n        reverseTransform: ((input, _payload) => {\n            if (input === true) {\n                return truthyArray[0] || \"true\";\n            }\n            else {\n                return falsyArray[0] || \"false\";\n            }\n        }),\n        error: params.error,\n    });\n    return codec;\n}\nexport function _stringFormat(Class, format, fnOrRegex, _params = {}) {\n    const params = util.normalizeParams(_params);\n    const def = {\n        ...util.normalizeParams(_params),\n        check: \"string_format\",\n        type: \"string\",\n        format,\n        fn: typeof fnOrRegex === \"function\" ? fnOrRegex : (val) => fnOrRegex.test(val),\n        ...params,\n    };\n    if (fnOrRegex instanceof RegExp) {\n        def.pattern = fnOrRegex;\n    }\n    const inst = new Class(def);\n    return inst;\n}\n","import * as core from \"../core/index.js\";\nimport * as schemas from \"./schemas.js\";\nexport const ZodISODateTime = /*@__PURE__*/ core.$constructor(\"ZodISODateTime\", (inst, def) => {\n    core.$ZodISODateTime.init(inst, def);\n    schemas.ZodStringFormat.init(inst, def);\n});\nexport function datetime(params) {\n    return core._isoDateTime(ZodISODateTime, params);\n}\nexport const ZodISODate = /*@__PURE__*/ core.$constructor(\"ZodISODate\", (inst, def) => {\n    core.$ZodISODate.init(inst, def);\n    schemas.ZodStringFormat.init(inst, def);\n});\nexport function date(params) {\n    return core._isoDate(ZodISODate, params);\n}\nexport const ZodISOTime = /*@__PURE__*/ core.$constructor(\"ZodISOTime\", (inst, def) => {\n    core.$ZodISOTime.init(inst, def);\n    schemas.ZodStringFormat.init(inst, def);\n});\nexport function time(params) {\n    return core._isoTime(ZodISOTime, params);\n}\nexport const ZodISODuration = /*@__PURE__*/ core.$constructor(\"ZodISODuration\", (inst, def) => {\n    core.$ZodISODuration.init(inst, def);\n    schemas.ZodStringFormat.init(inst, def);\n});\nexport function duration(params) {\n    return core._isoDuration(ZodISODuration, params);\n}\n","import * as core from \"../core/index.js\";\nimport { $ZodError } from \"../core/index.js\";\nimport * as util from \"../core/util.js\";\nconst initializer = (inst, issues) => {\n    $ZodError.init(inst, issues);\n    inst.name = \"ZodError\";\n    Object.defineProperties(inst, {\n        format: {\n            value: (mapper) => core.formatError(inst, mapper),\n            // enumerable: false,\n        },\n        flatten: {\n            value: (mapper) => core.flattenError(inst, mapper),\n            // enumerable: false,\n        },\n        addIssue: {\n            value: (issue) => {\n                inst.issues.push(issue);\n                inst.message = JSON.stringify(inst.issues, util.jsonStringifyReplacer, 2);\n            },\n            // enumerable: false,\n        },\n        addIssues: {\n            value: (issues) => {\n                inst.issues.push(...issues);\n                inst.message = JSON.stringify(inst.issues, util.jsonStringifyReplacer, 2);\n            },\n            // enumerable: false,\n        },\n        isEmpty: {\n            get() {\n                return inst.issues.length === 0;\n            },\n            // enumerable: false,\n        },\n    });\n    // Object.defineProperty(inst, \"isEmpty\", {\n    //   get() {\n    //     return inst.issues.length === 0;\n    //   },\n    // });\n};\nexport const ZodError = core.$constructor(\"ZodError\", initializer);\nexport const ZodRealError = core.$constructor(\"ZodError\", initializer, {\n    Parent: Error,\n});\n// /** @deprecated Use `z.core.$ZodErrorMapCtx` instead. */\n// export type ErrorMapCtx = core.$ZodErrorMapCtx;\n","import * as core from \"../core/index.js\";\nimport { ZodRealError } from \"./errors.js\";\nexport const parse = /* @__PURE__ */ core._parse(ZodRealError);\nexport const parseAsync = /* @__PURE__ */ core._parseAsync(ZodRealError);\nexport const safeParse = /* @__PURE__ */ core._safeParse(ZodRealError);\nexport const safeParseAsync = /* @__PURE__ */ core._safeParseAsync(ZodRealError);\n// Codec functions\nexport const encode = /* @__PURE__ */ core._encode(ZodRealError);\nexport const decode = /* @__PURE__ */ core._decode(ZodRealError);\nexport const encodeAsync = /* @__PURE__ */ core._encodeAsync(ZodRealError);\nexport const decodeAsync = /* @__PURE__ */ core._decodeAsync(ZodRealError);\nexport const safeEncode = /* @__PURE__ */ core._safeEncode(ZodRealError);\nexport const safeDecode = /* @__PURE__ */ core._safeDecode(ZodRealError);\nexport const safeEncodeAsync = /* @__PURE__ */ core._safeEncodeAsync(ZodRealError);\nexport const safeDecodeAsync = /* @__PURE__ */ core._safeDecodeAsync(ZodRealError);\n","import * as core from \"../core/index.js\";\nimport { util } from \"../core/index.js\";\nimport * as checks from \"./checks.js\";\nimport * as iso from \"./iso.js\";\nimport * as parse from \"./parse.js\";\nexport const ZodType = /*@__PURE__*/ core.$constructor(\"ZodType\", (inst, def) => {\n    core.$ZodType.init(inst, def);\n    inst.def = def;\n    inst.type = def.type;\n    Object.defineProperty(inst, \"_def\", { value: def });\n    // base methods\n    inst.check = (...checks) => {\n        return inst.clone(util.mergeDefs(def, {\n            checks: [\n                ...(def.checks ?? []),\n                ...checks.map((ch) => typeof ch === \"function\" ? { _zod: { check: ch, def: { check: \"custom\" }, onattach: [] } } : ch),\n            ],\n        }));\n    };\n    inst.clone = (def, params) => core.clone(inst, def, params);\n    inst.brand = () => inst;\n    inst.register = ((reg, meta) => {\n        reg.add(inst, meta);\n        return inst;\n    });\n    // parsing\n    inst.parse = (data, params) => parse.parse(inst, data, params, { callee: inst.parse });\n    inst.safeParse = (data, params) => parse.safeParse(inst, data, params);\n    inst.parseAsync = async (data, params) => parse.parseAsync(inst, data, params, { callee: inst.parseAsync });\n    inst.safeParseAsync = async (data, params) => parse.safeParseAsync(inst, data, params);\n    inst.spa = inst.safeParseAsync;\n    // encoding/decoding\n    inst.encode = (data, params) => parse.encode(inst, data, params);\n    inst.decode = (data, params) => parse.decode(inst, data, params);\n    inst.encodeAsync = async (data, params) => parse.encodeAsync(inst, data, params);\n    inst.decodeAsync = async (data, params) => parse.decodeAsync(inst, data, params);\n    inst.safeEncode = (data, params) => parse.safeEncode(inst, data, params);\n    inst.safeDecode = (data, params) => parse.safeDecode(inst, data, params);\n    inst.safeEncodeAsync = async (data, params) => parse.safeEncodeAsync(inst, data, params);\n    inst.safeDecodeAsync = async (data, params) => parse.safeDecodeAsync(inst, data, params);\n    // refinements\n    inst.refine = (check, params) => inst.check(refine(check, params));\n    inst.superRefine = (refinement) => inst.check(superRefine(refinement));\n    inst.overwrite = (fn) => inst.check(checks.overwrite(fn));\n    // wrappers\n    inst.optional = () => optional(inst);\n    inst.nullable = () => nullable(inst);\n    inst.nullish = () => optional(nullable(inst));\n    inst.nonoptional = (params) => nonoptional(inst, params);\n    inst.array = () => array(inst);\n    inst.or = (arg) => union([inst, arg]);\n    inst.and = (arg) => intersection(inst, arg);\n    inst.transform = (tx) => pipe(inst, transform(tx));\n    inst.default = (def) => _default(inst, def);\n    inst.prefault = (def) => prefault(inst, def);\n    // inst.coalesce = (def, params) => coalesce(inst, def, params);\n    inst.catch = (params) => _catch(inst, params);\n    inst.pipe = (target) => pipe(inst, target);\n    inst.readonly = () => readonly(inst);\n    // meta\n    inst.describe = (description) => {\n        const cl = inst.clone();\n        core.globalRegistry.add(cl, { description });\n        return cl;\n    };\n    Object.defineProperty(inst, \"description\", {\n        get() {\n            return core.globalRegistry.get(inst)?.description;\n        },\n        configurable: true,\n    });\n    inst.meta = (...args) => {\n        if (args.length === 0) {\n            return core.globalRegistry.get(inst);\n        }\n        const cl = inst.clone();\n        core.globalRegistry.add(cl, args[0]);\n        return cl;\n    };\n    // helpers\n    inst.isOptional = () => inst.safeParse(undefined).success;\n    inst.isNullable = () => inst.safeParse(null).success;\n    return inst;\n});\n/** @internal */\nexport const _ZodString = /*@__PURE__*/ core.$constructor(\"_ZodString\", (inst, def) => {\n    core.$ZodString.init(inst, def);\n    ZodType.init(inst, def);\n    const bag = inst._zod.bag;\n    inst.format = bag.format ?? null;\n    inst.minLength = bag.minimum ?? null;\n    inst.maxLength = bag.maximum ?? null;\n    // validations\n    inst.regex = (...args) => inst.check(checks.regex(...args));\n    inst.includes = (...args) => inst.check(checks.includes(...args));\n    inst.startsWith = (...args) => inst.check(checks.startsWith(...args));\n    inst.endsWith = (...args) => inst.check(checks.endsWith(...args));\n    inst.min = (...args) => inst.check(checks.minLength(...args));\n    inst.max = (...args) => inst.check(checks.maxLength(...args));\n    inst.length = (...args) => inst.check(checks.length(...args));\n    inst.nonempty = (...args) => inst.check(checks.minLength(1, ...args));\n    inst.lowercase = (params) => inst.check(checks.lowercase(params));\n    inst.uppercase = (params) => inst.check(checks.uppercase(params));\n    // transforms\n    inst.trim = () => inst.check(checks.trim());\n    inst.normalize = (...args) => inst.check(checks.normalize(...args));\n    inst.toLowerCase = () => inst.check(checks.toLowerCase());\n    inst.toUpperCase = () => inst.check(checks.toUpperCase());\n    inst.slugify = () => inst.check(checks.slugify());\n});\nexport const ZodString = /*@__PURE__*/ core.$constructor(\"ZodString\", (inst, def) => {\n    core.$ZodString.init(inst, def);\n    _ZodString.init(inst, def);\n    inst.email = (params) => inst.check(core._email(ZodEmail, params));\n    inst.url = (params) => inst.check(core._url(ZodURL, params));\n    inst.jwt = (params) => inst.check(core._jwt(ZodJWT, params));\n    inst.emoji = (params) => inst.check(core._emoji(ZodEmoji, params));\n    inst.guid = (params) => inst.check(core._guid(ZodGUID, params));\n    inst.uuid = (params) => inst.check(core._uuid(ZodUUID, params));\n    inst.uuidv4 = (params) => inst.check(core._uuidv4(ZodUUID, params));\n    inst.uuidv6 = (params) => inst.check(core._uuidv6(ZodUUID, params));\n    inst.uuidv7 = (params) => inst.check(core._uuidv7(ZodUUID, params));\n    inst.nanoid = (params) => inst.check(core._nanoid(ZodNanoID, params));\n    inst.guid = (params) => inst.check(core._guid(ZodGUID, params));\n    inst.cuid = (params) => inst.check(core._cuid(ZodCUID, params));\n    inst.cuid2 = (params) => inst.check(core._cuid2(ZodCUID2, params));\n    inst.ulid = (params) => inst.check(core._ulid(ZodULID, params));\n    inst.base64 = (params) => inst.check(core._base64(ZodBase64, params));\n    inst.base64url = (params) => inst.check(core._base64url(ZodBase64URL, params));\n    inst.xid = (params) => inst.check(core._xid(ZodXID, params));\n    inst.ksuid = (params) => inst.check(core._ksuid(ZodKSUID, params));\n    inst.ipv4 = (params) => inst.check(core._ipv4(ZodIPv4, params));\n    inst.ipv6 = (params) => inst.check(core._ipv6(ZodIPv6, params));\n    inst.cidrv4 = (params) => inst.check(core._cidrv4(ZodCIDRv4, params));\n    inst.cidrv6 = (params) => inst.check(core._cidrv6(ZodCIDRv6, params));\n    inst.e164 = (params) => inst.check(core._e164(ZodE164, params));\n    // iso\n    inst.datetime = (params) => inst.check(iso.datetime(params));\n    inst.date = (params) => inst.check(iso.date(params));\n    inst.time = (params) => inst.check(iso.time(params));\n    inst.duration = (params) => inst.check(iso.duration(params));\n});\nexport function string(params) {\n    return core._string(ZodString, params);\n}\nexport const ZodStringFormat = /*@__PURE__*/ core.$constructor(\"ZodStringFormat\", (inst, def) => {\n    core.$ZodStringFormat.init(inst, def);\n    _ZodString.init(inst, def);\n});\nexport const ZodEmail = /*@__PURE__*/ core.$constructor(\"ZodEmail\", (inst, def) => {\n    // ZodStringFormat.init(inst, def);\n    core.$ZodEmail.init(inst, def);\n    ZodStringFormat.init(inst, def);\n});\nexport function email(params) {\n    return core._email(ZodEmail, params);\n}\nexport const ZodGUID = /*@__PURE__*/ core.$constructor(\"ZodGUID\", (inst, def) => {\n    // ZodStringFormat.init(inst, def);\n    core.$ZodGUID.init(inst, def);\n    ZodStringFormat.init(inst, def);\n});\nexport function guid(params) {\n    return core._guid(ZodGUID, params);\n}\nexport const ZodUUID = /*@__PURE__*/ core.$constructor(\"ZodUUID\", (inst, def) => {\n    // ZodStringFormat.init(inst, def);\n    core.$ZodUUID.init(inst, def);\n    ZodStringFormat.init(inst, def);\n});\nexport function uuid(params) {\n    return core._uuid(ZodUUID, params);\n}\nexport function uuidv4(params) {\n    return core._uuidv4(ZodUUID, params);\n}\n// ZodUUIDv6\nexport function uuidv6(params) {\n    return core._uuidv6(ZodUUID, params);\n}\n// ZodUUIDv7\nexport function uuidv7(params) {\n    return core._uuidv7(ZodUUID, params);\n}\nexport const ZodURL = /*@__PURE__*/ core.$constructor(\"ZodURL\", (inst, def) => {\n    // ZodStringFormat.init(inst, def);\n    core.$ZodURL.init(inst, def);\n    ZodStringFormat.init(inst, def);\n});\nexport function url(params) {\n    return core._url(ZodURL, params);\n}\nexport function httpUrl(params) {\n    return core._url(ZodURL, {\n        protocol: /^https?$/,\n        hostname: core.regexes.domain,\n        ...util.normalizeParams(params),\n    });\n}\nexport const ZodEmoji = /*@__PURE__*/ core.$constructor(\"ZodEmoji\", (inst, def) => {\n    // ZodStringFormat.init(inst, def);\n    core.$ZodEmoji.init(inst, def);\n    ZodStringFormat.init(inst, def);\n});\nexport function emoji(params) {\n    return core._emoji(ZodEmoji, params);\n}\nexport const ZodNanoID = /*@__PURE__*/ core.$constructor(\"ZodNanoID\", (inst, def) => {\n    // ZodStringFormat.init(inst, def);\n    core.$ZodNanoID.init(inst, def);\n    ZodStringFormat.init(inst, def);\n});\nexport function nanoid(params) {\n    return core._nanoid(ZodNanoID, params);\n}\nexport const ZodCUID = /*@__PURE__*/ core.$constructor(\"ZodCUID\", (inst, def) => {\n    // ZodStringFormat.init(inst, def);\n    core.$ZodCUID.init(inst, def);\n    ZodStringFormat.init(inst, def);\n});\nexport function cuid(params) {\n    return core._cuid(ZodCUID, params);\n}\nexport const ZodCUID2 = /*@__PURE__*/ core.$constructor(\"ZodCUID2\", (inst, def) => {\n    // ZodStringFormat.init(inst, def);\n    core.$ZodCUID2.init(inst, def);\n    ZodStringFormat.init(inst, def);\n});\nexport function cuid2(params) {\n    return core._cuid2(ZodCUID2, params);\n}\nexport const ZodULID = /*@__PURE__*/ core.$constructor(\"ZodULID\", (inst, def) => {\n    // ZodStringFormat.init(inst, def);\n    core.$ZodULID.init(inst, def);\n    ZodStringFormat.init(inst, def);\n});\nexport function ulid(params) {\n    return core._ulid(ZodULID, params);\n}\nexport const ZodXID = /*@__PURE__*/ core.$constructor(\"ZodXID\", (inst, def) => {\n    // ZodStringFormat.init(inst, def);\n    core.$ZodXID.init(inst, def);\n    ZodStringFormat.init(inst, def);\n});\nexport function xid(params) {\n    return core._xid(ZodXID, params);\n}\nexport const ZodKSUID = /*@__PURE__*/ core.$constructor(\"ZodKSUID\", (inst, def) => {\n    // ZodStringFormat.init(inst, def);\n    core.$ZodKSUID.init(inst, def);\n    ZodStringFormat.init(inst, def);\n});\nexport function ksuid(params) {\n    return core._ksuid(ZodKSUID, params);\n}\nexport const ZodIPv4 = /*@__PURE__*/ core.$constructor(\"ZodIPv4\", (inst, def) => {\n    // ZodStringFormat.init(inst, def);\n    core.$ZodIPv4.init(inst, def);\n    ZodStringFormat.init(inst, def);\n});\nexport function ipv4(params) {\n    return core._ipv4(ZodIPv4, params);\n}\nexport const ZodMAC = /*@__PURE__*/ core.$constructor(\"ZodMAC\", (inst, def) => {\n    // ZodStringFormat.init(inst, def);\n    core.$ZodMAC.init(inst, def);\n    ZodStringFormat.init(inst, def);\n});\nexport function mac(params) {\n    return core._mac(ZodMAC, params);\n}\nexport const ZodIPv6 = /*@__PURE__*/ core.$constructor(\"ZodIPv6\", (inst, def) => {\n    // ZodStringFormat.init(inst, def);\n    core.$ZodIPv6.init(inst, def);\n    ZodStringFormat.init(inst, def);\n});\nexport function ipv6(params) {\n    return core._ipv6(ZodIPv6, params);\n}\nexport const ZodCIDRv4 = /*@__PURE__*/ core.$constructor(\"ZodCIDRv4\", (inst, def) => {\n    core.$ZodCIDRv4.init(inst, def);\n    ZodStringFormat.init(inst, def);\n});\nexport function cidrv4(params) {\n    return core._cidrv4(ZodCIDRv4, params);\n}\nexport const ZodCIDRv6 = /*@__PURE__*/ core.$constructor(\"ZodCIDRv6\", (inst, def) => {\n    core.$ZodCIDRv6.init(inst, def);\n    ZodStringFormat.init(inst, def);\n});\nexport function cidrv6(params) {\n    return core._cidrv6(ZodCIDRv6, params);\n}\nexport const ZodBase64 = /*@__PURE__*/ core.$constructor(\"ZodBase64\", (inst, def) => {\n    // ZodStringFormat.init(inst, def);\n    core.$ZodBase64.init(inst, def);\n    ZodStringFormat.init(inst, def);\n});\nexport function base64(params) {\n    return core._base64(ZodBase64, params);\n}\nexport const ZodBase64URL = /*@__PURE__*/ core.$constructor(\"ZodBase64URL\", (inst, def) => {\n    // ZodStringFormat.init(inst, def);\n    core.$ZodBase64URL.init(inst, def);\n    ZodStringFormat.init(inst, def);\n});\nexport function base64url(params) {\n    return core._base64url(ZodBase64URL, params);\n}\nexport const ZodE164 = /*@__PURE__*/ core.$constructor(\"ZodE164\", (inst, def) => {\n    // ZodStringFormat.init(inst, def);\n    core.$ZodE164.init(inst, def);\n    ZodStringFormat.init(inst, def);\n});\nexport function e164(params) {\n    return core._e164(ZodE164, params);\n}\nexport const ZodJWT = /*@__PURE__*/ core.$constructor(\"ZodJWT\", (inst, def) => {\n    // ZodStringFormat.init(inst, def);\n    core.$ZodJWT.init(inst, def);\n    ZodStringFormat.init(inst, def);\n});\nexport function jwt(params) {\n    return core._jwt(ZodJWT, params);\n}\nexport const ZodCustomStringFormat = /*@__PURE__*/ core.$constructor(\"ZodCustomStringFormat\", (inst, def) => {\n    // ZodStringFormat.init(inst, def);\n    core.$ZodCustomStringFormat.init(inst, def);\n    ZodStringFormat.init(inst, def);\n});\nexport function stringFormat(format, fnOrRegex, _params = {}) {\n    return core._stringFormat(ZodCustomStringFormat, format, fnOrRegex, _params);\n}\nexport function hostname(_params) {\n    return core._stringFormat(ZodCustomStringFormat, \"hostname\", core.regexes.hostname, _params);\n}\nexport function hex(_params) {\n    return core._stringFormat(ZodCustomStringFormat, \"hex\", core.regexes.hex, _params);\n}\nexport function hash(alg, params) {\n    const enc = params?.enc ?? \"hex\";\n    const format = `${alg}_${enc}`;\n    const regex = core.regexes[format];\n    if (!regex)\n        throw new Error(`Unrecognized hash format: ${format}`);\n    return core._stringFormat(ZodCustomStringFormat, format, regex, params);\n}\nexport const ZodNumber = /*@__PURE__*/ core.$constructor(\"ZodNumber\", (inst, def) => {\n    core.$ZodNumber.init(inst, def);\n    ZodType.init(inst, def);\n    inst.gt = (value, params) => inst.check(checks.gt(value, params));\n    inst.gte = (value, params) => inst.check(checks.gte(value, params));\n    inst.min = (value, params) => inst.check(checks.gte(value, params));\n    inst.lt = (value, params) => inst.check(checks.lt(value, params));\n    inst.lte = (value, params) => inst.check(checks.lte(value, params));\n    inst.max = (value, params) => inst.check(checks.lte(value, params));\n    inst.int = (params) => inst.check(int(params));\n    inst.safe = (params) => inst.check(int(params));\n    inst.positive = (params) => inst.check(checks.gt(0, params));\n    inst.nonnegative = (params) => inst.check(checks.gte(0, params));\n    inst.negative = (params) => inst.check(checks.lt(0, params));\n    inst.nonpositive = (params) => inst.check(checks.lte(0, params));\n    inst.multipleOf = (value, params) => inst.check(checks.multipleOf(value, params));\n    inst.step = (value, params) => inst.check(checks.multipleOf(value, params));\n    // inst.finite = (params) => inst.check(core.finite(params));\n    inst.finite = () => inst;\n    const bag = inst._zod.bag;\n    inst.minValue =\n        Math.max(bag.minimum ?? Number.NEGATIVE_INFINITY, bag.exclusiveMinimum ?? Number.NEGATIVE_INFINITY) ?? null;\n    inst.maxValue =\n        Math.min(bag.maximum ?? Number.POSITIVE_INFINITY, bag.exclusiveMaximum ?? Number.POSITIVE_INFINITY) ?? null;\n    inst.isInt = (bag.format ?? \"\").includes(\"int\") || Number.isSafeInteger(bag.multipleOf ?? 0.5);\n    inst.isFinite = true;\n    inst.format = bag.format ?? null;\n});\nexport function number(params) {\n    return core._number(ZodNumber, params);\n}\nexport const ZodNumberFormat = /*@__PURE__*/ core.$constructor(\"ZodNumberFormat\", (inst, def) => {\n    core.$ZodNumberFormat.init(inst, def);\n    ZodNumber.init(inst, def);\n});\nexport function int(params) {\n    return core._int(ZodNumberFormat, params);\n}\nexport function float32(params) {\n    return core._float32(ZodNumberFormat, params);\n}\nexport function float64(params) {\n    return core._float64(ZodNumberFormat, params);\n}\nexport function int32(params) {\n    return core._int32(ZodNumberFormat, params);\n}\nexport function uint32(params) {\n    return core._uint32(ZodNumberFormat, params);\n}\nexport const ZodBoolean = /*@__PURE__*/ core.$constructor(\"ZodBoolean\", (inst, def) => {\n    core.$ZodBoolean.init(inst, def);\n    ZodType.init(inst, def);\n});\nexport function boolean(params) {\n    return core._boolean(ZodBoolean, params);\n}\nexport const ZodBigInt = /*@__PURE__*/ core.$constructor(\"ZodBigInt\", (inst, def) => {\n    core.$ZodBigInt.init(inst, def);\n    ZodType.init(inst, def);\n    inst.gte = (value, params) => inst.check(checks.gte(value, params));\n    inst.min = (value, params) => inst.check(checks.gte(value, params));\n    inst.gt = (value, params) => inst.check(checks.gt(value, params));\n    inst.gte = (value, params) => inst.check(checks.gte(value, params));\n    inst.min = (value, params) => inst.check(checks.gte(value, params));\n    inst.lt = (value, params) => inst.check(checks.lt(value, params));\n    inst.lte = (value, params) => inst.check(checks.lte(value, params));\n    inst.max = (value, params) => inst.check(checks.lte(value, params));\n    inst.positive = (params) => inst.check(checks.gt(BigInt(0), params));\n    inst.negative = (params) => inst.check(checks.lt(BigInt(0), params));\n    inst.nonpositive = (params) => inst.check(checks.lte(BigInt(0), params));\n    inst.nonnegative = (params) => inst.check(checks.gte(BigInt(0), params));\n    inst.multipleOf = (value, params) => inst.check(checks.multipleOf(value, params));\n    const bag = inst._zod.bag;\n    inst.minValue = bag.minimum ?? null;\n    inst.maxValue = bag.maximum ?? null;\n    inst.format = bag.format ?? null;\n});\nexport function bigint(params) {\n    return core._bigint(ZodBigInt, params);\n}\nexport const ZodBigIntFormat = /*@__PURE__*/ core.$constructor(\"ZodBigIntFormat\", (inst, def) => {\n    core.$ZodBigIntFormat.init(inst, def);\n    ZodBigInt.init(inst, def);\n});\n// int64\nexport function int64(params) {\n    return core._int64(ZodBigIntFormat, params);\n}\n// uint64\nexport function uint64(params) {\n    return core._uint64(ZodBigIntFormat, params);\n}\nexport const ZodSymbol = /*@__PURE__*/ core.$constructor(\"ZodSymbol\", (inst, def) => {\n    core.$ZodSymbol.init(inst, def);\n    ZodType.init(inst, def);\n});\nexport function symbol(params) {\n    return core._symbol(ZodSymbol, params);\n}\nexport const ZodUndefined = /*@__PURE__*/ core.$constructor(\"ZodUndefined\", (inst, def) => {\n    core.$ZodUndefined.init(inst, def);\n    ZodType.init(inst, def);\n});\nfunction _undefined(params) {\n    return core._undefined(ZodUndefined, params);\n}\nexport { _undefined as undefined };\nexport const ZodNull = /*@__PURE__*/ core.$constructor(\"ZodNull\", (inst, def) => {\n    core.$ZodNull.init(inst, def);\n    ZodType.init(inst, def);\n});\nfunction _null(params) {\n    return core._null(ZodNull, params);\n}\nexport { _null as null };\nexport const ZodAny = /*@__PURE__*/ core.$constructor(\"ZodAny\", (inst, def) => {\n    core.$ZodAny.init(inst, def);\n    ZodType.init(inst, def);\n});\nexport function any() {\n    return core._any(ZodAny);\n}\nexport const ZodUnknown = /*@__PURE__*/ core.$constructor(\"ZodUnknown\", (inst, def) => {\n    core.$ZodUnknown.init(inst, def);\n    ZodType.init(inst, def);\n});\nexport function unknown() {\n    return core._unknown(ZodUnknown);\n}\nexport const ZodNever = /*@__PURE__*/ core.$constructor(\"ZodNever\", (inst, def) => {\n    core.$ZodNever.init(inst, def);\n    ZodType.init(inst, def);\n});\nexport function never(params) {\n    return core._never(ZodNever, params);\n}\nexport const ZodVoid = /*@__PURE__*/ core.$constructor(\"ZodVoid\", (inst, def) => {\n    core.$ZodVoid.init(inst, def);\n    ZodType.init(inst, def);\n});\nfunction _void(params) {\n    return core._void(ZodVoid, params);\n}\nexport { _void as void };\nexport const ZodDate = /*@__PURE__*/ core.$constructor(\"ZodDate\", (inst, def) => {\n    core.$ZodDate.init(inst, def);\n    ZodType.init(inst, def);\n    inst.min = (value, params) => inst.check(checks.gte(value, params));\n    inst.max = (value, params) => inst.check(checks.lte(value, params));\n    const c = inst._zod.bag;\n    inst.minDate = c.minimum ? new Date(c.minimum) : null;\n    inst.maxDate = c.maximum ? new Date(c.maximum) : null;\n});\nexport function date(params) {\n    return core._date(ZodDate, params);\n}\nexport const ZodArray = /*@__PURE__*/ core.$constructor(\"ZodArray\", (inst, def) => {\n    core.$ZodArray.init(inst, def);\n    ZodType.init(inst, def);\n    inst.element = def.element;\n    inst.min = (minLength, params) => inst.check(checks.minLength(minLength, params));\n    inst.nonempty = (params) => inst.check(checks.minLength(1, params));\n    inst.max = (maxLength, params) => inst.check(checks.maxLength(maxLength, params));\n    inst.length = (len, params) => inst.check(checks.length(len, params));\n    inst.unwrap = () => inst.element;\n});\nexport function array(element, params) {\n    return core._array(ZodArray, element, params);\n}\n// .keyof\nexport function keyof(schema) {\n    const shape = schema._zod.def.shape;\n    return _enum(Object.keys(shape));\n}\nexport const ZodObject = /*@__PURE__*/ core.$constructor(\"ZodObject\", (inst, def) => {\n    core.$ZodObjectJIT.init(inst, def);\n    ZodType.init(inst, def);\n    util.defineLazy(inst, \"shape\", () => {\n        return def.shape;\n    });\n    inst.keyof = () => _enum(Object.keys(inst._zod.def.shape));\n    inst.catchall = (catchall) => inst.clone({ ...inst._zod.def, catchall: catchall });\n    inst.passthrough = () => inst.clone({ ...inst._zod.def, catchall: unknown() });\n    inst.loose = () => inst.clone({ ...inst._zod.def, catchall: unknown() });\n    inst.strict = () => inst.clone({ ...inst._zod.def, catchall: never() });\n    inst.strip = () => inst.clone({ ...inst._zod.def, catchall: undefined });\n    inst.extend = (incoming) => {\n        return util.extend(inst, incoming);\n    };\n    inst.safeExtend = (incoming) => {\n        return util.safeExtend(inst, incoming);\n    };\n    inst.merge = (other) => util.merge(inst, other);\n    inst.pick = (mask) => util.pick(inst, mask);\n    inst.omit = (mask) => util.omit(inst, mask);\n    inst.partial = (...args) => util.partial(ZodOptional, inst, args[0]);\n    inst.required = (...args) => util.required(ZodNonOptional, inst, args[0]);\n});\nexport function object(shape, params) {\n    const def = {\n        type: \"object\",\n        shape: shape ?? {},\n        ...util.normalizeParams(params),\n    };\n    return new ZodObject(def);\n}\n// strictObject\nexport function strictObject(shape, params) {\n    return new ZodObject({\n        type: \"object\",\n        shape,\n        catchall: never(),\n        ...util.normalizeParams(params),\n    });\n}\n// looseObject\nexport function looseObject(shape, params) {\n    return new ZodObject({\n        type: \"object\",\n        shape,\n        catchall: unknown(),\n        ...util.normalizeParams(params),\n    });\n}\nexport const ZodUnion = /*@__PURE__*/ core.$constructor(\"ZodUnion\", (inst, def) => {\n    core.$ZodUnion.init(inst, def);\n    ZodType.init(inst, def);\n    inst.options = def.options;\n});\nexport function union(options, params) {\n    return new ZodUnion({\n        type: \"union\",\n        options: options,\n        ...util.normalizeParams(params),\n    });\n}\nexport const ZodDiscriminatedUnion = /*@__PURE__*/ core.$constructor(\"ZodDiscriminatedUnion\", (inst, def) => {\n    ZodUnion.init(inst, def);\n    core.$ZodDiscriminatedUnion.init(inst, def);\n});\nexport function discriminatedUnion(discriminator, options, params) {\n    // const [options, params] = args;\n    return new ZodDiscriminatedUnion({\n        type: \"union\",\n        options,\n        discriminator,\n        ...util.normalizeParams(params),\n    });\n}\nexport const ZodIntersection = /*@__PURE__*/ core.$constructor(\"ZodIntersection\", (inst, def) => {\n    core.$ZodIntersection.init(inst, def);\n    ZodType.init(inst, def);\n});\nexport function intersection(left, right) {\n    return new ZodIntersection({\n        type: \"intersection\",\n        left: left,\n        right: right,\n    });\n}\nexport const ZodTuple = /*@__PURE__*/ core.$constructor(\"ZodTuple\", (inst, def) => {\n    core.$ZodTuple.init(inst, def);\n    ZodType.init(inst, def);\n    inst.rest = (rest) => inst.clone({\n        ...inst._zod.def,\n        rest: rest,\n    });\n});\nexport function tuple(items, _paramsOrRest, _params) {\n    const hasRest = _paramsOrRest instanceof core.$ZodType;\n    const params = hasRest ? _params : _paramsOrRest;\n    const rest = hasRest ? _paramsOrRest : null;\n    return new ZodTuple({\n        type: \"tuple\",\n        items: items,\n        rest,\n        ...util.normalizeParams(params),\n    });\n}\nexport const ZodRecord = /*@__PURE__*/ core.$constructor(\"ZodRecord\", (inst, def) => {\n    core.$ZodRecord.init(inst, def);\n    ZodType.init(inst, def);\n    inst.keyType = def.keyType;\n    inst.valueType = def.valueType;\n});\nexport function record(keyType, valueType, params) {\n    return new ZodRecord({\n        type: \"record\",\n        keyType,\n        valueType: valueType,\n        ...util.normalizeParams(params),\n    });\n}\n// type alksjf = core.output<core.$ZodRecordKey>;\nexport function partialRecord(keyType, valueType, params) {\n    const k = core.clone(keyType);\n    k._zod.values = undefined;\n    return new ZodRecord({\n        type: \"record\",\n        keyType: k,\n        valueType: valueType,\n        ...util.normalizeParams(params),\n    });\n}\nexport const ZodMap = /*@__PURE__*/ core.$constructor(\"ZodMap\", (inst, def) => {\n    core.$ZodMap.init(inst, def);\n    ZodType.init(inst, def);\n    inst.keyType = def.keyType;\n    inst.valueType = def.valueType;\n});\nexport function map(keyType, valueType, params) {\n    return new ZodMap({\n        type: \"map\",\n        keyType: keyType,\n        valueType: valueType,\n        ...util.normalizeParams(params),\n    });\n}\nexport const ZodSet = /*@__PURE__*/ core.$constructor(\"ZodSet\", (inst, def) => {\n    core.$ZodSet.init(inst, def);\n    ZodType.init(inst, def);\n    inst.min = (...args) => inst.check(core._minSize(...args));\n    inst.nonempty = (params) => inst.check(core._minSize(1, params));\n    inst.max = (...args) => inst.check(core._maxSize(...args));\n    inst.size = (...args) => inst.check(core._size(...args));\n});\nexport function set(valueType, params) {\n    return new ZodSet({\n        type: \"set\",\n        valueType: valueType,\n        ...util.normalizeParams(params),\n    });\n}\nexport const ZodEnum = /*@__PURE__*/ core.$constructor(\"ZodEnum\", (inst, def) => {\n    core.$ZodEnum.init(inst, def);\n    ZodType.init(inst, def);\n    inst.enum = def.entries;\n    inst.options = Object.values(def.entries);\n    const keys = new Set(Object.keys(def.entries));\n    inst.extract = (values, params) => {\n        const newEntries = {};\n        for (const value of values) {\n            if (keys.has(value)) {\n                newEntries[value] = def.entries[value];\n            }\n            else\n                throw new Error(`Key ${value} not found in enum`);\n        }\n        return new ZodEnum({\n            ...def,\n            checks: [],\n            ...util.normalizeParams(params),\n            entries: newEntries,\n        });\n    };\n    inst.exclude = (values, params) => {\n        const newEntries = { ...def.entries };\n        for (const value of values) {\n            if (keys.has(value)) {\n                delete newEntries[value];\n            }\n            else\n                throw new Error(`Key ${value} not found in enum`);\n        }\n        return new ZodEnum({\n            ...def,\n            checks: [],\n            ...util.normalizeParams(params),\n            entries: newEntries,\n        });\n    };\n});\nfunction _enum(values, params) {\n    const entries = Array.isArray(values) ? Object.fromEntries(values.map((v) => [v, v])) : values;\n    return new ZodEnum({\n        type: \"enum\",\n        entries,\n        ...util.normalizeParams(params),\n    });\n}\nexport { _enum as enum };\n/** @deprecated This API has been merged into `z.enum()`. Use `z.enum()` instead.\n *\n * ```ts\n * enum Colors { red, green, blue }\n * z.enum(Colors);\n * ```\n */\nexport function nativeEnum(entries, params) {\n    return new ZodEnum({\n        type: \"enum\",\n        entries,\n        ...util.normalizeParams(params),\n    });\n}\nexport const ZodLiteral = /*@__PURE__*/ core.$constructor(\"ZodLiteral\", (inst, def) => {\n    core.$ZodLiteral.init(inst, def);\n    ZodType.init(inst, def);\n    inst.values = new Set(def.values);\n    Object.defineProperty(inst, \"value\", {\n        get() {\n            if (def.values.length > 1) {\n                throw new Error(\"This schema contains multiple valid literal values. Use `.values` instead.\");\n            }\n            return def.values[0];\n        },\n    });\n});\nexport function literal(value, params) {\n    return new ZodLiteral({\n        type: \"literal\",\n        values: Array.isArray(value) ? value : [value],\n        ...util.normalizeParams(params),\n    });\n}\nexport const ZodFile = /*@__PURE__*/ core.$constructor(\"ZodFile\", (inst, def) => {\n    core.$ZodFile.init(inst, def);\n    ZodType.init(inst, def);\n    inst.min = (size, params) => inst.check(core._minSize(size, params));\n    inst.max = (size, params) => inst.check(core._maxSize(size, params));\n    inst.mime = (types, params) => inst.check(core._mime(Array.isArray(types) ? types : [types], params));\n});\nexport function file(params) {\n    return core._file(ZodFile, params);\n}\nexport const ZodTransform = /*@__PURE__*/ core.$constructor(\"ZodTransform\", (inst, def) => {\n    core.$ZodTransform.init(inst, def);\n    ZodType.init(inst, def);\n    inst._zod.parse = (payload, _ctx) => {\n        if (_ctx.direction === \"backward\") {\n            throw new core.$ZodEncodeError(inst.constructor.name);\n        }\n        payload.addIssue = (issue) => {\n            if (typeof issue === \"string\") {\n                payload.issues.push(util.issue(issue, payload.value, def));\n            }\n            else {\n                // for Zod 3 backwards compatibility\n                const _issue = issue;\n                if (_issue.fatal)\n                    _issue.continue = false;\n                _issue.code ?? (_issue.code = \"custom\");\n                _issue.input ?? (_issue.input = payload.value);\n                _issue.inst ?? (_issue.inst = inst);\n                // _issue.continue ??= true;\n                payload.issues.push(util.issue(_issue));\n            }\n        };\n        const output = def.transform(payload.value, payload);\n        if (output instanceof Promise) {\n            return output.then((output) => {\n                payload.value = output;\n                return payload;\n            });\n        }\n        payload.value = output;\n        return payload;\n    };\n});\nexport function transform(fn) {\n    return new ZodTransform({\n        type: \"transform\",\n        transform: fn,\n    });\n}\nexport const ZodOptional = /*@__PURE__*/ core.$constructor(\"ZodOptional\", (inst, def) => {\n    core.$ZodOptional.init(inst, def);\n    ZodType.init(inst, def);\n    inst.unwrap = () => inst._zod.def.innerType;\n});\nexport function optional(innerType) {\n    return new ZodOptional({\n        type: \"optional\",\n        innerType: innerType,\n    });\n}\nexport const ZodNullable = /*@__PURE__*/ core.$constructor(\"ZodNullable\", (inst, def) => {\n    core.$ZodNullable.init(inst, def);\n    ZodType.init(inst, def);\n    inst.unwrap = () => inst._zod.def.innerType;\n});\nexport function nullable(innerType) {\n    return new ZodNullable({\n        type: \"nullable\",\n        innerType: innerType,\n    });\n}\n// nullish\nexport function nullish(innerType) {\n    return optional(nullable(innerType));\n}\nexport const ZodDefault = /*@__PURE__*/ core.$constructor(\"ZodDefault\", (inst, def) => {\n    core.$ZodDefault.init(inst, def);\n    ZodType.init(inst, def);\n    inst.unwrap = () => inst._zod.def.innerType;\n    inst.removeDefault = inst.unwrap;\n});\nexport function _default(innerType, defaultValue) {\n    return new ZodDefault({\n        type: \"default\",\n        innerType: innerType,\n        get defaultValue() {\n            return typeof defaultValue === \"function\" ? defaultValue() : util.shallowClone(defaultValue);\n        },\n    });\n}\nexport const ZodPrefault = /*@__PURE__*/ core.$constructor(\"ZodPrefault\", (inst, def) => {\n    core.$ZodPrefault.init(inst, def);\n    ZodType.init(inst, def);\n    inst.unwrap = () => inst._zod.def.innerType;\n});\nexport function prefault(innerType, defaultValue) {\n    return new ZodPrefault({\n        type: \"prefault\",\n        innerType: innerType,\n        get defaultValue() {\n            return typeof defaultValue === \"function\" ? defaultValue() : util.shallowClone(defaultValue);\n        },\n    });\n}\nexport const ZodNonOptional = /*@__PURE__*/ core.$constructor(\"ZodNonOptional\", (inst, def) => {\n    core.$ZodNonOptional.init(inst, def);\n    ZodType.init(inst, def);\n    inst.unwrap = () => inst._zod.def.innerType;\n});\nexport function nonoptional(innerType, params) {\n    return new ZodNonOptional({\n        type: \"nonoptional\",\n        innerType: innerType,\n        ...util.normalizeParams(params),\n    });\n}\nexport const ZodSuccess = /*@__PURE__*/ core.$constructor(\"ZodSuccess\", (inst, def) => {\n    core.$ZodSuccess.init(inst, def);\n    ZodType.init(inst, def);\n    inst.unwrap = () => inst._zod.def.innerType;\n});\nexport function success(innerType) {\n    return new ZodSuccess({\n        type: \"success\",\n        innerType: innerType,\n    });\n}\nexport const ZodCatch = /*@__PURE__*/ core.$constructor(\"ZodCatch\", (inst, def) => {\n    core.$ZodCatch.init(inst, def);\n    ZodType.init(inst, def);\n    inst.unwrap = () => inst._zod.def.innerType;\n    inst.removeCatch = inst.unwrap;\n});\nfunction _catch(innerType, catchValue) {\n    return new ZodCatch({\n        type: \"catch\",\n        innerType: innerType,\n        catchValue: (typeof catchValue === \"function\" ? catchValue : () => catchValue),\n    });\n}\nexport { _catch as catch };\nexport const ZodNaN = /*@__PURE__*/ core.$constructor(\"ZodNaN\", (inst, def) => {\n    core.$ZodNaN.init(inst, def);\n    ZodType.init(inst, def);\n});\nexport function nan(params) {\n    return core._nan(ZodNaN, params);\n}\nexport const ZodPipe = /*@__PURE__*/ core.$constructor(\"ZodPipe\", (inst, def) => {\n    core.$ZodPipe.init(inst, def);\n    ZodType.init(inst, def);\n    inst.in = def.in;\n    inst.out = def.out;\n});\nexport function pipe(in_, out) {\n    return new ZodPipe({\n        type: \"pipe\",\n        in: in_,\n        out: out,\n        // ...util.normalizeParams(params),\n    });\n}\nexport const ZodCodec = /*@__PURE__*/ core.$constructor(\"ZodCodec\", (inst, def) => {\n    ZodPipe.init(inst, def);\n    core.$ZodCodec.init(inst, def);\n});\nexport function codec(in_, out, params) {\n    return new ZodCodec({\n        type: \"pipe\",\n        in: in_,\n        out: out,\n        transform: params.decode,\n        reverseTransform: params.encode,\n    });\n}\nexport const ZodReadonly = /*@__PURE__*/ core.$constructor(\"ZodReadonly\", (inst, def) => {\n    core.$ZodReadonly.init(inst, def);\n    ZodType.init(inst, def);\n    inst.unwrap = () => inst._zod.def.innerType;\n});\nexport function readonly(innerType) {\n    return new ZodReadonly({\n        type: \"readonly\",\n        innerType: innerType,\n    });\n}\nexport const ZodTemplateLiteral = /*@__PURE__*/ core.$constructor(\"ZodTemplateLiteral\", (inst, def) => {\n    core.$ZodTemplateLiteral.init(inst, def);\n    ZodType.init(inst, def);\n});\nexport function templateLiteral(parts, params) {\n    return new ZodTemplateLiteral({\n        type: \"template_literal\",\n        parts,\n        ...util.normalizeParams(params),\n    });\n}\nexport const ZodLazy = /*@__PURE__*/ core.$constructor(\"ZodLazy\", (inst, def) => {\n    core.$ZodLazy.init(inst, def);\n    ZodType.init(inst, def);\n    inst.unwrap = () => inst._zod.def.getter();\n});\nexport function lazy(getter) {\n    return new ZodLazy({\n        type: \"lazy\",\n        getter: getter,\n    });\n}\nexport const ZodPromise = /*@__PURE__*/ core.$constructor(\"ZodPromise\", (inst, def) => {\n    core.$ZodPromise.init(inst, def);\n    ZodType.init(inst, def);\n    inst.unwrap = () => inst._zod.def.innerType;\n});\nexport function promise(innerType) {\n    return new ZodPromise({\n        type: \"promise\",\n        innerType: innerType,\n    });\n}\nexport const ZodFunction = /*@__PURE__*/ core.$constructor(\"ZodFunction\", (inst, def) => {\n    core.$ZodFunction.init(inst, def);\n    ZodType.init(inst, def);\n});\nexport function _function(params) {\n    return new ZodFunction({\n        type: \"function\",\n        input: Array.isArray(params?.input) ? tuple(params?.input) : (params?.input ?? array(unknown())),\n        output: params?.output ?? unknown(),\n    });\n}\nexport { _function as function };\nexport const ZodCustom = /*@__PURE__*/ core.$constructor(\"ZodCustom\", (inst, def) => {\n    core.$ZodCustom.init(inst, def);\n    ZodType.init(inst, def);\n});\n// custom checks\nexport function check(fn) {\n    const ch = new core.$ZodCheck({\n        check: \"custom\",\n        // ...util.normalizeParams(params),\n    });\n    ch._zod.check = fn;\n    return ch;\n}\nexport function custom(fn, _params) {\n    return core._custom(ZodCustom, fn ?? (() => true), _params);\n}\nexport function refine(fn, _params = {}) {\n    return core._refine(ZodCustom, fn, _params);\n}\n// superRefine\nexport function superRefine(fn) {\n    return core._superRefine(fn);\n}\n// Re-export describe and meta from core\nexport const describe = core.describe;\nexport const meta = core.meta;\nfunction _instanceof(cls, params = {\n    error: `Input not instance of ${cls.name}`,\n}) {\n    const inst = new ZodCustom({\n        type: \"custom\",\n        check: \"custom\",\n        fn: (data) => data instanceof cls,\n        abort: true,\n        ...util.normalizeParams(params),\n    });\n    inst._zod.bag.Class = cls;\n    return inst;\n}\nexport { _instanceof as instanceof };\n// stringbool\nexport const stringbool = (...args) => core._stringbool({\n    Codec: ZodCodec,\n    Boolean: ZodBoolean,\n    String: ZodString,\n}, ...args);\nexport function json(params) {\n    const jsonSchema = lazy(() => {\n        return union([string(params), number(), boolean(), _null(), array(jsonSchema), record(string(), jsonSchema)]);\n    });\n    return jsonSchema;\n}\n// preprocess\n// /** @deprecated Use `z.pipe()` and `z.transform()` instead. */\nexport function preprocess(fn, schema) {\n    return pipe(transform(fn), schema);\n}\n","// Zod 3 compat layer\nimport * as core from \"../core/index.js\";\n/** @deprecated Use the raw string literal codes instead, e.g. \"invalid_type\". */\nexport const ZodIssueCode = {\n    invalid_type: \"invalid_type\",\n    too_big: \"too_big\",\n    too_small: \"too_small\",\n    invalid_format: \"invalid_format\",\n    not_multiple_of: \"not_multiple_of\",\n    unrecognized_keys: \"unrecognized_keys\",\n    invalid_union: \"invalid_union\",\n    invalid_key: \"invalid_key\",\n    invalid_element: \"invalid_element\",\n    invalid_value: \"invalid_value\",\n    custom: \"custom\",\n};\nexport { $brand, config } from \"../core/index.js\";\n/** @deprecated Use `z.config(params)` instead. */\nexport function setErrorMap(map) {\n    core.config({\n        customError: map,\n    });\n}\n/** @deprecated Use `z.config()` instead. */\nexport function getErrorMap() {\n    return core.config().customError;\n}\n/** @deprecated Do not use. Stub definition, only included for zod-to-json-schema compatibility. */\nexport var ZodFirstPartyTypeKind;\n(function (ZodFirstPartyTypeKind) {\n})(ZodFirstPartyTypeKind || (ZodFirstPartyTypeKind = {}));\n","import * as core from \"../core/index.js\";\nimport * as schemas from \"./schemas.js\";\nexport function string(params) {\n    return core._coercedString(schemas.ZodString, params);\n}\nexport function number(params) {\n    return core._coercedNumber(schemas.ZodNumber, params);\n}\nexport function boolean(params) {\n    return core._coercedBoolean(schemas.ZodBoolean, params);\n}\nexport function bigint(params) {\n    return core._coercedBigint(schemas.ZodBigInt, params);\n}\nexport function date(params) {\n    return core._coercedDate(schemas.ZodDate, params);\n}\n","import { ZodError, z } from 'zod'\n\nconst EnvSchema = z.object({\n  VITE_BROWSEROS_AGENT_PORT: z.coerce.number().optional(),\n  VITE_PUBLIC_POSTHOG_KEY: z.string().optional(),\n  VITE_PUBLIC_POSTHOG_HOST: z.string().optional(),\n  VITE_PUBLIC_SENTRY_DSN: z.string().optional(),\n  PROD: z.boolean(),\n})\n\ntry {\n  EnvSchema.parse(import.meta.env)\n} catch (error) {\n  if (error instanceof ZodError) {\n    let message = 'Missing required values in .env:\\n'\n    for (const issue of error.issues) {\n      message += `${issue.path.join('.')}\\n`\n    }\n    const e = new Error(message)\n    e.stack = ''\n    throw e\n  }\n  // biome-ignore lint/suspicious/noConsole: allowed to display error information\n  console.error(error)\n  throw error\n}\n\n/**\n * @public\n */\nexport const env = EnvSchema.parse(import.meta.env)\n","/** @public */\nexport const BROWSEROS_PREFS = {\n  AGENT_PORT: 'browseros.server.agent_port',\n  MCP_PORT: 'browseros.server.mcp_port',\n  PROVIDERS: 'browseros.providers',\n  THIRD_PARTY_LLM_PROVIDERS: 'browseros.third_party_llm.providers',\n  THIRD_PARTY_LLM_SELECTED: 'browseros.third_party_llm.selected_provider',\n  ALLOW_REMOTE_MCP: 'browseros.server.allow_remote_in_mcp',\n  RESTART_SERVER: 'browseros.server.restart_requested',\n} as const\n","import { env } from '@/lib/env'\nimport { getBrowserOSAdapter } from './adapter'\nimport { BROWSEROS_PREFS } from './prefs'\n\nexport class AgentPortError extends Error {\n  constructor() {\n    super('Agent server port not configured.')\n    this.name = 'AgentPortError'\n  }\n}\n\nexport class McpPortError extends Error {\n  constructor() {\n    super('MCP server port not configured.')\n    this.name = 'McpPortError'\n  }\n}\n\n/**\n * @public\n */\nexport async function getAgentServerUrl(): Promise<string> {\n  const port = await getAgentPort()\n  return `http://127.0.0.1:${port}`\n}\n\nasync function getAgentPort(): Promise<number> {\n  if (env.VITE_BROWSEROS_AGENT_PORT) {\n    return env.VITE_BROWSEROS_AGENT_PORT\n  }\n\n  try {\n    const adapter = getBrowserOSAdapter()\n    const pref = await adapter.getPref(BROWSEROS_PREFS.AGENT_PORT)\n\n    if (pref?.value && typeof pref.value === 'number') {\n      return pref.value\n    }\n  } catch {\n    // BrowserOS API not available\n  }\n\n  throw new AgentPortError()\n}\n\nasync function getMcpPort(): Promise<number> {\n  try {\n    const adapter = getBrowserOSAdapter()\n    const pref = await adapter.getPref(BROWSEROS_PREFS.MCP_PORT)\n\n    if (pref?.value && typeof pref.value === 'number') {\n      return pref.value\n    }\n  } catch {\n    // BrowserOS API not available\n  }\n\n  throw new McpPortError()\n}\n\n/**\n * @public\n */\nexport async function getMcpServerUrl(): Promise<string> {\n  const port = await getMcpPort()\n  return `http://127.0.0.1:${port}/mcp`\n}\n\n/**\n * @public\n */\nexport async function getHealthCheckUrl(): Promise<string> {\n  const port = await getMcpPort()\n  return `http://127.0.0.1:${port}/health`\n}\n","/**\n * @public\n */\nexport async function openSidePanel(\n  tabId: number,\n): Promise<{ opened: boolean }> {\n  // @ts-expect-error browserosIsOpen is a BrowserOS-specific API\n  const isAlreadyOpen = await chrome.sidePanel.browserosIsOpen({ tabId })\n  if (isAlreadyOpen) {\n    return { opened: true }\n  }\n  // @ts-expect-error browserosToggle is a BrowserOS-specific API\n  return await chrome.sidePanel.browserosToggle({ tabId })\n}\n\n/**\n * @public\n */\nexport async function toggleSidePanel(\n  tabId: number,\n): Promise<{ opened: boolean }> {\n  // @ts-expect-error browserosToggle is a BrowserOS-specific API\n  return await chrome.sidePanel.browserosToggle({ tabId })\n}\n","var has = Object.prototype.hasOwnProperty;\n\nexport function dequal(foo, bar) {\n\tvar ctor, len;\n\tif (foo === bar) return true;\n\n\tif (foo && bar && (ctor=foo.constructor) === bar.constructor) {\n\t\tif (ctor === Date) return foo.getTime() === bar.getTime();\n\t\tif (ctor === RegExp) return foo.toString() === bar.toString();\n\n\t\tif (ctor === Array) {\n\t\t\tif ((len=foo.length) === bar.length) {\n\t\t\t\twhile (len-- && dequal(foo[len], bar[len]));\n\t\t\t}\n\t\t\treturn len === -1;\n\t\t}\n\n\t\tif (!ctor || typeof foo === 'object') {\n\t\t\tlen = 0;\n\t\t\tfor (ctor in foo) {\n\t\t\t\tif (has.call(foo, ctor) && ++len && !has.call(bar, ctor)) return false;\n\t\t\t\tif (!(ctor in bar) || !dequal(foo[ctor], bar[ctor])) return false;\n\t\t\t}\n\t\t\treturn Object.keys(bar).length === len;\n\t\t}\n\t}\n\n\treturn foo !== foo && bar !== bar;\n}\n","const E_TIMEOUT = new Error('timeout while waiting for mutex to become available');\nconst E_ALREADY_LOCKED = new Error('mutex already locked');\nconst E_CANCELED = new Error('request for lock canceled');\n\nvar __awaiter$2 = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nclass Semaphore {\n    constructor(_value, _cancelError = E_CANCELED) {\n        this._value = _value;\n        this._cancelError = _cancelError;\n        this._queue = [];\n        this._weightedWaiters = [];\n    }\n    acquire(weight = 1, priority = 0) {\n        if (weight <= 0)\n            throw new Error(`invalid weight ${weight}: must be positive`);\n        return new Promise((resolve, reject) => {\n            const task = { resolve, reject, weight, priority };\n            const i = findIndexFromEnd(this._queue, (other) => priority <= other.priority);\n            if (i === -1 && weight <= this._value) {\n                // Needs immediate dispatch, skip the queue\n                this._dispatchItem(task);\n            }\n            else {\n                this._queue.splice(i + 1, 0, task);\n            }\n        });\n    }\n    runExclusive(callback_1) {\n        return __awaiter$2(this, arguments, void 0, function* (callback, weight = 1, priority = 0) {\n            const [value, release] = yield this.acquire(weight, priority);\n            try {\n                return yield callback(value);\n            }\n            finally {\n                release();\n            }\n        });\n    }\n    waitForUnlock(weight = 1, priority = 0) {\n        if (weight <= 0)\n            throw new Error(`invalid weight ${weight}: must be positive`);\n        if (this._couldLockImmediately(weight, priority)) {\n            return Promise.resolve();\n        }\n        else {\n            return new Promise((resolve) => {\n                if (!this._weightedWaiters[weight - 1])\n                    this._weightedWaiters[weight - 1] = [];\n                insertSorted(this._weightedWaiters[weight - 1], { resolve, priority });\n            });\n        }\n    }\n    isLocked() {\n        return this._value <= 0;\n    }\n    getValue() {\n        return this._value;\n    }\n    setValue(value) {\n        this._value = value;\n        this._dispatchQueue();\n    }\n    release(weight = 1) {\n        if (weight <= 0)\n            throw new Error(`invalid weight ${weight}: must be positive`);\n        this._value += weight;\n        this._dispatchQueue();\n    }\n    cancel() {\n        this._queue.forEach((entry) => entry.reject(this._cancelError));\n        this._queue = [];\n    }\n    _dispatchQueue() {\n        this._drainUnlockWaiters();\n        while (this._queue.length > 0 && this._queue[0].weight <= this._value) {\n            this._dispatchItem(this._queue.shift());\n            this._drainUnlockWaiters();\n        }\n    }\n    _dispatchItem(item) {\n        const previousValue = this._value;\n        this._value -= item.weight;\n        item.resolve([previousValue, this._newReleaser(item.weight)]);\n    }\n    _newReleaser(weight) {\n        let called = false;\n        return () => {\n            if (called)\n                return;\n            called = true;\n            this.release(weight);\n        };\n    }\n    _drainUnlockWaiters() {\n        if (this._queue.length === 0) {\n            for (let weight = this._value; weight > 0; weight--) {\n                const waiters = this._weightedWaiters[weight - 1];\n                if (!waiters)\n                    continue;\n                waiters.forEach((waiter) => waiter.resolve());\n                this._weightedWaiters[weight - 1] = [];\n            }\n        }\n        else {\n            const queuedPriority = this._queue[0].priority;\n            for (let weight = this._value; weight > 0; weight--) {\n                const waiters = this._weightedWaiters[weight - 1];\n                if (!waiters)\n                    continue;\n                const i = waiters.findIndex((waiter) => waiter.priority <= queuedPriority);\n                (i === -1 ? waiters : waiters.splice(0, i))\n                    .forEach((waiter => waiter.resolve()));\n            }\n        }\n    }\n    _couldLockImmediately(weight, priority) {\n        return (this._queue.length === 0 || this._queue[0].priority < priority) &&\n            weight <= this._value;\n    }\n}\nfunction insertSorted(a, v) {\n    const i = findIndexFromEnd(a, (other) => v.priority <= other.priority);\n    a.splice(i + 1, 0, v);\n}\nfunction findIndexFromEnd(a, predicate) {\n    for (let i = a.length - 1; i >= 0; i--) {\n        if (predicate(a[i])) {\n            return i;\n        }\n    }\n    return -1;\n}\n\nvar __awaiter$1 = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nclass Mutex {\n    constructor(cancelError) {\n        this._semaphore = new Semaphore(1, cancelError);\n    }\n    acquire() {\n        return __awaiter$1(this, arguments, void 0, function* (priority = 0) {\n            const [, releaser] = yield this._semaphore.acquire(1, priority);\n            return releaser;\n        });\n    }\n    runExclusive(callback, priority = 0) {\n        return this._semaphore.runExclusive(() => callback(), 1, priority);\n    }\n    isLocked() {\n        return this._semaphore.isLocked();\n    }\n    waitForUnlock(priority = 0) {\n        return this._semaphore.waitForUnlock(1, priority);\n    }\n    release() {\n        if (this._semaphore.isLocked())\n            this._semaphore.release();\n    }\n    cancel() {\n        return this._semaphore.cancel();\n    }\n}\n\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nfunction withTimeout(sync, timeout, timeoutError = E_TIMEOUT) {\n    return {\n        acquire: (weightOrPriority, priority) => {\n            let weight;\n            if (isSemaphore(sync)) {\n                weight = weightOrPriority;\n            }\n            else {\n                weight = undefined;\n                priority = weightOrPriority;\n            }\n            if (weight !== undefined && weight <= 0) {\n                throw new Error(`invalid weight ${weight}: must be positive`);\n            }\n            return new Promise((resolve, reject) => __awaiter(this, void 0, void 0, function* () {\n                let isTimeout = false;\n                const handle = setTimeout(() => {\n                    isTimeout = true;\n                    reject(timeoutError);\n                }, timeout);\n                try {\n                    const ticket = yield (isSemaphore(sync)\n                        ? sync.acquire(weight, priority)\n                        : sync.acquire(priority));\n                    if (isTimeout) {\n                        const release = Array.isArray(ticket) ? ticket[1] : ticket;\n                        release();\n                    }\n                    else {\n                        clearTimeout(handle);\n                        resolve(ticket);\n                    }\n                }\n                catch (e) {\n                    if (!isTimeout) {\n                        clearTimeout(handle);\n                        reject(e);\n                    }\n                }\n            }));\n        },\n        runExclusive(callback, weight, priority) {\n            return __awaiter(this, void 0, void 0, function* () {\n                let release = () => undefined;\n                try {\n                    const ticket = yield this.acquire(weight, priority);\n                    if (Array.isArray(ticket)) {\n                        release = ticket[1];\n                        return yield callback(ticket[0]);\n                    }\n                    else {\n                        release = ticket;\n                        return yield callback();\n                    }\n                }\n                finally {\n                    release();\n                }\n            });\n        },\n        release(weight) {\n            sync.release(weight);\n        },\n        cancel() {\n            return sync.cancel();\n        },\n        waitForUnlock: (weightOrPriority, priority) => {\n            let weight;\n            if (isSemaphore(sync)) {\n                weight = weightOrPriority;\n            }\n            else {\n                weight = undefined;\n                priority = weightOrPriority;\n            }\n            if (weight !== undefined && weight <= 0) {\n                throw new Error(`invalid weight ${weight}: must be positive`);\n            }\n            return new Promise((resolve, reject) => {\n                const handle = setTimeout(() => reject(timeoutError), timeout);\n                (isSemaphore(sync)\n                    ? sync.waitForUnlock(weight, priority)\n                    : sync.waitForUnlock(priority)).then(() => {\n                    clearTimeout(handle);\n                    resolve();\n                });\n            });\n        },\n        isLocked: () => sync.isLocked(),\n        getValue: () => sync.getValue(),\n        setValue: (value) => sync.setValue(value),\n    };\n}\nfunction isSemaphore(sync) {\n    return sync.getValue !== undefined;\n}\n\n// eslint-disable-next-lisne @typescript-eslint/explicit-module-boundary-types\nfunction tryAcquire(sync, alreadyAcquiredError = E_ALREADY_LOCKED) {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return withTimeout(sync, 0, alreadyAcquiredError);\n}\n\nexport { E_ALREADY_LOCKED, E_CANCELED, E_TIMEOUT, Mutex, Semaphore, tryAcquire, withTimeout };\n","// #region snippet\nexport const browser = globalThis.browser?.runtime?.id\n  ? globalThis.browser\n  : globalThis.chrome;\n// #endregion snippet\n","import { dequal } from 'dequal/lite';\nimport { Mutex } from 'async-mutex';\nimport { browser } from '@wxt-dev/browser';\n\nconst storage = createStorage();\nfunction createStorage() {\n  const drivers = {\n    local: createDriver(\"local\"),\n    session: createDriver(\"session\"),\n    sync: createDriver(\"sync\"),\n    managed: createDriver(\"managed\")\n  };\n  const getDriver = (area) => {\n    const driver = drivers[area];\n    if (driver == null) {\n      const areaNames = Object.keys(drivers).join(\", \");\n      throw Error(`Invalid area \"${area}\". Options: ${areaNames}`);\n    }\n    return driver;\n  };\n  const resolveKey = (key) => {\n    const deliminatorIndex = key.indexOf(\":\");\n    const driverArea = key.substring(0, deliminatorIndex);\n    const driverKey = key.substring(deliminatorIndex + 1);\n    if (driverKey == null)\n      throw Error(\n        `Storage key should be in the form of \"area:key\", but received \"${key}\"`\n      );\n    return {\n      driverArea,\n      driverKey,\n      driver: getDriver(driverArea)\n    };\n  };\n  const getMetaKey = (key) => key + \"$\";\n  const mergeMeta = (oldMeta, newMeta) => {\n    const newFields = { ...oldMeta };\n    Object.entries(newMeta).forEach(([key, value]) => {\n      if (value == null) delete newFields[key];\n      else newFields[key] = value;\n    });\n    return newFields;\n  };\n  const getValueOrFallback = (value, fallback) => value ?? fallback ?? null;\n  const getMetaValue = (properties) => typeof properties === \"object\" && !Array.isArray(properties) ? properties : {};\n  const getItem = async (driver, driverKey, opts) => {\n    const res = await driver.getItem(driverKey);\n    return getValueOrFallback(res, opts?.fallback ?? opts?.defaultValue);\n  };\n  const getMeta = async (driver, driverKey) => {\n    const metaKey = getMetaKey(driverKey);\n    const res = await driver.getItem(metaKey);\n    return getMetaValue(res);\n  };\n  const setItem = async (driver, driverKey, value) => {\n    await driver.setItem(driverKey, value ?? null);\n  };\n  const setMeta = async (driver, driverKey, properties) => {\n    const metaKey = getMetaKey(driverKey);\n    const existingFields = getMetaValue(await driver.getItem(metaKey));\n    await driver.setItem(metaKey, mergeMeta(existingFields, properties));\n  };\n  const removeItem = async (driver, driverKey, opts) => {\n    await driver.removeItem(driverKey);\n    if (opts?.removeMeta) {\n      const metaKey = getMetaKey(driverKey);\n      await driver.removeItem(metaKey);\n    }\n  };\n  const removeMeta = async (driver, driverKey, properties) => {\n    const metaKey = getMetaKey(driverKey);\n    if (properties == null) {\n      await driver.removeItem(metaKey);\n    } else {\n      const newFields = getMetaValue(await driver.getItem(metaKey));\n      [properties].flat().forEach((field) => delete newFields[field]);\n      await driver.setItem(metaKey, newFields);\n    }\n  };\n  const watch = (driver, driverKey, cb) => {\n    return driver.watch(driverKey, cb);\n  };\n  const storage2 = {\n    getItem: async (key, opts) => {\n      const { driver, driverKey } = resolveKey(key);\n      return await getItem(driver, driverKey, opts);\n    },\n    getItems: async (keys) => {\n      const areaToKeyMap = /* @__PURE__ */ new Map();\n      const keyToOptsMap = /* @__PURE__ */ new Map();\n      const orderedKeys = [];\n      keys.forEach((key) => {\n        let keyStr;\n        let opts;\n        if (typeof key === \"string\") {\n          keyStr = key;\n        } else if (\"getValue\" in key) {\n          keyStr = key.key;\n          opts = { fallback: key.fallback };\n        } else {\n          keyStr = key.key;\n          opts = key.options;\n        }\n        orderedKeys.push(keyStr);\n        const { driverArea, driverKey } = resolveKey(keyStr);\n        const areaKeys = areaToKeyMap.get(driverArea) ?? [];\n        areaToKeyMap.set(driverArea, areaKeys.concat(driverKey));\n        keyToOptsMap.set(keyStr, opts);\n      });\n      const resultsMap = /* @__PURE__ */ new Map();\n      await Promise.all(\n        Array.from(areaToKeyMap.entries()).map(async ([driverArea, keys2]) => {\n          const driverResults = await drivers[driverArea].getItems(keys2);\n          driverResults.forEach((driverResult) => {\n            const key = `${driverArea}:${driverResult.key}`;\n            const opts = keyToOptsMap.get(key);\n            const value = getValueOrFallback(\n              driverResult.value,\n              opts?.fallback ?? opts?.defaultValue\n            );\n            resultsMap.set(key, value);\n          });\n        })\n      );\n      return orderedKeys.map((key) => ({\n        key,\n        value: resultsMap.get(key)\n      }));\n    },\n    getMeta: async (key) => {\n      const { driver, driverKey } = resolveKey(key);\n      return await getMeta(driver, driverKey);\n    },\n    getMetas: async (args) => {\n      const keys = args.map((arg) => {\n        const key = typeof arg === \"string\" ? arg : arg.key;\n        const { driverArea, driverKey } = resolveKey(key);\n        return {\n          key,\n          driverArea,\n          driverKey,\n          driverMetaKey: getMetaKey(driverKey)\n        };\n      });\n      const areaToDriverMetaKeysMap = keys.reduce((map, key) => {\n        map[key.driverArea] ??= [];\n        map[key.driverArea].push(key);\n        return map;\n      }, {});\n      const resultsMap = {};\n      await Promise.all(\n        Object.entries(areaToDriverMetaKeysMap).map(async ([area, keys2]) => {\n          const areaRes = await browser.storage[area].get(\n            keys2.map((key) => key.driverMetaKey)\n          );\n          keys2.forEach((key) => {\n            resultsMap[key.key] = areaRes[key.driverMetaKey] ?? {};\n          });\n        })\n      );\n      return keys.map((key) => ({\n        key: key.key,\n        meta: resultsMap[key.key]\n      }));\n    },\n    setItem: async (key, value) => {\n      const { driver, driverKey } = resolveKey(key);\n      await setItem(driver, driverKey, value);\n    },\n    setItems: async (items) => {\n      const areaToKeyValueMap = {};\n      items.forEach((item) => {\n        const { driverArea, driverKey } = resolveKey(\n          \"key\" in item ? item.key : item.item.key\n        );\n        areaToKeyValueMap[driverArea] ??= [];\n        areaToKeyValueMap[driverArea].push({\n          key: driverKey,\n          value: item.value\n        });\n      });\n      await Promise.all(\n        Object.entries(areaToKeyValueMap).map(async ([driverArea, values]) => {\n          const driver = getDriver(driverArea);\n          await driver.setItems(values);\n        })\n      );\n    },\n    setMeta: async (key, properties) => {\n      const { driver, driverKey } = resolveKey(key);\n      await setMeta(driver, driverKey, properties);\n    },\n    setMetas: async (items) => {\n      const areaToMetaUpdatesMap = {};\n      items.forEach((item) => {\n        const { driverArea, driverKey } = resolveKey(\n          \"key\" in item ? item.key : item.item.key\n        );\n        areaToMetaUpdatesMap[driverArea] ??= [];\n        areaToMetaUpdatesMap[driverArea].push({\n          key: driverKey,\n          properties: item.meta\n        });\n      });\n      await Promise.all(\n        Object.entries(areaToMetaUpdatesMap).map(\n          async ([storageArea, updates]) => {\n            const driver = getDriver(storageArea);\n            const metaKeys = updates.map(({ key }) => getMetaKey(key));\n            const existingMetas = await driver.getItems(metaKeys);\n            const existingMetaMap = Object.fromEntries(\n              existingMetas.map(({ key, value }) => [key, getMetaValue(value)])\n            );\n            const metaUpdates = updates.map(({ key, properties }) => {\n              const metaKey = getMetaKey(key);\n              return {\n                key: metaKey,\n                value: mergeMeta(existingMetaMap[metaKey] ?? {}, properties)\n              };\n            });\n            await driver.setItems(metaUpdates);\n          }\n        )\n      );\n    },\n    removeItem: async (key, opts) => {\n      const { driver, driverKey } = resolveKey(key);\n      await removeItem(driver, driverKey, opts);\n    },\n    removeItems: async (keys) => {\n      const areaToKeysMap = {};\n      keys.forEach((key) => {\n        let keyStr;\n        let opts;\n        if (typeof key === \"string\") {\n          keyStr = key;\n        } else if (\"getValue\" in key) {\n          keyStr = key.key;\n        } else if (\"item\" in key) {\n          keyStr = key.item.key;\n          opts = key.options;\n        } else {\n          keyStr = key.key;\n          opts = key.options;\n        }\n        const { driverArea, driverKey } = resolveKey(keyStr);\n        areaToKeysMap[driverArea] ??= [];\n        areaToKeysMap[driverArea].push(driverKey);\n        if (opts?.removeMeta) {\n          areaToKeysMap[driverArea].push(getMetaKey(driverKey));\n        }\n      });\n      await Promise.all(\n        Object.entries(areaToKeysMap).map(async ([driverArea, keys2]) => {\n          const driver = getDriver(driverArea);\n          await driver.removeItems(keys2);\n        })\n      );\n    },\n    clear: async (base) => {\n      const driver = getDriver(base);\n      await driver.clear();\n    },\n    removeMeta: async (key, properties) => {\n      const { driver, driverKey } = resolveKey(key);\n      await removeMeta(driver, driverKey, properties);\n    },\n    snapshot: async (base, opts) => {\n      const driver = getDriver(base);\n      const data = await driver.snapshot();\n      opts?.excludeKeys?.forEach((key) => {\n        delete data[key];\n        delete data[getMetaKey(key)];\n      });\n      return data;\n    },\n    restoreSnapshot: async (base, data) => {\n      const driver = getDriver(base);\n      await driver.restoreSnapshot(data);\n    },\n    watch: (key, cb) => {\n      const { driver, driverKey } = resolveKey(key);\n      return watch(driver, driverKey, cb);\n    },\n    unwatch() {\n      Object.values(drivers).forEach((driver) => {\n        driver.unwatch();\n      });\n    },\n    defineItem: (key, opts) => {\n      const { driver, driverKey } = resolveKey(key);\n      const {\n        version: targetVersion = 1,\n        migrations = {},\n        onMigrationComplete,\n        debug = false\n      } = opts ?? {};\n      if (targetVersion < 1) {\n        throw Error(\n          \"Storage item version cannot be less than 1. Initial versions should be set to 1, not 0.\"\n        );\n      }\n      const migrate = async () => {\n        const driverMetaKey = getMetaKey(driverKey);\n        const [{ value }, { value: meta }] = await driver.getItems([\n          driverKey,\n          driverMetaKey\n        ]);\n        if (value == null) return;\n        const currentVersion = meta?.v ?? 1;\n        if (currentVersion > targetVersion) {\n          throw Error(\n            `Version downgrade detected (v${currentVersion} -> v${targetVersion}) for \"${key}\"`\n          );\n        }\n        if (currentVersion === targetVersion) {\n          return;\n        }\n        if (debug === true) {\n          console.debug(\n            `[@wxt-dev/storage] Running storage migration for ${key}: v${currentVersion} -> v${targetVersion}`\n          );\n        }\n        const migrationsToRun = Array.from(\n          { length: targetVersion - currentVersion },\n          (_, i) => currentVersion + i + 1\n        );\n        let migratedValue = value;\n        for (const migrateToVersion of migrationsToRun) {\n          try {\n            migratedValue = await migrations?.[migrateToVersion]?.(migratedValue) ?? migratedValue;\n            if (debug === true) {\n              console.debug(\n                `[@wxt-dev/storage] Storage migration processed for version: v${migrateToVersion}`\n              );\n            }\n          } catch (err) {\n            throw new MigrationError(key, migrateToVersion, {\n              cause: err\n            });\n          }\n        }\n        await driver.setItems([\n          { key: driverKey, value: migratedValue },\n          { key: driverMetaKey, value: { ...meta, v: targetVersion } }\n        ]);\n        if (debug === true) {\n          console.debug(\n            `[@wxt-dev/storage] Storage migration completed for ${key} v${targetVersion}`,\n            { migratedValue }\n          );\n        }\n        onMigrationComplete?.(migratedValue, targetVersion);\n      };\n      const migrationsDone = opts?.migrations == null ? Promise.resolve() : migrate().catch((err) => {\n        console.error(\n          `[@wxt-dev/storage] Migration failed for ${key}`,\n          err\n        );\n      });\n      const initMutex = new Mutex();\n      const getFallback = () => opts?.fallback ?? opts?.defaultValue ?? null;\n      const getOrInitValue = () => initMutex.runExclusive(async () => {\n        const value = await driver.getItem(driverKey);\n        if (value != null || opts?.init == null) return value;\n        const newValue = await opts.init();\n        await driver.setItem(driverKey, newValue);\n        return newValue;\n      });\n      migrationsDone.then(getOrInitValue);\n      return {\n        key,\n        get defaultValue() {\n          return getFallback();\n        },\n        get fallback() {\n          return getFallback();\n        },\n        getValue: async () => {\n          await migrationsDone;\n          if (opts?.init) {\n            return await getOrInitValue();\n          } else {\n            return await getItem(driver, driverKey, opts);\n          }\n        },\n        getMeta: async () => {\n          await migrationsDone;\n          return await getMeta(driver, driverKey);\n        },\n        setValue: async (value) => {\n          await migrationsDone;\n          return await setItem(driver, driverKey, value);\n        },\n        setMeta: async (properties) => {\n          await migrationsDone;\n          return await setMeta(driver, driverKey, properties);\n        },\n        removeValue: async (opts2) => {\n          await migrationsDone;\n          return await removeItem(driver, driverKey, opts2);\n        },\n        removeMeta: async (properties) => {\n          await migrationsDone;\n          return await removeMeta(driver, driverKey, properties);\n        },\n        watch: (cb) => watch(\n          driver,\n          driverKey,\n          (newValue, oldValue) => cb(newValue ?? getFallback(), oldValue ?? getFallback())\n        ),\n        migrate\n      };\n    }\n  };\n  return storage2;\n}\nfunction createDriver(storageArea) {\n  const getStorageArea = () => {\n    if (browser.runtime == null) {\n      throw Error(\n        [\n          \"'wxt/storage' must be loaded in a web extension environment\",\n          \"\\n - If thrown during a build, see https://github.com/wxt-dev/wxt/issues/371\",\n          \" - If thrown during tests, mock 'wxt/browser' correctly. See https://wxt.dev/guide/go-further/testing.html\\n\"\n        ].join(\"\\n\")\n      );\n    }\n    if (browser.storage == null) {\n      throw Error(\n        \"You must add the 'storage' permission to your manifest to use 'wxt/storage'\"\n      );\n    }\n    const area = browser.storage[storageArea];\n    if (area == null)\n      throw Error(`\"browser.storage.${storageArea}\" is undefined`);\n    return area;\n  };\n  const watchListeners = /* @__PURE__ */ new Set();\n  return {\n    getItem: async (key) => {\n      const res = await getStorageArea().get(key);\n      return res[key];\n    },\n    getItems: async (keys) => {\n      const result = await getStorageArea().get(keys);\n      return keys.map((key) => ({ key, value: result[key] ?? null }));\n    },\n    setItem: async (key, value) => {\n      if (value == null) {\n        await getStorageArea().remove(key);\n      } else {\n        await getStorageArea().set({ [key]: value });\n      }\n    },\n    setItems: async (values) => {\n      const map = values.reduce(\n        (map2, { key, value }) => {\n          map2[key] = value;\n          return map2;\n        },\n        {}\n      );\n      await getStorageArea().set(map);\n    },\n    removeItem: async (key) => {\n      await getStorageArea().remove(key);\n    },\n    removeItems: async (keys) => {\n      await getStorageArea().remove(keys);\n    },\n    clear: async () => {\n      await getStorageArea().clear();\n    },\n    snapshot: async () => {\n      return await getStorageArea().get();\n    },\n    restoreSnapshot: async (data) => {\n      await getStorageArea().set(data);\n    },\n    watch(key, cb) {\n      const listener = (changes) => {\n        const change = changes[key];\n        if (change == null) return;\n        if (dequal(change.newValue, change.oldValue)) return;\n        cb(change.newValue ?? null, change.oldValue ?? null);\n      };\n      getStorageArea().onChanged.addListener(listener);\n      watchListeners.add(listener);\n      return () => {\n        getStorageArea().onChanged.removeListener(listener);\n        watchListeners.delete(listener);\n      };\n    },\n    unwatch() {\n      watchListeners.forEach((listener) => {\n        getStorageArea().onChanged.removeListener(listener);\n      });\n      watchListeners.clear();\n    }\n  };\n}\nclass MigrationError extends Error {\n  constructor(key, version, options) {\n    super(`v${version} migration failed for \"${key}\"`, options);\n    this.key = key;\n    this.version = version;\n  }\n}\n\nexport { MigrationError, storage };\n","import { storage } from '@wxt-dev/storage'\nimport { getBrowserOSAdapter } from '@/lib/browseros/adapter'\nimport { BROWSEROS_PREFS } from '@/lib/browseros/prefs'\nimport type { LlmProviderConfig, LlmProvidersBackup } from './types'\n\n/** Default provider ID constant */\nexport const DEFAULT_PROVIDER_ID = 'browseros'\n\n/** Storage key for LLM providers array */\nexport const providersStorage = storage.defineItem<LlmProviderConfig[]>(\n  'local:llm-providers',\n)\n\n/** Backup providers to BrowserOS prefs (write-only, best-effort) */\nasync function backupToBrowserOS(backup: LlmProvidersBackup): Promise<void> {\n  try {\n    const adapter = getBrowserOSAdapter()\n    await adapter.setPref(BROWSEROS_PREFS.PROVIDERS, JSON.stringify(backup))\n  } catch {\n    // BrowserOS API not available - ignore\n  }\n}\n\n/**\n * Setup one-way sync of LLM providers to BrowserOS prefs\n * @public\n */\nexport function setupLlmProvidersBackupToBrowserOS(): () => void {\n  const unsubscribe = providersStorage.watch(async (providers) => {\n    if (providers) {\n      const defaultProviderId = await defaultProviderIdStorage.getValue()\n      await backupToBrowserOS({ defaultProviderId, providers })\n    }\n  })\n  return unsubscribe\n}\n\n/** Load providers from storage */\nexport async function loadProviders(): Promise<LlmProviderConfig[]> {\n  const providers = await providersStorage.getValue()\n  return providers || []\n}\n\n/** Creates the default BrowserOS provider configuration */\nexport function createDefaultBrowserOSProvider(): LlmProviderConfig {\n  const timestamp = Date.now()\n  return {\n    id: DEFAULT_PROVIDER_ID,\n    type: 'browseros',\n    name: 'BrowserOS',\n    baseUrl: 'https://api.browseros.com/v1',\n    modelId: 'browseros-auto',\n    supportsImages: true,\n    contextWindow: 400000,\n    temperature: 0.2,\n    createdAt: timestamp,\n    updatedAt: timestamp,\n  }\n}\n\n/** Creates the default providers configuration. Only call when storage is empty. */\nexport function createDefaultProvidersConfig(): LlmProviderConfig[] {\n  return [createDefaultBrowserOSProvider()]\n}\n\n/** Storage key for the default provider ID */\nexport const defaultProviderIdStorage = storage.defineItem<string>(\n  'local:default-provider-id',\n  {\n    fallback: DEFAULT_PROVIDER_ID,\n  },\n)\n","// zod-compat.ts\n// ----------------------------------------------------\n// Unified types + helpers to accept Zod v3 and v4 (Mini)\n// ----------------------------------------------------\nimport * as z3rt from 'zod/v3';\nimport * as z4mini from 'zod/v4-mini';\n// --- Runtime detection ---\nexport function isZ4Schema(s) {\n    // Present on Zod 4 (Classic & Mini) schemas; absent on Zod 3\n    const schema = s;\n    return !!schema._zod;\n}\n// --- Schema construction ---\nexport function objectFromShape(shape) {\n    const values = Object.values(shape);\n    if (values.length === 0)\n        return z4mini.object({}); // default to v4 Mini\n    const allV4 = values.every(isZ4Schema);\n    const allV3 = values.every(s => !isZ4Schema(s));\n    if (allV4)\n        return z4mini.object(shape);\n    if (allV3)\n        return z3rt.object(shape);\n    throw new Error('Mixed Zod versions detected in object shape.');\n}\n// --- Unified parsing ---\nexport function safeParse(schema, data) {\n    if (isZ4Schema(schema)) {\n        // Mini exposes top-level safeParse\n        const result = z4mini.safeParse(schema, data);\n        return result;\n    }\n    const v3Schema = schema;\n    const result = v3Schema.safeParse(data);\n    return result;\n}\nexport async function safeParseAsync(schema, data) {\n    if (isZ4Schema(schema)) {\n        // Mini exposes top-level safeParseAsync\n        const result = await z4mini.safeParseAsync(schema, data);\n        return result;\n    }\n    const v3Schema = schema;\n    const result = await v3Schema.safeParseAsync(data);\n    return result;\n}\n// --- Shape extraction ---\nexport function getObjectShape(schema) {\n    var _a, _b;\n    if (!schema)\n        return undefined;\n    // Zod v3 exposes `.shape`; Zod v4 keeps the shape on `_zod.def.shape`\n    let rawShape;\n    if (isZ4Schema(schema)) {\n        const v4Schema = schema;\n        rawShape = (_b = (_a = v4Schema._zod) === null || _a === void 0 ? void 0 : _a.def) === null || _b === void 0 ? void 0 : _b.shape;\n    }\n    else {\n        const v3Schema = schema;\n        rawShape = v3Schema.shape;\n    }\n    if (!rawShape)\n        return undefined;\n    if (typeof rawShape === 'function') {\n        try {\n            return rawShape();\n        }\n        catch (_c) {\n            return undefined;\n        }\n    }\n    return rawShape;\n}\n// --- Schema normalization ---\n/**\n * Normalizes a schema to an object schema. Handles both:\n * - Already-constructed object schemas (v3 or v4)\n * - Raw shapes that need to be wrapped into object schemas\n */\nexport function normalizeObjectSchema(schema) {\n    var _a;\n    if (!schema)\n        return undefined;\n    // First check if it's a raw shape (Record<string, AnySchema>)\n    // Raw shapes don't have _def or _zod properties and aren't schemas themselves\n    if (typeof schema === 'object') {\n        // Check if it's actually a ZodRawShapeCompat (not a schema instance)\n        // by checking if it lacks schema-like internal properties\n        const asV3 = schema;\n        const asV4 = schema;\n        // If it's not a schema instance (no _def or _zod), it might be a raw shape\n        if (!asV3._def && !asV4._zod) {\n            // Check if all values are schemas (heuristic to confirm it's a raw shape)\n            const values = Object.values(schema);\n            if (values.length > 0 &&\n                values.every(v => typeof v === 'object' &&\n                    v !== null &&\n                    (v._def !== undefined ||\n                        v._zod !== undefined ||\n                        typeof v.parse === 'function'))) {\n                return objectFromShape(schema);\n            }\n        }\n    }\n    // If we get here, it should be an AnySchema (not a raw shape)\n    // Check if it's already an object schema\n    if (isZ4Schema(schema)) {\n        // Check if it's a v4 object\n        const v4Schema = schema;\n        const def = (_a = v4Schema._zod) === null || _a === void 0 ? void 0 : _a.def;\n        if (def && (def.type === 'object' || def.shape !== undefined)) {\n            return schema;\n        }\n    }\n    else {\n        // Check if it's a v3 object\n        const v3Schema = schema;\n        if (v3Schema.shape !== undefined) {\n            return schema;\n        }\n    }\n    return undefined;\n}\n// --- Error message extraction ---\n/**\n * Safely extracts an error message from a parse result error.\n * Zod errors can have different structures, so we handle various cases.\n */\nexport function getParseErrorMessage(error) {\n    if (error && typeof error === 'object') {\n        // Try common error structures\n        if ('message' in error && typeof error.message === 'string') {\n            return error.message;\n        }\n        if ('issues' in error && Array.isArray(error.issues) && error.issues.length > 0) {\n            const firstIssue = error.issues[0];\n            if (firstIssue && typeof firstIssue === 'object' && 'message' in firstIssue) {\n                return String(firstIssue.message);\n            }\n        }\n        // Fallback: try to stringify the error\n        try {\n            return JSON.stringify(error);\n        }\n        catch (_a) {\n            return String(error);\n        }\n    }\n    return String(error);\n}\n// --- Schema metadata access ---\n/**\n * Gets the description from a schema, if available.\n * Works with both Zod v3 and v4.\n */\nexport function getSchemaDescription(schema) {\n    var _a, _b, _c, _d;\n    if (isZ4Schema(schema)) {\n        const v4Schema = schema;\n        return (_b = (_a = v4Schema._zod) === null || _a === void 0 ? void 0 : _a.def) === null || _b === void 0 ? void 0 : _b.description;\n    }\n    const v3Schema = schema;\n    // v3 may have description on the schema itself or in _def\n    return (_c = schema.description) !== null && _c !== void 0 ? _c : (_d = v3Schema._def) === null || _d === void 0 ? void 0 : _d.description;\n}\n/**\n * Checks if a schema is optional.\n * Works with both Zod v3 and v4.\n */\nexport function isSchemaOptional(schema) {\n    var _a, _b, _c;\n    if (isZ4Schema(schema)) {\n        const v4Schema = schema;\n        return ((_b = (_a = v4Schema._zod) === null || _a === void 0 ? void 0 : _a.def) === null || _b === void 0 ? void 0 : _b.type) === 'optional';\n    }\n    const v3Schema = schema;\n    // v3 has isOptional() method\n    if (typeof schema.isOptional === 'function') {\n        return schema.isOptional();\n    }\n    return ((_c = v3Schema._def) === null || _c === void 0 ? void 0 : _c.typeName) === 'ZodOptional';\n}\n/**\n * Gets the literal value from a schema, if it's a literal schema.\n * Works with both Zod v3 and v4.\n * Returns undefined if the schema is not a literal or the value cannot be determined.\n */\nexport function getLiteralValue(schema) {\n    var _a;\n    if (isZ4Schema(schema)) {\n        const v4Schema = schema;\n        const def = (_a = v4Schema._zod) === null || _a === void 0 ? void 0 : _a.def;\n        if (def) {\n            // Try various ways to get the literal value\n            if (def.value !== undefined)\n                return def.value;\n            if (Array.isArray(def.values) && def.values.length > 0) {\n                return def.values[0];\n            }\n        }\n    }\n    const v3Schema = schema;\n    const def = v3Schema._def;\n    if (def) {\n        if (def.value !== undefined)\n            return def.value;\n        if (Array.isArray(def.values) && def.values.length > 0) {\n            return def.values[0];\n        }\n    }\n    // Fallback: check for direct value property (some Zod versions)\n    const directValue = schema.value;\n    if (directValue !== undefined)\n        return directValue;\n    return undefined;\n}\n//# sourceMappingURL=zod-compat.js.map","import * as z from 'zod/v4';\nexport const LATEST_PROTOCOL_VERSION = '2025-11-25';\nexport const DEFAULT_NEGOTIATED_PROTOCOL_VERSION = '2025-03-26';\nexport const SUPPORTED_PROTOCOL_VERSIONS = [LATEST_PROTOCOL_VERSION, '2025-06-18', '2025-03-26', '2024-11-05', '2024-10-07'];\nexport const RELATED_TASK_META_KEY = 'io.modelcontextprotocol/related-task';\n/* JSON-RPC types */\nexport const JSONRPC_VERSION = '2.0';\n/**\n * Assert 'object' type schema.\n *\n * @internal\n */\nconst AssertObjectSchema = z.custom((v) => v !== null && (typeof v === 'object' || typeof v === 'function'));\n/**\n * A progress token, used to associate progress notifications with the original request.\n */\nexport const ProgressTokenSchema = z.union([z.string(), z.number().int()]);\n/**\n * An opaque token used to represent a cursor for pagination.\n */\nexport const CursorSchema = z.string();\n/**\n * Task creation parameters, used to ask that the server create a task to represent a request.\n */\nexport const TaskCreationParamsSchema = z.looseObject({\n    /**\n     * Time in milliseconds to keep task results available after completion.\n     * If null, the task has unlimited lifetime until manually cleaned up.\n     */\n    ttl: z.union([z.number(), z.null()]).optional(),\n    /**\n     * Time in milliseconds to wait between task status requests.\n     */\n    pollInterval: z.number().optional()\n});\n/**\n * Task association metadata, used to signal which task a message originated from.\n */\nexport const RelatedTaskMetadataSchema = z.looseObject({\n    taskId: z.string()\n});\nconst RequestMetaSchema = z.looseObject({\n    /**\n     * If specified, the caller is requesting out-of-band progress notifications for this request (as represented by notifications/progress). The value of this parameter is an opaque token that will be attached to any subsequent notifications. The receiver is not obligated to provide these notifications.\n     */\n    progressToken: ProgressTokenSchema.optional(),\n    /**\n     * If specified, this request is related to the provided task.\n     */\n    [RELATED_TASK_META_KEY]: RelatedTaskMetadataSchema.optional()\n});\n/**\n * Common params for any request.\n */\nconst BaseRequestParamsSchema = z.looseObject({\n    /**\n     * If specified, the caller is requesting that the receiver create a task to represent the request.\n     * Task creation parameters are now at the top level instead of in _meta.\n     */\n    task: TaskCreationParamsSchema.optional(),\n    /**\n     * See [General fields: `_meta`](/specification/draft/basic/index#meta) for notes on `_meta` usage.\n     */\n    _meta: RequestMetaSchema.optional()\n});\nexport const RequestSchema = z.object({\n    method: z.string(),\n    params: BaseRequestParamsSchema.optional()\n});\nconst NotificationsParamsSchema = z.looseObject({\n    /**\n     * See [MCP specification](https://github.com/modelcontextprotocol/modelcontextprotocol/blob/47339c03c143bb4ec01a26e721a1b8fe66634ebe/docs/specification/draft/basic/index.mdx#general-fields)\n     * for notes on _meta usage.\n     */\n    _meta: z\n        .object({\n        /**\n         * If specified, this notification is related to the provided task.\n         */\n        [RELATED_TASK_META_KEY]: z.optional(RelatedTaskMetadataSchema)\n    })\n        .passthrough()\n        .optional()\n});\nexport const NotificationSchema = z.object({\n    method: z.string(),\n    params: NotificationsParamsSchema.optional()\n});\nexport const ResultSchema = z.looseObject({\n    /**\n     * See [MCP specification](https://github.com/modelcontextprotocol/modelcontextprotocol/blob/47339c03c143bb4ec01a26e721a1b8fe66634ebe/docs/specification/draft/basic/index.mdx#general-fields)\n     * for notes on _meta usage.\n     */\n    _meta: z\n        .looseObject({\n        /**\n         * If specified, this result is related to the provided task.\n         */\n        [RELATED_TASK_META_KEY]: RelatedTaskMetadataSchema.optional()\n    })\n        .optional()\n});\n/**\n * A uniquely identifying ID for a request in JSON-RPC.\n */\nexport const RequestIdSchema = z.union([z.string(), z.number().int()]);\n/**\n * A request that expects a response.\n */\nexport const JSONRPCRequestSchema = z\n    .object({\n    jsonrpc: z.literal(JSONRPC_VERSION),\n    id: RequestIdSchema,\n    ...RequestSchema.shape\n})\n    .strict();\nexport const isJSONRPCRequest = (value) => JSONRPCRequestSchema.safeParse(value).success;\n/**\n * A notification which does not expect a response.\n */\nexport const JSONRPCNotificationSchema = z\n    .object({\n    jsonrpc: z.literal(JSONRPC_VERSION),\n    ...NotificationSchema.shape\n})\n    .strict();\nexport const isJSONRPCNotification = (value) => JSONRPCNotificationSchema.safeParse(value).success;\n/**\n * A successful (non-error) response to a request.\n */\nexport const JSONRPCResponseSchema = z\n    .object({\n    jsonrpc: z.literal(JSONRPC_VERSION),\n    id: RequestIdSchema,\n    result: ResultSchema\n})\n    .strict();\nexport const isJSONRPCResponse = (value) => JSONRPCResponseSchema.safeParse(value).success;\n/**\n * Error codes defined by the JSON-RPC specification.\n */\nexport var ErrorCode;\n(function (ErrorCode) {\n    // SDK error codes\n    ErrorCode[ErrorCode[\"ConnectionClosed\"] = -32000] = \"ConnectionClosed\";\n    ErrorCode[ErrorCode[\"RequestTimeout\"] = -32001] = \"RequestTimeout\";\n    // Standard JSON-RPC error codes\n    ErrorCode[ErrorCode[\"ParseError\"] = -32700] = \"ParseError\";\n    ErrorCode[ErrorCode[\"InvalidRequest\"] = -32600] = \"InvalidRequest\";\n    ErrorCode[ErrorCode[\"MethodNotFound\"] = -32601] = \"MethodNotFound\";\n    ErrorCode[ErrorCode[\"InvalidParams\"] = -32602] = \"InvalidParams\";\n    ErrorCode[ErrorCode[\"InternalError\"] = -32603] = \"InternalError\";\n    // MCP-specific error codes\n    ErrorCode[ErrorCode[\"UrlElicitationRequired\"] = -32042] = \"UrlElicitationRequired\";\n})(ErrorCode || (ErrorCode = {}));\n/**\n * A response to a request that indicates an error occurred.\n */\nexport const JSONRPCErrorSchema = z\n    .object({\n    jsonrpc: z.literal(JSONRPC_VERSION),\n    id: RequestIdSchema,\n    error: z.object({\n        /**\n         * The error type that occurred.\n         */\n        code: z.number().int(),\n        /**\n         * A short description of the error. The message SHOULD be limited to a concise single sentence.\n         */\n        message: z.string(),\n        /**\n         * Additional information about the error. The value of this member is defined by the sender (e.g. detailed error information, nested errors etc.).\n         */\n        data: z.optional(z.unknown())\n    })\n})\n    .strict();\nexport const isJSONRPCError = (value) => JSONRPCErrorSchema.safeParse(value).success;\nexport const JSONRPCMessageSchema = z.union([JSONRPCRequestSchema, JSONRPCNotificationSchema, JSONRPCResponseSchema, JSONRPCErrorSchema]);\n/* Empty result */\n/**\n * A response that indicates success but carries no data.\n */\nexport const EmptyResultSchema = ResultSchema.strict();\nexport const CancelledNotificationParamsSchema = NotificationsParamsSchema.extend({\n    /**\n     * The ID of the request to cancel.\n     *\n     * This MUST correspond to the ID of a request previously issued in the same direction.\n     */\n    requestId: RequestIdSchema,\n    /**\n     * An optional string describing the reason for the cancellation. This MAY be logged or presented to the user.\n     */\n    reason: z.string().optional()\n});\n/* Cancellation */\n/**\n * This notification can be sent by either side to indicate that it is cancelling a previously-issued request.\n *\n * The request SHOULD still be in-flight, but due to communication latency, it is always possible that this notification MAY arrive after the request has already finished.\n *\n * This notification indicates that the result will be unused, so any associated processing SHOULD cease.\n *\n * A client MUST NOT attempt to cancel its `initialize` request.\n */\nexport const CancelledNotificationSchema = NotificationSchema.extend({\n    method: z.literal('notifications/cancelled'),\n    params: CancelledNotificationParamsSchema\n});\n/* Base Metadata */\n/**\n * Icon schema for use in tools, prompts, resources, and implementations.\n */\nexport const IconSchema = z.object({\n    /**\n     * URL or data URI for the icon.\n     */\n    src: z.string(),\n    /**\n     * Optional MIME type for the icon.\n     */\n    mimeType: z.string().optional(),\n    /**\n     * Optional array of strings that specify sizes at which the icon can be used.\n     * Each string should be in WxH format (e.g., `\"48x48\"`, `\"96x96\"`) or `\"any\"` for scalable formats like SVG.\n     *\n     * If not provided, the client should assume that the icon can be used at any size.\n     */\n    sizes: z.array(z.string()).optional()\n});\n/**\n * Base schema to add `icons` property.\n *\n */\nexport const IconsSchema = z.object({\n    /**\n     * Optional set of sized icons that the client can display in a user interface.\n     *\n     * Clients that support rendering icons MUST support at least the following MIME types:\n     * - `image/png` - PNG images (safe, universal compatibility)\n     * - `image/jpeg` (and `image/jpg`) - JPEG images (safe, universal compatibility)\n     *\n     * Clients that support rendering icons SHOULD also support:\n     * - `image/svg+xml` - SVG images (scalable but requires security precautions)\n     * - `image/webp` - WebP images (modern, efficient format)\n     */\n    icons: z.array(IconSchema).optional()\n});\n/**\n * Base metadata interface for common properties across resources, tools, prompts, and implementations.\n */\nexport const BaseMetadataSchema = z.object({\n    /** Intended for programmatic or logical use, but used as a display name in past specs or fallback */\n    name: z.string(),\n    /**\n     * Intended for UI and end-user contexts  optimized to be human-readable and easily understood,\n     * even by those unfamiliar with domain-specific terminology.\n     *\n     * If not provided, the name should be used for display (except for Tool,\n     * where `annotations.title` should be given precedence over using `name`,\n     * if present).\n     */\n    title: z.string().optional()\n});\n/* Initialization */\n/**\n * Describes the name and version of an MCP implementation.\n */\nexport const ImplementationSchema = BaseMetadataSchema.extend({\n    ...BaseMetadataSchema.shape,\n    ...IconsSchema.shape,\n    version: z.string(),\n    /**\n     * An optional URL of the website for this implementation.\n     */\n    websiteUrl: z.string().optional()\n});\nconst FormElicitationCapabilitySchema = z.intersection(z.object({\n    applyDefaults: z.boolean().optional()\n}), z.record(z.string(), z.unknown()));\nconst ElicitationCapabilitySchema = z.preprocess(value => {\n    if (value && typeof value === 'object' && !Array.isArray(value)) {\n        if (Object.keys(value).length === 0) {\n            return { form: {} };\n        }\n    }\n    return value;\n}, z.intersection(z.object({\n    form: FormElicitationCapabilitySchema.optional(),\n    url: AssertObjectSchema.optional()\n}), z.record(z.string(), z.unknown()).optional()));\n/**\n * Task capabilities for clients, indicating which request types support task creation.\n */\nexport const ClientTasksCapabilitySchema = z\n    .object({\n    /**\n     * Present if the client supports listing tasks.\n     */\n    list: z.optional(z.object({}).passthrough()),\n    /**\n     * Present if the client supports cancelling tasks.\n     */\n    cancel: z.optional(z.object({}).passthrough()),\n    /**\n     * Capabilities for task creation on specific request types.\n     */\n    requests: z.optional(z\n        .object({\n        /**\n         * Task support for sampling requests.\n         */\n        sampling: z.optional(z\n            .object({\n            createMessage: z.optional(z.object({}).passthrough())\n        })\n            .passthrough()),\n        /**\n         * Task support for elicitation requests.\n         */\n        elicitation: z.optional(z\n            .object({\n            create: z.optional(z.object({}).passthrough())\n        })\n            .passthrough())\n    })\n        .passthrough())\n})\n    .passthrough();\n/**\n * Task capabilities for servers, indicating which request types support task creation.\n */\nexport const ServerTasksCapabilitySchema = z\n    .object({\n    /**\n     * Present if the server supports listing tasks.\n     */\n    list: z.optional(z.object({}).passthrough()),\n    /**\n     * Present if the server supports cancelling tasks.\n     */\n    cancel: z.optional(z.object({}).passthrough()),\n    /**\n     * Capabilities for task creation on specific request types.\n     */\n    requests: z.optional(z\n        .object({\n        /**\n         * Task support for tool requests.\n         */\n        tools: z.optional(z\n            .object({\n            call: z.optional(z.object({}).passthrough())\n        })\n            .passthrough())\n    })\n        .passthrough())\n})\n    .passthrough();\n/**\n * Capabilities a client may support. Known capabilities are defined here, in this schema, but this is not a closed set: any client can define its own, additional capabilities.\n */\nexport const ClientCapabilitiesSchema = z.object({\n    /**\n     * Experimental, non-standard capabilities that the client supports.\n     */\n    experimental: z.record(z.string(), AssertObjectSchema).optional(),\n    /**\n     * Present if the client supports sampling from an LLM.\n     */\n    sampling: z\n        .object({\n        /**\n         * Present if the client supports context inclusion via includeContext parameter.\n         * If not declared, servers SHOULD only use `includeContext: \"none\"` (or omit it).\n         */\n        context: AssertObjectSchema.optional(),\n        /**\n         * Present if the client supports tool use via tools and toolChoice parameters.\n         */\n        tools: AssertObjectSchema.optional()\n    })\n        .optional(),\n    /**\n     * Present if the client supports eliciting user input.\n     */\n    elicitation: ElicitationCapabilitySchema.optional(),\n    /**\n     * Present if the client supports listing roots.\n     */\n    roots: z\n        .object({\n        /**\n         * Whether the client supports issuing notifications for changes to the roots list.\n         */\n        listChanged: z.boolean().optional()\n    })\n        .optional(),\n    /**\n     * Present if the client supports task creation.\n     */\n    tasks: z.optional(ClientTasksCapabilitySchema)\n});\nexport const InitializeRequestParamsSchema = BaseRequestParamsSchema.extend({\n    /**\n     * The latest version of the Model Context Protocol that the client supports. The client MAY decide to support older versions as well.\n     */\n    protocolVersion: z.string(),\n    capabilities: ClientCapabilitiesSchema,\n    clientInfo: ImplementationSchema\n});\n/**\n * This request is sent from the client to the server when it first connects, asking it to begin initialization.\n */\nexport const InitializeRequestSchema = RequestSchema.extend({\n    method: z.literal('initialize'),\n    params: InitializeRequestParamsSchema\n});\nexport const isInitializeRequest = (value) => InitializeRequestSchema.safeParse(value).success;\n/**\n * Capabilities that a server may support. Known capabilities are defined here, in this schema, but this is not a closed set: any server can define its own, additional capabilities.\n */\nexport const ServerCapabilitiesSchema = z\n    .object({\n    /**\n     * Experimental, non-standard capabilities that the server supports.\n     */\n    experimental: z.record(z.string(), AssertObjectSchema).optional(),\n    /**\n     * Present if the server supports sending log messages to the client.\n     */\n    logging: AssertObjectSchema.optional(),\n    /**\n     * Present if the server supports sending completions to the client.\n     */\n    completions: AssertObjectSchema.optional(),\n    /**\n     * Present if the server offers any prompt templates.\n     */\n    prompts: z.optional(z.object({\n        /**\n         * Whether this server supports issuing notifications for changes to the prompt list.\n         */\n        listChanged: z.optional(z.boolean())\n    })),\n    /**\n     * Present if the server offers any resources to read.\n     */\n    resources: z\n        .object({\n        /**\n         * Whether this server supports clients subscribing to resource updates.\n         */\n        subscribe: z.boolean().optional(),\n        /**\n         * Whether this server supports issuing notifications for changes to the resource list.\n         */\n        listChanged: z.boolean().optional()\n    })\n        .optional(),\n    /**\n     * Present if the server offers any tools to call.\n     */\n    tools: z\n        .object({\n        /**\n         * Whether this server supports issuing notifications for changes to the tool list.\n         */\n        listChanged: z.boolean().optional()\n    })\n        .optional(),\n    /**\n     * Present if the server supports task creation.\n     */\n    tasks: z.optional(ServerTasksCapabilitySchema)\n})\n    .passthrough();\n/**\n * After receiving an initialize request from the client, the server sends this response.\n */\nexport const InitializeResultSchema = ResultSchema.extend({\n    /**\n     * The version of the Model Context Protocol that the server wants to use. This may not match the version that the client requested. If the client cannot support this version, it MUST disconnect.\n     */\n    protocolVersion: z.string(),\n    capabilities: ServerCapabilitiesSchema,\n    serverInfo: ImplementationSchema,\n    /**\n     * Instructions describing how to use the server and its features.\n     *\n     * This can be used by clients to improve the LLM's understanding of available tools, resources, etc. It can be thought of like a \"hint\" to the model. For example, this information MAY be added to the system prompt.\n     */\n    instructions: z.string().optional()\n});\n/**\n * This notification is sent from the client to the server after initialization has finished.\n */\nexport const InitializedNotificationSchema = NotificationSchema.extend({\n    method: z.literal('notifications/initialized')\n});\nexport const isInitializedNotification = (value) => InitializedNotificationSchema.safeParse(value).success;\n/* Ping */\n/**\n * A ping, issued by either the server or the client, to check that the other party is still alive. The receiver must promptly respond, or else may be disconnected.\n */\nexport const PingRequestSchema = RequestSchema.extend({\n    method: z.literal('ping')\n});\n/* Progress notifications */\nexport const ProgressSchema = z.object({\n    /**\n     * The progress thus far. This should increase every time progress is made, even if the total is unknown.\n     */\n    progress: z.number(),\n    /**\n     * Total number of items to process (or total progress required), if known.\n     */\n    total: z.optional(z.number()),\n    /**\n     * An optional message describing the current progress.\n     */\n    message: z.optional(z.string())\n});\nexport const ProgressNotificationParamsSchema = z.object({\n    ...NotificationsParamsSchema.shape,\n    ...ProgressSchema.shape,\n    /**\n     * The progress token which was given in the initial request, used to associate this notification with the request that is proceeding.\n     */\n    progressToken: ProgressTokenSchema\n});\n/**\n * An out-of-band notification used to inform the receiver of a progress update for a long-running request.\n *\n * @category notifications/progress\n */\nexport const ProgressNotificationSchema = NotificationSchema.extend({\n    method: z.literal('notifications/progress'),\n    params: ProgressNotificationParamsSchema\n});\nexport const PaginatedRequestParamsSchema = BaseRequestParamsSchema.extend({\n    /**\n     * An opaque token representing the current pagination position.\n     * If provided, the server should return results starting after this cursor.\n     */\n    cursor: CursorSchema.optional()\n});\n/* Pagination */\nexport const PaginatedRequestSchema = RequestSchema.extend({\n    params: PaginatedRequestParamsSchema.optional()\n});\nexport const PaginatedResultSchema = ResultSchema.extend({\n    /**\n     * An opaque token representing the pagination position after the last returned result.\n     * If present, there may be more results available.\n     */\n    nextCursor: z.optional(CursorSchema)\n});\n/* Tasks */\n/**\n * A pollable state object associated with a request.\n */\nexport const TaskSchema = z.object({\n    taskId: z.string(),\n    status: z.enum(['working', 'input_required', 'completed', 'failed', 'cancelled']),\n    /**\n     * Time in milliseconds to keep task results available after completion.\n     * If null, the task has unlimited lifetime until manually cleaned up.\n     */\n    ttl: z.union([z.number(), z.null()]),\n    /**\n     * ISO 8601 timestamp when the task was created.\n     */\n    createdAt: z.string(),\n    /**\n     * ISO 8601 timestamp when the task was last updated.\n     */\n    lastUpdatedAt: z.string(),\n    pollInterval: z.optional(z.number()),\n    /**\n     * Optional diagnostic message for failed tasks or other status information.\n     */\n    statusMessage: z.optional(z.string())\n});\n/**\n * Result returned when a task is created, containing the task data wrapped in a task field.\n */\nexport const CreateTaskResultSchema = ResultSchema.extend({\n    task: TaskSchema\n});\n/**\n * Parameters for task status notification.\n */\nexport const TaskStatusNotificationParamsSchema = NotificationsParamsSchema.merge(TaskSchema);\n/**\n * A notification sent when a task's status changes.\n */\nexport const TaskStatusNotificationSchema = NotificationSchema.extend({\n    method: z.literal('notifications/tasks/status'),\n    params: TaskStatusNotificationParamsSchema\n});\n/**\n * A request to get the state of a specific task.\n */\nexport const GetTaskRequestSchema = RequestSchema.extend({\n    method: z.literal('tasks/get'),\n    params: BaseRequestParamsSchema.extend({\n        taskId: z.string()\n    })\n});\n/**\n * The response to a tasks/get request.\n */\nexport const GetTaskResultSchema = ResultSchema.merge(TaskSchema);\n/**\n * A request to get the result of a specific task.\n */\nexport const GetTaskPayloadRequestSchema = RequestSchema.extend({\n    method: z.literal('tasks/result'),\n    params: BaseRequestParamsSchema.extend({\n        taskId: z.string()\n    })\n});\n/**\n * A request to list tasks.\n */\nexport const ListTasksRequestSchema = PaginatedRequestSchema.extend({\n    method: z.literal('tasks/list')\n});\n/**\n * The response to a tasks/list request.\n */\nexport const ListTasksResultSchema = PaginatedResultSchema.extend({\n    tasks: z.array(TaskSchema)\n});\n/**\n * A request to cancel a specific task.\n */\nexport const CancelTaskRequestSchema = RequestSchema.extend({\n    method: z.literal('tasks/cancel'),\n    params: BaseRequestParamsSchema.extend({\n        taskId: z.string()\n    })\n});\n/**\n * The response to a tasks/cancel request.\n */\nexport const CancelTaskResultSchema = ResultSchema.merge(TaskSchema);\n/* Resources */\n/**\n * The contents of a specific resource or sub-resource.\n */\nexport const ResourceContentsSchema = z.object({\n    /**\n     * The URI of this resource.\n     */\n    uri: z.string(),\n    /**\n     * The MIME type of this resource, if known.\n     */\n    mimeType: z.optional(z.string()),\n    /**\n     * See [MCP specification](https://github.com/modelcontextprotocol/modelcontextprotocol/blob/47339c03c143bb4ec01a26e721a1b8fe66634ebe/docs/specification/draft/basic/index.mdx#general-fields)\n     * for notes on _meta usage.\n     */\n    _meta: z.record(z.string(), z.unknown()).optional()\n});\nexport const TextResourceContentsSchema = ResourceContentsSchema.extend({\n    /**\n     * The text of the item. This must only be set if the item can actually be represented as text (not binary data).\n     */\n    text: z.string()\n});\n/**\n * A Zod schema for validating Base64 strings that is more performant and\n * robust for very large inputs than the default regex-based check. It avoids\n * stack overflows by using the native `atob` function for validation.\n */\nconst Base64Schema = z.string().refine(val => {\n    try {\n        // atob throws a DOMException if the string contains characters\n        // that are not part of the Base64 character set.\n        atob(val);\n        return true;\n    }\n    catch (_a) {\n        return false;\n    }\n}, { message: 'Invalid Base64 string' });\nexport const BlobResourceContentsSchema = ResourceContentsSchema.extend({\n    /**\n     * A base64-encoded string representing the binary data of the item.\n     */\n    blob: Base64Schema\n});\n/**\n * Optional annotations providing clients additional context about a resource.\n */\nexport const AnnotationsSchema = z.object({\n    /**\n     * Intended audience(s) for the resource.\n     */\n    audience: z.array(z.enum(['user', 'assistant'])).optional(),\n    /**\n     * Importance hint for the resource, from 0 (least) to 1 (most).\n     */\n    priority: z.number().min(0).max(1).optional(),\n    /**\n     * ISO 8601 timestamp for the most recent modification.\n     */\n    lastModified: z.iso.datetime({ offset: true }).optional()\n});\n/**\n * A known resource that the server is capable of reading.\n */\nexport const ResourceSchema = z.object({\n    ...BaseMetadataSchema.shape,\n    ...IconsSchema.shape,\n    /**\n     * The URI of this resource.\n     */\n    uri: z.string(),\n    /**\n     * A description of what this resource represents.\n     *\n     * This can be used by clients to improve the LLM's understanding of available resources. It can be thought of like a \"hint\" to the model.\n     */\n    description: z.optional(z.string()),\n    /**\n     * The MIME type of this resource, if known.\n     */\n    mimeType: z.optional(z.string()),\n    /**\n     * Optional annotations for the client.\n     */\n    annotations: AnnotationsSchema.optional(),\n    /**\n     * See [MCP specification](https://github.com/modelcontextprotocol/modelcontextprotocol/blob/47339c03c143bb4ec01a26e721a1b8fe66634ebe/docs/specification/draft/basic/index.mdx#general-fields)\n     * for notes on _meta usage.\n     */\n    _meta: z.optional(z.looseObject({}))\n});\n/**\n * A template description for resources available on the server.\n */\nexport const ResourceTemplateSchema = z.object({\n    ...BaseMetadataSchema.shape,\n    ...IconsSchema.shape,\n    /**\n     * A URI template (according to RFC 6570) that can be used to construct resource URIs.\n     */\n    uriTemplate: z.string(),\n    /**\n     * A description of what this template is for.\n     *\n     * This can be used by clients to improve the LLM's understanding of available resources. It can be thought of like a \"hint\" to the model.\n     */\n    description: z.optional(z.string()),\n    /**\n     * The MIME type for all resources that match this template. This should only be included if all resources matching this template have the same type.\n     */\n    mimeType: z.optional(z.string()),\n    /**\n     * Optional annotations for the client.\n     */\n    annotations: AnnotationsSchema.optional(),\n    /**\n     * See [MCP specification](https://github.com/modelcontextprotocol/modelcontextprotocol/blob/47339c03c143bb4ec01a26e721a1b8fe66634ebe/docs/specification/draft/basic/index.mdx#general-fields)\n     * for notes on _meta usage.\n     */\n    _meta: z.optional(z.looseObject({}))\n});\n/**\n * Sent from the client to request a list of resources the server has.\n */\nexport const ListResourcesRequestSchema = PaginatedRequestSchema.extend({\n    method: z.literal('resources/list')\n});\n/**\n * The server's response to a resources/list request from the client.\n */\nexport const ListResourcesResultSchema = PaginatedResultSchema.extend({\n    resources: z.array(ResourceSchema)\n});\n/**\n * Sent from the client to request a list of resource templates the server has.\n */\nexport const ListResourceTemplatesRequestSchema = PaginatedRequestSchema.extend({\n    method: z.literal('resources/templates/list')\n});\n/**\n * The server's response to a resources/templates/list request from the client.\n */\nexport const ListResourceTemplatesResultSchema = PaginatedResultSchema.extend({\n    resourceTemplates: z.array(ResourceTemplateSchema)\n});\nexport const ResourceRequestParamsSchema = BaseRequestParamsSchema.extend({\n    /**\n     * The URI of the resource to read. The URI can use any protocol; it is up to the server how to interpret it.\n     *\n     * @format uri\n     */\n    uri: z.string()\n});\n/**\n * Parameters for a `resources/read` request.\n */\nexport const ReadResourceRequestParamsSchema = ResourceRequestParamsSchema;\n/**\n * Sent from the client to the server, to read a specific resource URI.\n */\nexport const ReadResourceRequestSchema = RequestSchema.extend({\n    method: z.literal('resources/read'),\n    params: ReadResourceRequestParamsSchema\n});\n/**\n * The server's response to a resources/read request from the client.\n */\nexport const ReadResourceResultSchema = ResultSchema.extend({\n    contents: z.array(z.union([TextResourceContentsSchema, BlobResourceContentsSchema]))\n});\n/**\n * An optional notification from the server to the client, informing it that the list of resources it can read from has changed. This may be issued by servers without any previous subscription from the client.\n */\nexport const ResourceListChangedNotificationSchema = NotificationSchema.extend({\n    method: z.literal('notifications/resources/list_changed')\n});\nexport const SubscribeRequestParamsSchema = ResourceRequestParamsSchema;\n/**\n * Sent from the client to request resources/updated notifications from the server whenever a particular resource changes.\n */\nexport const SubscribeRequestSchema = RequestSchema.extend({\n    method: z.literal('resources/subscribe'),\n    params: SubscribeRequestParamsSchema\n});\nexport const UnsubscribeRequestParamsSchema = ResourceRequestParamsSchema;\n/**\n * Sent from the client to request cancellation of resources/updated notifications from the server. This should follow a previous resources/subscribe request.\n */\nexport const UnsubscribeRequestSchema = RequestSchema.extend({\n    method: z.literal('resources/unsubscribe'),\n    params: UnsubscribeRequestParamsSchema\n});\n/**\n * Parameters for a `notifications/resources/updated` notification.\n */\nexport const ResourceUpdatedNotificationParamsSchema = NotificationsParamsSchema.extend({\n    /**\n     * The URI of the resource that has been updated. This might be a sub-resource of the one that the client actually subscribed to.\n     */\n    uri: z.string()\n});\n/**\n * A notification from the server to the client, informing it that a resource has changed and may need to be read again. This should only be sent if the client previously sent a resources/subscribe request.\n */\nexport const ResourceUpdatedNotificationSchema = NotificationSchema.extend({\n    method: z.literal('notifications/resources/updated'),\n    params: ResourceUpdatedNotificationParamsSchema\n});\n/* Prompts */\n/**\n * Describes an argument that a prompt can accept.\n */\nexport const PromptArgumentSchema = z.object({\n    /**\n     * The name of the argument.\n     */\n    name: z.string(),\n    /**\n     * A human-readable description of the argument.\n     */\n    description: z.optional(z.string()),\n    /**\n     * Whether this argument must be provided.\n     */\n    required: z.optional(z.boolean())\n});\n/**\n * A prompt or prompt template that the server offers.\n */\nexport const PromptSchema = z.object({\n    ...BaseMetadataSchema.shape,\n    ...IconsSchema.shape,\n    /**\n     * An optional description of what this prompt provides\n     */\n    description: z.optional(z.string()),\n    /**\n     * A list of arguments to use for templating the prompt.\n     */\n    arguments: z.optional(z.array(PromptArgumentSchema)),\n    /**\n     * See [MCP specification](https://github.com/modelcontextprotocol/modelcontextprotocol/blob/47339c03c143bb4ec01a26e721a1b8fe66634ebe/docs/specification/draft/basic/index.mdx#general-fields)\n     * for notes on _meta usage.\n     */\n    _meta: z.optional(z.looseObject({}))\n});\n/**\n * Sent from the client to request a list of prompts and prompt templates the server has.\n */\nexport const ListPromptsRequestSchema = PaginatedRequestSchema.extend({\n    method: z.literal('prompts/list')\n});\n/**\n * The server's response to a prompts/list request from the client.\n */\nexport const ListPromptsResultSchema = PaginatedResultSchema.extend({\n    prompts: z.array(PromptSchema)\n});\n/**\n * Parameters for a `prompts/get` request.\n */\nexport const GetPromptRequestParamsSchema = BaseRequestParamsSchema.extend({\n    /**\n     * The name of the prompt or prompt template.\n     */\n    name: z.string(),\n    /**\n     * Arguments to use for templating the prompt.\n     */\n    arguments: z.record(z.string(), z.string()).optional()\n});\n/**\n * Used by the client to get a prompt provided by the server.\n */\nexport const GetPromptRequestSchema = RequestSchema.extend({\n    method: z.literal('prompts/get'),\n    params: GetPromptRequestParamsSchema\n});\n/**\n * Text provided to or from an LLM.\n */\nexport const TextContentSchema = z.object({\n    type: z.literal('text'),\n    /**\n     * The text content of the message.\n     */\n    text: z.string(),\n    /**\n     * Optional annotations for the client.\n     */\n    annotations: AnnotationsSchema.optional(),\n    /**\n     * See [MCP specification](https://github.com/modelcontextprotocol/modelcontextprotocol/blob/47339c03c143bb4ec01a26e721a1b8fe66634ebe/docs/specification/draft/basic/index.mdx#general-fields)\n     * for notes on _meta usage.\n     */\n    _meta: z.record(z.string(), z.unknown()).optional()\n});\n/**\n * An image provided to or from an LLM.\n */\nexport const ImageContentSchema = z.object({\n    type: z.literal('image'),\n    /**\n     * The base64-encoded image data.\n     */\n    data: Base64Schema,\n    /**\n     * The MIME type of the image. Different providers may support different image types.\n     */\n    mimeType: z.string(),\n    /**\n     * Optional annotations for the client.\n     */\n    annotations: AnnotationsSchema.optional(),\n    /**\n     * See [MCP specification](https://github.com/modelcontextprotocol/modelcontextprotocol/blob/47339c03c143bb4ec01a26e721a1b8fe66634ebe/docs/specification/draft/basic/index.mdx#general-fields)\n     * for notes on _meta usage.\n     */\n    _meta: z.record(z.string(), z.unknown()).optional()\n});\n/**\n * An Audio provided to or from an LLM.\n */\nexport const AudioContentSchema = z.object({\n    type: z.literal('audio'),\n    /**\n     * The base64-encoded audio data.\n     */\n    data: Base64Schema,\n    /**\n     * The MIME type of the audio. Different providers may support different audio types.\n     */\n    mimeType: z.string(),\n    /**\n     * Optional annotations for the client.\n     */\n    annotations: AnnotationsSchema.optional(),\n    /**\n     * See [MCP specification](https://github.com/modelcontextprotocol/modelcontextprotocol/blob/47339c03c143bb4ec01a26e721a1b8fe66634ebe/docs/specification/draft/basic/index.mdx#general-fields)\n     * for notes on _meta usage.\n     */\n    _meta: z.record(z.string(), z.unknown()).optional()\n});\n/**\n * A tool call request from an assistant (LLM).\n * Represents the assistant's request to use a tool.\n */\nexport const ToolUseContentSchema = z\n    .object({\n    type: z.literal('tool_use'),\n    /**\n     * The name of the tool to invoke.\n     * Must match a tool name from the request's tools array.\n     */\n    name: z.string(),\n    /**\n     * Unique identifier for this tool call.\n     * Used to correlate with ToolResultContent in subsequent messages.\n     */\n    id: z.string(),\n    /**\n     * Arguments to pass to the tool.\n     * Must conform to the tool's inputSchema.\n     */\n    input: z.object({}).passthrough(),\n    /**\n     * See [MCP specification](https://github.com/modelcontextprotocol/modelcontextprotocol/blob/47339c03c143bb4ec01a26e721a1b8fe66634ebe/docs/specification/draft/basic/index.mdx#general-fields)\n     * for notes on _meta usage.\n     */\n    _meta: z.optional(z.object({}).passthrough())\n})\n    .passthrough();\n/**\n * The contents of a resource, embedded into a prompt or tool call result.\n */\nexport const EmbeddedResourceSchema = z.object({\n    type: z.literal('resource'),\n    resource: z.union([TextResourceContentsSchema, BlobResourceContentsSchema]),\n    /**\n     * Optional annotations for the client.\n     */\n    annotations: AnnotationsSchema.optional(),\n    /**\n     * See [MCP specification](https://github.com/modelcontextprotocol/modelcontextprotocol/blob/47339c03c143bb4ec01a26e721a1b8fe66634ebe/docs/specification/draft/basic/index.mdx#general-fields)\n     * for notes on _meta usage.\n     */\n    _meta: z.record(z.string(), z.unknown()).optional()\n});\n/**\n * A resource that the server is capable of reading, included in a prompt or tool call result.\n *\n * Note: resource links returned by tools are not guaranteed to appear in the results of `resources/list` requests.\n */\nexport const ResourceLinkSchema = ResourceSchema.extend({\n    type: z.literal('resource_link')\n});\n/**\n * A content block that can be used in prompts and tool results.\n */\nexport const ContentBlockSchema = z.union([\n    TextContentSchema,\n    ImageContentSchema,\n    AudioContentSchema,\n    ResourceLinkSchema,\n    EmbeddedResourceSchema\n]);\n/**\n * Describes a message returned as part of a prompt.\n */\nexport const PromptMessageSchema = z.object({\n    role: z.enum(['user', 'assistant']),\n    content: ContentBlockSchema\n});\n/**\n * The server's response to a prompts/get request from the client.\n */\nexport const GetPromptResultSchema = ResultSchema.extend({\n    /**\n     * An optional description for the prompt.\n     */\n    description: z.optional(z.string()),\n    messages: z.array(PromptMessageSchema)\n});\n/**\n * An optional notification from the server to the client, informing it that the list of prompts it offers has changed. This may be issued by servers without any previous subscription from the client.\n */\nexport const PromptListChangedNotificationSchema = NotificationSchema.extend({\n    method: z.literal('notifications/prompts/list_changed')\n});\n/* Tools */\n/**\n * Additional properties describing a Tool to clients.\n *\n * NOTE: all properties in ToolAnnotations are **hints**.\n * They are not guaranteed to provide a faithful description of\n * tool behavior (including descriptive properties like `title`).\n *\n * Clients should never make tool use decisions based on ToolAnnotations\n * received from untrusted servers.\n */\nexport const ToolAnnotationsSchema = z.object({\n    /**\n     * A human-readable title for the tool.\n     */\n    title: z.string().optional(),\n    /**\n     * If true, the tool does not modify its environment.\n     *\n     * Default: false\n     */\n    readOnlyHint: z.boolean().optional(),\n    /**\n     * If true, the tool may perform destructive updates to its environment.\n     * If false, the tool performs only additive updates.\n     *\n     * (This property is meaningful only when `readOnlyHint == false`)\n     *\n     * Default: true\n     */\n    destructiveHint: z.boolean().optional(),\n    /**\n     * If true, calling the tool repeatedly with the same arguments\n     * will have no additional effect on the its environment.\n     *\n     * (This property is meaningful only when `readOnlyHint == false`)\n     *\n     * Default: false\n     */\n    idempotentHint: z.boolean().optional(),\n    /**\n     * If true, this tool may interact with an \"open world\" of external\n     * entities. If false, the tool's domain of interaction is closed.\n     * For example, the world of a web search tool is open, whereas that\n     * of a memory tool is not.\n     *\n     * Default: true\n     */\n    openWorldHint: z.boolean().optional()\n});\n/**\n * Execution-related properties for a tool.\n */\nexport const ToolExecutionSchema = z.object({\n    /**\n     * Indicates the tool's preference for task-augmented execution.\n     * - \"required\": Clients MUST invoke the tool as a task\n     * - \"optional\": Clients MAY invoke the tool as a task or normal request\n     * - \"forbidden\": Clients MUST NOT attempt to invoke the tool as a task\n     *\n     * If not present, defaults to \"forbidden\".\n     */\n    taskSupport: z.enum(['required', 'optional', 'forbidden']).optional()\n});\n/**\n * Definition for a tool the client can call.\n */\nexport const ToolSchema = z.object({\n    ...BaseMetadataSchema.shape,\n    ...IconsSchema.shape,\n    /**\n     * A human-readable description of the tool.\n     */\n    description: z.string().optional(),\n    /**\n     * A JSON Schema 2020-12 object defining the expected parameters for the tool.\n     * Must have type: 'object' at the root level per MCP spec.\n     */\n    inputSchema: z\n        .object({\n        type: z.literal('object'),\n        properties: z.record(z.string(), AssertObjectSchema).optional(),\n        required: z.array(z.string()).optional()\n    })\n        .catchall(z.unknown()),\n    /**\n     * An optional JSON Schema 2020-12 object defining the structure of the tool's output\n     * returned in the structuredContent field of a CallToolResult.\n     * Must have type: 'object' at the root level per MCP spec.\n     */\n    outputSchema: z\n        .object({\n        type: z.literal('object'),\n        properties: z.record(z.string(), AssertObjectSchema).optional(),\n        required: z.array(z.string()).optional()\n    })\n        .catchall(z.unknown())\n        .optional(),\n    /**\n     * Optional additional tool information.\n     */\n    annotations: z.optional(ToolAnnotationsSchema),\n    /**\n     * Execution-related properties for this tool.\n     */\n    execution: z.optional(ToolExecutionSchema),\n    /**\n     * See [MCP specification](https://github.com/modelcontextprotocol/modelcontextprotocol/blob/47339c03c143bb4ec01a26e721a1b8fe66634ebe/docs/specification/draft/basic/index.mdx#general-fields)\n     * for notes on _meta usage.\n     */\n    _meta: z.record(z.string(), z.unknown()).optional()\n});\n/**\n * Sent from the client to request a list of tools the server has.\n */\nexport const ListToolsRequestSchema = PaginatedRequestSchema.extend({\n    method: z.literal('tools/list')\n});\n/**\n * The server's response to a tools/list request from the client.\n */\nexport const ListToolsResultSchema = PaginatedResultSchema.extend({\n    tools: z.array(ToolSchema)\n});\n/**\n * The server's response to a tool call.\n */\nexport const CallToolResultSchema = ResultSchema.extend({\n    /**\n     * A list of content objects that represent the result of the tool call.\n     *\n     * If the Tool does not define an outputSchema, this field MUST be present in the result.\n     * For backwards compatibility, this field is always present, but it may be empty.\n     */\n    content: z.array(ContentBlockSchema).default([]),\n    /**\n     * An object containing structured tool output.\n     *\n     * If the Tool defines an outputSchema, this field MUST be present in the result, and contain a JSON object that matches the schema.\n     */\n    structuredContent: z.record(z.string(), z.unknown()).optional(),\n    /**\n     * Whether the tool call ended in an error.\n     *\n     * If not set, this is assumed to be false (the call was successful).\n     *\n     * Any errors that originate from the tool SHOULD be reported inside the result\n     * object, with `isError` set to true, _not_ as an MCP protocol-level error\n     * response. Otherwise, the LLM would not be able to see that an error occurred\n     * and self-correct.\n     *\n     * However, any errors in _finding_ the tool, an error indicating that the\n     * server does not support tool calls, or any other exceptional conditions,\n     * should be reported as an MCP error response.\n     */\n    isError: z.optional(z.boolean())\n});\n/**\n * CallToolResultSchema extended with backwards compatibility to protocol version 2024-10-07.\n */\nexport const CompatibilityCallToolResultSchema = CallToolResultSchema.or(ResultSchema.extend({\n    toolResult: z.unknown()\n}));\n/**\n * Parameters for a `tools/call` request.\n */\nexport const CallToolRequestParamsSchema = BaseRequestParamsSchema.extend({\n    /**\n     * The name of the tool to call.\n     */\n    name: z.string(),\n    /**\n     * Arguments to pass to the tool.\n     */\n    arguments: z.optional(z.record(z.string(), z.unknown()))\n});\n/**\n * Used by the client to invoke a tool provided by the server.\n */\nexport const CallToolRequestSchema = RequestSchema.extend({\n    method: z.literal('tools/call'),\n    params: CallToolRequestParamsSchema\n});\n/**\n * An optional notification from the server to the client, informing it that the list of tools it offers has changed. This may be issued by servers without any previous subscription from the client.\n */\nexport const ToolListChangedNotificationSchema = NotificationSchema.extend({\n    method: z.literal('notifications/tools/list_changed')\n});\n/* Logging */\n/**\n * The severity of a log message.\n */\nexport const LoggingLevelSchema = z.enum(['debug', 'info', 'notice', 'warning', 'error', 'critical', 'alert', 'emergency']);\n/**\n * Parameters for a `logging/setLevel` request.\n */\nexport const SetLevelRequestParamsSchema = BaseRequestParamsSchema.extend({\n    /**\n     * The level of logging that the client wants to receive from the server. The server should send all logs at this level and higher (i.e., more severe) to the client as notifications/logging/message.\n     */\n    level: LoggingLevelSchema\n});\n/**\n * A request from the client to the server, to enable or adjust logging.\n */\nexport const SetLevelRequestSchema = RequestSchema.extend({\n    method: z.literal('logging/setLevel'),\n    params: SetLevelRequestParamsSchema\n});\n/**\n * Parameters for a `notifications/message` notification.\n */\nexport const LoggingMessageNotificationParamsSchema = NotificationsParamsSchema.extend({\n    /**\n     * The severity of this log message.\n     */\n    level: LoggingLevelSchema,\n    /**\n     * An optional name of the logger issuing this message.\n     */\n    logger: z.string().optional(),\n    /**\n     * The data to be logged, such as a string message or an object. Any JSON serializable type is allowed here.\n     */\n    data: z.unknown()\n});\n/**\n * Notification of a log message passed from server to client. If no logging/setLevel request has been sent from the client, the server MAY decide which messages to send automatically.\n */\nexport const LoggingMessageNotificationSchema = NotificationSchema.extend({\n    method: z.literal('notifications/message'),\n    params: LoggingMessageNotificationParamsSchema\n});\n/* Sampling */\n/**\n * Hints to use for model selection.\n */\nexport const ModelHintSchema = z.object({\n    /**\n     * A hint for a model name.\n     */\n    name: z.string().optional()\n});\n/**\n * The server's preferences for model selection, requested of the client during sampling.\n */\nexport const ModelPreferencesSchema = z.object({\n    /**\n     * Optional hints to use for model selection.\n     */\n    hints: z.optional(z.array(ModelHintSchema)),\n    /**\n     * How much to prioritize cost when selecting a model.\n     */\n    costPriority: z.optional(z.number().min(0).max(1)),\n    /**\n     * How much to prioritize sampling speed (latency) when selecting a model.\n     */\n    speedPriority: z.optional(z.number().min(0).max(1)),\n    /**\n     * How much to prioritize intelligence and capabilities when selecting a model.\n     */\n    intelligencePriority: z.optional(z.number().min(0).max(1))\n});\n/**\n * Controls tool usage behavior in sampling requests.\n */\nexport const ToolChoiceSchema = z.object({\n    /**\n     * Controls when tools are used:\n     * - \"auto\": Model decides whether to use tools (default)\n     * - \"required\": Model MUST use at least one tool before completing\n     * - \"none\": Model MUST NOT use any tools\n     */\n    mode: z.optional(z.enum(['auto', 'required', 'none']))\n});\n/**\n * The result of a tool execution, provided by the user (server).\n * Represents the outcome of invoking a tool requested via ToolUseContent.\n */\nexport const ToolResultContentSchema = z\n    .object({\n    type: z.literal('tool_result'),\n    toolUseId: z.string().describe('The unique identifier for the corresponding tool call.'),\n    content: z.array(ContentBlockSchema).default([]),\n    structuredContent: z.object({}).passthrough().optional(),\n    isError: z.optional(z.boolean()),\n    /**\n     * See [MCP specification](https://github.com/modelcontextprotocol/modelcontextprotocol/blob/47339c03c143bb4ec01a26e721a1b8fe66634ebe/docs/specification/draft/basic/index.mdx#general-fields)\n     * for notes on _meta usage.\n     */\n    _meta: z.optional(z.object({}).passthrough())\n})\n    .passthrough();\n/**\n * Basic content types for sampling responses (without tool use).\n * Used for backwards-compatible CreateMessageResult when tools are not used.\n */\nexport const SamplingContentSchema = z.discriminatedUnion('type', [TextContentSchema, ImageContentSchema, AudioContentSchema]);\n/**\n * Content block types allowed in sampling messages.\n * This includes text, image, audio, tool use requests, and tool results.\n */\nexport const SamplingMessageContentBlockSchema = z.discriminatedUnion('type', [\n    TextContentSchema,\n    ImageContentSchema,\n    AudioContentSchema,\n    ToolUseContentSchema,\n    ToolResultContentSchema\n]);\n/**\n * Describes a message issued to or received from an LLM API.\n */\nexport const SamplingMessageSchema = z\n    .object({\n    role: z.enum(['user', 'assistant']),\n    content: z.union([SamplingMessageContentBlockSchema, z.array(SamplingMessageContentBlockSchema)]),\n    /**\n     * See [MCP specification](https://github.com/modelcontextprotocol/modelcontextprotocol/blob/47339c03c143bb4ec01a26e721a1b8fe66634ebe/docs/specification/draft/basic/index.mdx#general-fields)\n     * for notes on _meta usage.\n     */\n    _meta: z.optional(z.object({}).passthrough())\n})\n    .passthrough();\n/**\n * Parameters for a `sampling/createMessage` request.\n */\nexport const CreateMessageRequestParamsSchema = BaseRequestParamsSchema.extend({\n    messages: z.array(SamplingMessageSchema),\n    /**\n     * The server's preferences for which model to select. The client MAY modify or omit this request.\n     */\n    modelPreferences: ModelPreferencesSchema.optional(),\n    /**\n     * An optional system prompt the server wants to use for sampling. The client MAY modify or omit this prompt.\n     */\n    systemPrompt: z.string().optional(),\n    /**\n     * A request to include context from one or more MCP servers (including the caller), to be attached to the prompt.\n     * The client MAY ignore this request.\n     *\n     * Default is \"none\". Values \"thisServer\" and \"allServers\" are soft-deprecated. Servers SHOULD only use these values if the client\n     * declares ClientCapabilities.sampling.context. These values may be removed in future spec releases.\n     */\n    includeContext: z.enum(['none', 'thisServer', 'allServers']).optional(),\n    temperature: z.number().optional(),\n    /**\n     * The requested maximum number of tokens to sample (to prevent runaway completions).\n     *\n     * The client MAY choose to sample fewer tokens than the requested maximum.\n     */\n    maxTokens: z.number().int(),\n    stopSequences: z.array(z.string()).optional(),\n    /**\n     * Optional metadata to pass through to the LLM provider. The format of this metadata is provider-specific.\n     */\n    metadata: AssertObjectSchema.optional(),\n    /**\n     * Tools that the model may use during generation.\n     * The client MUST return an error if this field is provided but ClientCapabilities.sampling.tools is not declared.\n     */\n    tools: z.optional(z.array(ToolSchema)),\n    /**\n     * Controls how the model uses tools.\n     * The client MUST return an error if this field is provided but ClientCapabilities.sampling.tools is not declared.\n     * Default is `{ mode: \"auto\" }`.\n     */\n    toolChoice: z.optional(ToolChoiceSchema)\n});\n/**\n * A request from the server to sample an LLM via the client. The client has full discretion over which model to select. The client should also inform the user before beginning sampling, to allow them to inspect the request (human in the loop) and decide whether to approve it.\n */\nexport const CreateMessageRequestSchema = RequestSchema.extend({\n    method: z.literal('sampling/createMessage'),\n    params: CreateMessageRequestParamsSchema\n});\n/**\n * The client's response to a sampling/create_message request from the server.\n * This is the backwards-compatible version that returns single content (no arrays).\n * Used when the request does not include tools.\n */\nexport const CreateMessageResultSchema = ResultSchema.extend({\n    /**\n     * The name of the model that generated the message.\n     */\n    model: z.string(),\n    /**\n     * The reason why sampling stopped, if known.\n     *\n     * Standard values:\n     * - \"endTurn\": Natural end of the assistant's turn\n     * - \"stopSequence\": A stop sequence was encountered\n     * - \"maxTokens\": Maximum token limit was reached\n     *\n     * This field is an open string to allow for provider-specific stop reasons.\n     */\n    stopReason: z.optional(z.enum(['endTurn', 'stopSequence', 'maxTokens']).or(z.string())),\n    role: z.enum(['user', 'assistant']),\n    /**\n     * Response content. Single content block (text, image, or audio).\n     */\n    content: SamplingContentSchema\n});\n/**\n * The client's response to a sampling/create_message request when tools were provided.\n * This version supports array content for tool use flows.\n */\nexport const CreateMessageResultWithToolsSchema = ResultSchema.extend({\n    /**\n     * The name of the model that generated the message.\n     */\n    model: z.string(),\n    /**\n     * The reason why sampling stopped, if known.\n     *\n     * Standard values:\n     * - \"endTurn\": Natural end of the assistant's turn\n     * - \"stopSequence\": A stop sequence was encountered\n     * - \"maxTokens\": Maximum token limit was reached\n     * - \"toolUse\": The model wants to use one or more tools\n     *\n     * This field is an open string to allow for provider-specific stop reasons.\n     */\n    stopReason: z.optional(z.enum(['endTurn', 'stopSequence', 'maxTokens', 'toolUse']).or(z.string())),\n    role: z.enum(['user', 'assistant']),\n    /**\n     * Response content. May be a single block or array. May include ToolUseContent if stopReason is \"toolUse\".\n     */\n    content: z.union([SamplingMessageContentBlockSchema, z.array(SamplingMessageContentBlockSchema)])\n});\n/* Elicitation */\n/**\n * Primitive schema definition for boolean fields.\n */\nexport const BooleanSchemaSchema = z.object({\n    type: z.literal('boolean'),\n    title: z.string().optional(),\n    description: z.string().optional(),\n    default: z.boolean().optional()\n});\n/**\n * Primitive schema definition for string fields.\n */\nexport const StringSchemaSchema = z.object({\n    type: z.literal('string'),\n    title: z.string().optional(),\n    description: z.string().optional(),\n    minLength: z.number().optional(),\n    maxLength: z.number().optional(),\n    format: z.enum(['email', 'uri', 'date', 'date-time']).optional(),\n    default: z.string().optional()\n});\n/**\n * Primitive schema definition for number fields.\n */\nexport const NumberSchemaSchema = z.object({\n    type: z.enum(['number', 'integer']),\n    title: z.string().optional(),\n    description: z.string().optional(),\n    minimum: z.number().optional(),\n    maximum: z.number().optional(),\n    default: z.number().optional()\n});\n/**\n * Schema for single-selection enumeration without display titles for options.\n */\nexport const UntitledSingleSelectEnumSchemaSchema = z.object({\n    type: z.literal('string'),\n    title: z.string().optional(),\n    description: z.string().optional(),\n    enum: z.array(z.string()),\n    default: z.string().optional()\n});\n/**\n * Schema for single-selection enumeration with display titles for each option.\n */\nexport const TitledSingleSelectEnumSchemaSchema = z.object({\n    type: z.literal('string'),\n    title: z.string().optional(),\n    description: z.string().optional(),\n    oneOf: z.array(z.object({\n        const: z.string(),\n        title: z.string()\n    })),\n    default: z.string().optional()\n});\n/**\n * Use TitledSingleSelectEnumSchema instead.\n * This interface will be removed in a future version.\n */\nexport const LegacyTitledEnumSchemaSchema = z.object({\n    type: z.literal('string'),\n    title: z.string().optional(),\n    description: z.string().optional(),\n    enum: z.array(z.string()),\n    enumNames: z.array(z.string()).optional(),\n    default: z.string().optional()\n});\n// Combined single selection enumeration\nexport const SingleSelectEnumSchemaSchema = z.union([UntitledSingleSelectEnumSchemaSchema, TitledSingleSelectEnumSchemaSchema]);\n/**\n * Schema for multiple-selection enumeration without display titles for options.\n */\nexport const UntitledMultiSelectEnumSchemaSchema = z.object({\n    type: z.literal('array'),\n    title: z.string().optional(),\n    description: z.string().optional(),\n    minItems: z.number().optional(),\n    maxItems: z.number().optional(),\n    items: z.object({\n        type: z.literal('string'),\n        enum: z.array(z.string())\n    }),\n    default: z.array(z.string()).optional()\n});\n/**\n * Schema for multiple-selection enumeration with display titles for each option.\n */\nexport const TitledMultiSelectEnumSchemaSchema = z.object({\n    type: z.literal('array'),\n    title: z.string().optional(),\n    description: z.string().optional(),\n    minItems: z.number().optional(),\n    maxItems: z.number().optional(),\n    items: z.object({\n        anyOf: z.array(z.object({\n            const: z.string(),\n            title: z.string()\n        }))\n    }),\n    default: z.array(z.string()).optional()\n});\n/**\n * Combined schema for multiple-selection enumeration\n */\nexport const MultiSelectEnumSchemaSchema = z.union([UntitledMultiSelectEnumSchemaSchema, TitledMultiSelectEnumSchemaSchema]);\n/**\n * Primitive schema definition for enum fields.\n */\nexport const EnumSchemaSchema = z.union([LegacyTitledEnumSchemaSchema, SingleSelectEnumSchemaSchema, MultiSelectEnumSchemaSchema]);\n/**\n * Union of all primitive schema definitions.\n */\nexport const PrimitiveSchemaDefinitionSchema = z.union([EnumSchemaSchema, BooleanSchemaSchema, StringSchemaSchema, NumberSchemaSchema]);\n/**\n * Parameters for an `elicitation/create` request for form-based elicitation.\n */\nexport const ElicitRequestFormParamsSchema = BaseRequestParamsSchema.extend({\n    /**\n     * The elicitation mode.\n     *\n     * Optional for backward compatibility. Clients MUST treat missing mode as \"form\".\n     */\n    mode: z.literal('form').optional(),\n    /**\n     * The message to present to the user describing what information is being requested.\n     */\n    message: z.string(),\n    /**\n     * A restricted subset of JSON Schema.\n     * Only top-level properties are allowed, without nesting.\n     */\n    requestedSchema: z.object({\n        type: z.literal('object'),\n        properties: z.record(z.string(), PrimitiveSchemaDefinitionSchema),\n        required: z.array(z.string()).optional()\n    })\n});\n/**\n * Parameters for an `elicitation/create` request for URL-based elicitation.\n */\nexport const ElicitRequestURLParamsSchema = BaseRequestParamsSchema.extend({\n    /**\n     * The elicitation mode.\n     */\n    mode: z.literal('url'),\n    /**\n     * The message to present to the user explaining why the interaction is needed.\n     */\n    message: z.string(),\n    /**\n     * The ID of the elicitation, which must be unique within the context of the server.\n     * The client MUST treat this ID as an opaque value.\n     */\n    elicitationId: z.string(),\n    /**\n     * The URL that the user should navigate to.\n     */\n    url: z.string().url()\n});\n/**\n * The parameters for a request to elicit additional information from the user via the client.\n */\nexport const ElicitRequestParamsSchema = z.union([ElicitRequestFormParamsSchema, ElicitRequestURLParamsSchema]);\n/**\n * A request from the server to elicit user input via the client.\n * The client should present the message and form fields to the user (form mode)\n * or navigate to a URL (URL mode).\n */\nexport const ElicitRequestSchema = RequestSchema.extend({\n    method: z.literal('elicitation/create'),\n    params: ElicitRequestParamsSchema\n});\n/**\n * Parameters for a `notifications/elicitation/complete` notification.\n *\n * @category notifications/elicitation/complete\n */\nexport const ElicitationCompleteNotificationParamsSchema = NotificationsParamsSchema.extend({\n    /**\n     * The ID of the elicitation that completed.\n     */\n    elicitationId: z.string()\n});\n/**\n * A notification from the server to the client, informing it of a completion of an out-of-band elicitation request.\n *\n * @category notifications/elicitation/complete\n */\nexport const ElicitationCompleteNotificationSchema = NotificationSchema.extend({\n    method: z.literal('notifications/elicitation/complete'),\n    params: ElicitationCompleteNotificationParamsSchema\n});\n/**\n * The client's response to an elicitation/create request from the server.\n */\nexport const ElicitResultSchema = ResultSchema.extend({\n    /**\n     * The user action in response to the elicitation.\n     * - \"accept\": User submitted the form/confirmed the action\n     * - \"decline\": User explicitly decline the action\n     * - \"cancel\": User dismissed without making an explicit choice\n     */\n    action: z.enum(['accept', 'decline', 'cancel']),\n    /**\n     * The submitted form data, only present when action is \"accept\".\n     * Contains values matching the requested schema.\n     * Per MCP spec, content is \"typically omitted\" for decline/cancel actions.\n     * We normalize null to undefined for leniency while maintaining type compatibility.\n     */\n    content: z.preprocess(val => (val === null ? undefined : val), z.record(z.string(), z.union([z.string(), z.number(), z.boolean(), z.array(z.string())])).optional())\n});\n/* Autocomplete */\n/**\n * A reference to a resource or resource template definition.\n */\nexport const ResourceTemplateReferenceSchema = z.object({\n    type: z.literal('ref/resource'),\n    /**\n     * The URI or URI template of the resource.\n     */\n    uri: z.string()\n});\n/**\n * @deprecated Use ResourceTemplateReferenceSchema instead\n */\nexport const ResourceReferenceSchema = ResourceTemplateReferenceSchema;\n/**\n * Identifies a prompt.\n */\nexport const PromptReferenceSchema = z.object({\n    type: z.literal('ref/prompt'),\n    /**\n     * The name of the prompt or prompt template\n     */\n    name: z.string()\n});\n/**\n * Parameters for a `completion/complete` request.\n */\nexport const CompleteRequestParamsSchema = BaseRequestParamsSchema.extend({\n    ref: z.union([PromptReferenceSchema, ResourceTemplateReferenceSchema]),\n    /**\n     * The argument's information\n     */\n    argument: z.object({\n        /**\n         * The name of the argument\n         */\n        name: z.string(),\n        /**\n         * The value of the argument to use for completion matching.\n         */\n        value: z.string()\n    }),\n    context: z\n        .object({\n        /**\n         * Previously-resolved variables in a URI template or prompt.\n         */\n        arguments: z.record(z.string(), z.string()).optional()\n    })\n        .optional()\n});\n/**\n * A request from the client to the server, to ask for completion options.\n */\nexport const CompleteRequestSchema = RequestSchema.extend({\n    method: z.literal('completion/complete'),\n    params: CompleteRequestParamsSchema\n});\nexport function assertCompleteRequestPrompt(request) {\n    if (request.params.ref.type !== 'ref/prompt') {\n        throw new TypeError(`Expected CompleteRequestPrompt, but got ${request.params.ref.type}`);\n    }\n    void request;\n}\nexport function assertCompleteRequestResourceTemplate(request) {\n    if (request.params.ref.type !== 'ref/resource') {\n        throw new TypeError(`Expected CompleteRequestResourceTemplate, but got ${request.params.ref.type}`);\n    }\n    void request;\n}\n/**\n * The server's response to a completion/complete request\n */\nexport const CompleteResultSchema = ResultSchema.extend({\n    completion: z.looseObject({\n        /**\n         * An array of completion values. Must not exceed 100 items.\n         */\n        values: z.array(z.string()).max(100),\n        /**\n         * The total number of completion options available. This can exceed the number of values actually sent in the response.\n         */\n        total: z.optional(z.number().int()),\n        /**\n         * Indicates whether there are additional completion options beyond those provided in the current response, even if the exact total is unknown.\n         */\n        hasMore: z.optional(z.boolean())\n    })\n});\n/* Roots */\n/**\n * Represents a root directory or file that the server can operate on.\n */\nexport const RootSchema = z.object({\n    /**\n     * The URI identifying the root. This *must* start with file:// for now.\n     */\n    uri: z.string().startsWith('file://'),\n    /**\n     * An optional name for the root.\n     */\n    name: z.string().optional(),\n    /**\n     * See [MCP specification](https://github.com/modelcontextprotocol/modelcontextprotocol/blob/47339c03c143bb4ec01a26e721a1b8fe66634ebe/docs/specification/draft/basic/index.mdx#general-fields)\n     * for notes on _meta usage.\n     */\n    _meta: z.record(z.string(), z.unknown()).optional()\n});\n/**\n * Sent from the server to request a list of root URIs from the client.\n */\nexport const ListRootsRequestSchema = RequestSchema.extend({\n    method: z.literal('roots/list')\n});\n/**\n * The client's response to a roots/list request from the server.\n */\nexport const ListRootsResultSchema = ResultSchema.extend({\n    roots: z.array(RootSchema)\n});\n/**\n * A notification from the client to the server, informing it that the list of roots has changed.\n */\nexport const RootsListChangedNotificationSchema = NotificationSchema.extend({\n    method: z.literal('notifications/roots/list_changed')\n});\n/* Client messages */\nexport const ClientRequestSchema = z.union([\n    PingRequestSchema,\n    InitializeRequestSchema,\n    CompleteRequestSchema,\n    SetLevelRequestSchema,\n    GetPromptRequestSchema,\n    ListPromptsRequestSchema,\n    ListResourcesRequestSchema,\n    ListResourceTemplatesRequestSchema,\n    ReadResourceRequestSchema,\n    SubscribeRequestSchema,\n    UnsubscribeRequestSchema,\n    CallToolRequestSchema,\n    ListToolsRequestSchema,\n    GetTaskRequestSchema,\n    GetTaskPayloadRequestSchema,\n    ListTasksRequestSchema\n]);\nexport const ClientNotificationSchema = z.union([\n    CancelledNotificationSchema,\n    ProgressNotificationSchema,\n    InitializedNotificationSchema,\n    RootsListChangedNotificationSchema,\n    TaskStatusNotificationSchema\n]);\nexport const ClientResultSchema = z.union([\n    EmptyResultSchema,\n    CreateMessageResultSchema,\n    CreateMessageResultWithToolsSchema,\n    ElicitResultSchema,\n    ListRootsResultSchema,\n    GetTaskResultSchema,\n    ListTasksResultSchema,\n    CreateTaskResultSchema\n]);\n/* Server messages */\nexport const ServerRequestSchema = z.union([\n    PingRequestSchema,\n    CreateMessageRequestSchema,\n    ElicitRequestSchema,\n    ListRootsRequestSchema,\n    GetTaskRequestSchema,\n    GetTaskPayloadRequestSchema,\n    ListTasksRequestSchema\n]);\nexport const ServerNotificationSchema = z.union([\n    CancelledNotificationSchema,\n    ProgressNotificationSchema,\n    LoggingMessageNotificationSchema,\n    ResourceUpdatedNotificationSchema,\n    ResourceListChangedNotificationSchema,\n    ToolListChangedNotificationSchema,\n    PromptListChangedNotificationSchema,\n    TaskStatusNotificationSchema,\n    ElicitationCompleteNotificationSchema\n]);\nexport const ServerResultSchema = z.union([\n    EmptyResultSchema,\n    InitializeResultSchema,\n    CompleteResultSchema,\n    GetPromptResultSchema,\n    ListPromptsResultSchema,\n    ListResourcesResultSchema,\n    ListResourceTemplatesResultSchema,\n    ReadResourceResultSchema,\n    CallToolResultSchema,\n    ListToolsResultSchema,\n    GetTaskResultSchema,\n    ListTasksResultSchema,\n    CreateTaskResultSchema\n]);\nexport class McpError extends Error {\n    constructor(code, message, data) {\n        super(`MCP error ${code}: ${message}`);\n        this.code = code;\n        this.data = data;\n        this.name = 'McpError';\n    }\n    /**\n     * Factory method to create the appropriate error type based on the error code and data\n     */\n    static fromError(code, message, data) {\n        // Check for specific error types\n        if (code === ErrorCode.UrlElicitationRequired && data) {\n            const errorData = data;\n            if (errorData.elicitations) {\n                return new UrlElicitationRequiredError(errorData.elicitations, message);\n            }\n        }\n        // Default to generic McpError\n        return new McpError(code, message, data);\n    }\n}\n/**\n * Specialized error type when a tool requires a URL mode elicitation.\n * This makes it nicer for the client to handle since there is specific data to work with instead of just a code to check against.\n */\nexport class UrlElicitationRequiredError extends McpError {\n    constructor(elicitations, message = `URL elicitation${elicitations.length > 1 ? 's' : ''} required`) {\n        super(ErrorCode.UrlElicitationRequired, message, {\n            elicitations: elicitations\n        });\n    }\n    get elicitations() {\n        var _a, _b;\n        return (_b = (_a = this.data) === null || _a === void 0 ? void 0 : _a.elicitations) !== null && _b !== void 0 ? _b : [];\n    }\n}\n//# sourceMappingURL=types.js.map","/**\n * Experimental task interfaces for MCP SDK.\n * WARNING: These APIs are experimental and may change without notice.\n */\n/**\n * Checks if a task status represents a terminal state.\n * Terminal states are those where the task has finished and will not change.\n *\n * @param status - The task status to check\n * @returns True if the status is terminal (completed, failed, or cancelled)\n * @experimental\n */\nexport function isTerminal(status) {\n    return status === 'completed' || status === 'failed' || status === 'cancelled';\n}\n//# sourceMappingURL=interfaces.js.map","import { setResponseValueAndErrors } from \"../errorMessages.js\";\nlet emojiRegex = undefined;\n/**\n * Generated from the regular expressions found here as of 2024-05-22:\n * https://github.com/colinhacks/zod/blob/master/src/types.ts.\n *\n * Expressions with /i flag have been changed accordingly.\n */\nexport const zodPatterns = {\n    /**\n     * `c` was changed to `[cC]` to replicate /i flag\n     */\n    cuid: /^[cC][^\\s-]{8,}$/,\n    cuid2: /^[0-9a-z]+$/,\n    ulid: /^[0-9A-HJKMNP-TV-Z]{26}$/,\n    /**\n     * `a-z` was added to replicate /i flag\n     */\n    email: /^(?!\\.)(?!.*\\.\\.)([a-zA-Z0-9_'+\\-\\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\\-]*\\.)+[a-zA-Z]{2,}$/,\n    /**\n     * Constructed a valid Unicode RegExp\n     *\n     * Lazily instantiate since this type of regex isn't supported\n     * in all envs (e.g. React Native).\n     *\n     * See:\n     * https://github.com/colinhacks/zod/issues/2433\n     * Fix in Zod:\n     * https://github.com/colinhacks/zod/commit/9340fd51e48576a75adc919bff65dbc4a5d4c99b\n     */\n    emoji: () => {\n        if (emojiRegex === undefined) {\n            emojiRegex = RegExp(\"^(\\\\p{Extended_Pictographic}|\\\\p{Emoji_Component})+$\", \"u\");\n        }\n        return emojiRegex;\n    },\n    /**\n     * Unused\n     */\n    uuid: /^[0-9a-fA-F]{8}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{12}$/,\n    /**\n     * Unused\n     */\n    ipv4: /^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,\n    ipv4Cidr: /^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\/(3[0-2]|[12]?[0-9])$/,\n    /**\n     * Unused\n     */\n    ipv6: /^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,\n    ipv6Cidr: /^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,\n    base64: /^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,\n    base64url: /^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,\n    nanoid: /^[a-zA-Z0-9_-]{21}$/,\n    jwt: /^[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]*$/,\n};\nexport function parseStringDef(def, refs) {\n    const res = {\n        type: \"string\",\n    };\n    if (def.checks) {\n        for (const check of def.checks) {\n            switch (check.kind) {\n                case \"min\":\n                    setResponseValueAndErrors(res, \"minLength\", typeof res.minLength === \"number\"\n                        ? Math.max(res.minLength, check.value)\n                        : check.value, check.message, refs);\n                    break;\n                case \"max\":\n                    setResponseValueAndErrors(res, \"maxLength\", typeof res.maxLength === \"number\"\n                        ? Math.min(res.maxLength, check.value)\n                        : check.value, check.message, refs);\n                    break;\n                case \"email\":\n                    switch (refs.emailStrategy) {\n                        case \"format:email\":\n                            addFormat(res, \"email\", check.message, refs);\n                            break;\n                        case \"format:idn-email\":\n                            addFormat(res, \"idn-email\", check.message, refs);\n                            break;\n                        case \"pattern:zod\":\n                            addPattern(res, zodPatterns.email, check.message, refs);\n                            break;\n                    }\n                    break;\n                case \"url\":\n                    addFormat(res, \"uri\", check.message, refs);\n                    break;\n                case \"uuid\":\n                    addFormat(res, \"uuid\", check.message, refs);\n                    break;\n                case \"regex\":\n                    addPattern(res, check.regex, check.message, refs);\n                    break;\n                case \"cuid\":\n                    addPattern(res, zodPatterns.cuid, check.message, refs);\n                    break;\n                case \"cuid2\":\n                    addPattern(res, zodPatterns.cuid2, check.message, refs);\n                    break;\n                case \"startsWith\":\n                    addPattern(res, RegExp(`^${escapeLiteralCheckValue(check.value, refs)}`), check.message, refs);\n                    break;\n                case \"endsWith\":\n                    addPattern(res, RegExp(`${escapeLiteralCheckValue(check.value, refs)}$`), check.message, refs);\n                    break;\n                case \"datetime\":\n                    addFormat(res, \"date-time\", check.message, refs);\n                    break;\n                case \"date\":\n                    addFormat(res, \"date\", check.message, refs);\n                    break;\n                case \"time\":\n                    addFormat(res, \"time\", check.message, refs);\n                    break;\n                case \"duration\":\n                    addFormat(res, \"duration\", check.message, refs);\n                    break;\n                case \"length\":\n                    setResponseValueAndErrors(res, \"minLength\", typeof res.minLength === \"number\"\n                        ? Math.max(res.minLength, check.value)\n                        : check.value, check.message, refs);\n                    setResponseValueAndErrors(res, \"maxLength\", typeof res.maxLength === \"number\"\n                        ? Math.min(res.maxLength, check.value)\n                        : check.value, check.message, refs);\n                    break;\n                case \"includes\": {\n                    addPattern(res, RegExp(escapeLiteralCheckValue(check.value, refs)), check.message, refs);\n                    break;\n                }\n                case \"ip\": {\n                    if (check.version !== \"v6\") {\n                        addFormat(res, \"ipv4\", check.message, refs);\n                    }\n                    if (check.version !== \"v4\") {\n                        addFormat(res, \"ipv6\", check.message, refs);\n                    }\n                    break;\n                }\n                case \"base64url\":\n                    addPattern(res, zodPatterns.base64url, check.message, refs);\n                    break;\n                case \"jwt\":\n                    addPattern(res, zodPatterns.jwt, check.message, refs);\n                    break;\n                case \"cidr\": {\n                    if (check.version !== \"v6\") {\n                        addPattern(res, zodPatterns.ipv4Cidr, check.message, refs);\n                    }\n                    if (check.version !== \"v4\") {\n                        addPattern(res, zodPatterns.ipv6Cidr, check.message, refs);\n                    }\n                    break;\n                }\n                case \"emoji\":\n                    addPattern(res, zodPatterns.emoji(), check.message, refs);\n                    break;\n                case \"ulid\": {\n                    addPattern(res, zodPatterns.ulid, check.message, refs);\n                    break;\n                }\n                case \"base64\": {\n                    switch (refs.base64Strategy) {\n                        case \"format:binary\": {\n                            addFormat(res, \"binary\", check.message, refs);\n                            break;\n                        }\n                        case \"contentEncoding:base64\": {\n                            setResponseValueAndErrors(res, \"contentEncoding\", \"base64\", check.message, refs);\n                            break;\n                        }\n                        case \"pattern:zod\": {\n                            addPattern(res, zodPatterns.base64, check.message, refs);\n                            break;\n                        }\n                    }\n                    break;\n                }\n                case \"nanoid\": {\n                    addPattern(res, zodPatterns.nanoid, check.message, refs);\n                }\n                case \"toLowerCase\":\n                case \"toUpperCase\":\n                case \"trim\":\n                    break;\n                default:\n                    ((_) => { })(check);\n            }\n        }\n    }\n    return res;\n}\nfunction escapeLiteralCheckValue(literal, refs) {\n    return refs.patternStrategy === \"escape\"\n        ? escapeNonAlphaNumeric(literal)\n        : literal;\n}\nconst ALPHA_NUMERIC = new Set(\"ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789\");\nfunction escapeNonAlphaNumeric(source) {\n    let result = \"\";\n    for (let i = 0; i < source.length; i++) {\n        if (!ALPHA_NUMERIC.has(source[i])) {\n            result += \"\\\\\";\n        }\n        result += source[i];\n    }\n    return result;\n}\n// Adds a \"format\" keyword to the schema. If a format exists, both formats will be joined in an allOf-node, along with subsequent ones.\nfunction addFormat(schema, value, message, refs) {\n    if (schema.format || schema.anyOf?.some((x) => x.format)) {\n        if (!schema.anyOf) {\n            schema.anyOf = [];\n        }\n        if (schema.format) {\n            schema.anyOf.push({\n                format: schema.format,\n                ...(schema.errorMessage &&\n                    refs.errorMessages && {\n                    errorMessage: { format: schema.errorMessage.format },\n                }),\n            });\n            delete schema.format;\n            if (schema.errorMessage) {\n                delete schema.errorMessage.format;\n                if (Object.keys(schema.errorMessage).length === 0) {\n                    delete schema.errorMessage;\n                }\n            }\n        }\n        schema.anyOf.push({\n            format: value,\n            ...(message &&\n                refs.errorMessages && { errorMessage: { format: message } }),\n        });\n    }\n    else {\n        setResponseValueAndErrors(schema, \"format\", value, message, refs);\n    }\n}\n// Adds a \"pattern\" keyword to the schema. If a pattern exists, both patterns will be joined in an allOf-node, along with subsequent ones.\nfunction addPattern(schema, regex, message, refs) {\n    if (schema.pattern || schema.allOf?.some((x) => x.pattern)) {\n        if (!schema.allOf) {\n            schema.allOf = [];\n        }\n        if (schema.pattern) {\n            schema.allOf.push({\n                pattern: schema.pattern,\n                ...(schema.errorMessage &&\n                    refs.errorMessages && {\n                    errorMessage: { pattern: schema.errorMessage.pattern },\n                }),\n            });\n            delete schema.pattern;\n            if (schema.errorMessage) {\n                delete schema.errorMessage.pattern;\n                if (Object.keys(schema.errorMessage).length === 0) {\n                    delete schema.errorMessage;\n                }\n            }\n        }\n        schema.allOf.push({\n            pattern: stringifyRegExpWithFlags(regex, refs),\n            ...(message &&\n                refs.errorMessages && { errorMessage: { pattern: message } }),\n        });\n    }\n    else {\n        setResponseValueAndErrors(schema, \"pattern\", stringifyRegExpWithFlags(regex, refs), message, refs);\n    }\n}\n// Mutate z.string.regex() in a best attempt to accommodate for regex flags when applyRegexFlags is true\nfunction stringifyRegExpWithFlags(regex, refs) {\n    if (!refs.applyRegexFlags || !regex.flags) {\n        return regex.source;\n    }\n    // Currently handled flags\n    const flags = {\n        i: regex.flags.includes(\"i\"),\n        m: regex.flags.includes(\"m\"),\n        s: regex.flags.includes(\"s\"), // `.` matches newlines\n    };\n    // The general principle here is to step through each character, one at a time, applying mutations as flags require. We keep track when the current character is escaped, and when it's inside a group /like [this]/ or (also) a range like /[a-z]/. The following is fairly brittle imperative code; edit at your peril!\n    const source = flags.i ? regex.source.toLowerCase() : regex.source;\n    let pattern = \"\";\n    let isEscaped = false;\n    let inCharGroup = false;\n    let inCharRange = false;\n    for (let i = 0; i < source.length; i++) {\n        if (isEscaped) {\n            pattern += source[i];\n            isEscaped = false;\n            continue;\n        }\n        if (flags.i) {\n            if (inCharGroup) {\n                if (source[i].match(/[a-z]/)) {\n                    if (inCharRange) {\n                        pattern += source[i];\n                        pattern += `${source[i - 2]}-${source[i]}`.toUpperCase();\n                        inCharRange = false;\n                    }\n                    else if (source[i + 1] === \"-\" && source[i + 2]?.match(/[a-z]/)) {\n                        pattern += source[i];\n                        inCharRange = true;\n                    }\n                    else {\n                        pattern += `${source[i]}${source[i].toUpperCase()}`;\n                    }\n                    continue;\n                }\n            }\n            else if (source[i].match(/[a-z]/)) {\n                pattern += `[${source[i]}${source[i].toUpperCase()}]`;\n                continue;\n            }\n        }\n        if (flags.m) {\n            if (source[i] === \"^\") {\n                pattern += `(^|(?<=[\\r\\n]))`;\n                continue;\n            }\n            else if (source[i] === \"$\") {\n                pattern += `($|(?=[\\r\\n]))`;\n                continue;\n            }\n        }\n        if (flags.s && source[i] === \".\") {\n            pattern += inCharGroup ? `${source[i]}\\r\\n` : `[${source[i]}\\r\\n]`;\n            continue;\n        }\n        pattern += source[i];\n        if (source[i] === \"\\\\\") {\n            isEscaped = true;\n        }\n        else if (inCharGroup && source[i] === \"]\") {\n            inCharGroup = false;\n        }\n        else if (!inCharGroup && source[i] === \"[\") {\n            inCharGroup = true;\n        }\n    }\n    try {\n        new RegExp(pattern);\n    }\n    catch {\n        console.warn(`Could not convert regex pattern at ${refs.currentPath.join(\"/\")} to a flag-independent form! Falling back to the flag-ignorant source`);\n        return regex.source;\n    }\n    return pattern;\n}\n","// zod-json-schema-compat.ts\n// ----------------------------------------------------\n// JSON Schema conversion for both Zod v3 and Zod v4 (Mini)\n// v3 uses your vendored converter; v4 uses Mini's toJSONSchema\n// ----------------------------------------------------\nimport * as z4mini from 'zod/v4-mini';\nimport { getObjectShape, safeParse, isZ4Schema, getLiteralValue } from './zod-compat.js';\nimport { zodToJsonSchema } from 'zod-to-json-schema';\nfunction mapMiniTarget(t) {\n    if (!t)\n        return 'draft-7';\n    if (t === 'jsonSchema7' || t === 'draft-7')\n        return 'draft-7';\n    if (t === 'jsonSchema2019-09' || t === 'draft-2020-12')\n        return 'draft-2020-12';\n    return 'draft-7'; // fallback\n}\nexport function toJsonSchemaCompat(schema, opts) {\n    var _a, _b, _c;\n    if (isZ4Schema(schema)) {\n        // v4 branch  use Mini's built-in toJSONSchema\n        return z4mini.toJSONSchema(schema, {\n            target: mapMiniTarget(opts === null || opts === void 0 ? void 0 : opts.target),\n            io: (_a = opts === null || opts === void 0 ? void 0 : opts.pipeStrategy) !== null && _a !== void 0 ? _a : 'input'\n        });\n    }\n    // v3 branch  use vendored converter\n    return zodToJsonSchema(schema, {\n        strictUnions: (_b = opts === null || opts === void 0 ? void 0 : opts.strictUnions) !== null && _b !== void 0 ? _b : true,\n        pipeStrategy: (_c = opts === null || opts === void 0 ? void 0 : opts.pipeStrategy) !== null && _c !== void 0 ? _c : 'input'\n    });\n}\nexport function getMethodLiteral(schema) {\n    const shape = getObjectShape(schema);\n    const methodSchema = shape === null || shape === void 0 ? void 0 : shape.method;\n    if (!methodSchema) {\n        throw new Error('Schema is missing a method literal');\n    }\n    const value = getLiteralValue(methodSchema);\n    if (typeof value !== 'string') {\n        throw new Error('Schema method literal must be a string');\n    }\n    return value;\n}\nexport function parseWithCompat(schema, data) {\n    const result = safeParse(schema, data);\n    if (!result.success) {\n        throw result.error;\n    }\n    return result.data;\n}\n//# sourceMappingURL=zod-json-schema-compat.js.map","import { safeParse } from '../server/zod-compat.js';\nimport { CancelledNotificationSchema, CreateTaskResultSchema, ErrorCode, GetTaskRequestSchema, GetTaskResultSchema, GetTaskPayloadRequestSchema, ListTasksRequestSchema, ListTasksResultSchema, CancelTaskRequestSchema, CancelTaskResultSchema, isJSONRPCError, isJSONRPCRequest, isJSONRPCResponse, isJSONRPCNotification, McpError, PingRequestSchema, ProgressNotificationSchema, RELATED_TASK_META_KEY, TaskStatusNotificationSchema } from '../types.js';\nimport { isTerminal } from '../experimental/tasks/interfaces.js';\nimport { getMethodLiteral, parseWithCompat } from '../server/zod-json-schema-compat.js';\n/**\n * The default request timeout, in miliseconds.\n */\nexport const DEFAULT_REQUEST_TIMEOUT_MSEC = 60000;\n/**\n * Implements MCP protocol framing on top of a pluggable transport, including\n * features like request/response linking, notifications, and progress.\n */\nexport class Protocol {\n    constructor(_options) {\n        this._options = _options;\n        this._requestMessageId = 0;\n        this._requestHandlers = new Map();\n        this._requestHandlerAbortControllers = new Map();\n        this._notificationHandlers = new Map();\n        this._responseHandlers = new Map();\n        this._progressHandlers = new Map();\n        this._timeoutInfo = new Map();\n        this._pendingDebouncedNotifications = new Set();\n        // Maps task IDs to progress tokens to keep handlers alive after CreateTaskResult\n        this._taskProgressTokens = new Map();\n        this._requestResolvers = new Map();\n        this.setNotificationHandler(CancelledNotificationSchema, notification => {\n            this._oncancel(notification);\n        });\n        this.setNotificationHandler(ProgressNotificationSchema, notification => {\n            this._onprogress(notification);\n        });\n        this.setRequestHandler(PingRequestSchema, \n        // Automatic pong by default.\n        _request => ({}));\n        // Install task handlers if TaskStore is provided\n        this._taskStore = _options === null || _options === void 0 ? void 0 : _options.taskStore;\n        this._taskMessageQueue = _options === null || _options === void 0 ? void 0 : _options.taskMessageQueue;\n        if (this._taskStore) {\n            this.setRequestHandler(GetTaskRequestSchema, async (request, extra) => {\n                const task = await this._taskStore.getTask(request.params.taskId, extra.sessionId);\n                if (!task) {\n                    throw new McpError(ErrorCode.InvalidParams, 'Failed to retrieve task: Task not found');\n                }\n                // Per spec: tasks/get responses SHALL NOT include related-task metadata\n                // as the taskId parameter is the source of truth\n                // @ts-expect-error SendResultT cannot contain GetTaskResult, but we include it in our derived types everywhere else\n                return {\n                    ...task\n                };\n            });\n            this.setRequestHandler(GetTaskPayloadRequestSchema, async (request, extra) => {\n                const handleTaskResult = async () => {\n                    var _a;\n                    const taskId = request.params.taskId;\n                    // Deliver queued messages\n                    if (this._taskMessageQueue) {\n                        let queuedMessage;\n                        while ((queuedMessage = await this._taskMessageQueue.dequeue(taskId, extra.sessionId))) {\n                            // Handle response and error messages by routing them to the appropriate resolver\n                            if (queuedMessage.type === 'response' || queuedMessage.type === 'error') {\n                                const message = queuedMessage.message;\n                                const requestId = message.id;\n                                // Lookup resolver in _requestResolvers map\n                                const resolver = this._requestResolvers.get(requestId);\n                                if (resolver) {\n                                    // Remove resolver from map after invocation\n                                    this._requestResolvers.delete(requestId);\n                                    // Invoke resolver with response or error\n                                    if (queuedMessage.type === 'response') {\n                                        resolver(message);\n                                    }\n                                    else {\n                                        // Convert JSONRPCError to McpError\n                                        const errorMessage = message;\n                                        const error = new McpError(errorMessage.error.code, errorMessage.error.message, errorMessage.error.data);\n                                        resolver(error);\n                                    }\n                                }\n                                else {\n                                    // Handle missing resolver gracefully with error logging\n                                    const messageType = queuedMessage.type === 'response' ? 'Response' : 'Error';\n                                    this._onerror(new Error(`${messageType} handler missing for request ${requestId}`));\n                                }\n                                // Continue to next message\n                                continue;\n                            }\n                            // Send the message on the response stream by passing the relatedRequestId\n                            // This tells the transport to write the message to the tasks/result response stream\n                            await ((_a = this._transport) === null || _a === void 0 ? void 0 : _a.send(queuedMessage.message, { relatedRequestId: extra.requestId }));\n                        }\n                    }\n                    // Now check task status\n                    const task = await this._taskStore.getTask(taskId, extra.sessionId);\n                    if (!task) {\n                        throw new McpError(ErrorCode.InvalidParams, `Task not found: ${taskId}`);\n                    }\n                    // Block if task is not terminal (we've already delivered all queued messages above)\n                    if (!isTerminal(task.status)) {\n                        // Wait for status change or new messages\n                        await this._waitForTaskUpdate(taskId, extra.signal);\n                        // After waking up, recursively call to deliver any new messages or result\n                        return await handleTaskResult();\n                    }\n                    // If task is terminal, return the result\n                    if (isTerminal(task.status)) {\n                        const result = await this._taskStore.getTaskResult(taskId, extra.sessionId);\n                        this._clearTaskQueue(taskId);\n                        return {\n                            ...result,\n                            _meta: {\n                                ...result._meta,\n                                [RELATED_TASK_META_KEY]: {\n                                    taskId: taskId\n                                }\n                            }\n                        };\n                    }\n                    return await handleTaskResult();\n                };\n                return await handleTaskResult();\n            });\n            this.setRequestHandler(ListTasksRequestSchema, async (request, extra) => {\n                var _a;\n                try {\n                    const { tasks, nextCursor } = await this._taskStore.listTasks((_a = request.params) === null || _a === void 0 ? void 0 : _a.cursor, extra.sessionId);\n                    // @ts-expect-error SendResultT cannot contain ListTasksResult, but we include it in our derived types everywhere else\n                    return {\n                        tasks,\n                        nextCursor,\n                        _meta: {}\n                    };\n                }\n                catch (error) {\n                    throw new McpError(ErrorCode.InvalidParams, `Failed to list tasks: ${error instanceof Error ? error.message : String(error)}`);\n                }\n            });\n            this.setRequestHandler(CancelTaskRequestSchema, async (request, extra) => {\n                try {\n                    // Get the current task to check if it's in a terminal state, in case the implementation is not atomic\n                    const task = await this._taskStore.getTask(request.params.taskId, extra.sessionId);\n                    if (!task) {\n                        throw new McpError(ErrorCode.InvalidParams, `Task not found: ${request.params.taskId}`);\n                    }\n                    // Reject cancellation of terminal tasks\n                    if (isTerminal(task.status)) {\n                        throw new McpError(ErrorCode.InvalidParams, `Cannot cancel task in terminal status: ${task.status}`);\n                    }\n                    await this._taskStore.updateTaskStatus(request.params.taskId, 'cancelled', 'Client cancelled task execution.', extra.sessionId);\n                    this._clearTaskQueue(request.params.taskId);\n                    const cancelledTask = await this._taskStore.getTask(request.params.taskId, extra.sessionId);\n                    if (!cancelledTask) {\n                        // Task was deleted during cancellation (e.g., cleanup happened)\n                        throw new McpError(ErrorCode.InvalidParams, `Task not found after cancellation: ${request.params.taskId}`);\n                    }\n                    return {\n                        _meta: {},\n                        ...cancelledTask\n                    };\n                }\n                catch (error) {\n                    // Re-throw McpError as-is\n                    if (error instanceof McpError) {\n                        throw error;\n                    }\n                    throw new McpError(ErrorCode.InvalidRequest, `Failed to cancel task: ${error instanceof Error ? error.message : String(error)}`);\n                }\n            });\n        }\n    }\n    async _oncancel(notification) {\n        // Handle request cancellation\n        const controller = this._requestHandlerAbortControllers.get(notification.params.requestId);\n        controller === null || controller === void 0 ? void 0 : controller.abort(notification.params.reason);\n    }\n    _setupTimeout(messageId, timeout, maxTotalTimeout, onTimeout, resetTimeoutOnProgress = false) {\n        this._timeoutInfo.set(messageId, {\n            timeoutId: setTimeout(onTimeout, timeout),\n            startTime: Date.now(),\n            timeout,\n            maxTotalTimeout,\n            resetTimeoutOnProgress,\n            onTimeout\n        });\n    }\n    _resetTimeout(messageId) {\n        const info = this._timeoutInfo.get(messageId);\n        if (!info)\n            return false;\n        const totalElapsed = Date.now() - info.startTime;\n        if (info.maxTotalTimeout && totalElapsed >= info.maxTotalTimeout) {\n            this._timeoutInfo.delete(messageId);\n            throw McpError.fromError(ErrorCode.RequestTimeout, 'Maximum total timeout exceeded', {\n                maxTotalTimeout: info.maxTotalTimeout,\n                totalElapsed\n            });\n        }\n        clearTimeout(info.timeoutId);\n        info.timeoutId = setTimeout(info.onTimeout, info.timeout);\n        return true;\n    }\n    _cleanupTimeout(messageId) {\n        const info = this._timeoutInfo.get(messageId);\n        if (info) {\n            clearTimeout(info.timeoutId);\n            this._timeoutInfo.delete(messageId);\n        }\n    }\n    /**\n     * Attaches to the given transport, starts it, and starts listening for messages.\n     *\n     * The Protocol object assumes ownership of the Transport, replacing any callbacks that have already been set, and expects that it is the only user of the Transport instance going forward.\n     */\n    async connect(transport) {\n        var _a, _b, _c;\n        this._transport = transport;\n        const _onclose = (_a = this.transport) === null || _a === void 0 ? void 0 : _a.onclose;\n        this._transport.onclose = () => {\n            _onclose === null || _onclose === void 0 ? void 0 : _onclose();\n            this._onclose();\n        };\n        const _onerror = (_b = this.transport) === null || _b === void 0 ? void 0 : _b.onerror;\n        this._transport.onerror = (error) => {\n            _onerror === null || _onerror === void 0 ? void 0 : _onerror(error);\n            this._onerror(error);\n        };\n        const _onmessage = (_c = this._transport) === null || _c === void 0 ? void 0 : _c.onmessage;\n        this._transport.onmessage = (message, extra) => {\n            _onmessage === null || _onmessage === void 0 ? void 0 : _onmessage(message, extra);\n            if (isJSONRPCResponse(message) || isJSONRPCError(message)) {\n                this._onresponse(message);\n            }\n            else if (isJSONRPCRequest(message)) {\n                this._onrequest(message, extra);\n            }\n            else if (isJSONRPCNotification(message)) {\n                this._onnotification(message);\n            }\n            else {\n                this._onerror(new Error(`Unknown message type: ${JSON.stringify(message)}`));\n            }\n        };\n        await this._transport.start();\n    }\n    _onclose() {\n        var _a;\n        const responseHandlers = this._responseHandlers;\n        this._responseHandlers = new Map();\n        this._progressHandlers.clear();\n        this._taskProgressTokens.clear();\n        this._pendingDebouncedNotifications.clear();\n        const error = McpError.fromError(ErrorCode.ConnectionClosed, 'Connection closed');\n        this._transport = undefined;\n        (_a = this.onclose) === null || _a === void 0 ? void 0 : _a.call(this);\n        for (const handler of responseHandlers.values()) {\n            handler(error);\n        }\n    }\n    _onerror(error) {\n        var _a;\n        (_a = this.onerror) === null || _a === void 0 ? void 0 : _a.call(this, error);\n    }\n    _onnotification(notification) {\n        var _a;\n        const handler = (_a = this._notificationHandlers.get(notification.method)) !== null && _a !== void 0 ? _a : this.fallbackNotificationHandler;\n        // Ignore notifications not being subscribed to.\n        if (handler === undefined) {\n            return;\n        }\n        // Starting with Promise.resolve() puts any synchronous errors into the monad as well.\n        Promise.resolve()\n            .then(() => handler(notification))\n            .catch(error => this._onerror(new Error(`Uncaught error in notification handler: ${error}`)));\n    }\n    _onrequest(request, extra) {\n        var _a, _b, _c, _d, _e, _f;\n        const handler = (_a = this._requestHandlers.get(request.method)) !== null && _a !== void 0 ? _a : this.fallbackRequestHandler;\n        // Capture the current transport at request time to ensure responses go to the correct client\n        const capturedTransport = this._transport;\n        // Extract taskId from request metadata if present (needed early for method not found case)\n        const relatedTaskId = (_d = (_c = (_b = request.params) === null || _b === void 0 ? void 0 : _b._meta) === null || _c === void 0 ? void 0 : _c[RELATED_TASK_META_KEY]) === null || _d === void 0 ? void 0 : _d.taskId;\n        if (handler === undefined) {\n            const errorResponse = {\n                jsonrpc: '2.0',\n                id: request.id,\n                error: {\n                    code: ErrorCode.MethodNotFound,\n                    message: 'Method not found'\n                }\n            };\n            // Queue or send the error response based on whether this is a task-related request\n            if (relatedTaskId && this._taskMessageQueue) {\n                this._enqueueTaskMessage(relatedTaskId, {\n                    type: 'error',\n                    message: errorResponse,\n                    timestamp: Date.now()\n                }, capturedTransport === null || capturedTransport === void 0 ? void 0 : capturedTransport.sessionId).catch(error => this._onerror(new Error(`Failed to enqueue error response: ${error}`)));\n            }\n            else {\n                capturedTransport === null || capturedTransport === void 0 ? void 0 : capturedTransport.send(errorResponse).catch(error => this._onerror(new Error(`Failed to send an error response: ${error}`)));\n            }\n            return;\n        }\n        const abortController = new AbortController();\n        this._requestHandlerAbortControllers.set(request.id, abortController);\n        const taskCreationParams = (_e = request.params) === null || _e === void 0 ? void 0 : _e.task;\n        const taskStore = this._taskStore ? this.requestTaskStore(request, capturedTransport === null || capturedTransport === void 0 ? void 0 : capturedTransport.sessionId) : undefined;\n        const fullExtra = {\n            signal: abortController.signal,\n            sessionId: capturedTransport === null || capturedTransport === void 0 ? void 0 : capturedTransport.sessionId,\n            _meta: (_f = request.params) === null || _f === void 0 ? void 0 : _f._meta,\n            sendNotification: async (notification) => {\n                // Include related-task metadata if this request is part of a task\n                const notificationOptions = { relatedRequestId: request.id };\n                if (relatedTaskId) {\n                    notificationOptions.relatedTask = { taskId: relatedTaskId };\n                }\n                await this.notification(notification, notificationOptions);\n            },\n            sendRequest: async (r, resultSchema, options) => {\n                var _a, _b;\n                // Include related-task metadata if this request is part of a task\n                const requestOptions = { ...options, relatedRequestId: request.id };\n                if (relatedTaskId && !requestOptions.relatedTask) {\n                    requestOptions.relatedTask = { taskId: relatedTaskId };\n                }\n                // Set task status to input_required when sending a request within a task context\n                // Use the taskId from options (explicit) or fall back to relatedTaskId (inherited)\n                const effectiveTaskId = (_b = (_a = requestOptions.relatedTask) === null || _a === void 0 ? void 0 : _a.taskId) !== null && _b !== void 0 ? _b : relatedTaskId;\n                if (effectiveTaskId && taskStore) {\n                    await taskStore.updateTaskStatus(effectiveTaskId, 'input_required');\n                }\n                return await this.request(r, resultSchema, requestOptions);\n            },\n            authInfo: extra === null || extra === void 0 ? void 0 : extra.authInfo,\n            requestId: request.id,\n            requestInfo: extra === null || extra === void 0 ? void 0 : extra.requestInfo,\n            taskId: relatedTaskId,\n            taskStore: taskStore,\n            taskRequestedTtl: taskCreationParams === null || taskCreationParams === void 0 ? void 0 : taskCreationParams.ttl,\n            closeSSEStream: extra === null || extra === void 0 ? void 0 : extra.closeSSEStream,\n            closeStandaloneSSEStream: extra === null || extra === void 0 ? void 0 : extra.closeStandaloneSSEStream\n        };\n        // Starting with Promise.resolve() puts any synchronous errors into the monad as well.\n        Promise.resolve()\n            .then(() => {\n            // If this request asked for task creation, check capability first\n            if (taskCreationParams) {\n                // Check if the request method supports task creation\n                this.assertTaskHandlerCapability(request.method);\n            }\n        })\n            .then(() => handler(request, fullExtra))\n            .then(async (result) => {\n            if (abortController.signal.aborted) {\n                // Request was cancelled\n                return;\n            }\n            const response = {\n                result,\n                jsonrpc: '2.0',\n                id: request.id\n            };\n            // Queue or send the response based on whether this is a task-related request\n            if (relatedTaskId && this._taskMessageQueue) {\n                await this._enqueueTaskMessage(relatedTaskId, {\n                    type: 'response',\n                    message: response,\n                    timestamp: Date.now()\n                }, capturedTransport === null || capturedTransport === void 0 ? void 0 : capturedTransport.sessionId);\n            }\n            else {\n                await (capturedTransport === null || capturedTransport === void 0 ? void 0 : capturedTransport.send(response));\n            }\n        }, async (error) => {\n            var _a;\n            if (abortController.signal.aborted) {\n                // Request was cancelled\n                return;\n            }\n            const errorResponse = {\n                jsonrpc: '2.0',\n                id: request.id,\n                error: {\n                    code: Number.isSafeInteger(error['code']) ? error['code'] : ErrorCode.InternalError,\n                    message: (_a = error.message) !== null && _a !== void 0 ? _a : 'Internal error',\n                    ...(error['data'] !== undefined && { data: error['data'] })\n                }\n            };\n            // Queue or send the error response based on whether this is a task-related request\n            if (relatedTaskId && this._taskMessageQueue) {\n                await this._enqueueTaskMessage(relatedTaskId, {\n                    type: 'error',\n                    message: errorResponse,\n                    timestamp: Date.now()\n                }, capturedTransport === null || capturedTransport === void 0 ? void 0 : capturedTransport.sessionId);\n            }\n            else {\n                await (capturedTransport === null || capturedTransport === void 0 ? void 0 : capturedTransport.send(errorResponse));\n            }\n        })\n            .catch(error => this._onerror(new Error(`Failed to send response: ${error}`)))\n            .finally(() => {\n            this._requestHandlerAbortControllers.delete(request.id);\n        });\n    }\n    _onprogress(notification) {\n        const { progressToken, ...params } = notification.params;\n        const messageId = Number(progressToken);\n        const handler = this._progressHandlers.get(messageId);\n        if (!handler) {\n            this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(notification)}`));\n            return;\n        }\n        const responseHandler = this._responseHandlers.get(messageId);\n        const timeoutInfo = this._timeoutInfo.get(messageId);\n        if (timeoutInfo && responseHandler && timeoutInfo.resetTimeoutOnProgress) {\n            try {\n                this._resetTimeout(messageId);\n            }\n            catch (error) {\n                // Clean up if maxTotalTimeout was exceeded\n                this._responseHandlers.delete(messageId);\n                this._progressHandlers.delete(messageId);\n                this._cleanupTimeout(messageId);\n                responseHandler(error);\n                return;\n            }\n        }\n        handler(params);\n    }\n    _onresponse(response) {\n        const messageId = Number(response.id);\n        // Check if this is a response to a queued request\n        const resolver = this._requestResolvers.get(messageId);\n        if (resolver) {\n            this._requestResolvers.delete(messageId);\n            if (isJSONRPCResponse(response)) {\n                resolver(response);\n            }\n            else {\n                const error = new McpError(response.error.code, response.error.message, response.error.data);\n                resolver(error);\n            }\n            return;\n        }\n        const handler = this._responseHandlers.get(messageId);\n        if (handler === undefined) {\n            this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(response)}`));\n            return;\n        }\n        this._responseHandlers.delete(messageId);\n        this._cleanupTimeout(messageId);\n        // Keep progress handler alive for CreateTaskResult responses\n        let isTaskResponse = false;\n        if (isJSONRPCResponse(response) && response.result && typeof response.result === 'object') {\n            const result = response.result;\n            if (result.task && typeof result.task === 'object') {\n                const task = result.task;\n                if (typeof task.taskId === 'string') {\n                    isTaskResponse = true;\n                    this._taskProgressTokens.set(task.taskId, messageId);\n                }\n            }\n        }\n        if (!isTaskResponse) {\n            this._progressHandlers.delete(messageId);\n        }\n        if (isJSONRPCResponse(response)) {\n            handler(response);\n        }\n        else {\n            const error = McpError.fromError(response.error.code, response.error.message, response.error.data);\n            handler(error);\n        }\n    }\n    get transport() {\n        return this._transport;\n    }\n    /**\n     * Closes the connection.\n     */\n    async close() {\n        var _a;\n        await ((_a = this._transport) === null || _a === void 0 ? void 0 : _a.close());\n    }\n    /**\n     * Sends a request and returns an AsyncGenerator that yields response messages.\n     * The generator is guaranteed to end with either a 'result' or 'error' message.\n     *\n     * @example\n     * ```typescript\n     * const stream = protocol.requestStream(request, resultSchema, options);\n     * for await (const message of stream) {\n     *   switch (message.type) {\n     *     case 'taskCreated':\n     *       console.log('Task created:', message.task.taskId);\n     *       break;\n     *     case 'taskStatus':\n     *       console.log('Task status:', message.task.status);\n     *       break;\n     *     case 'result':\n     *       console.log('Final result:', message.result);\n     *       break;\n     *     case 'error':\n     *       console.error('Error:', message.error);\n     *       break;\n     *   }\n     * }\n     * ```\n     *\n     * @experimental Use `client.experimental.tasks.requestStream()` to access this method.\n     */\n    async *requestStream(request, resultSchema, options) {\n        var _a, _b, _c, _d;\n        const { task } = options !== null && options !== void 0 ? options : {};\n        // For non-task requests, just yield the result\n        if (!task) {\n            try {\n                const result = await this.request(request, resultSchema, options);\n                yield { type: 'result', result };\n            }\n            catch (error) {\n                yield {\n                    type: 'error',\n                    error: error instanceof McpError ? error : new McpError(ErrorCode.InternalError, String(error))\n                };\n            }\n            return;\n        }\n        // For task-augmented requests, we need to poll for status\n        // First, make the request to create the task\n        let taskId;\n        try {\n            // Send the request and get the CreateTaskResult\n            const createResult = await this.request(request, CreateTaskResultSchema, options);\n            // Extract taskId from the result\n            if (createResult.task) {\n                taskId = createResult.task.taskId;\n                yield { type: 'taskCreated', task: createResult.task };\n            }\n            else {\n                throw new McpError(ErrorCode.InternalError, 'Task creation did not return a task');\n            }\n            // Poll for task completion\n            while (true) {\n                // Get current task status\n                const task = await this.getTask({ taskId }, options);\n                yield { type: 'taskStatus', task };\n                // Check if task is terminal\n                if (isTerminal(task.status)) {\n                    if (task.status === 'completed') {\n                        // Get the final result\n                        const result = await this.getTaskResult({ taskId }, resultSchema, options);\n                        yield { type: 'result', result };\n                    }\n                    else if (task.status === 'failed') {\n                        yield {\n                            type: 'error',\n                            error: new McpError(ErrorCode.InternalError, `Task ${taskId} failed`)\n                        };\n                    }\n                    else if (task.status === 'cancelled') {\n                        yield {\n                            type: 'error',\n                            error: new McpError(ErrorCode.InternalError, `Task ${taskId} was cancelled`)\n                        };\n                    }\n                    return;\n                }\n                // When input_required, call tasks/result to deliver queued messages\n                // (elicitation, sampling) via SSE and block until terminal\n                if (task.status === 'input_required') {\n                    const result = await this.getTaskResult({ taskId }, resultSchema, options);\n                    yield { type: 'result', result };\n                    return;\n                }\n                // Wait before polling again\n                const pollInterval = (_c = (_a = task.pollInterval) !== null && _a !== void 0 ? _a : (_b = this._options) === null || _b === void 0 ? void 0 : _b.defaultTaskPollInterval) !== null && _c !== void 0 ? _c : 1000;\n                await new Promise(resolve => setTimeout(resolve, pollInterval));\n                // Check if cancelled\n                (_d = options === null || options === void 0 ? void 0 : options.signal) === null || _d === void 0 ? void 0 : _d.throwIfAborted();\n            }\n        }\n        catch (error) {\n            yield {\n                type: 'error',\n                error: error instanceof McpError ? error : new McpError(ErrorCode.InternalError, String(error))\n            };\n        }\n    }\n    /**\n     * Sends a request and waits for a response.\n     *\n     * Do not use this method to emit notifications! Use notification() instead.\n     */\n    request(request, resultSchema, options) {\n        const { relatedRequestId, resumptionToken, onresumptiontoken, task, relatedTask } = options !== null && options !== void 0 ? options : {};\n        // Send the request\n        return new Promise((resolve, reject) => {\n            var _a, _b, _c, _d, _e, _f, _g;\n            const earlyReject = (error) => {\n                reject(error);\n            };\n            if (!this._transport) {\n                earlyReject(new Error('Not connected'));\n                return;\n            }\n            if (((_a = this._options) === null || _a === void 0 ? void 0 : _a.enforceStrictCapabilities) === true) {\n                try {\n                    this.assertCapabilityForMethod(request.method);\n                    // If task creation is requested, also check task capabilities\n                    if (task) {\n                        this.assertTaskCapability(request.method);\n                    }\n                }\n                catch (e) {\n                    earlyReject(e);\n                    return;\n                }\n            }\n            (_b = options === null || options === void 0 ? void 0 : options.signal) === null || _b === void 0 ? void 0 : _b.throwIfAborted();\n            const messageId = this._requestMessageId++;\n            const jsonrpcRequest = {\n                ...request,\n                jsonrpc: '2.0',\n                id: messageId\n            };\n            if (options === null || options === void 0 ? void 0 : options.onprogress) {\n                this._progressHandlers.set(messageId, options.onprogress);\n                jsonrpcRequest.params = {\n                    ...request.params,\n                    _meta: {\n                        ...(((_c = request.params) === null || _c === void 0 ? void 0 : _c._meta) || {}),\n                        progressToken: messageId\n                    }\n                };\n            }\n            // Augment with task creation parameters if provided\n            if (task) {\n                jsonrpcRequest.params = {\n                    ...jsonrpcRequest.params,\n                    task: task\n                };\n            }\n            // Augment with related task metadata if relatedTask is provided\n            if (relatedTask) {\n                jsonrpcRequest.params = {\n                    ...jsonrpcRequest.params,\n                    _meta: {\n                        ...(((_d = jsonrpcRequest.params) === null || _d === void 0 ? void 0 : _d._meta) || {}),\n                        [RELATED_TASK_META_KEY]: relatedTask\n                    }\n                };\n            }\n            const cancel = (reason) => {\n                var _a;\n                this._responseHandlers.delete(messageId);\n                this._progressHandlers.delete(messageId);\n                this._cleanupTimeout(messageId);\n                (_a = this._transport) === null || _a === void 0 ? void 0 : _a.send({\n                    jsonrpc: '2.0',\n                    method: 'notifications/cancelled',\n                    params: {\n                        requestId: messageId,\n                        reason: String(reason)\n                    }\n                }, { relatedRequestId, resumptionToken, onresumptiontoken }).catch(error => this._onerror(new Error(`Failed to send cancellation: ${error}`)));\n                // Wrap the reason in an McpError if it isn't already\n                const error = reason instanceof McpError ? reason : new McpError(ErrorCode.RequestTimeout, String(reason));\n                reject(error);\n            };\n            this._responseHandlers.set(messageId, response => {\n                var _a;\n                if ((_a = options === null || options === void 0 ? void 0 : options.signal) === null || _a === void 0 ? void 0 : _a.aborted) {\n                    return;\n                }\n                if (response instanceof Error) {\n                    return reject(response);\n                }\n                try {\n                    const parseResult = safeParse(resultSchema, response.result);\n                    if (!parseResult.success) {\n                        // Type guard: if success is false, error is guaranteed to exist\n                        reject(parseResult.error);\n                    }\n                    else {\n                        resolve(parseResult.data);\n                    }\n                }\n                catch (error) {\n                    reject(error);\n                }\n            });\n            (_e = options === null || options === void 0 ? void 0 : options.signal) === null || _e === void 0 ? void 0 : _e.addEventListener('abort', () => {\n                var _a;\n                cancel((_a = options === null || options === void 0 ? void 0 : options.signal) === null || _a === void 0 ? void 0 : _a.reason);\n            });\n            const timeout = (_f = options === null || options === void 0 ? void 0 : options.timeout) !== null && _f !== void 0 ? _f : DEFAULT_REQUEST_TIMEOUT_MSEC;\n            const timeoutHandler = () => cancel(McpError.fromError(ErrorCode.RequestTimeout, 'Request timed out', { timeout }));\n            this._setupTimeout(messageId, timeout, options === null || options === void 0 ? void 0 : options.maxTotalTimeout, timeoutHandler, (_g = options === null || options === void 0 ? void 0 : options.resetTimeoutOnProgress) !== null && _g !== void 0 ? _g : false);\n            // Queue request if related to a task\n            const relatedTaskId = relatedTask === null || relatedTask === void 0 ? void 0 : relatedTask.taskId;\n            if (relatedTaskId) {\n                // Store the response resolver for this request so responses can be routed back\n                const responseResolver = (response) => {\n                    const handler = this._responseHandlers.get(messageId);\n                    if (handler) {\n                        handler(response);\n                    }\n                    else {\n                        // Log error when resolver is missing, but don't fail\n                        this._onerror(new Error(`Response handler missing for side-channeled request ${messageId}`));\n                    }\n                };\n                this._requestResolvers.set(messageId, responseResolver);\n                this._enqueueTaskMessage(relatedTaskId, {\n                    type: 'request',\n                    message: jsonrpcRequest,\n                    timestamp: Date.now()\n                }).catch(error => {\n                    this._cleanupTimeout(messageId);\n                    reject(error);\n                });\n                // Don't send through transport - queued messages are delivered via tasks/result only\n                // This prevents duplicate delivery for bidirectional transports\n            }\n            else {\n                // No related task - send through transport normally\n                this._transport.send(jsonrpcRequest, { relatedRequestId, resumptionToken, onresumptiontoken }).catch(error => {\n                    this._cleanupTimeout(messageId);\n                    reject(error);\n                });\n            }\n        });\n    }\n    /**\n     * Gets the current status of a task.\n     *\n     * @experimental Use `client.experimental.tasks.getTask()` to access this method.\n     */\n    async getTask(params, options) {\n        // @ts-expect-error SendRequestT cannot directly contain GetTaskRequest, but we ensure all type instantiations contain it anyways\n        return this.request({ method: 'tasks/get', params }, GetTaskResultSchema, options);\n    }\n    /**\n     * Retrieves the result of a completed task.\n     *\n     * @experimental Use `client.experimental.tasks.getTaskResult()` to access this method.\n     */\n    async getTaskResult(params, resultSchema, options) {\n        // @ts-expect-error SendRequestT cannot directly contain GetTaskPayloadRequest, but we ensure all type instantiations contain it anyways\n        return this.request({ method: 'tasks/result', params }, resultSchema, options);\n    }\n    /**\n     * Lists tasks, optionally starting from a pagination cursor.\n     *\n     * @experimental Use `client.experimental.tasks.listTasks()` to access this method.\n     */\n    async listTasks(params, options) {\n        // @ts-expect-error SendRequestT cannot directly contain ListTasksRequest, but we ensure all type instantiations contain it anyways\n        return this.request({ method: 'tasks/list', params }, ListTasksResultSchema, options);\n    }\n    /**\n     * Cancels a specific task.\n     *\n     * @experimental Use `client.experimental.tasks.cancelTask()` to access this method.\n     */\n    async cancelTask(params, options) {\n        // @ts-expect-error SendRequestT cannot directly contain CancelTaskRequest, but we ensure all type instantiations contain it anyways\n        return this.request({ method: 'tasks/cancel', params }, CancelTaskResultSchema, options);\n    }\n    /**\n     * Emits a notification, which is a one-way message that does not expect a response.\n     */\n    async notification(notification, options) {\n        var _a, _b, _c, _d, _e;\n        if (!this._transport) {\n            throw new Error('Not connected');\n        }\n        this.assertNotificationCapability(notification.method);\n        // Queue notification if related to a task\n        const relatedTaskId = (_a = options === null || options === void 0 ? void 0 : options.relatedTask) === null || _a === void 0 ? void 0 : _a.taskId;\n        if (relatedTaskId) {\n            // Build the JSONRPC notification with metadata\n            const jsonrpcNotification = {\n                ...notification,\n                jsonrpc: '2.0',\n                params: {\n                    ...notification.params,\n                    _meta: {\n                        ...(((_b = notification.params) === null || _b === void 0 ? void 0 : _b._meta) || {}),\n                        [RELATED_TASK_META_KEY]: options.relatedTask\n                    }\n                }\n            };\n            await this._enqueueTaskMessage(relatedTaskId, {\n                type: 'notification',\n                message: jsonrpcNotification,\n                timestamp: Date.now()\n            });\n            // Don't send through transport - queued messages are delivered via tasks/result only\n            // This prevents duplicate delivery for bidirectional transports\n            return;\n        }\n        const debouncedMethods = (_d = (_c = this._options) === null || _c === void 0 ? void 0 : _c.debouncedNotificationMethods) !== null && _d !== void 0 ? _d : [];\n        // A notification can only be debounced if it's in the list AND it's \"simple\"\n        // (i.e., has no parameters and no related request ID or related task that could be lost).\n        const canDebounce = debouncedMethods.includes(notification.method) && !notification.params && !(options === null || options === void 0 ? void 0 : options.relatedRequestId) && !(options === null || options === void 0 ? void 0 : options.relatedTask);\n        if (canDebounce) {\n            // If a notification of this type is already scheduled, do nothing.\n            if (this._pendingDebouncedNotifications.has(notification.method)) {\n                return;\n            }\n            // Mark this notification type as pending.\n            this._pendingDebouncedNotifications.add(notification.method);\n            // Schedule the actual send to happen in the next microtask.\n            // This allows all synchronous calls in the current event loop tick to be coalesced.\n            Promise.resolve().then(() => {\n                var _a, _b;\n                // Un-mark the notification so the next one can be scheduled.\n                this._pendingDebouncedNotifications.delete(notification.method);\n                // SAFETY CHECK: If the connection was closed while this was pending, abort.\n                if (!this._transport) {\n                    return;\n                }\n                let jsonrpcNotification = {\n                    ...notification,\n                    jsonrpc: '2.0'\n                };\n                // Augment with related task metadata if relatedTask is provided\n                if (options === null || options === void 0 ? void 0 : options.relatedTask) {\n                    jsonrpcNotification = {\n                        ...jsonrpcNotification,\n                        params: {\n                            ...jsonrpcNotification.params,\n                            _meta: {\n                                ...(((_a = jsonrpcNotification.params) === null || _a === void 0 ? void 0 : _a._meta) || {}),\n                                [RELATED_TASK_META_KEY]: options.relatedTask\n                            }\n                        }\n                    };\n                }\n                // Send the notification, but don't await it here to avoid blocking.\n                // Handle potential errors with a .catch().\n                (_b = this._transport) === null || _b === void 0 ? void 0 : _b.send(jsonrpcNotification, options).catch(error => this._onerror(error));\n            });\n            // Return immediately.\n            return;\n        }\n        let jsonrpcNotification = {\n            ...notification,\n            jsonrpc: '2.0'\n        };\n        // Augment with related task metadata if relatedTask is provided\n        if (options === null || options === void 0 ? void 0 : options.relatedTask) {\n            jsonrpcNotification = {\n                ...jsonrpcNotification,\n                params: {\n                    ...jsonrpcNotification.params,\n                    _meta: {\n                        ...(((_e = jsonrpcNotification.params) === null || _e === void 0 ? void 0 : _e._meta) || {}),\n                        [RELATED_TASK_META_KEY]: options.relatedTask\n                    }\n                }\n            };\n        }\n        await this._transport.send(jsonrpcNotification, options);\n    }\n    /**\n     * Registers a handler to invoke when this protocol object receives a request with the given method.\n     *\n     * Note that this will replace any previous request handler for the same method.\n     */\n    setRequestHandler(requestSchema, handler) {\n        const method = getMethodLiteral(requestSchema);\n        this.assertRequestHandlerCapability(method);\n        this._requestHandlers.set(method, (request, extra) => {\n            const parsed = parseWithCompat(requestSchema, request);\n            return Promise.resolve(handler(parsed, extra));\n        });\n    }\n    /**\n     * Removes the request handler for the given method.\n     */\n    removeRequestHandler(method) {\n        this._requestHandlers.delete(method);\n    }\n    /**\n     * Asserts that a request handler has not already been set for the given method, in preparation for a new one being automatically installed.\n     */\n    assertCanSetRequestHandler(method) {\n        if (this._requestHandlers.has(method)) {\n            throw new Error(`A request handler for ${method} already exists, which would be overridden`);\n        }\n    }\n    /**\n     * Registers a handler to invoke when this protocol object receives a notification with the given method.\n     *\n     * Note that this will replace any previous notification handler for the same method.\n     */\n    setNotificationHandler(notificationSchema, handler) {\n        const method = getMethodLiteral(notificationSchema);\n        this._notificationHandlers.set(method, notification => {\n            const parsed = parseWithCompat(notificationSchema, notification);\n            return Promise.resolve(handler(parsed));\n        });\n    }\n    /**\n     * Removes the notification handler for the given method.\n     */\n    removeNotificationHandler(method) {\n        this._notificationHandlers.delete(method);\n    }\n    /**\n     * Cleans up the progress handler associated with a task.\n     * This should be called when a task reaches a terminal status.\n     */\n    _cleanupTaskProgressHandler(taskId) {\n        const progressToken = this._taskProgressTokens.get(taskId);\n        if (progressToken !== undefined) {\n            this._progressHandlers.delete(progressToken);\n            this._taskProgressTokens.delete(taskId);\n        }\n    }\n    /**\n     * Enqueues a task-related message for side-channel delivery via tasks/result.\n     * @param taskId The task ID to associate the message with\n     * @param message The message to enqueue\n     * @param sessionId Optional session ID for binding the operation to a specific session\n     * @throws Error if taskStore is not configured or if enqueue fails (e.g., queue overflow)\n     *\n     * Note: If enqueue fails, it's the TaskMessageQueue implementation's responsibility to handle\n     * the error appropriately (e.g., by failing the task, logging, etc.). The Protocol layer\n     * simply propagates the error.\n     */\n    async _enqueueTaskMessage(taskId, message, sessionId) {\n        var _a;\n        // Task message queues are only used when taskStore is configured\n        if (!this._taskStore || !this._taskMessageQueue) {\n            throw new Error('Cannot enqueue task message: taskStore and taskMessageQueue are not configured');\n        }\n        const maxQueueSize = (_a = this._options) === null || _a === void 0 ? void 0 : _a.maxTaskQueueSize;\n        await this._taskMessageQueue.enqueue(taskId, message, sessionId, maxQueueSize);\n    }\n    /**\n     * Clears the message queue for a task and rejects any pending request resolvers.\n     * @param taskId The task ID whose queue should be cleared\n     * @param sessionId Optional session ID for binding the operation to a specific session\n     */\n    async _clearTaskQueue(taskId, sessionId) {\n        if (this._taskMessageQueue) {\n            // Reject any pending request resolvers\n            const messages = await this._taskMessageQueue.dequeueAll(taskId, sessionId);\n            for (const message of messages) {\n                if (message.type === 'request' && isJSONRPCRequest(message.message)) {\n                    // Extract request ID from the message\n                    const requestId = message.message.id;\n                    const resolver = this._requestResolvers.get(requestId);\n                    if (resolver) {\n                        resolver(new McpError(ErrorCode.InternalError, 'Task cancelled or completed'));\n                        this._requestResolvers.delete(requestId);\n                    }\n                    else {\n                        // Log error when resolver is missing during cleanup for better observability\n                        this._onerror(new Error(`Resolver missing for request ${requestId} during task ${taskId} cleanup`));\n                    }\n                }\n            }\n        }\n    }\n    /**\n     * Waits for a task update (new messages or status change) with abort signal support.\n     * Uses polling to check for updates at the task's configured poll interval.\n     * @param taskId The task ID to wait for\n     * @param signal Abort signal to cancel the wait\n     * @returns Promise that resolves when an update occurs or rejects if aborted\n     */\n    async _waitForTaskUpdate(taskId, signal) {\n        var _a, _b, _c;\n        // Get the task's poll interval, falling back to default\n        let interval = (_b = (_a = this._options) === null || _a === void 0 ? void 0 : _a.defaultTaskPollInterval) !== null && _b !== void 0 ? _b : 1000;\n        try {\n            const task = await ((_c = this._taskStore) === null || _c === void 0 ? void 0 : _c.getTask(taskId));\n            if (task === null || task === void 0 ? void 0 : task.pollInterval) {\n                interval = task.pollInterval;\n            }\n        }\n        catch (_d) {\n            // Use default interval if task lookup fails\n        }\n        return new Promise((resolve, reject) => {\n            if (signal.aborted) {\n                reject(new McpError(ErrorCode.InvalidRequest, 'Request cancelled'));\n                return;\n            }\n            // Wait for the poll interval, then resolve so caller can check for updates\n            const timeoutId = setTimeout(resolve, interval);\n            // Clean up timeout and reject if aborted\n            signal.addEventListener('abort', () => {\n                clearTimeout(timeoutId);\n                reject(new McpError(ErrorCode.InvalidRequest, 'Request cancelled'));\n            }, { once: true });\n        });\n    }\n    requestTaskStore(request, sessionId) {\n        const taskStore = this._taskStore;\n        if (!taskStore) {\n            throw new Error('No task store configured');\n        }\n        return {\n            createTask: async (taskParams) => {\n                if (!request) {\n                    throw new Error('No request provided');\n                }\n                return await taskStore.createTask(taskParams, request.id, {\n                    method: request.method,\n                    params: request.params\n                }, sessionId);\n            },\n            getTask: async (taskId) => {\n                const task = await taskStore.getTask(taskId, sessionId);\n                if (!task) {\n                    throw new McpError(ErrorCode.InvalidParams, 'Failed to retrieve task: Task not found');\n                }\n                return task;\n            },\n            storeTaskResult: async (taskId, status, result) => {\n                await taskStore.storeTaskResult(taskId, status, result, sessionId);\n                // Get updated task state and send notification\n                const task = await taskStore.getTask(taskId, sessionId);\n                if (task) {\n                    const notification = TaskStatusNotificationSchema.parse({\n                        method: 'notifications/tasks/status',\n                        params: task\n                    });\n                    await this.notification(notification);\n                    if (isTerminal(task.status)) {\n                        this._cleanupTaskProgressHandler(taskId);\n                        // Don't clear queue here - it will be cleared after delivery via tasks/result\n                    }\n                }\n            },\n            getTaskResult: taskId => {\n                return taskStore.getTaskResult(taskId, sessionId);\n            },\n            updateTaskStatus: async (taskId, status, statusMessage) => {\n                // Check if task exists\n                const task = await taskStore.getTask(taskId, sessionId);\n                if (!task) {\n                    throw new McpError(ErrorCode.InvalidParams, `Task \"${taskId}\" not found - it may have been cleaned up`);\n                }\n                // Don't allow transitions from terminal states\n                if (isTerminal(task.status)) {\n                    throw new McpError(ErrorCode.InvalidParams, `Cannot update task \"${taskId}\" from terminal status \"${task.status}\" to \"${status}\". Terminal states (completed, failed, cancelled) cannot transition to other states.`);\n                }\n                await taskStore.updateTaskStatus(taskId, status, statusMessage, sessionId);\n                // Get updated task state and send notification\n                const updatedTask = await taskStore.getTask(taskId, sessionId);\n                if (updatedTask) {\n                    const notification = TaskStatusNotificationSchema.parse({\n                        method: 'notifications/tasks/status',\n                        params: updatedTask\n                    });\n                    await this.notification(notification);\n                    if (isTerminal(updatedTask.status)) {\n                        this._cleanupTaskProgressHandler(taskId);\n                        // Don't clear queue here - it will be cleared after delivery via tasks/result\n                    }\n                }\n            },\n            listTasks: cursor => {\n                return taskStore.listTasks(cursor, sessionId);\n            }\n        };\n    }\n}\nfunction isPlainObject(value) {\n    return value !== null && typeof value === 'object' && !Array.isArray(value);\n}\nexport function mergeCapabilities(base, additional) {\n    const result = { ...base };\n    for (const key in additional) {\n        const k = key;\n        const addValue = additional[k];\n        if (addValue === undefined)\n            continue;\n        const baseValue = result[k];\n        if (isPlainObject(baseValue) && isPlainObject(addValue)) {\n            result[k] = { ...baseValue, ...addValue };\n        }\n        else {\n            result[k] = addValue;\n        }\n    }\n    return result;\n}\n//# sourceMappingURL=protocol.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.regexpCode = exports.getEsmExportName = exports.getProperty = exports.safeStringify = exports.stringify = exports.strConcat = exports.addCodeArg = exports.str = exports._ = exports.nil = exports._Code = exports.Name = exports.IDENTIFIER = exports._CodeOrName = void 0;\n// eslint-disable-next-line @typescript-eslint/no-extraneous-class\nclass _CodeOrName {\n}\nexports._CodeOrName = _CodeOrName;\nexports.IDENTIFIER = /^[a-z$_][a-z$_0-9]*$/i;\nclass Name extends _CodeOrName {\n    constructor(s) {\n        super();\n        if (!exports.IDENTIFIER.test(s))\n            throw new Error(\"CodeGen: name must be a valid identifier\");\n        this.str = s;\n    }\n    toString() {\n        return this.str;\n    }\n    emptyStr() {\n        return false;\n    }\n    get names() {\n        return { [this.str]: 1 };\n    }\n}\nexports.Name = Name;\nclass _Code extends _CodeOrName {\n    constructor(code) {\n        super();\n        this._items = typeof code === \"string\" ? [code] : code;\n    }\n    toString() {\n        return this.str;\n    }\n    emptyStr() {\n        if (this._items.length > 1)\n            return false;\n        const item = this._items[0];\n        return item === \"\" || item === '\"\"';\n    }\n    get str() {\n        var _a;\n        return ((_a = this._str) !== null && _a !== void 0 ? _a : (this._str = this._items.reduce((s, c) => `${s}${c}`, \"\")));\n    }\n    get names() {\n        var _a;\n        return ((_a = this._names) !== null && _a !== void 0 ? _a : (this._names = this._items.reduce((names, c) => {\n            if (c instanceof Name)\n                names[c.str] = (names[c.str] || 0) + 1;\n            return names;\n        }, {})));\n    }\n}\nexports._Code = _Code;\nexports.nil = new _Code(\"\");\nfunction _(strs, ...args) {\n    const code = [strs[0]];\n    let i = 0;\n    while (i < args.length) {\n        addCodeArg(code, args[i]);\n        code.push(strs[++i]);\n    }\n    return new _Code(code);\n}\nexports._ = _;\nconst plus = new _Code(\"+\");\nfunction str(strs, ...args) {\n    const expr = [safeStringify(strs[0])];\n    let i = 0;\n    while (i < args.length) {\n        expr.push(plus);\n        addCodeArg(expr, args[i]);\n        expr.push(plus, safeStringify(strs[++i]));\n    }\n    optimize(expr);\n    return new _Code(expr);\n}\nexports.str = str;\nfunction addCodeArg(code, arg) {\n    if (arg instanceof _Code)\n        code.push(...arg._items);\n    else if (arg instanceof Name)\n        code.push(arg);\n    else\n        code.push(interpolate(arg));\n}\nexports.addCodeArg = addCodeArg;\nfunction optimize(expr) {\n    let i = 1;\n    while (i < expr.length - 1) {\n        if (expr[i] === plus) {\n            const res = mergeExprItems(expr[i - 1], expr[i + 1]);\n            if (res !== undefined) {\n                expr.splice(i - 1, 3, res);\n                continue;\n            }\n            expr[i++] = \"+\";\n        }\n        i++;\n    }\n}\nfunction mergeExprItems(a, b) {\n    if (b === '\"\"')\n        return a;\n    if (a === '\"\"')\n        return b;\n    if (typeof a == \"string\") {\n        if (b instanceof Name || a[a.length - 1] !== '\"')\n            return;\n        if (typeof b != \"string\")\n            return `${a.slice(0, -1)}${b}\"`;\n        if (b[0] === '\"')\n            return a.slice(0, -1) + b.slice(1);\n        return;\n    }\n    if (typeof b == \"string\" && b[0] === '\"' && !(a instanceof Name))\n        return `\"${a}${b.slice(1)}`;\n    return;\n}\nfunction strConcat(c1, c2) {\n    return c2.emptyStr() ? c1 : c1.emptyStr() ? c2 : str `${c1}${c2}`;\n}\nexports.strConcat = strConcat;\n// TODO do not allow arrays here\nfunction interpolate(x) {\n    return typeof x == \"number\" || typeof x == \"boolean\" || x === null\n        ? x\n        : safeStringify(Array.isArray(x) ? x.join(\",\") : x);\n}\nfunction stringify(x) {\n    return new _Code(safeStringify(x));\n}\nexports.stringify = stringify;\nfunction safeStringify(x) {\n    return JSON.stringify(x)\n        .replace(/\\u2028/g, \"\\\\u2028\")\n        .replace(/\\u2029/g, \"\\\\u2029\");\n}\nexports.safeStringify = safeStringify;\nfunction getProperty(key) {\n    return typeof key == \"string\" && exports.IDENTIFIER.test(key) ? new _Code(`.${key}`) : _ `[${key}]`;\n}\nexports.getProperty = getProperty;\n//Does best effort to format the name properly\nfunction getEsmExportName(key) {\n    if (typeof key == \"string\" && exports.IDENTIFIER.test(key)) {\n        return new _Code(`${key}`);\n    }\n    throw new Error(`CodeGen: invalid export name: ${key}, use explicit $id name mapping`);\n}\nexports.getEsmExportName = getEsmExportName;\nfunction regexpCode(rx) {\n    return new _Code(rx.toString());\n}\nexports.regexpCode = regexpCode;\n//# sourceMappingURL=code.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ValueScope = exports.ValueScopeName = exports.Scope = exports.varKinds = exports.UsedValueState = void 0;\nconst code_1 = require(\"./code\");\nclass ValueError extends Error {\n    constructor(name) {\n        super(`CodeGen: \"code\" for ${name} not defined`);\n        this.value = name.value;\n    }\n}\nvar UsedValueState;\n(function (UsedValueState) {\n    UsedValueState[UsedValueState[\"Started\"] = 0] = \"Started\";\n    UsedValueState[UsedValueState[\"Completed\"] = 1] = \"Completed\";\n})(UsedValueState || (exports.UsedValueState = UsedValueState = {}));\nexports.varKinds = {\n    const: new code_1.Name(\"const\"),\n    let: new code_1.Name(\"let\"),\n    var: new code_1.Name(\"var\"),\n};\nclass Scope {\n    constructor({ prefixes, parent } = {}) {\n        this._names = {};\n        this._prefixes = prefixes;\n        this._parent = parent;\n    }\n    toName(nameOrPrefix) {\n        return nameOrPrefix instanceof code_1.Name ? nameOrPrefix : this.name(nameOrPrefix);\n    }\n    name(prefix) {\n        return new code_1.Name(this._newName(prefix));\n    }\n    _newName(prefix) {\n        const ng = this._names[prefix] || this._nameGroup(prefix);\n        return `${prefix}${ng.index++}`;\n    }\n    _nameGroup(prefix) {\n        var _a, _b;\n        if (((_b = (_a = this._parent) === null || _a === void 0 ? void 0 : _a._prefixes) === null || _b === void 0 ? void 0 : _b.has(prefix)) || (this._prefixes && !this._prefixes.has(prefix))) {\n            throw new Error(`CodeGen: prefix \"${prefix}\" is not allowed in this scope`);\n        }\n        return (this._names[prefix] = { prefix, index: 0 });\n    }\n}\nexports.Scope = Scope;\nclass ValueScopeName extends code_1.Name {\n    constructor(prefix, nameStr) {\n        super(nameStr);\n        this.prefix = prefix;\n    }\n    setValue(value, { property, itemIndex }) {\n        this.value = value;\n        this.scopePath = (0, code_1._) `.${new code_1.Name(property)}[${itemIndex}]`;\n    }\n}\nexports.ValueScopeName = ValueScopeName;\nconst line = (0, code_1._) `\\n`;\nclass ValueScope extends Scope {\n    constructor(opts) {\n        super(opts);\n        this._values = {};\n        this._scope = opts.scope;\n        this.opts = { ...opts, _n: opts.lines ? line : code_1.nil };\n    }\n    get() {\n        return this._scope;\n    }\n    name(prefix) {\n        return new ValueScopeName(prefix, this._newName(prefix));\n    }\n    value(nameOrPrefix, value) {\n        var _a;\n        if (value.ref === undefined)\n            throw new Error(\"CodeGen: ref must be passed in value\");\n        const name = this.toName(nameOrPrefix);\n        const { prefix } = name;\n        const valueKey = (_a = value.key) !== null && _a !== void 0 ? _a : value.ref;\n        let vs = this._values[prefix];\n        if (vs) {\n            const _name = vs.get(valueKey);\n            if (_name)\n                return _name;\n        }\n        else {\n            vs = this._values[prefix] = new Map();\n        }\n        vs.set(valueKey, name);\n        const s = this._scope[prefix] || (this._scope[prefix] = []);\n        const itemIndex = s.length;\n        s[itemIndex] = value.ref;\n        name.setValue(value, { property: prefix, itemIndex });\n        return name;\n    }\n    getValue(prefix, keyOrRef) {\n        const vs = this._values[prefix];\n        if (!vs)\n            return;\n        return vs.get(keyOrRef);\n    }\n    scopeRefs(scopeName, values = this._values) {\n        return this._reduceValues(values, (name) => {\n            if (name.scopePath === undefined)\n                throw new Error(`CodeGen: name \"${name}\" has no value`);\n            return (0, code_1._) `${scopeName}${name.scopePath}`;\n        });\n    }\n    scopeCode(values = this._values, usedValues, getCode) {\n        return this._reduceValues(values, (name) => {\n            if (name.value === undefined)\n                throw new Error(`CodeGen: name \"${name}\" has no value`);\n            return name.value.code;\n        }, usedValues, getCode);\n    }\n    _reduceValues(values, valueCode, usedValues = {}, getCode) {\n        let code = code_1.nil;\n        for (const prefix in values) {\n            const vs = values[prefix];\n            if (!vs)\n                continue;\n            const nameSet = (usedValues[prefix] = usedValues[prefix] || new Map());\n            vs.forEach((name) => {\n                if (nameSet.has(name))\n                    return;\n                nameSet.set(name, UsedValueState.Started);\n                let c = valueCode(name);\n                if (c) {\n                    const def = this.opts.es5 ? exports.varKinds.var : exports.varKinds.const;\n                    code = (0, code_1._) `${code}${def} ${name} = ${c};${this.opts._n}`;\n                }\n                else if ((c = getCode === null || getCode === void 0 ? void 0 : getCode(name))) {\n                    code = (0, code_1._) `${code}${c}${this.opts._n}`;\n                }\n                else {\n                    throw new ValueError(name);\n                }\n                nameSet.set(name, UsedValueState.Completed);\n            });\n        }\n        return code;\n    }\n}\nexports.ValueScope = ValueScope;\n//# sourceMappingURL=scope.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.or = exports.and = exports.not = exports.CodeGen = exports.operators = exports.varKinds = exports.ValueScopeName = exports.ValueScope = exports.Scope = exports.Name = exports.regexpCode = exports.stringify = exports.getProperty = exports.nil = exports.strConcat = exports.str = exports._ = void 0;\nconst code_1 = require(\"./code\");\nconst scope_1 = require(\"./scope\");\nvar code_2 = require(\"./code\");\nObject.defineProperty(exports, \"_\", { enumerable: true, get: function () { return code_2._; } });\nObject.defineProperty(exports, \"str\", { enumerable: true, get: function () { return code_2.str; } });\nObject.defineProperty(exports, \"strConcat\", { enumerable: true, get: function () { return code_2.strConcat; } });\nObject.defineProperty(exports, \"nil\", { enumerable: true, get: function () { return code_2.nil; } });\nObject.defineProperty(exports, \"getProperty\", { enumerable: true, get: function () { return code_2.getProperty; } });\nObject.defineProperty(exports, \"stringify\", { enumerable: true, get: function () { return code_2.stringify; } });\nObject.defineProperty(exports, \"regexpCode\", { enumerable: true, get: function () { return code_2.regexpCode; } });\nObject.defineProperty(exports, \"Name\", { enumerable: true, get: function () { return code_2.Name; } });\nvar scope_2 = require(\"./scope\");\nObject.defineProperty(exports, \"Scope\", { enumerable: true, get: function () { return scope_2.Scope; } });\nObject.defineProperty(exports, \"ValueScope\", { enumerable: true, get: function () { return scope_2.ValueScope; } });\nObject.defineProperty(exports, \"ValueScopeName\", { enumerable: true, get: function () { return scope_2.ValueScopeName; } });\nObject.defineProperty(exports, \"varKinds\", { enumerable: true, get: function () { return scope_2.varKinds; } });\nexports.operators = {\n    GT: new code_1._Code(\">\"),\n    GTE: new code_1._Code(\">=\"),\n    LT: new code_1._Code(\"<\"),\n    LTE: new code_1._Code(\"<=\"),\n    EQ: new code_1._Code(\"===\"),\n    NEQ: new code_1._Code(\"!==\"),\n    NOT: new code_1._Code(\"!\"),\n    OR: new code_1._Code(\"||\"),\n    AND: new code_1._Code(\"&&\"),\n    ADD: new code_1._Code(\"+\"),\n};\nclass Node {\n    optimizeNodes() {\n        return this;\n    }\n    optimizeNames(_names, _constants) {\n        return this;\n    }\n}\nclass Def extends Node {\n    constructor(varKind, name, rhs) {\n        super();\n        this.varKind = varKind;\n        this.name = name;\n        this.rhs = rhs;\n    }\n    render({ es5, _n }) {\n        const varKind = es5 ? scope_1.varKinds.var : this.varKind;\n        const rhs = this.rhs === undefined ? \"\" : ` = ${this.rhs}`;\n        return `${varKind} ${this.name}${rhs};` + _n;\n    }\n    optimizeNames(names, constants) {\n        if (!names[this.name.str])\n            return;\n        if (this.rhs)\n            this.rhs = optimizeExpr(this.rhs, names, constants);\n        return this;\n    }\n    get names() {\n        return this.rhs instanceof code_1._CodeOrName ? this.rhs.names : {};\n    }\n}\nclass Assign extends Node {\n    constructor(lhs, rhs, sideEffects) {\n        super();\n        this.lhs = lhs;\n        this.rhs = rhs;\n        this.sideEffects = sideEffects;\n    }\n    render({ _n }) {\n        return `${this.lhs} = ${this.rhs};` + _n;\n    }\n    optimizeNames(names, constants) {\n        if (this.lhs instanceof code_1.Name && !names[this.lhs.str] && !this.sideEffects)\n            return;\n        this.rhs = optimizeExpr(this.rhs, names, constants);\n        return this;\n    }\n    get names() {\n        const names = this.lhs instanceof code_1.Name ? {} : { ...this.lhs.names };\n        return addExprNames(names, this.rhs);\n    }\n}\nclass AssignOp extends Assign {\n    constructor(lhs, op, rhs, sideEffects) {\n        super(lhs, rhs, sideEffects);\n        this.op = op;\n    }\n    render({ _n }) {\n        return `${this.lhs} ${this.op}= ${this.rhs};` + _n;\n    }\n}\nclass Label extends Node {\n    constructor(label) {\n        super();\n        this.label = label;\n        this.names = {};\n    }\n    render({ _n }) {\n        return `${this.label}:` + _n;\n    }\n}\nclass Break extends Node {\n    constructor(label) {\n        super();\n        this.label = label;\n        this.names = {};\n    }\n    render({ _n }) {\n        const label = this.label ? ` ${this.label}` : \"\";\n        return `break${label};` + _n;\n    }\n}\nclass Throw extends Node {\n    constructor(error) {\n        super();\n        this.error = error;\n    }\n    render({ _n }) {\n        return `throw ${this.error};` + _n;\n    }\n    get names() {\n        return this.error.names;\n    }\n}\nclass AnyCode extends Node {\n    constructor(code) {\n        super();\n        this.code = code;\n    }\n    render({ _n }) {\n        return `${this.code};` + _n;\n    }\n    optimizeNodes() {\n        return `${this.code}` ? this : undefined;\n    }\n    optimizeNames(names, constants) {\n        this.code = optimizeExpr(this.code, names, constants);\n        return this;\n    }\n    get names() {\n        return this.code instanceof code_1._CodeOrName ? this.code.names : {};\n    }\n}\nclass ParentNode extends Node {\n    constructor(nodes = []) {\n        super();\n        this.nodes = nodes;\n    }\n    render(opts) {\n        return this.nodes.reduce((code, n) => code + n.render(opts), \"\");\n    }\n    optimizeNodes() {\n        const { nodes } = this;\n        let i = nodes.length;\n        while (i--) {\n            const n = nodes[i].optimizeNodes();\n            if (Array.isArray(n))\n                nodes.splice(i, 1, ...n);\n            else if (n)\n                nodes[i] = n;\n            else\n                nodes.splice(i, 1);\n        }\n        return nodes.length > 0 ? this : undefined;\n    }\n    optimizeNames(names, constants) {\n        const { nodes } = this;\n        let i = nodes.length;\n        while (i--) {\n            // iterating backwards improves 1-pass optimization\n            const n = nodes[i];\n            if (n.optimizeNames(names, constants))\n                continue;\n            subtractNames(names, n.names);\n            nodes.splice(i, 1);\n        }\n        return nodes.length > 0 ? this : undefined;\n    }\n    get names() {\n        return this.nodes.reduce((names, n) => addNames(names, n.names), {});\n    }\n}\nclass BlockNode extends ParentNode {\n    render(opts) {\n        return \"{\" + opts._n + super.render(opts) + \"}\" + opts._n;\n    }\n}\nclass Root extends ParentNode {\n}\nclass Else extends BlockNode {\n}\nElse.kind = \"else\";\nclass If extends BlockNode {\n    constructor(condition, nodes) {\n        super(nodes);\n        this.condition = condition;\n    }\n    render(opts) {\n        let code = `if(${this.condition})` + super.render(opts);\n        if (this.else)\n            code += \"else \" + this.else.render(opts);\n        return code;\n    }\n    optimizeNodes() {\n        super.optimizeNodes();\n        const cond = this.condition;\n        if (cond === true)\n            return this.nodes; // else is ignored here\n        let e = this.else;\n        if (e) {\n            const ns = e.optimizeNodes();\n            e = this.else = Array.isArray(ns) ? new Else(ns) : ns;\n        }\n        if (e) {\n            if (cond === false)\n                return e instanceof If ? e : e.nodes;\n            if (this.nodes.length)\n                return this;\n            return new If(not(cond), e instanceof If ? [e] : e.nodes);\n        }\n        if (cond === false || !this.nodes.length)\n            return undefined;\n        return this;\n    }\n    optimizeNames(names, constants) {\n        var _a;\n        this.else = (_a = this.else) === null || _a === void 0 ? void 0 : _a.optimizeNames(names, constants);\n        if (!(super.optimizeNames(names, constants) || this.else))\n            return;\n        this.condition = optimizeExpr(this.condition, names, constants);\n        return this;\n    }\n    get names() {\n        const names = super.names;\n        addExprNames(names, this.condition);\n        if (this.else)\n            addNames(names, this.else.names);\n        return names;\n    }\n}\nIf.kind = \"if\";\nclass For extends BlockNode {\n}\nFor.kind = \"for\";\nclass ForLoop extends For {\n    constructor(iteration) {\n        super();\n        this.iteration = iteration;\n    }\n    render(opts) {\n        return `for(${this.iteration})` + super.render(opts);\n    }\n    optimizeNames(names, constants) {\n        if (!super.optimizeNames(names, constants))\n            return;\n        this.iteration = optimizeExpr(this.iteration, names, constants);\n        return this;\n    }\n    get names() {\n        return addNames(super.names, this.iteration.names);\n    }\n}\nclass ForRange extends For {\n    constructor(varKind, name, from, to) {\n        super();\n        this.varKind = varKind;\n        this.name = name;\n        this.from = from;\n        this.to = to;\n    }\n    render(opts) {\n        const varKind = opts.es5 ? scope_1.varKinds.var : this.varKind;\n        const { name, from, to } = this;\n        return `for(${varKind} ${name}=${from}; ${name}<${to}; ${name}++)` + super.render(opts);\n    }\n    get names() {\n        const names = addExprNames(super.names, this.from);\n        return addExprNames(names, this.to);\n    }\n}\nclass ForIter extends For {\n    constructor(loop, varKind, name, iterable) {\n        super();\n        this.loop = loop;\n        this.varKind = varKind;\n        this.name = name;\n        this.iterable = iterable;\n    }\n    render(opts) {\n        return `for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})` + super.render(opts);\n    }\n    optimizeNames(names, constants) {\n        if (!super.optimizeNames(names, constants))\n            return;\n        this.iterable = optimizeExpr(this.iterable, names, constants);\n        return this;\n    }\n    get names() {\n        return addNames(super.names, this.iterable.names);\n    }\n}\nclass Func extends BlockNode {\n    constructor(name, args, async) {\n        super();\n        this.name = name;\n        this.args = args;\n        this.async = async;\n    }\n    render(opts) {\n        const _async = this.async ? \"async \" : \"\";\n        return `${_async}function ${this.name}(${this.args})` + super.render(opts);\n    }\n}\nFunc.kind = \"func\";\nclass Return extends ParentNode {\n    render(opts) {\n        return \"return \" + super.render(opts);\n    }\n}\nReturn.kind = \"return\";\nclass Try extends BlockNode {\n    render(opts) {\n        let code = \"try\" + super.render(opts);\n        if (this.catch)\n            code += this.catch.render(opts);\n        if (this.finally)\n            code += this.finally.render(opts);\n        return code;\n    }\n    optimizeNodes() {\n        var _a, _b;\n        super.optimizeNodes();\n        (_a = this.catch) === null || _a === void 0 ? void 0 : _a.optimizeNodes();\n        (_b = this.finally) === null || _b === void 0 ? void 0 : _b.optimizeNodes();\n        return this;\n    }\n    optimizeNames(names, constants) {\n        var _a, _b;\n        super.optimizeNames(names, constants);\n        (_a = this.catch) === null || _a === void 0 ? void 0 : _a.optimizeNames(names, constants);\n        (_b = this.finally) === null || _b === void 0 ? void 0 : _b.optimizeNames(names, constants);\n        return this;\n    }\n    get names() {\n        const names = super.names;\n        if (this.catch)\n            addNames(names, this.catch.names);\n        if (this.finally)\n            addNames(names, this.finally.names);\n        return names;\n    }\n}\nclass Catch extends BlockNode {\n    constructor(error) {\n        super();\n        this.error = error;\n    }\n    render(opts) {\n        return `catch(${this.error})` + super.render(opts);\n    }\n}\nCatch.kind = \"catch\";\nclass Finally extends BlockNode {\n    render(opts) {\n        return \"finally\" + super.render(opts);\n    }\n}\nFinally.kind = \"finally\";\nclass CodeGen {\n    constructor(extScope, opts = {}) {\n        this._values = {};\n        this._blockStarts = [];\n        this._constants = {};\n        this.opts = { ...opts, _n: opts.lines ? \"\\n\" : \"\" };\n        this._extScope = extScope;\n        this._scope = new scope_1.Scope({ parent: extScope });\n        this._nodes = [new Root()];\n    }\n    toString() {\n        return this._root.render(this.opts);\n    }\n    // returns unique name in the internal scope\n    name(prefix) {\n        return this._scope.name(prefix);\n    }\n    // reserves unique name in the external scope\n    scopeName(prefix) {\n        return this._extScope.name(prefix);\n    }\n    // reserves unique name in the external scope and assigns value to it\n    scopeValue(prefixOrName, value) {\n        const name = this._extScope.value(prefixOrName, value);\n        const vs = this._values[name.prefix] || (this._values[name.prefix] = new Set());\n        vs.add(name);\n        return name;\n    }\n    getScopeValue(prefix, keyOrRef) {\n        return this._extScope.getValue(prefix, keyOrRef);\n    }\n    // return code that assigns values in the external scope to the names that are used internally\n    // (same names that were returned by gen.scopeName or gen.scopeValue)\n    scopeRefs(scopeName) {\n        return this._extScope.scopeRefs(scopeName, this._values);\n    }\n    scopeCode() {\n        return this._extScope.scopeCode(this._values);\n    }\n    _def(varKind, nameOrPrefix, rhs, constant) {\n        const name = this._scope.toName(nameOrPrefix);\n        if (rhs !== undefined && constant)\n            this._constants[name.str] = rhs;\n        this._leafNode(new Def(varKind, name, rhs));\n        return name;\n    }\n    // `const` declaration (`var` in es5 mode)\n    const(nameOrPrefix, rhs, _constant) {\n        return this._def(scope_1.varKinds.const, nameOrPrefix, rhs, _constant);\n    }\n    // `let` declaration with optional assignment (`var` in es5 mode)\n    let(nameOrPrefix, rhs, _constant) {\n        return this._def(scope_1.varKinds.let, nameOrPrefix, rhs, _constant);\n    }\n    // `var` declaration with optional assignment\n    var(nameOrPrefix, rhs, _constant) {\n        return this._def(scope_1.varKinds.var, nameOrPrefix, rhs, _constant);\n    }\n    // assignment code\n    assign(lhs, rhs, sideEffects) {\n        return this._leafNode(new Assign(lhs, rhs, sideEffects));\n    }\n    // `+=` code\n    add(lhs, rhs) {\n        return this._leafNode(new AssignOp(lhs, exports.operators.ADD, rhs));\n    }\n    // appends passed SafeExpr to code or executes Block\n    code(c) {\n        if (typeof c == \"function\")\n            c();\n        else if (c !== code_1.nil)\n            this._leafNode(new AnyCode(c));\n        return this;\n    }\n    // returns code for object literal for the passed argument list of key-value pairs\n    object(...keyValues) {\n        const code = [\"{\"];\n        for (const [key, value] of keyValues) {\n            if (code.length > 1)\n                code.push(\",\");\n            code.push(key);\n            if (key !== value || this.opts.es5) {\n                code.push(\":\");\n                (0, code_1.addCodeArg)(code, value);\n            }\n        }\n        code.push(\"}\");\n        return new code_1._Code(code);\n    }\n    // `if` clause (or statement if `thenBody` and, optionally, `elseBody` are passed)\n    if(condition, thenBody, elseBody) {\n        this._blockNode(new If(condition));\n        if (thenBody && elseBody) {\n            this.code(thenBody).else().code(elseBody).endIf();\n        }\n        else if (thenBody) {\n            this.code(thenBody).endIf();\n        }\n        else if (elseBody) {\n            throw new Error('CodeGen: \"else\" body without \"then\" body');\n        }\n        return this;\n    }\n    // `else if` clause - invalid without `if` or after `else` clauses\n    elseIf(condition) {\n        return this._elseNode(new If(condition));\n    }\n    // `else` clause - only valid after `if` or `else if` clauses\n    else() {\n        return this._elseNode(new Else());\n    }\n    // end `if` statement (needed if gen.if was used only with condition)\n    endIf() {\n        return this._endBlockNode(If, Else);\n    }\n    _for(node, forBody) {\n        this._blockNode(node);\n        if (forBody)\n            this.code(forBody).endFor();\n        return this;\n    }\n    // a generic `for` clause (or statement if `forBody` is passed)\n    for(iteration, forBody) {\n        return this._for(new ForLoop(iteration), forBody);\n    }\n    // `for` statement for a range of values\n    forRange(nameOrPrefix, from, to, forBody, varKind = this.opts.es5 ? scope_1.varKinds.var : scope_1.varKinds.let) {\n        const name = this._scope.toName(nameOrPrefix);\n        return this._for(new ForRange(varKind, name, from, to), () => forBody(name));\n    }\n    // `for-of` statement (in es5 mode replace with a normal for loop)\n    forOf(nameOrPrefix, iterable, forBody, varKind = scope_1.varKinds.const) {\n        const name = this._scope.toName(nameOrPrefix);\n        if (this.opts.es5) {\n            const arr = iterable instanceof code_1.Name ? iterable : this.var(\"_arr\", iterable);\n            return this.forRange(\"_i\", 0, (0, code_1._) `${arr}.length`, (i) => {\n                this.var(name, (0, code_1._) `${arr}[${i}]`);\n                forBody(name);\n            });\n        }\n        return this._for(new ForIter(\"of\", varKind, name, iterable), () => forBody(name));\n    }\n    // `for-in` statement.\n    // With option `ownProperties` replaced with a `for-of` loop for object keys\n    forIn(nameOrPrefix, obj, forBody, varKind = this.opts.es5 ? scope_1.varKinds.var : scope_1.varKinds.const) {\n        if (this.opts.ownProperties) {\n            return this.forOf(nameOrPrefix, (0, code_1._) `Object.keys(${obj})`, forBody);\n        }\n        const name = this._scope.toName(nameOrPrefix);\n        return this._for(new ForIter(\"in\", varKind, name, obj), () => forBody(name));\n    }\n    // end `for` loop\n    endFor() {\n        return this._endBlockNode(For);\n    }\n    // `label` statement\n    label(label) {\n        return this._leafNode(new Label(label));\n    }\n    // `break` statement\n    break(label) {\n        return this._leafNode(new Break(label));\n    }\n    // `return` statement\n    return(value) {\n        const node = new Return();\n        this._blockNode(node);\n        this.code(value);\n        if (node.nodes.length !== 1)\n            throw new Error('CodeGen: \"return\" should have one node');\n        return this._endBlockNode(Return);\n    }\n    // `try` statement\n    try(tryBody, catchCode, finallyCode) {\n        if (!catchCode && !finallyCode)\n            throw new Error('CodeGen: \"try\" without \"catch\" and \"finally\"');\n        const node = new Try();\n        this._blockNode(node);\n        this.code(tryBody);\n        if (catchCode) {\n            const error = this.name(\"e\");\n            this._currNode = node.catch = new Catch(error);\n            catchCode(error);\n        }\n        if (finallyCode) {\n            this._currNode = node.finally = new Finally();\n            this.code(finallyCode);\n        }\n        return this._endBlockNode(Catch, Finally);\n    }\n    // `throw` statement\n    throw(error) {\n        return this._leafNode(new Throw(error));\n    }\n    // start self-balancing block\n    block(body, nodeCount) {\n        this._blockStarts.push(this._nodes.length);\n        if (body)\n            this.code(body).endBlock(nodeCount);\n        return this;\n    }\n    // end the current self-balancing block\n    endBlock(nodeCount) {\n        const len = this._blockStarts.pop();\n        if (len === undefined)\n            throw new Error(\"CodeGen: not in self-balancing block\");\n        const toClose = this._nodes.length - len;\n        if (toClose < 0 || (nodeCount !== undefined && toClose !== nodeCount)) {\n            throw new Error(`CodeGen: wrong number of nodes: ${toClose} vs ${nodeCount} expected`);\n        }\n        this._nodes.length = len;\n        return this;\n    }\n    // `function` heading (or definition if funcBody is passed)\n    func(name, args = code_1.nil, async, funcBody) {\n        this._blockNode(new Func(name, args, async));\n        if (funcBody)\n            this.code(funcBody).endFunc();\n        return this;\n    }\n    // end function definition\n    endFunc() {\n        return this._endBlockNode(Func);\n    }\n    optimize(n = 1) {\n        while (n-- > 0) {\n            this._root.optimizeNodes();\n            this._root.optimizeNames(this._root.names, this._constants);\n        }\n    }\n    _leafNode(node) {\n        this._currNode.nodes.push(node);\n        return this;\n    }\n    _blockNode(node) {\n        this._currNode.nodes.push(node);\n        this._nodes.push(node);\n    }\n    _endBlockNode(N1, N2) {\n        const n = this._currNode;\n        if (n instanceof N1 || (N2 && n instanceof N2)) {\n            this._nodes.pop();\n            return this;\n        }\n        throw new Error(`CodeGen: not in block \"${N2 ? `${N1.kind}/${N2.kind}` : N1.kind}\"`);\n    }\n    _elseNode(node) {\n        const n = this._currNode;\n        if (!(n instanceof If)) {\n            throw new Error('CodeGen: \"else\" without \"if\"');\n        }\n        this._currNode = n.else = node;\n        return this;\n    }\n    get _root() {\n        return this._nodes[0];\n    }\n    get _currNode() {\n        const ns = this._nodes;\n        return ns[ns.length - 1];\n    }\n    set _currNode(node) {\n        const ns = this._nodes;\n        ns[ns.length - 1] = node;\n    }\n}\nexports.CodeGen = CodeGen;\nfunction addNames(names, from) {\n    for (const n in from)\n        names[n] = (names[n] || 0) + (from[n] || 0);\n    return names;\n}\nfunction addExprNames(names, from) {\n    return from instanceof code_1._CodeOrName ? addNames(names, from.names) : names;\n}\nfunction optimizeExpr(expr, names, constants) {\n    if (expr instanceof code_1.Name)\n        return replaceName(expr);\n    if (!canOptimize(expr))\n        return expr;\n    return new code_1._Code(expr._items.reduce((items, c) => {\n        if (c instanceof code_1.Name)\n            c = replaceName(c);\n        if (c instanceof code_1._Code)\n            items.push(...c._items);\n        else\n            items.push(c);\n        return items;\n    }, []));\n    function replaceName(n) {\n        const c = constants[n.str];\n        if (c === undefined || names[n.str] !== 1)\n            return n;\n        delete names[n.str];\n        return c;\n    }\n    function canOptimize(e) {\n        return (e instanceof code_1._Code &&\n            e._items.some((c) => c instanceof code_1.Name && names[c.str] === 1 && constants[c.str] !== undefined));\n    }\n}\nfunction subtractNames(names, from) {\n    for (const n in from)\n        names[n] = (names[n] || 0) - (from[n] || 0);\n}\nfunction not(x) {\n    return typeof x == \"boolean\" || typeof x == \"number\" || x === null ? !x : (0, code_1._) `!${par(x)}`;\n}\nexports.not = not;\nconst andCode = mappend(exports.operators.AND);\n// boolean AND (&&) expression with the passed arguments\nfunction and(...args) {\n    return args.reduce(andCode);\n}\nexports.and = and;\nconst orCode = mappend(exports.operators.OR);\n// boolean OR (||) expression with the passed arguments\nfunction or(...args) {\n    return args.reduce(orCode);\n}\nexports.or = or;\nfunction mappend(op) {\n    return (x, y) => (x === code_1.nil ? y : y === code_1.nil ? x : (0, code_1._) `${par(x)} ${op} ${par(y)}`);\n}\nfunction par(x) {\n    return x instanceof code_1.Name ? x : (0, code_1._) `(${x})`;\n}\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.checkStrictMode = exports.getErrorPath = exports.Type = exports.useFunc = exports.setEvaluated = exports.evaluatedPropsToName = exports.mergeEvaluated = exports.eachItem = exports.unescapeJsonPointer = exports.escapeJsonPointer = exports.escapeFragment = exports.unescapeFragment = exports.schemaRefOrVal = exports.schemaHasRulesButRef = exports.schemaHasRules = exports.checkUnknownRules = exports.alwaysValidSchema = exports.toHash = void 0;\nconst codegen_1 = require(\"./codegen\");\nconst code_1 = require(\"./codegen/code\");\n// TODO refactor to use Set\nfunction toHash(arr) {\n    const hash = {};\n    for (const item of arr)\n        hash[item] = true;\n    return hash;\n}\nexports.toHash = toHash;\nfunction alwaysValidSchema(it, schema) {\n    if (typeof schema == \"boolean\")\n        return schema;\n    if (Object.keys(schema).length === 0)\n        return true;\n    checkUnknownRules(it, schema);\n    return !schemaHasRules(schema, it.self.RULES.all);\n}\nexports.alwaysValidSchema = alwaysValidSchema;\nfunction checkUnknownRules(it, schema = it.schema) {\n    const { opts, self } = it;\n    if (!opts.strictSchema)\n        return;\n    if (typeof schema === \"boolean\")\n        return;\n    const rules = self.RULES.keywords;\n    for (const key in schema) {\n        if (!rules[key])\n            checkStrictMode(it, `unknown keyword: \"${key}\"`);\n    }\n}\nexports.checkUnknownRules = checkUnknownRules;\nfunction schemaHasRules(schema, rules) {\n    if (typeof schema == \"boolean\")\n        return !schema;\n    for (const key in schema)\n        if (rules[key])\n            return true;\n    return false;\n}\nexports.schemaHasRules = schemaHasRules;\nfunction schemaHasRulesButRef(schema, RULES) {\n    if (typeof schema == \"boolean\")\n        return !schema;\n    for (const key in schema)\n        if (key !== \"$ref\" && RULES.all[key])\n            return true;\n    return false;\n}\nexports.schemaHasRulesButRef = schemaHasRulesButRef;\nfunction schemaRefOrVal({ topSchemaRef, schemaPath }, schema, keyword, $data) {\n    if (!$data) {\n        if (typeof schema == \"number\" || typeof schema == \"boolean\")\n            return schema;\n        if (typeof schema == \"string\")\n            return (0, codegen_1._) `${schema}`;\n    }\n    return (0, codegen_1._) `${topSchemaRef}${schemaPath}${(0, codegen_1.getProperty)(keyword)}`;\n}\nexports.schemaRefOrVal = schemaRefOrVal;\nfunction unescapeFragment(str) {\n    return unescapeJsonPointer(decodeURIComponent(str));\n}\nexports.unescapeFragment = unescapeFragment;\nfunction escapeFragment(str) {\n    return encodeURIComponent(escapeJsonPointer(str));\n}\nexports.escapeFragment = escapeFragment;\nfunction escapeJsonPointer(str) {\n    if (typeof str == \"number\")\n        return `${str}`;\n    return str.replace(/~/g, \"~0\").replace(/\\//g, \"~1\");\n}\nexports.escapeJsonPointer = escapeJsonPointer;\nfunction unescapeJsonPointer(str) {\n    return str.replace(/~1/g, \"/\").replace(/~0/g, \"~\");\n}\nexports.unescapeJsonPointer = unescapeJsonPointer;\nfunction eachItem(xs, f) {\n    if (Array.isArray(xs)) {\n        for (const x of xs)\n            f(x);\n    }\n    else {\n        f(xs);\n    }\n}\nexports.eachItem = eachItem;\nfunction makeMergeEvaluated({ mergeNames, mergeToName, mergeValues, resultToName, }) {\n    return (gen, from, to, toName) => {\n        const res = to === undefined\n            ? from\n            : to instanceof codegen_1.Name\n                ? (from instanceof codegen_1.Name ? mergeNames(gen, from, to) : mergeToName(gen, from, to), to)\n                : from instanceof codegen_1.Name\n                    ? (mergeToName(gen, to, from), from)\n                    : mergeValues(from, to);\n        return toName === codegen_1.Name && !(res instanceof codegen_1.Name) ? resultToName(gen, res) : res;\n    };\n}\nexports.mergeEvaluated = {\n    props: makeMergeEvaluated({\n        mergeNames: (gen, from, to) => gen.if((0, codegen_1._) `${to} !== true && ${from} !== undefined`, () => {\n            gen.if((0, codegen_1._) `${from} === true`, () => gen.assign(to, true), () => gen.assign(to, (0, codegen_1._) `${to} || {}`).code((0, codegen_1._) `Object.assign(${to}, ${from})`));\n        }),\n        mergeToName: (gen, from, to) => gen.if((0, codegen_1._) `${to} !== true`, () => {\n            if (from === true) {\n                gen.assign(to, true);\n            }\n            else {\n                gen.assign(to, (0, codegen_1._) `${to} || {}`);\n                setEvaluated(gen, to, from);\n            }\n        }),\n        mergeValues: (from, to) => (from === true ? true : { ...from, ...to }),\n        resultToName: evaluatedPropsToName,\n    }),\n    items: makeMergeEvaluated({\n        mergeNames: (gen, from, to) => gen.if((0, codegen_1._) `${to} !== true && ${from} !== undefined`, () => gen.assign(to, (0, codegen_1._) `${from} === true ? true : ${to} > ${from} ? ${to} : ${from}`)),\n        mergeToName: (gen, from, to) => gen.if((0, codegen_1._) `${to} !== true`, () => gen.assign(to, from === true ? true : (0, codegen_1._) `${to} > ${from} ? ${to} : ${from}`)),\n        mergeValues: (from, to) => (from === true ? true : Math.max(from, to)),\n        resultToName: (gen, items) => gen.var(\"items\", items),\n    }),\n};\nfunction evaluatedPropsToName(gen, ps) {\n    if (ps === true)\n        return gen.var(\"props\", true);\n    const props = gen.var(\"props\", (0, codegen_1._) `{}`);\n    if (ps !== undefined)\n        setEvaluated(gen, props, ps);\n    return props;\n}\nexports.evaluatedPropsToName = evaluatedPropsToName;\nfunction setEvaluated(gen, props, ps) {\n    Object.keys(ps).forEach((p) => gen.assign((0, codegen_1._) `${props}${(0, codegen_1.getProperty)(p)}`, true));\n}\nexports.setEvaluated = setEvaluated;\nconst snippets = {};\nfunction useFunc(gen, f) {\n    return gen.scopeValue(\"func\", {\n        ref: f,\n        code: snippets[f.code] || (snippets[f.code] = new code_1._Code(f.code)),\n    });\n}\nexports.useFunc = useFunc;\nvar Type;\n(function (Type) {\n    Type[Type[\"Num\"] = 0] = \"Num\";\n    Type[Type[\"Str\"] = 1] = \"Str\";\n})(Type || (exports.Type = Type = {}));\nfunction getErrorPath(dataProp, dataPropType, jsPropertySyntax) {\n    // let path\n    if (dataProp instanceof codegen_1.Name) {\n        const isNumber = dataPropType === Type.Num;\n        return jsPropertySyntax\n            ? isNumber\n                ? (0, codegen_1._) `\"[\" + ${dataProp} + \"]\"`\n                : (0, codegen_1._) `\"['\" + ${dataProp} + \"']\"`\n            : isNumber\n                ? (0, codegen_1._) `\"/\" + ${dataProp}`\n                : (0, codegen_1._) `\"/\" + ${dataProp}.replace(/~/g, \"~0\").replace(/\\\\//g, \"~1\")`; // TODO maybe use global escapePointer\n    }\n    return jsPropertySyntax ? (0, codegen_1.getProperty)(dataProp).toString() : \"/\" + escapeJsonPointer(dataProp);\n}\nexports.getErrorPath = getErrorPath;\nfunction checkStrictMode(it, msg, mode = it.opts.strictSchema) {\n    if (!mode)\n        return;\n    msg = `strict mode: ${msg}`;\n    if (mode === true)\n        throw new Error(msg);\n    it.self.logger.warn(msg);\n}\nexports.checkStrictMode = checkStrictMode;\n//# sourceMappingURL=util.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"./codegen\");\nconst names = {\n    // validation function arguments\n    data: new codegen_1.Name(\"data\"), // data passed to validation function\n    // args passed from referencing schema\n    valCxt: new codegen_1.Name(\"valCxt\"), // validation/data context - should not be used directly, it is destructured to the names below\n    instancePath: new codegen_1.Name(\"instancePath\"),\n    parentData: new codegen_1.Name(\"parentData\"),\n    parentDataProperty: new codegen_1.Name(\"parentDataProperty\"),\n    rootData: new codegen_1.Name(\"rootData\"), // root data - same as the data passed to the first/top validation function\n    dynamicAnchors: new codegen_1.Name(\"dynamicAnchors\"), // used to support recursiveRef and dynamicRef\n    // function scoped variables\n    vErrors: new codegen_1.Name(\"vErrors\"), // null or array of validation errors\n    errors: new codegen_1.Name(\"errors\"), // counter of validation errors\n    this: new codegen_1.Name(\"this\"),\n    // \"globals\"\n    self: new codegen_1.Name(\"self\"),\n    scope: new codegen_1.Name(\"scope\"),\n    // JTD serialize/parse name for JSON string and position\n    json: new codegen_1.Name(\"json\"),\n    jsonPos: new codegen_1.Name(\"jsonPos\"),\n    jsonLen: new codegen_1.Name(\"jsonLen\"),\n    jsonPart: new codegen_1.Name(\"jsonPart\"),\n};\nexports.default = names;\n//# sourceMappingURL=names.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.extendErrors = exports.resetErrorsCount = exports.reportExtraError = exports.reportError = exports.keyword$DataError = exports.keywordError = void 0;\nconst codegen_1 = require(\"./codegen\");\nconst util_1 = require(\"./util\");\nconst names_1 = require(\"./names\");\nexports.keywordError = {\n    message: ({ keyword }) => (0, codegen_1.str) `must pass \"${keyword}\" keyword validation`,\n};\nexports.keyword$DataError = {\n    message: ({ keyword, schemaType }) => schemaType\n        ? (0, codegen_1.str) `\"${keyword}\" keyword must be ${schemaType} ($data)`\n        : (0, codegen_1.str) `\"${keyword}\" keyword is invalid ($data)`,\n};\nfunction reportError(cxt, error = exports.keywordError, errorPaths, overrideAllErrors) {\n    const { it } = cxt;\n    const { gen, compositeRule, allErrors } = it;\n    const errObj = errorObjectCode(cxt, error, errorPaths);\n    if (overrideAllErrors !== null && overrideAllErrors !== void 0 ? overrideAllErrors : (compositeRule || allErrors)) {\n        addError(gen, errObj);\n    }\n    else {\n        returnErrors(it, (0, codegen_1._) `[${errObj}]`);\n    }\n}\nexports.reportError = reportError;\nfunction reportExtraError(cxt, error = exports.keywordError, errorPaths) {\n    const { it } = cxt;\n    const { gen, compositeRule, allErrors } = it;\n    const errObj = errorObjectCode(cxt, error, errorPaths);\n    addError(gen, errObj);\n    if (!(compositeRule || allErrors)) {\n        returnErrors(it, names_1.default.vErrors);\n    }\n}\nexports.reportExtraError = reportExtraError;\nfunction resetErrorsCount(gen, errsCount) {\n    gen.assign(names_1.default.errors, errsCount);\n    gen.if((0, codegen_1._) `${names_1.default.vErrors} !== null`, () => gen.if(errsCount, () => gen.assign((0, codegen_1._) `${names_1.default.vErrors}.length`, errsCount), () => gen.assign(names_1.default.vErrors, null)));\n}\nexports.resetErrorsCount = resetErrorsCount;\nfunction extendErrors({ gen, keyword, schemaValue, data, errsCount, it, }) {\n    /* istanbul ignore if */\n    if (errsCount === undefined)\n        throw new Error(\"ajv implementation error\");\n    const err = gen.name(\"err\");\n    gen.forRange(\"i\", errsCount, names_1.default.errors, (i) => {\n        gen.const(err, (0, codegen_1._) `${names_1.default.vErrors}[${i}]`);\n        gen.if((0, codegen_1._) `${err}.instancePath === undefined`, () => gen.assign((0, codegen_1._) `${err}.instancePath`, (0, codegen_1.strConcat)(names_1.default.instancePath, it.errorPath)));\n        gen.assign((0, codegen_1._) `${err}.schemaPath`, (0, codegen_1.str) `${it.errSchemaPath}/${keyword}`);\n        if (it.opts.verbose) {\n            gen.assign((0, codegen_1._) `${err}.schema`, schemaValue);\n            gen.assign((0, codegen_1._) `${err}.data`, data);\n        }\n    });\n}\nexports.extendErrors = extendErrors;\nfunction addError(gen, errObj) {\n    const err = gen.const(\"err\", errObj);\n    gen.if((0, codegen_1._) `${names_1.default.vErrors} === null`, () => gen.assign(names_1.default.vErrors, (0, codegen_1._) `[${err}]`), (0, codegen_1._) `${names_1.default.vErrors}.push(${err})`);\n    gen.code((0, codegen_1._) `${names_1.default.errors}++`);\n}\nfunction returnErrors(it, errs) {\n    const { gen, validateName, schemaEnv } = it;\n    if (schemaEnv.$async) {\n        gen.throw((0, codegen_1._) `new ${it.ValidationError}(${errs})`);\n    }\n    else {\n        gen.assign((0, codegen_1._) `${validateName}.errors`, errs);\n        gen.return(false);\n    }\n}\nconst E = {\n    keyword: new codegen_1.Name(\"keyword\"),\n    schemaPath: new codegen_1.Name(\"schemaPath\"), // also used in JTD errors\n    params: new codegen_1.Name(\"params\"),\n    propertyName: new codegen_1.Name(\"propertyName\"),\n    message: new codegen_1.Name(\"message\"),\n    schema: new codegen_1.Name(\"schema\"),\n    parentSchema: new codegen_1.Name(\"parentSchema\"),\n};\nfunction errorObjectCode(cxt, error, errorPaths) {\n    const { createErrors } = cxt.it;\n    if (createErrors === false)\n        return (0, codegen_1._) `{}`;\n    return errorObject(cxt, error, errorPaths);\n}\nfunction errorObject(cxt, error, errorPaths = {}) {\n    const { gen, it } = cxt;\n    const keyValues = [\n        errorInstancePath(it, errorPaths),\n        errorSchemaPath(cxt, errorPaths),\n    ];\n    extraErrorProps(cxt, error, keyValues);\n    return gen.object(...keyValues);\n}\nfunction errorInstancePath({ errorPath }, { instancePath }) {\n    const instPath = instancePath\n        ? (0, codegen_1.str) `${errorPath}${(0, util_1.getErrorPath)(instancePath, util_1.Type.Str)}`\n        : errorPath;\n    return [names_1.default.instancePath, (0, codegen_1.strConcat)(names_1.default.instancePath, instPath)];\n}\nfunction errorSchemaPath({ keyword, it: { errSchemaPath } }, { schemaPath, parentSchema }) {\n    let schPath = parentSchema ? errSchemaPath : (0, codegen_1.str) `${errSchemaPath}/${keyword}`;\n    if (schemaPath) {\n        schPath = (0, codegen_1.str) `${schPath}${(0, util_1.getErrorPath)(schemaPath, util_1.Type.Str)}`;\n    }\n    return [E.schemaPath, schPath];\n}\nfunction extraErrorProps(cxt, { params, message }, keyValues) {\n    const { keyword, data, schemaValue, it } = cxt;\n    const { opts, propertyName, topSchemaRef, schemaPath } = it;\n    keyValues.push([E.keyword, keyword], [E.params, typeof params == \"function\" ? params(cxt) : params || (0, codegen_1._) `{}`]);\n    if (opts.messages) {\n        keyValues.push([E.message, typeof message == \"function\" ? message(cxt) : message]);\n    }\n    if (opts.verbose) {\n        keyValues.push([E.schema, schemaValue], [E.parentSchema, (0, codegen_1._) `${topSchemaRef}${schemaPath}`], [names_1.default.data, data]);\n    }\n    if (propertyName)\n        keyValues.push([E.propertyName, propertyName]);\n}\n//# sourceMappingURL=errors.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.boolOrEmptySchema = exports.topBoolOrEmptySchema = void 0;\nconst errors_1 = require(\"../errors\");\nconst codegen_1 = require(\"../codegen\");\nconst names_1 = require(\"../names\");\nconst boolError = {\n    message: \"boolean schema is false\",\n};\nfunction topBoolOrEmptySchema(it) {\n    const { gen, schema, validateName } = it;\n    if (schema === false) {\n        falseSchemaError(it, false);\n    }\n    else if (typeof schema == \"object\" && schema.$async === true) {\n        gen.return(names_1.default.data);\n    }\n    else {\n        gen.assign((0, codegen_1._) `${validateName}.errors`, null);\n        gen.return(true);\n    }\n}\nexports.topBoolOrEmptySchema = topBoolOrEmptySchema;\nfunction boolOrEmptySchema(it, valid) {\n    const { gen, schema } = it;\n    if (schema === false) {\n        gen.var(valid, false); // TODO var\n        falseSchemaError(it);\n    }\n    else {\n        gen.var(valid, true); // TODO var\n    }\n}\nexports.boolOrEmptySchema = boolOrEmptySchema;\nfunction falseSchemaError(it, overrideAllErrors) {\n    const { gen, data } = it;\n    // TODO maybe some other interface should be used for non-keyword validation errors...\n    const cxt = {\n        gen,\n        keyword: \"false schema\",\n        data,\n        schema: false,\n        schemaCode: false,\n        schemaValue: false,\n        params: {},\n        it,\n    };\n    (0, errors_1.reportError)(cxt, boolError, undefined, overrideAllErrors);\n}\n//# sourceMappingURL=boolSchema.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getRules = exports.isJSONType = void 0;\nconst _jsonTypes = [\"string\", \"number\", \"integer\", \"boolean\", \"null\", \"object\", \"array\"];\nconst jsonTypes = new Set(_jsonTypes);\nfunction isJSONType(x) {\n    return typeof x == \"string\" && jsonTypes.has(x);\n}\nexports.isJSONType = isJSONType;\nfunction getRules() {\n    const groups = {\n        number: { type: \"number\", rules: [] },\n        string: { type: \"string\", rules: [] },\n        array: { type: \"array\", rules: [] },\n        object: { type: \"object\", rules: [] },\n    };\n    return {\n        types: { ...groups, integer: true, boolean: true, null: true },\n        rules: [{ rules: [] }, groups.number, groups.string, groups.array, groups.object],\n        post: { rules: [] },\n        all: {},\n        keywords: {},\n    };\n}\nexports.getRules = getRules;\n//# sourceMappingURL=rules.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.shouldUseRule = exports.shouldUseGroup = exports.schemaHasRulesForType = void 0;\nfunction schemaHasRulesForType({ schema, self }, type) {\n    const group = self.RULES.types[type];\n    return group && group !== true && shouldUseGroup(schema, group);\n}\nexports.schemaHasRulesForType = schemaHasRulesForType;\nfunction shouldUseGroup(schema, group) {\n    return group.rules.some((rule) => shouldUseRule(schema, rule));\n}\nexports.shouldUseGroup = shouldUseGroup;\nfunction shouldUseRule(schema, rule) {\n    var _a;\n    return (schema[rule.keyword] !== undefined ||\n        ((_a = rule.definition.implements) === null || _a === void 0 ? void 0 : _a.some((kwd) => schema[kwd] !== undefined)));\n}\nexports.shouldUseRule = shouldUseRule;\n//# sourceMappingURL=applicability.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.reportTypeError = exports.checkDataTypes = exports.checkDataType = exports.coerceAndCheckDataType = exports.getJSONTypes = exports.getSchemaTypes = exports.DataType = void 0;\nconst rules_1 = require(\"../rules\");\nconst applicability_1 = require(\"./applicability\");\nconst errors_1 = require(\"../errors\");\nconst codegen_1 = require(\"../codegen\");\nconst util_1 = require(\"../util\");\nvar DataType;\n(function (DataType) {\n    DataType[DataType[\"Correct\"] = 0] = \"Correct\";\n    DataType[DataType[\"Wrong\"] = 1] = \"Wrong\";\n})(DataType || (exports.DataType = DataType = {}));\nfunction getSchemaTypes(schema) {\n    const types = getJSONTypes(schema.type);\n    const hasNull = types.includes(\"null\");\n    if (hasNull) {\n        if (schema.nullable === false)\n            throw new Error(\"type: null contradicts nullable: false\");\n    }\n    else {\n        if (!types.length && schema.nullable !== undefined) {\n            throw new Error('\"nullable\" cannot be used without \"type\"');\n        }\n        if (schema.nullable === true)\n            types.push(\"null\");\n    }\n    return types;\n}\nexports.getSchemaTypes = getSchemaTypes;\n// eslint-disable-next-line @typescript-eslint/no-redundant-type-constituents\nfunction getJSONTypes(ts) {\n    const types = Array.isArray(ts) ? ts : ts ? [ts] : [];\n    if (types.every(rules_1.isJSONType))\n        return types;\n    throw new Error(\"type must be JSONType or JSONType[]: \" + types.join(\",\"));\n}\nexports.getJSONTypes = getJSONTypes;\nfunction coerceAndCheckDataType(it, types) {\n    const { gen, data, opts } = it;\n    const coerceTo = coerceToTypes(types, opts.coerceTypes);\n    const checkTypes = types.length > 0 &&\n        !(coerceTo.length === 0 && types.length === 1 && (0, applicability_1.schemaHasRulesForType)(it, types[0]));\n    if (checkTypes) {\n        const wrongType = checkDataTypes(types, data, opts.strictNumbers, DataType.Wrong);\n        gen.if(wrongType, () => {\n            if (coerceTo.length)\n                coerceData(it, types, coerceTo);\n            else\n                reportTypeError(it);\n        });\n    }\n    return checkTypes;\n}\nexports.coerceAndCheckDataType = coerceAndCheckDataType;\nconst COERCIBLE = new Set([\"string\", \"number\", \"integer\", \"boolean\", \"null\"]);\nfunction coerceToTypes(types, coerceTypes) {\n    return coerceTypes\n        ? types.filter((t) => COERCIBLE.has(t) || (coerceTypes === \"array\" && t === \"array\"))\n        : [];\n}\nfunction coerceData(it, types, coerceTo) {\n    const { gen, data, opts } = it;\n    const dataType = gen.let(\"dataType\", (0, codegen_1._) `typeof ${data}`);\n    const coerced = gen.let(\"coerced\", (0, codegen_1._) `undefined`);\n    if (opts.coerceTypes === \"array\") {\n        gen.if((0, codegen_1._) `${dataType} == 'object' && Array.isArray(${data}) && ${data}.length == 1`, () => gen\n            .assign(data, (0, codegen_1._) `${data}[0]`)\n            .assign(dataType, (0, codegen_1._) `typeof ${data}`)\n            .if(checkDataTypes(types, data, opts.strictNumbers), () => gen.assign(coerced, data)));\n    }\n    gen.if((0, codegen_1._) `${coerced} !== undefined`);\n    for (const t of coerceTo) {\n        if (COERCIBLE.has(t) || (t === \"array\" && opts.coerceTypes === \"array\")) {\n            coerceSpecificType(t);\n        }\n    }\n    gen.else();\n    reportTypeError(it);\n    gen.endIf();\n    gen.if((0, codegen_1._) `${coerced} !== undefined`, () => {\n        gen.assign(data, coerced);\n        assignParentData(it, coerced);\n    });\n    function coerceSpecificType(t) {\n        switch (t) {\n            case \"string\":\n                gen\n                    .elseIf((0, codegen_1._) `${dataType} == \"number\" || ${dataType} == \"boolean\"`)\n                    .assign(coerced, (0, codegen_1._) `\"\" + ${data}`)\n                    .elseIf((0, codegen_1._) `${data} === null`)\n                    .assign(coerced, (0, codegen_1._) `\"\"`);\n                return;\n            case \"number\":\n                gen\n                    .elseIf((0, codegen_1._) `${dataType} == \"boolean\" || ${data} === null\n              || (${dataType} == \"string\" && ${data} && ${data} == +${data})`)\n                    .assign(coerced, (0, codegen_1._) `+${data}`);\n                return;\n            case \"integer\":\n                gen\n                    .elseIf((0, codegen_1._) `${dataType} === \"boolean\" || ${data} === null\n              || (${dataType} === \"string\" && ${data} && ${data} == +${data} && !(${data} % 1))`)\n                    .assign(coerced, (0, codegen_1._) `+${data}`);\n                return;\n            case \"boolean\":\n                gen\n                    .elseIf((0, codegen_1._) `${data} === \"false\" || ${data} === 0 || ${data} === null`)\n                    .assign(coerced, false)\n                    .elseIf((0, codegen_1._) `${data} === \"true\" || ${data} === 1`)\n                    .assign(coerced, true);\n                return;\n            case \"null\":\n                gen.elseIf((0, codegen_1._) `${data} === \"\" || ${data} === 0 || ${data} === false`);\n                gen.assign(coerced, null);\n                return;\n            case \"array\":\n                gen\n                    .elseIf((0, codegen_1._) `${dataType} === \"string\" || ${dataType} === \"number\"\n              || ${dataType} === \"boolean\" || ${data} === null`)\n                    .assign(coerced, (0, codegen_1._) `[${data}]`);\n        }\n    }\n}\nfunction assignParentData({ gen, parentData, parentDataProperty }, expr) {\n    // TODO use gen.property\n    gen.if((0, codegen_1._) `${parentData} !== undefined`, () => gen.assign((0, codegen_1._) `${parentData}[${parentDataProperty}]`, expr));\n}\nfunction checkDataType(dataType, data, strictNums, correct = DataType.Correct) {\n    const EQ = correct === DataType.Correct ? codegen_1.operators.EQ : codegen_1.operators.NEQ;\n    let cond;\n    switch (dataType) {\n        case \"null\":\n            return (0, codegen_1._) `${data} ${EQ} null`;\n        case \"array\":\n            cond = (0, codegen_1._) `Array.isArray(${data})`;\n            break;\n        case \"object\":\n            cond = (0, codegen_1._) `${data} && typeof ${data} == \"object\" && !Array.isArray(${data})`;\n            break;\n        case \"integer\":\n            cond = numCond((0, codegen_1._) `!(${data} % 1) && !isNaN(${data})`);\n            break;\n        case \"number\":\n            cond = numCond();\n            break;\n        default:\n            return (0, codegen_1._) `typeof ${data} ${EQ} ${dataType}`;\n    }\n    return correct === DataType.Correct ? cond : (0, codegen_1.not)(cond);\n    function numCond(_cond = codegen_1.nil) {\n        return (0, codegen_1.and)((0, codegen_1._) `typeof ${data} == \"number\"`, _cond, strictNums ? (0, codegen_1._) `isFinite(${data})` : codegen_1.nil);\n    }\n}\nexports.checkDataType = checkDataType;\nfunction checkDataTypes(dataTypes, data, strictNums, correct) {\n    if (dataTypes.length === 1) {\n        return checkDataType(dataTypes[0], data, strictNums, correct);\n    }\n    let cond;\n    const types = (0, util_1.toHash)(dataTypes);\n    if (types.array && types.object) {\n        const notObj = (0, codegen_1._) `typeof ${data} != \"object\"`;\n        cond = types.null ? notObj : (0, codegen_1._) `!${data} || ${notObj}`;\n        delete types.null;\n        delete types.array;\n        delete types.object;\n    }\n    else {\n        cond = codegen_1.nil;\n    }\n    if (types.number)\n        delete types.integer;\n    for (const t in types)\n        cond = (0, codegen_1.and)(cond, checkDataType(t, data, strictNums, correct));\n    return cond;\n}\nexports.checkDataTypes = checkDataTypes;\nconst typeError = {\n    message: ({ schema }) => `must be ${schema}`,\n    params: ({ schema, schemaValue }) => typeof schema == \"string\" ? (0, codegen_1._) `{type: ${schema}}` : (0, codegen_1._) `{type: ${schemaValue}}`,\n};\nfunction reportTypeError(it) {\n    const cxt = getTypeErrorContext(it);\n    (0, errors_1.reportError)(cxt, typeError);\n}\nexports.reportTypeError = reportTypeError;\nfunction getTypeErrorContext(it) {\n    const { gen, data, schema } = it;\n    const schemaCode = (0, util_1.schemaRefOrVal)(it, schema, \"type\");\n    return {\n        gen,\n        keyword: \"type\",\n        data,\n        schema: schema.type,\n        schemaCode,\n        schemaValue: schemaCode,\n        parentSchema: schema,\n        params: {},\n        it,\n    };\n}\n//# sourceMappingURL=dataType.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.assignDefaults = void 0;\nconst codegen_1 = require(\"../codegen\");\nconst util_1 = require(\"../util\");\nfunction assignDefaults(it, ty) {\n    const { properties, items } = it.schema;\n    if (ty === \"object\" && properties) {\n        for (const key in properties) {\n            assignDefault(it, key, properties[key].default);\n        }\n    }\n    else if (ty === \"array\" && Array.isArray(items)) {\n        items.forEach((sch, i) => assignDefault(it, i, sch.default));\n    }\n}\nexports.assignDefaults = assignDefaults;\nfunction assignDefault(it, prop, defaultValue) {\n    const { gen, compositeRule, data, opts } = it;\n    if (defaultValue === undefined)\n        return;\n    const childData = (0, codegen_1._) `${data}${(0, codegen_1.getProperty)(prop)}`;\n    if (compositeRule) {\n        (0, util_1.checkStrictMode)(it, `default is ignored for: ${childData}`);\n        return;\n    }\n    let condition = (0, codegen_1._) `${childData} === undefined`;\n    if (opts.useDefaults === \"empty\") {\n        condition = (0, codegen_1._) `${condition} || ${childData} === null || ${childData} === \"\"`;\n    }\n    // `${childData} === undefined` +\n    // (opts.useDefaults === \"empty\" ? ` || ${childData} === null || ${childData} === \"\"` : \"\")\n    gen.if(condition, (0, codegen_1._) `${childData} = ${(0, codegen_1.stringify)(defaultValue)}`);\n}\n//# sourceMappingURL=defaults.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.validateUnion = exports.validateArray = exports.usePattern = exports.callValidateCode = exports.schemaProperties = exports.allSchemaProperties = exports.noPropertyInData = exports.propertyInData = exports.isOwnProperty = exports.hasPropFunc = exports.reportMissingProp = exports.checkMissingProp = exports.checkReportMissingProp = void 0;\nconst codegen_1 = require(\"../compile/codegen\");\nconst util_1 = require(\"../compile/util\");\nconst names_1 = require(\"../compile/names\");\nconst util_2 = require(\"../compile/util\");\nfunction checkReportMissingProp(cxt, prop) {\n    const { gen, data, it } = cxt;\n    gen.if(noPropertyInData(gen, data, prop, it.opts.ownProperties), () => {\n        cxt.setParams({ missingProperty: (0, codegen_1._) `${prop}` }, true);\n        cxt.error();\n    });\n}\nexports.checkReportMissingProp = checkReportMissingProp;\nfunction checkMissingProp({ gen, data, it: { opts } }, properties, missing) {\n    return (0, codegen_1.or)(...properties.map((prop) => (0, codegen_1.and)(noPropertyInData(gen, data, prop, opts.ownProperties), (0, codegen_1._) `${missing} = ${prop}`)));\n}\nexports.checkMissingProp = checkMissingProp;\nfunction reportMissingProp(cxt, missing) {\n    cxt.setParams({ missingProperty: missing }, true);\n    cxt.error();\n}\nexports.reportMissingProp = reportMissingProp;\nfunction hasPropFunc(gen) {\n    return gen.scopeValue(\"func\", {\n        // eslint-disable-next-line @typescript-eslint/unbound-method\n        ref: Object.prototype.hasOwnProperty,\n        code: (0, codegen_1._) `Object.prototype.hasOwnProperty`,\n    });\n}\nexports.hasPropFunc = hasPropFunc;\nfunction isOwnProperty(gen, data, property) {\n    return (0, codegen_1._) `${hasPropFunc(gen)}.call(${data}, ${property})`;\n}\nexports.isOwnProperty = isOwnProperty;\nfunction propertyInData(gen, data, property, ownProperties) {\n    const cond = (0, codegen_1._) `${data}${(0, codegen_1.getProperty)(property)} !== undefined`;\n    return ownProperties ? (0, codegen_1._) `${cond} && ${isOwnProperty(gen, data, property)}` : cond;\n}\nexports.propertyInData = propertyInData;\nfunction noPropertyInData(gen, data, property, ownProperties) {\n    const cond = (0, codegen_1._) `${data}${(0, codegen_1.getProperty)(property)} === undefined`;\n    return ownProperties ? (0, codegen_1.or)(cond, (0, codegen_1.not)(isOwnProperty(gen, data, property))) : cond;\n}\nexports.noPropertyInData = noPropertyInData;\nfunction allSchemaProperties(schemaMap) {\n    return schemaMap ? Object.keys(schemaMap).filter((p) => p !== \"__proto__\") : [];\n}\nexports.allSchemaProperties = allSchemaProperties;\nfunction schemaProperties(it, schemaMap) {\n    return allSchemaProperties(schemaMap).filter((p) => !(0, util_1.alwaysValidSchema)(it, schemaMap[p]));\n}\nexports.schemaProperties = schemaProperties;\nfunction callValidateCode({ schemaCode, data, it: { gen, topSchemaRef, schemaPath, errorPath }, it }, func, context, passSchema) {\n    const dataAndSchema = passSchema ? (0, codegen_1._) `${schemaCode}, ${data}, ${topSchemaRef}${schemaPath}` : data;\n    const valCxt = [\n        [names_1.default.instancePath, (0, codegen_1.strConcat)(names_1.default.instancePath, errorPath)],\n        [names_1.default.parentData, it.parentData],\n        [names_1.default.parentDataProperty, it.parentDataProperty],\n        [names_1.default.rootData, names_1.default.rootData],\n    ];\n    if (it.opts.dynamicRef)\n        valCxt.push([names_1.default.dynamicAnchors, names_1.default.dynamicAnchors]);\n    const args = (0, codegen_1._) `${dataAndSchema}, ${gen.object(...valCxt)}`;\n    return context !== codegen_1.nil ? (0, codegen_1._) `${func}.call(${context}, ${args})` : (0, codegen_1._) `${func}(${args})`;\n}\nexports.callValidateCode = callValidateCode;\nconst newRegExp = (0, codegen_1._) `new RegExp`;\nfunction usePattern({ gen, it: { opts } }, pattern) {\n    const u = opts.unicodeRegExp ? \"u\" : \"\";\n    const { regExp } = opts.code;\n    const rx = regExp(pattern, u);\n    return gen.scopeValue(\"pattern\", {\n        key: rx.toString(),\n        ref: rx,\n        code: (0, codegen_1._) `${regExp.code === \"new RegExp\" ? newRegExp : (0, util_2.useFunc)(gen, regExp)}(${pattern}, ${u})`,\n    });\n}\nexports.usePattern = usePattern;\nfunction validateArray(cxt) {\n    const { gen, data, keyword, it } = cxt;\n    const valid = gen.name(\"valid\");\n    if (it.allErrors) {\n        const validArr = gen.let(\"valid\", true);\n        validateItems(() => gen.assign(validArr, false));\n        return validArr;\n    }\n    gen.var(valid, true);\n    validateItems(() => gen.break());\n    return valid;\n    function validateItems(notValid) {\n        const len = gen.const(\"len\", (0, codegen_1._) `${data}.length`);\n        gen.forRange(\"i\", 0, len, (i) => {\n            cxt.subschema({\n                keyword,\n                dataProp: i,\n                dataPropType: util_1.Type.Num,\n            }, valid);\n            gen.if((0, codegen_1.not)(valid), notValid);\n        });\n    }\n}\nexports.validateArray = validateArray;\nfunction validateUnion(cxt) {\n    const { gen, schema, keyword, it } = cxt;\n    /* istanbul ignore if */\n    if (!Array.isArray(schema))\n        throw new Error(\"ajv implementation error\");\n    const alwaysValid = schema.some((sch) => (0, util_1.alwaysValidSchema)(it, sch));\n    if (alwaysValid && !it.opts.unevaluated)\n        return;\n    const valid = gen.let(\"valid\", false);\n    const schValid = gen.name(\"_valid\");\n    gen.block(() => schema.forEach((_sch, i) => {\n        const schCxt = cxt.subschema({\n            keyword,\n            schemaProp: i,\n            compositeRule: true,\n        }, schValid);\n        gen.assign(valid, (0, codegen_1._) `${valid} || ${schValid}`);\n        const merged = cxt.mergeValidEvaluated(schCxt, schValid);\n        // can short-circuit if `unevaluatedProperties/Items` not supported (opts.unevaluated !== true)\n        // or if all properties and items were evaluated (it.props === true && it.items === true)\n        if (!merged)\n            gen.if((0, codegen_1.not)(valid));\n    }));\n    cxt.result(valid, () => cxt.reset(), () => cxt.error(true));\n}\nexports.validateUnion = validateUnion;\n//# sourceMappingURL=code.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.validateKeywordUsage = exports.validSchemaType = exports.funcKeywordCode = exports.macroKeywordCode = void 0;\nconst codegen_1 = require(\"../codegen\");\nconst names_1 = require(\"../names\");\nconst code_1 = require(\"../../vocabularies/code\");\nconst errors_1 = require(\"../errors\");\nfunction macroKeywordCode(cxt, def) {\n    const { gen, keyword, schema, parentSchema, it } = cxt;\n    const macroSchema = def.macro.call(it.self, schema, parentSchema, it);\n    const schemaRef = useKeyword(gen, keyword, macroSchema);\n    if (it.opts.validateSchema !== false)\n        it.self.validateSchema(macroSchema, true);\n    const valid = gen.name(\"valid\");\n    cxt.subschema({\n        schema: macroSchema,\n        schemaPath: codegen_1.nil,\n        errSchemaPath: `${it.errSchemaPath}/${keyword}`,\n        topSchemaRef: schemaRef,\n        compositeRule: true,\n    }, valid);\n    cxt.pass(valid, () => cxt.error(true));\n}\nexports.macroKeywordCode = macroKeywordCode;\nfunction funcKeywordCode(cxt, def) {\n    var _a;\n    const { gen, keyword, schema, parentSchema, $data, it } = cxt;\n    checkAsyncKeyword(it, def);\n    const validate = !$data && def.compile ? def.compile.call(it.self, schema, parentSchema, it) : def.validate;\n    const validateRef = useKeyword(gen, keyword, validate);\n    const valid = gen.let(\"valid\");\n    cxt.block$data(valid, validateKeyword);\n    cxt.ok((_a = def.valid) !== null && _a !== void 0 ? _a : valid);\n    function validateKeyword() {\n        if (def.errors === false) {\n            assignValid();\n            if (def.modifying)\n                modifyData(cxt);\n            reportErrs(() => cxt.error());\n        }\n        else {\n            const ruleErrs = def.async ? validateAsync() : validateSync();\n            if (def.modifying)\n                modifyData(cxt);\n            reportErrs(() => addErrs(cxt, ruleErrs));\n        }\n    }\n    function validateAsync() {\n        const ruleErrs = gen.let(\"ruleErrs\", null);\n        gen.try(() => assignValid((0, codegen_1._) `await `), (e) => gen.assign(valid, false).if((0, codegen_1._) `${e} instanceof ${it.ValidationError}`, () => gen.assign(ruleErrs, (0, codegen_1._) `${e}.errors`), () => gen.throw(e)));\n        return ruleErrs;\n    }\n    function validateSync() {\n        const validateErrs = (0, codegen_1._) `${validateRef}.errors`;\n        gen.assign(validateErrs, null);\n        assignValid(codegen_1.nil);\n        return validateErrs;\n    }\n    function assignValid(_await = def.async ? (0, codegen_1._) `await ` : codegen_1.nil) {\n        const passCxt = it.opts.passContext ? names_1.default.this : names_1.default.self;\n        const passSchema = !((\"compile\" in def && !$data) || def.schema === false);\n        gen.assign(valid, (0, codegen_1._) `${_await}${(0, code_1.callValidateCode)(cxt, validateRef, passCxt, passSchema)}`, def.modifying);\n    }\n    function reportErrs(errors) {\n        var _a;\n        gen.if((0, codegen_1.not)((_a = def.valid) !== null && _a !== void 0 ? _a : valid), errors);\n    }\n}\nexports.funcKeywordCode = funcKeywordCode;\nfunction modifyData(cxt) {\n    const { gen, data, it } = cxt;\n    gen.if(it.parentData, () => gen.assign(data, (0, codegen_1._) `${it.parentData}[${it.parentDataProperty}]`));\n}\nfunction addErrs(cxt, errs) {\n    const { gen } = cxt;\n    gen.if((0, codegen_1._) `Array.isArray(${errs})`, () => {\n        gen\n            .assign(names_1.default.vErrors, (0, codegen_1._) `${names_1.default.vErrors} === null ? ${errs} : ${names_1.default.vErrors}.concat(${errs})`)\n            .assign(names_1.default.errors, (0, codegen_1._) `${names_1.default.vErrors}.length`);\n        (0, errors_1.extendErrors)(cxt);\n    }, () => cxt.error());\n}\nfunction checkAsyncKeyword({ schemaEnv }, def) {\n    if (def.async && !schemaEnv.$async)\n        throw new Error(\"async keyword in sync schema\");\n}\nfunction useKeyword(gen, keyword, result) {\n    if (result === undefined)\n        throw new Error(`keyword \"${keyword}\" failed to compile`);\n    return gen.scopeValue(\"keyword\", typeof result == \"function\" ? { ref: result } : { ref: result, code: (0, codegen_1.stringify)(result) });\n}\nfunction validSchemaType(schema, schemaType, allowUndefined = false) {\n    // TODO add tests\n    return (!schemaType.length ||\n        schemaType.some((st) => st === \"array\"\n            ? Array.isArray(schema)\n            : st === \"object\"\n                ? schema && typeof schema == \"object\" && !Array.isArray(schema)\n                : typeof schema == st || (allowUndefined && typeof schema == \"undefined\")));\n}\nexports.validSchemaType = validSchemaType;\nfunction validateKeywordUsage({ schema, opts, self, errSchemaPath }, def, keyword) {\n    /* istanbul ignore if */\n    if (Array.isArray(def.keyword) ? !def.keyword.includes(keyword) : def.keyword !== keyword) {\n        throw new Error(\"ajv implementation error\");\n    }\n    const deps = def.dependencies;\n    if (deps === null || deps === void 0 ? void 0 : deps.some((kwd) => !Object.prototype.hasOwnProperty.call(schema, kwd))) {\n        throw new Error(`parent schema must have dependencies of ${keyword}: ${deps.join(\",\")}`);\n    }\n    if (def.validateSchema) {\n        const valid = def.validateSchema(schema[keyword]);\n        if (!valid) {\n            const msg = `keyword \"${keyword}\" value is invalid at path \"${errSchemaPath}\": ` +\n                self.errorsText(def.validateSchema.errors);\n            if (opts.validateSchema === \"log\")\n                self.logger.error(msg);\n            else\n                throw new Error(msg);\n        }\n    }\n}\nexports.validateKeywordUsage = validateKeywordUsage;\n//# sourceMappingURL=keyword.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.extendSubschemaMode = exports.extendSubschemaData = exports.getSubschema = void 0;\nconst codegen_1 = require(\"../codegen\");\nconst util_1 = require(\"../util\");\nfunction getSubschema(it, { keyword, schemaProp, schema, schemaPath, errSchemaPath, topSchemaRef }) {\n    if (keyword !== undefined && schema !== undefined) {\n        throw new Error('both \"keyword\" and \"schema\" passed, only one allowed');\n    }\n    if (keyword !== undefined) {\n        const sch = it.schema[keyword];\n        return schemaProp === undefined\n            ? {\n                schema: sch,\n                schemaPath: (0, codegen_1._) `${it.schemaPath}${(0, codegen_1.getProperty)(keyword)}`,\n                errSchemaPath: `${it.errSchemaPath}/${keyword}`,\n            }\n            : {\n                schema: sch[schemaProp],\n                schemaPath: (0, codegen_1._) `${it.schemaPath}${(0, codegen_1.getProperty)(keyword)}${(0, codegen_1.getProperty)(schemaProp)}`,\n                errSchemaPath: `${it.errSchemaPath}/${keyword}/${(0, util_1.escapeFragment)(schemaProp)}`,\n            };\n    }\n    if (schema !== undefined) {\n        if (schemaPath === undefined || errSchemaPath === undefined || topSchemaRef === undefined) {\n            throw new Error('\"schemaPath\", \"errSchemaPath\" and \"topSchemaRef\" are required with \"schema\"');\n        }\n        return {\n            schema,\n            schemaPath,\n            topSchemaRef,\n            errSchemaPath,\n        };\n    }\n    throw new Error('either \"keyword\" or \"schema\" must be passed');\n}\nexports.getSubschema = getSubschema;\nfunction extendSubschemaData(subschema, it, { dataProp, dataPropType: dpType, data, dataTypes, propertyName }) {\n    if (data !== undefined && dataProp !== undefined) {\n        throw new Error('both \"data\" and \"dataProp\" passed, only one allowed');\n    }\n    const { gen } = it;\n    if (dataProp !== undefined) {\n        const { errorPath, dataPathArr, opts } = it;\n        const nextData = gen.let(\"data\", (0, codegen_1._) `${it.data}${(0, codegen_1.getProperty)(dataProp)}`, true);\n        dataContextProps(nextData);\n        subschema.errorPath = (0, codegen_1.str) `${errorPath}${(0, util_1.getErrorPath)(dataProp, dpType, opts.jsPropertySyntax)}`;\n        subschema.parentDataProperty = (0, codegen_1._) `${dataProp}`;\n        subschema.dataPathArr = [...dataPathArr, subschema.parentDataProperty];\n    }\n    if (data !== undefined) {\n        const nextData = data instanceof codegen_1.Name ? data : gen.let(\"data\", data, true); // replaceable if used once?\n        dataContextProps(nextData);\n        if (propertyName !== undefined)\n            subschema.propertyName = propertyName;\n        // TODO something is possibly wrong here with not changing parentDataProperty and not appending dataPathArr\n    }\n    if (dataTypes)\n        subschema.dataTypes = dataTypes;\n    function dataContextProps(_nextData) {\n        subschema.data = _nextData;\n        subschema.dataLevel = it.dataLevel + 1;\n        subschema.dataTypes = [];\n        it.definedProperties = new Set();\n        subschema.parentData = it.data;\n        subschema.dataNames = [...it.dataNames, _nextData];\n    }\n}\nexports.extendSubschemaData = extendSubschemaData;\nfunction extendSubschemaMode(subschema, { jtdDiscriminator, jtdMetadata, compositeRule, createErrors, allErrors }) {\n    if (compositeRule !== undefined)\n        subschema.compositeRule = compositeRule;\n    if (createErrors !== undefined)\n        subschema.createErrors = createErrors;\n    if (allErrors !== undefined)\n        subschema.allErrors = allErrors;\n    subschema.jtdDiscriminator = jtdDiscriminator; // not inherited\n    subschema.jtdMetadata = jtdMetadata; // not inherited\n}\nexports.extendSubschemaMode = extendSubschemaMode;\n//# sourceMappingURL=subschema.js.map","'use strict';\n\n// do not edit .js files directly - edit src/index.jst\n\n\n\nmodule.exports = function equal(a, b) {\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    if (a.constructor !== b.constructor) return false;\n\n    var length, i, keys;\n    if (Array.isArray(a)) {\n      length = a.length;\n      if (length != b.length) return false;\n      for (i = length; i-- !== 0;)\n        if (!equal(a[i], b[i])) return false;\n      return true;\n    }\n\n\n\n    if (a.constructor === RegExp) return a.source === b.source && a.flags === b.flags;\n    if (a.valueOf !== Object.prototype.valueOf) return a.valueOf() === b.valueOf();\n    if (a.toString !== Object.prototype.toString) return a.toString() === b.toString();\n\n    keys = Object.keys(a);\n    length = keys.length;\n    if (length !== Object.keys(b).length) return false;\n\n    for (i = length; i-- !== 0;)\n      if (!Object.prototype.hasOwnProperty.call(b, keys[i])) return false;\n\n    for (i = length; i-- !== 0;) {\n      var key = keys[i];\n\n      if (!equal(a[key], b[key])) return false;\n    }\n\n    return true;\n  }\n\n  // true if both NaN, false otherwise\n  return a!==a && b!==b;\n};\n","'use strict';\n\nvar traverse = module.exports = function (schema, opts, cb) {\n  // Legacy support for v0.3.1 and earlier.\n  if (typeof opts == 'function') {\n    cb = opts;\n    opts = {};\n  }\n\n  cb = opts.cb || cb;\n  var pre = (typeof cb == 'function') ? cb : cb.pre || function() {};\n  var post = cb.post || function() {};\n\n  _traverse(opts, pre, post, schema, '', schema);\n};\n\n\ntraverse.keywords = {\n  additionalItems: true,\n  items: true,\n  contains: true,\n  additionalProperties: true,\n  propertyNames: true,\n  not: true,\n  if: true,\n  then: true,\n  else: true\n};\n\ntraverse.arrayKeywords = {\n  items: true,\n  allOf: true,\n  anyOf: true,\n  oneOf: true\n};\n\ntraverse.propsKeywords = {\n  $defs: true,\n  definitions: true,\n  properties: true,\n  patternProperties: true,\n  dependencies: true\n};\n\ntraverse.skipKeywords = {\n  default: true,\n  enum: true,\n  const: true,\n  required: true,\n  maximum: true,\n  minimum: true,\n  exclusiveMaximum: true,\n  exclusiveMinimum: true,\n  multipleOf: true,\n  maxLength: true,\n  minLength: true,\n  pattern: true,\n  format: true,\n  maxItems: true,\n  minItems: true,\n  uniqueItems: true,\n  maxProperties: true,\n  minProperties: true\n};\n\n\nfunction _traverse(opts, pre, post, schema, jsonPtr, rootSchema, parentJsonPtr, parentKeyword, parentSchema, keyIndex) {\n  if (schema && typeof schema == 'object' && !Array.isArray(schema)) {\n    pre(schema, jsonPtr, rootSchema, parentJsonPtr, parentKeyword, parentSchema, keyIndex);\n    for (var key in schema) {\n      var sch = schema[key];\n      if (Array.isArray(sch)) {\n        if (key in traverse.arrayKeywords) {\n          for (var i=0; i<sch.length; i++)\n            _traverse(opts, pre, post, sch[i], jsonPtr + '/' + key + '/' + i, rootSchema, jsonPtr, key, schema, i);\n        }\n      } else if (key in traverse.propsKeywords) {\n        if (sch && typeof sch == 'object') {\n          for (var prop in sch)\n            _traverse(opts, pre, post, sch[prop], jsonPtr + '/' + key + '/' + escapeJsonPtr(prop), rootSchema, jsonPtr, key, schema, prop);\n        }\n      } else if (key in traverse.keywords || (opts.allKeys && !(key in traverse.skipKeywords))) {\n        _traverse(opts, pre, post, sch, jsonPtr + '/' + key, rootSchema, jsonPtr, key, schema);\n      }\n    }\n    post(schema, jsonPtr, rootSchema, parentJsonPtr, parentKeyword, parentSchema, keyIndex);\n  }\n}\n\n\nfunction escapeJsonPtr(str) {\n  return str.replace(/~/g, '~0').replace(/\\//g, '~1');\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getSchemaRefs = exports.resolveUrl = exports.normalizeId = exports._getFullPath = exports.getFullPath = exports.inlineRef = void 0;\nconst util_1 = require(\"./util\");\nconst equal = require(\"fast-deep-equal\");\nconst traverse = require(\"json-schema-traverse\");\n// TODO refactor to use keyword definitions\nconst SIMPLE_INLINED = new Set([\n    \"type\",\n    \"format\",\n    \"pattern\",\n    \"maxLength\",\n    \"minLength\",\n    \"maxProperties\",\n    \"minProperties\",\n    \"maxItems\",\n    \"minItems\",\n    \"maximum\",\n    \"minimum\",\n    \"uniqueItems\",\n    \"multipleOf\",\n    \"required\",\n    \"enum\",\n    \"const\",\n]);\nfunction inlineRef(schema, limit = true) {\n    if (typeof schema == \"boolean\")\n        return true;\n    if (limit === true)\n        return !hasRef(schema);\n    if (!limit)\n        return false;\n    return countKeys(schema) <= limit;\n}\nexports.inlineRef = inlineRef;\nconst REF_KEYWORDS = new Set([\n    \"$ref\",\n    \"$recursiveRef\",\n    \"$recursiveAnchor\",\n    \"$dynamicRef\",\n    \"$dynamicAnchor\",\n]);\nfunction hasRef(schema) {\n    for (const key in schema) {\n        if (REF_KEYWORDS.has(key))\n            return true;\n        const sch = schema[key];\n        if (Array.isArray(sch) && sch.some(hasRef))\n            return true;\n        if (typeof sch == \"object\" && hasRef(sch))\n            return true;\n    }\n    return false;\n}\nfunction countKeys(schema) {\n    let count = 0;\n    for (const key in schema) {\n        if (key === \"$ref\")\n            return Infinity;\n        count++;\n        if (SIMPLE_INLINED.has(key))\n            continue;\n        if (typeof schema[key] == \"object\") {\n            (0, util_1.eachItem)(schema[key], (sch) => (count += countKeys(sch)));\n        }\n        if (count === Infinity)\n            return Infinity;\n    }\n    return count;\n}\nfunction getFullPath(resolver, id = \"\", normalize) {\n    if (normalize !== false)\n        id = normalizeId(id);\n    const p = resolver.parse(id);\n    return _getFullPath(resolver, p);\n}\nexports.getFullPath = getFullPath;\nfunction _getFullPath(resolver, p) {\n    const serialized = resolver.serialize(p);\n    return serialized.split(\"#\")[0] + \"#\";\n}\nexports._getFullPath = _getFullPath;\nconst TRAILING_SLASH_HASH = /#\\/?$/;\nfunction normalizeId(id) {\n    return id ? id.replace(TRAILING_SLASH_HASH, \"\") : \"\";\n}\nexports.normalizeId = normalizeId;\nfunction resolveUrl(resolver, baseId, id) {\n    id = normalizeId(id);\n    return resolver.resolve(baseId, id);\n}\nexports.resolveUrl = resolveUrl;\nconst ANCHOR = /^[a-z_][-a-z0-9._]*$/i;\nfunction getSchemaRefs(schema, baseId) {\n    if (typeof schema == \"boolean\")\n        return {};\n    const { schemaId, uriResolver } = this.opts;\n    const schId = normalizeId(schema[schemaId] || baseId);\n    const baseIds = { \"\": schId };\n    const pathPrefix = getFullPath(uriResolver, schId, false);\n    const localRefs = {};\n    const schemaRefs = new Set();\n    traverse(schema, { allKeys: true }, (sch, jsonPtr, _, parentJsonPtr) => {\n        if (parentJsonPtr === undefined)\n            return;\n        const fullPath = pathPrefix + jsonPtr;\n        let innerBaseId = baseIds[parentJsonPtr];\n        if (typeof sch[schemaId] == \"string\")\n            innerBaseId = addRef.call(this, sch[schemaId]);\n        addAnchor.call(this, sch.$anchor);\n        addAnchor.call(this, sch.$dynamicAnchor);\n        baseIds[jsonPtr] = innerBaseId;\n        function addRef(ref) {\n            // eslint-disable-next-line @typescript-eslint/unbound-method\n            const _resolve = this.opts.uriResolver.resolve;\n            ref = normalizeId(innerBaseId ? _resolve(innerBaseId, ref) : ref);\n            if (schemaRefs.has(ref))\n                throw ambiguos(ref);\n            schemaRefs.add(ref);\n            let schOrRef = this.refs[ref];\n            if (typeof schOrRef == \"string\")\n                schOrRef = this.refs[schOrRef];\n            if (typeof schOrRef == \"object\") {\n                checkAmbiguosRef(sch, schOrRef.schema, ref);\n            }\n            else if (ref !== normalizeId(fullPath)) {\n                if (ref[0] === \"#\") {\n                    checkAmbiguosRef(sch, localRefs[ref], ref);\n                    localRefs[ref] = sch;\n                }\n                else {\n                    this.refs[ref] = fullPath;\n                }\n            }\n            return ref;\n        }\n        function addAnchor(anchor) {\n            if (typeof anchor == \"string\") {\n                if (!ANCHOR.test(anchor))\n                    throw new Error(`invalid anchor \"${anchor}\"`);\n                addRef.call(this, `#${anchor}`);\n            }\n        }\n    });\n    return localRefs;\n    function checkAmbiguosRef(sch1, sch2, ref) {\n        if (sch2 !== undefined && !equal(sch1, sch2))\n            throw ambiguos(ref);\n    }\n    function ambiguos(ref) {\n        return new Error(`reference \"${ref}\" resolves to more than one schema`);\n    }\n}\nexports.getSchemaRefs = getSchemaRefs;\n//# sourceMappingURL=resolve.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getData = exports.KeywordCxt = exports.validateFunctionCode = void 0;\nconst boolSchema_1 = require(\"./boolSchema\");\nconst dataType_1 = require(\"./dataType\");\nconst applicability_1 = require(\"./applicability\");\nconst dataType_2 = require(\"./dataType\");\nconst defaults_1 = require(\"./defaults\");\nconst keyword_1 = require(\"./keyword\");\nconst subschema_1 = require(\"./subschema\");\nconst codegen_1 = require(\"../codegen\");\nconst names_1 = require(\"../names\");\nconst resolve_1 = require(\"../resolve\");\nconst util_1 = require(\"../util\");\nconst errors_1 = require(\"../errors\");\n// schema compilation - generates validation function, subschemaCode (below) is used for subschemas\nfunction validateFunctionCode(it) {\n    if (isSchemaObj(it)) {\n        checkKeywords(it);\n        if (schemaCxtHasRules(it)) {\n            topSchemaObjCode(it);\n            return;\n        }\n    }\n    validateFunction(it, () => (0, boolSchema_1.topBoolOrEmptySchema)(it));\n}\nexports.validateFunctionCode = validateFunctionCode;\nfunction validateFunction({ gen, validateName, schema, schemaEnv, opts }, body) {\n    if (opts.code.es5) {\n        gen.func(validateName, (0, codegen_1._) `${names_1.default.data}, ${names_1.default.valCxt}`, schemaEnv.$async, () => {\n            gen.code((0, codegen_1._) `\"use strict\"; ${funcSourceUrl(schema, opts)}`);\n            destructureValCxtES5(gen, opts);\n            gen.code(body);\n        });\n    }\n    else {\n        gen.func(validateName, (0, codegen_1._) `${names_1.default.data}, ${destructureValCxt(opts)}`, schemaEnv.$async, () => gen.code(funcSourceUrl(schema, opts)).code(body));\n    }\n}\nfunction destructureValCxt(opts) {\n    return (0, codegen_1._) `{${names_1.default.instancePath}=\"\", ${names_1.default.parentData}, ${names_1.default.parentDataProperty}, ${names_1.default.rootData}=${names_1.default.data}${opts.dynamicRef ? (0, codegen_1._) `, ${names_1.default.dynamicAnchors}={}` : codegen_1.nil}}={}`;\n}\nfunction destructureValCxtES5(gen, opts) {\n    gen.if(names_1.default.valCxt, () => {\n        gen.var(names_1.default.instancePath, (0, codegen_1._) `${names_1.default.valCxt}.${names_1.default.instancePath}`);\n        gen.var(names_1.default.parentData, (0, codegen_1._) `${names_1.default.valCxt}.${names_1.default.parentData}`);\n        gen.var(names_1.default.parentDataProperty, (0, codegen_1._) `${names_1.default.valCxt}.${names_1.default.parentDataProperty}`);\n        gen.var(names_1.default.rootData, (0, codegen_1._) `${names_1.default.valCxt}.${names_1.default.rootData}`);\n        if (opts.dynamicRef)\n            gen.var(names_1.default.dynamicAnchors, (0, codegen_1._) `${names_1.default.valCxt}.${names_1.default.dynamicAnchors}`);\n    }, () => {\n        gen.var(names_1.default.instancePath, (0, codegen_1._) `\"\"`);\n        gen.var(names_1.default.parentData, (0, codegen_1._) `undefined`);\n        gen.var(names_1.default.parentDataProperty, (0, codegen_1._) `undefined`);\n        gen.var(names_1.default.rootData, names_1.default.data);\n        if (opts.dynamicRef)\n            gen.var(names_1.default.dynamicAnchors, (0, codegen_1._) `{}`);\n    });\n}\nfunction topSchemaObjCode(it) {\n    const { schema, opts, gen } = it;\n    validateFunction(it, () => {\n        if (opts.$comment && schema.$comment)\n            commentKeyword(it);\n        checkNoDefault(it);\n        gen.let(names_1.default.vErrors, null);\n        gen.let(names_1.default.errors, 0);\n        if (opts.unevaluated)\n            resetEvaluated(it);\n        typeAndKeywords(it);\n        returnResults(it);\n    });\n    return;\n}\nfunction resetEvaluated(it) {\n    // TODO maybe some hook to execute it in the end to check whether props/items are Name, as in assignEvaluated\n    const { gen, validateName } = it;\n    it.evaluated = gen.const(\"evaluated\", (0, codegen_1._) `${validateName}.evaluated`);\n    gen.if((0, codegen_1._) `${it.evaluated}.dynamicProps`, () => gen.assign((0, codegen_1._) `${it.evaluated}.props`, (0, codegen_1._) `undefined`));\n    gen.if((0, codegen_1._) `${it.evaluated}.dynamicItems`, () => gen.assign((0, codegen_1._) `${it.evaluated}.items`, (0, codegen_1._) `undefined`));\n}\nfunction funcSourceUrl(schema, opts) {\n    const schId = typeof schema == \"object\" && schema[opts.schemaId];\n    return schId && (opts.code.source || opts.code.process) ? (0, codegen_1._) `/*# sourceURL=${schId} */` : codegen_1.nil;\n}\n// schema compilation - this function is used recursively to generate code for sub-schemas\nfunction subschemaCode(it, valid) {\n    if (isSchemaObj(it)) {\n        checkKeywords(it);\n        if (schemaCxtHasRules(it)) {\n            subSchemaObjCode(it, valid);\n            return;\n        }\n    }\n    (0, boolSchema_1.boolOrEmptySchema)(it, valid);\n}\nfunction schemaCxtHasRules({ schema, self }) {\n    if (typeof schema == \"boolean\")\n        return !schema;\n    for (const key in schema)\n        if (self.RULES.all[key])\n            return true;\n    return false;\n}\nfunction isSchemaObj(it) {\n    return typeof it.schema != \"boolean\";\n}\nfunction subSchemaObjCode(it, valid) {\n    const { schema, gen, opts } = it;\n    if (opts.$comment && schema.$comment)\n        commentKeyword(it);\n    updateContext(it);\n    checkAsyncSchema(it);\n    const errsCount = gen.const(\"_errs\", names_1.default.errors);\n    typeAndKeywords(it, errsCount);\n    // TODO var\n    gen.var(valid, (0, codegen_1._) `${errsCount} === ${names_1.default.errors}`);\n}\nfunction checkKeywords(it) {\n    (0, util_1.checkUnknownRules)(it);\n    checkRefsAndKeywords(it);\n}\nfunction typeAndKeywords(it, errsCount) {\n    if (it.opts.jtd)\n        return schemaKeywords(it, [], false, errsCount);\n    const types = (0, dataType_1.getSchemaTypes)(it.schema);\n    const checkedTypes = (0, dataType_1.coerceAndCheckDataType)(it, types);\n    schemaKeywords(it, types, !checkedTypes, errsCount);\n}\nfunction checkRefsAndKeywords(it) {\n    const { schema, errSchemaPath, opts, self } = it;\n    if (schema.$ref && opts.ignoreKeywordsWithRef && (0, util_1.schemaHasRulesButRef)(schema, self.RULES)) {\n        self.logger.warn(`$ref: keywords ignored in schema at path \"${errSchemaPath}\"`);\n    }\n}\nfunction checkNoDefault(it) {\n    const { schema, opts } = it;\n    if (schema.default !== undefined && opts.useDefaults && opts.strictSchema) {\n        (0, util_1.checkStrictMode)(it, \"default is ignored in the schema root\");\n    }\n}\nfunction updateContext(it) {\n    const schId = it.schema[it.opts.schemaId];\n    if (schId)\n        it.baseId = (0, resolve_1.resolveUrl)(it.opts.uriResolver, it.baseId, schId);\n}\nfunction checkAsyncSchema(it) {\n    if (it.schema.$async && !it.schemaEnv.$async)\n        throw new Error(\"async schema in sync schema\");\n}\nfunction commentKeyword({ gen, schemaEnv, schema, errSchemaPath, opts }) {\n    const msg = schema.$comment;\n    if (opts.$comment === true) {\n        gen.code((0, codegen_1._) `${names_1.default.self}.logger.log(${msg})`);\n    }\n    else if (typeof opts.$comment == \"function\") {\n        const schemaPath = (0, codegen_1.str) `${errSchemaPath}/$comment`;\n        const rootName = gen.scopeValue(\"root\", { ref: schemaEnv.root });\n        gen.code((0, codegen_1._) `${names_1.default.self}.opts.$comment(${msg}, ${schemaPath}, ${rootName}.schema)`);\n    }\n}\nfunction returnResults(it) {\n    const { gen, schemaEnv, validateName, ValidationError, opts } = it;\n    if (schemaEnv.$async) {\n        // TODO assign unevaluated\n        gen.if((0, codegen_1._) `${names_1.default.errors} === 0`, () => gen.return(names_1.default.data), () => gen.throw((0, codegen_1._) `new ${ValidationError}(${names_1.default.vErrors})`));\n    }\n    else {\n        gen.assign((0, codegen_1._) `${validateName}.errors`, names_1.default.vErrors);\n        if (opts.unevaluated)\n            assignEvaluated(it);\n        gen.return((0, codegen_1._) `${names_1.default.errors} === 0`);\n    }\n}\nfunction assignEvaluated({ gen, evaluated, props, items }) {\n    if (props instanceof codegen_1.Name)\n        gen.assign((0, codegen_1._) `${evaluated}.props`, props);\n    if (items instanceof codegen_1.Name)\n        gen.assign((0, codegen_1._) `${evaluated}.items`, items);\n}\nfunction schemaKeywords(it, types, typeErrors, errsCount) {\n    const { gen, schema, data, allErrors, opts, self } = it;\n    const { RULES } = self;\n    if (schema.$ref && (opts.ignoreKeywordsWithRef || !(0, util_1.schemaHasRulesButRef)(schema, RULES))) {\n        gen.block(() => keywordCode(it, \"$ref\", RULES.all.$ref.definition)); // TODO typecast\n        return;\n    }\n    if (!opts.jtd)\n        checkStrictTypes(it, types);\n    gen.block(() => {\n        for (const group of RULES.rules)\n            groupKeywords(group);\n        groupKeywords(RULES.post);\n    });\n    function groupKeywords(group) {\n        if (!(0, applicability_1.shouldUseGroup)(schema, group))\n            return;\n        if (group.type) {\n            gen.if((0, dataType_2.checkDataType)(group.type, data, opts.strictNumbers));\n            iterateKeywords(it, group);\n            if (types.length === 1 && types[0] === group.type && typeErrors) {\n                gen.else();\n                (0, dataType_2.reportTypeError)(it);\n            }\n            gen.endIf();\n        }\n        else {\n            iterateKeywords(it, group);\n        }\n        // TODO make it \"ok\" call?\n        if (!allErrors)\n            gen.if((0, codegen_1._) `${names_1.default.errors} === ${errsCount || 0}`);\n    }\n}\nfunction iterateKeywords(it, group) {\n    const { gen, schema, opts: { useDefaults }, } = it;\n    if (useDefaults)\n        (0, defaults_1.assignDefaults)(it, group.type);\n    gen.block(() => {\n        for (const rule of group.rules) {\n            if ((0, applicability_1.shouldUseRule)(schema, rule)) {\n                keywordCode(it, rule.keyword, rule.definition, group.type);\n            }\n        }\n    });\n}\nfunction checkStrictTypes(it, types) {\n    if (it.schemaEnv.meta || !it.opts.strictTypes)\n        return;\n    checkContextTypes(it, types);\n    if (!it.opts.allowUnionTypes)\n        checkMultipleTypes(it, types);\n    checkKeywordTypes(it, it.dataTypes);\n}\nfunction checkContextTypes(it, types) {\n    if (!types.length)\n        return;\n    if (!it.dataTypes.length) {\n        it.dataTypes = types;\n        return;\n    }\n    types.forEach((t) => {\n        if (!includesType(it.dataTypes, t)) {\n            strictTypesError(it, `type \"${t}\" not allowed by context \"${it.dataTypes.join(\",\")}\"`);\n        }\n    });\n    narrowSchemaTypes(it, types);\n}\nfunction checkMultipleTypes(it, ts) {\n    if (ts.length > 1 && !(ts.length === 2 && ts.includes(\"null\"))) {\n        strictTypesError(it, \"use allowUnionTypes to allow union type keyword\");\n    }\n}\nfunction checkKeywordTypes(it, ts) {\n    const rules = it.self.RULES.all;\n    for (const keyword in rules) {\n        const rule = rules[keyword];\n        if (typeof rule == \"object\" && (0, applicability_1.shouldUseRule)(it.schema, rule)) {\n            const { type } = rule.definition;\n            if (type.length && !type.some((t) => hasApplicableType(ts, t))) {\n                strictTypesError(it, `missing type \"${type.join(\",\")}\" for keyword \"${keyword}\"`);\n            }\n        }\n    }\n}\nfunction hasApplicableType(schTs, kwdT) {\n    return schTs.includes(kwdT) || (kwdT === \"number\" && schTs.includes(\"integer\"));\n}\nfunction includesType(ts, t) {\n    return ts.includes(t) || (t === \"integer\" && ts.includes(\"number\"));\n}\nfunction narrowSchemaTypes(it, withTypes) {\n    const ts = [];\n    for (const t of it.dataTypes) {\n        if (includesType(withTypes, t))\n            ts.push(t);\n        else if (withTypes.includes(\"integer\") && t === \"number\")\n            ts.push(\"integer\");\n    }\n    it.dataTypes = ts;\n}\nfunction strictTypesError(it, msg) {\n    const schemaPath = it.schemaEnv.baseId + it.errSchemaPath;\n    msg += ` at \"${schemaPath}\" (strictTypes)`;\n    (0, util_1.checkStrictMode)(it, msg, it.opts.strictTypes);\n}\nclass KeywordCxt {\n    constructor(it, def, keyword) {\n        (0, keyword_1.validateKeywordUsage)(it, def, keyword);\n        this.gen = it.gen;\n        this.allErrors = it.allErrors;\n        this.keyword = keyword;\n        this.data = it.data;\n        this.schema = it.schema[keyword];\n        this.$data = def.$data && it.opts.$data && this.schema && this.schema.$data;\n        this.schemaValue = (0, util_1.schemaRefOrVal)(it, this.schema, keyword, this.$data);\n        this.schemaType = def.schemaType;\n        this.parentSchema = it.schema;\n        this.params = {};\n        this.it = it;\n        this.def = def;\n        if (this.$data) {\n            this.schemaCode = it.gen.const(\"vSchema\", getData(this.$data, it));\n        }\n        else {\n            this.schemaCode = this.schemaValue;\n            if (!(0, keyword_1.validSchemaType)(this.schema, def.schemaType, def.allowUndefined)) {\n                throw new Error(`${keyword} value must be ${JSON.stringify(def.schemaType)}`);\n            }\n        }\n        if (\"code\" in def ? def.trackErrors : def.errors !== false) {\n            this.errsCount = it.gen.const(\"_errs\", names_1.default.errors);\n        }\n    }\n    result(condition, successAction, failAction) {\n        this.failResult((0, codegen_1.not)(condition), successAction, failAction);\n    }\n    failResult(condition, successAction, failAction) {\n        this.gen.if(condition);\n        if (failAction)\n            failAction();\n        else\n            this.error();\n        if (successAction) {\n            this.gen.else();\n            successAction();\n            if (this.allErrors)\n                this.gen.endIf();\n        }\n        else {\n            if (this.allErrors)\n                this.gen.endIf();\n            else\n                this.gen.else();\n        }\n    }\n    pass(condition, failAction) {\n        this.failResult((0, codegen_1.not)(condition), undefined, failAction);\n    }\n    fail(condition) {\n        if (condition === undefined) {\n            this.error();\n            if (!this.allErrors)\n                this.gen.if(false); // this branch will be removed by gen.optimize\n            return;\n        }\n        this.gen.if(condition);\n        this.error();\n        if (this.allErrors)\n            this.gen.endIf();\n        else\n            this.gen.else();\n    }\n    fail$data(condition) {\n        if (!this.$data)\n            return this.fail(condition);\n        const { schemaCode } = this;\n        this.fail((0, codegen_1._) `${schemaCode} !== undefined && (${(0, codegen_1.or)(this.invalid$data(), condition)})`);\n    }\n    error(append, errorParams, errorPaths) {\n        if (errorParams) {\n            this.setParams(errorParams);\n            this._error(append, errorPaths);\n            this.setParams({});\n            return;\n        }\n        this._error(append, errorPaths);\n    }\n    _error(append, errorPaths) {\n        ;\n        (append ? errors_1.reportExtraError : errors_1.reportError)(this, this.def.error, errorPaths);\n    }\n    $dataError() {\n        (0, errors_1.reportError)(this, this.def.$dataError || errors_1.keyword$DataError);\n    }\n    reset() {\n        if (this.errsCount === undefined)\n            throw new Error('add \"trackErrors\" to keyword definition');\n        (0, errors_1.resetErrorsCount)(this.gen, this.errsCount);\n    }\n    ok(cond) {\n        if (!this.allErrors)\n            this.gen.if(cond);\n    }\n    setParams(obj, assign) {\n        if (assign)\n            Object.assign(this.params, obj);\n        else\n            this.params = obj;\n    }\n    block$data(valid, codeBlock, $dataValid = codegen_1.nil) {\n        this.gen.block(() => {\n            this.check$data(valid, $dataValid);\n            codeBlock();\n        });\n    }\n    check$data(valid = codegen_1.nil, $dataValid = codegen_1.nil) {\n        if (!this.$data)\n            return;\n        const { gen, schemaCode, schemaType, def } = this;\n        gen.if((0, codegen_1.or)((0, codegen_1._) `${schemaCode} === undefined`, $dataValid));\n        if (valid !== codegen_1.nil)\n            gen.assign(valid, true);\n        if (schemaType.length || def.validateSchema) {\n            gen.elseIf(this.invalid$data());\n            this.$dataError();\n            if (valid !== codegen_1.nil)\n                gen.assign(valid, false);\n        }\n        gen.else();\n    }\n    invalid$data() {\n        const { gen, schemaCode, schemaType, def, it } = this;\n        return (0, codegen_1.or)(wrong$DataType(), invalid$DataSchema());\n        function wrong$DataType() {\n            if (schemaType.length) {\n                /* istanbul ignore if */\n                if (!(schemaCode instanceof codegen_1.Name))\n                    throw new Error(\"ajv implementation error\");\n                const st = Array.isArray(schemaType) ? schemaType : [schemaType];\n                return (0, codegen_1._) `${(0, dataType_2.checkDataTypes)(st, schemaCode, it.opts.strictNumbers, dataType_2.DataType.Wrong)}`;\n            }\n            return codegen_1.nil;\n        }\n        function invalid$DataSchema() {\n            if (def.validateSchema) {\n                const validateSchemaRef = gen.scopeValue(\"validate$data\", { ref: def.validateSchema }); // TODO value.code for standalone\n                return (0, codegen_1._) `!${validateSchemaRef}(${schemaCode})`;\n            }\n            return codegen_1.nil;\n        }\n    }\n    subschema(appl, valid) {\n        const subschema = (0, subschema_1.getSubschema)(this.it, appl);\n        (0, subschema_1.extendSubschemaData)(subschema, this.it, appl);\n        (0, subschema_1.extendSubschemaMode)(subschema, appl);\n        const nextContext = { ...this.it, ...subschema, items: undefined, props: undefined };\n        subschemaCode(nextContext, valid);\n        return nextContext;\n    }\n    mergeEvaluated(schemaCxt, toName) {\n        const { it, gen } = this;\n        if (!it.opts.unevaluated)\n            return;\n        if (it.props !== true && schemaCxt.props !== undefined) {\n            it.props = util_1.mergeEvaluated.props(gen, schemaCxt.props, it.props, toName);\n        }\n        if (it.items !== true && schemaCxt.items !== undefined) {\n            it.items = util_1.mergeEvaluated.items(gen, schemaCxt.items, it.items, toName);\n        }\n    }\n    mergeValidEvaluated(schemaCxt, valid) {\n        const { it, gen } = this;\n        if (it.opts.unevaluated && (it.props !== true || it.items !== true)) {\n            gen.if(valid, () => this.mergeEvaluated(schemaCxt, codegen_1.Name));\n            return true;\n        }\n    }\n}\nexports.KeywordCxt = KeywordCxt;\nfunction keywordCode(it, keyword, def, ruleType) {\n    const cxt = new KeywordCxt(it, def, keyword);\n    if (\"code\" in def) {\n        def.code(cxt, ruleType);\n    }\n    else if (cxt.$data && def.validate) {\n        (0, keyword_1.funcKeywordCode)(cxt, def);\n    }\n    else if (\"macro\" in def) {\n        (0, keyword_1.macroKeywordCode)(cxt, def);\n    }\n    else if (def.compile || def.validate) {\n        (0, keyword_1.funcKeywordCode)(cxt, def);\n    }\n}\nconst JSON_POINTER = /^\\/(?:[^~]|~0|~1)*$/;\nconst RELATIVE_JSON_POINTER = /^([0-9]+)(#|\\/(?:[^~]|~0|~1)*)?$/;\nfunction getData($data, { dataLevel, dataNames, dataPathArr }) {\n    let jsonPointer;\n    let data;\n    if ($data === \"\")\n        return names_1.default.rootData;\n    if ($data[0] === \"/\") {\n        if (!JSON_POINTER.test($data))\n            throw new Error(`Invalid JSON-pointer: ${$data}`);\n        jsonPointer = $data;\n        data = names_1.default.rootData;\n    }\n    else {\n        const matches = RELATIVE_JSON_POINTER.exec($data);\n        if (!matches)\n            throw new Error(`Invalid JSON-pointer: ${$data}`);\n        const up = +matches[1];\n        jsonPointer = matches[2];\n        if (jsonPointer === \"#\") {\n            if (up >= dataLevel)\n                throw new Error(errorMsg(\"property/index\", up));\n            return dataPathArr[dataLevel - up];\n        }\n        if (up > dataLevel)\n            throw new Error(errorMsg(\"data\", up));\n        data = dataNames[dataLevel - up];\n        if (!jsonPointer)\n            return data;\n    }\n    let expr = data;\n    const segments = jsonPointer.split(\"/\");\n    for (const segment of segments) {\n        if (segment) {\n            data = (0, codegen_1._) `${data}${(0, codegen_1.getProperty)((0, util_1.unescapeJsonPointer)(segment))}`;\n            expr = (0, codegen_1._) `${expr} && ${data}`;\n        }\n    }\n    return expr;\n    function errorMsg(pointerType, up) {\n        return `Cannot access ${pointerType} ${up} levels up, current level is ${dataLevel}`;\n    }\n}\nexports.getData = getData;\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nclass ValidationError extends Error {\n    constructor(errors) {\n        super(\"validation failed\");\n        this.errors = errors;\n        this.ajv = this.validation = true;\n    }\n}\nexports.default = ValidationError;\n//# sourceMappingURL=validation_error.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst resolve_1 = require(\"./resolve\");\nclass MissingRefError extends Error {\n    constructor(resolver, baseId, ref, msg) {\n        super(msg || `can't resolve reference ${ref} from id ${baseId}`);\n        this.missingRef = (0, resolve_1.resolveUrl)(resolver, baseId, ref);\n        this.missingSchema = (0, resolve_1.normalizeId)((0, resolve_1.getFullPath)(resolver, this.missingRef));\n    }\n}\nexports.default = MissingRefError;\n//# sourceMappingURL=ref_error.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.resolveSchema = exports.getCompilingSchema = exports.resolveRef = exports.compileSchema = exports.SchemaEnv = void 0;\nconst codegen_1 = require(\"./codegen\");\nconst validation_error_1 = require(\"../runtime/validation_error\");\nconst names_1 = require(\"./names\");\nconst resolve_1 = require(\"./resolve\");\nconst util_1 = require(\"./util\");\nconst validate_1 = require(\"./validate\");\nclass SchemaEnv {\n    constructor(env) {\n        var _a;\n        this.refs = {};\n        this.dynamicAnchors = {};\n        let schema;\n        if (typeof env.schema == \"object\")\n            schema = env.schema;\n        this.schema = env.schema;\n        this.schemaId = env.schemaId;\n        this.root = env.root || this;\n        this.baseId = (_a = env.baseId) !== null && _a !== void 0 ? _a : (0, resolve_1.normalizeId)(schema === null || schema === void 0 ? void 0 : schema[env.schemaId || \"$id\"]);\n        this.schemaPath = env.schemaPath;\n        this.localRefs = env.localRefs;\n        this.meta = env.meta;\n        this.$async = schema === null || schema === void 0 ? void 0 : schema.$async;\n        this.refs = {};\n    }\n}\nexports.SchemaEnv = SchemaEnv;\n// let codeSize = 0\n// let nodeCount = 0\n// Compiles schema in SchemaEnv\nfunction compileSchema(sch) {\n    // TODO refactor - remove compilations\n    const _sch = getCompilingSchema.call(this, sch);\n    if (_sch)\n        return _sch;\n    const rootId = (0, resolve_1.getFullPath)(this.opts.uriResolver, sch.root.baseId); // TODO if getFullPath removed 1 tests fails\n    const { es5, lines } = this.opts.code;\n    const { ownProperties } = this.opts;\n    const gen = new codegen_1.CodeGen(this.scope, { es5, lines, ownProperties });\n    let _ValidationError;\n    if (sch.$async) {\n        _ValidationError = gen.scopeValue(\"Error\", {\n            ref: validation_error_1.default,\n            code: (0, codegen_1._) `require(\"ajv/dist/runtime/validation_error\").default`,\n        });\n    }\n    const validateName = gen.scopeName(\"validate\");\n    sch.validateName = validateName;\n    const schemaCxt = {\n        gen,\n        allErrors: this.opts.allErrors,\n        data: names_1.default.data,\n        parentData: names_1.default.parentData,\n        parentDataProperty: names_1.default.parentDataProperty,\n        dataNames: [names_1.default.data],\n        dataPathArr: [codegen_1.nil], // TODO can its length be used as dataLevel if nil is removed?\n        dataLevel: 0,\n        dataTypes: [],\n        definedProperties: new Set(),\n        topSchemaRef: gen.scopeValue(\"schema\", this.opts.code.source === true\n            ? { ref: sch.schema, code: (0, codegen_1.stringify)(sch.schema) }\n            : { ref: sch.schema }),\n        validateName,\n        ValidationError: _ValidationError,\n        schema: sch.schema,\n        schemaEnv: sch,\n        rootId,\n        baseId: sch.baseId || rootId,\n        schemaPath: codegen_1.nil,\n        errSchemaPath: sch.schemaPath || (this.opts.jtd ? \"\" : \"#\"),\n        errorPath: (0, codegen_1._) `\"\"`,\n        opts: this.opts,\n        self: this,\n    };\n    let sourceCode;\n    try {\n        this._compilations.add(sch);\n        (0, validate_1.validateFunctionCode)(schemaCxt);\n        gen.optimize(this.opts.code.optimize);\n        // gen.optimize(1)\n        const validateCode = gen.toString();\n        sourceCode = `${gen.scopeRefs(names_1.default.scope)}return ${validateCode}`;\n        // console.log((codeSize += sourceCode.length), (nodeCount += gen.nodeCount))\n        if (this.opts.code.process)\n            sourceCode = this.opts.code.process(sourceCode, sch);\n        // console.log(\"\\n\\n\\n *** \\n\", sourceCode)\n        const makeValidate = new Function(`${names_1.default.self}`, `${names_1.default.scope}`, sourceCode);\n        const validate = makeValidate(this, this.scope.get());\n        this.scope.value(validateName, { ref: validate });\n        validate.errors = null;\n        validate.schema = sch.schema;\n        validate.schemaEnv = sch;\n        if (sch.$async)\n            validate.$async = true;\n        if (this.opts.code.source === true) {\n            validate.source = { validateName, validateCode, scopeValues: gen._values };\n        }\n        if (this.opts.unevaluated) {\n            const { props, items } = schemaCxt;\n            validate.evaluated = {\n                props: props instanceof codegen_1.Name ? undefined : props,\n                items: items instanceof codegen_1.Name ? undefined : items,\n                dynamicProps: props instanceof codegen_1.Name,\n                dynamicItems: items instanceof codegen_1.Name,\n            };\n            if (validate.source)\n                validate.source.evaluated = (0, codegen_1.stringify)(validate.evaluated);\n        }\n        sch.validate = validate;\n        return sch;\n    }\n    catch (e) {\n        delete sch.validate;\n        delete sch.validateName;\n        if (sourceCode)\n            this.logger.error(\"Error compiling schema, function code:\", sourceCode);\n        // console.log(\"\\n\\n\\n *** \\n\", sourceCode, this.opts)\n        throw e;\n    }\n    finally {\n        this._compilations.delete(sch);\n    }\n}\nexports.compileSchema = compileSchema;\nfunction resolveRef(root, baseId, ref) {\n    var _a;\n    ref = (0, resolve_1.resolveUrl)(this.opts.uriResolver, baseId, ref);\n    const schOrFunc = root.refs[ref];\n    if (schOrFunc)\n        return schOrFunc;\n    let _sch = resolve.call(this, root, ref);\n    if (_sch === undefined) {\n        const schema = (_a = root.localRefs) === null || _a === void 0 ? void 0 : _a[ref]; // TODO maybe localRefs should hold SchemaEnv\n        const { schemaId } = this.opts;\n        if (schema)\n            _sch = new SchemaEnv({ schema, schemaId, root, baseId });\n    }\n    if (_sch === undefined)\n        return;\n    return (root.refs[ref] = inlineOrCompile.call(this, _sch));\n}\nexports.resolveRef = resolveRef;\nfunction inlineOrCompile(sch) {\n    if ((0, resolve_1.inlineRef)(sch.schema, this.opts.inlineRefs))\n        return sch.schema;\n    return sch.validate ? sch : compileSchema.call(this, sch);\n}\n// Index of schema compilation in the currently compiled list\nfunction getCompilingSchema(schEnv) {\n    for (const sch of this._compilations) {\n        if (sameSchemaEnv(sch, schEnv))\n            return sch;\n    }\n}\nexports.getCompilingSchema = getCompilingSchema;\nfunction sameSchemaEnv(s1, s2) {\n    return s1.schema === s2.schema && s1.root === s2.root && s1.baseId === s2.baseId;\n}\n// resolve and compile the references ($ref)\n// TODO returns AnySchemaObject (if the schema can be inlined) or validation function\nfunction resolve(root, // information about the root schema for the current schema\nref // reference to resolve\n) {\n    let sch;\n    while (typeof (sch = this.refs[ref]) == \"string\")\n        ref = sch;\n    return sch || this.schemas[ref] || resolveSchema.call(this, root, ref);\n}\n// Resolve schema, its root and baseId\nfunction resolveSchema(root, // root object with properties schema, refs TODO below SchemaEnv is assigned to it\nref // reference to resolve\n) {\n    const p = this.opts.uriResolver.parse(ref);\n    const refPath = (0, resolve_1._getFullPath)(this.opts.uriResolver, p);\n    let baseId = (0, resolve_1.getFullPath)(this.opts.uriResolver, root.baseId, undefined);\n    // TODO `Object.keys(root.schema).length > 0` should not be needed - but removing breaks 2 tests\n    if (Object.keys(root.schema).length > 0 && refPath === baseId) {\n        return getJsonPointer.call(this, p, root);\n    }\n    const id = (0, resolve_1.normalizeId)(refPath);\n    const schOrRef = this.refs[id] || this.schemas[id];\n    if (typeof schOrRef == \"string\") {\n        const sch = resolveSchema.call(this, root, schOrRef);\n        if (typeof (sch === null || sch === void 0 ? void 0 : sch.schema) !== \"object\")\n            return;\n        return getJsonPointer.call(this, p, sch);\n    }\n    if (typeof (schOrRef === null || schOrRef === void 0 ? void 0 : schOrRef.schema) !== \"object\")\n        return;\n    if (!schOrRef.validate)\n        compileSchema.call(this, schOrRef);\n    if (id === (0, resolve_1.normalizeId)(ref)) {\n        const { schema } = schOrRef;\n        const { schemaId } = this.opts;\n        const schId = schema[schemaId];\n        if (schId)\n            baseId = (0, resolve_1.resolveUrl)(this.opts.uriResolver, baseId, schId);\n        return new SchemaEnv({ schema, schemaId, root, baseId });\n    }\n    return getJsonPointer.call(this, p, schOrRef);\n}\nexports.resolveSchema = resolveSchema;\nconst PREVENT_SCOPE_CHANGE = new Set([\n    \"properties\",\n    \"patternProperties\",\n    \"enum\",\n    \"dependencies\",\n    \"definitions\",\n]);\nfunction getJsonPointer(parsedRef, { baseId, schema, root }) {\n    var _a;\n    if (((_a = parsedRef.fragment) === null || _a === void 0 ? void 0 : _a[0]) !== \"/\")\n        return;\n    for (const part of parsedRef.fragment.slice(1).split(\"/\")) {\n        if (typeof schema === \"boolean\")\n            return;\n        const partSchema = schema[(0, util_1.unescapeFragment)(part)];\n        if (partSchema === undefined)\n            return;\n        schema = partSchema;\n        // TODO PREVENT_SCOPE_CHANGE could be defined in keyword def?\n        const schId = typeof schema === \"object\" && schema[this.opts.schemaId];\n        if (!PREVENT_SCOPE_CHANGE.has(part) && schId) {\n            baseId = (0, resolve_1.resolveUrl)(this.opts.uriResolver, baseId, schId);\n        }\n    }\n    let env;\n    if (typeof schema != \"boolean\" && schema.$ref && !(0, util_1.schemaHasRulesButRef)(schema, this.RULES)) {\n        const $ref = (0, resolve_1.resolveUrl)(this.opts.uriResolver, baseId, schema.$ref);\n        env = resolveSchema.call(this, root, $ref);\n    }\n    // even though resolution failed we need to return SchemaEnv to throw exception\n    // so that compileAsync loads missing schema.\n    const { schemaId } = this.opts;\n    env = env || new SchemaEnv({ schema, schemaId, root, baseId });\n    if (env.schema !== env.root.schema)\n        return env;\n    return undefined;\n}\n//# sourceMappingURL=index.js.map","'use strict'\n\n/** @type {(value: string) => boolean} */\nconst isUUID = RegExp.prototype.test.bind(/^[\\da-f]{8}-[\\da-f]{4}-[\\da-f]{4}-[\\da-f]{4}-[\\da-f]{12}$/iu)\n\n/** @type {(value: string) => boolean} */\nconst isIPv4 = RegExp.prototype.test.bind(/^(?:(?:25[0-5]|2[0-4]\\d|1\\d{2}|[1-9]\\d|\\d)\\.){3}(?:25[0-5]|2[0-4]\\d|1\\d{2}|[1-9]\\d|\\d)$/u)\n\n/**\n * @param {Array<string>} input\n * @returns {string}\n */\nfunction stringArrayToHexStripped (input) {\n  let acc = ''\n  let code = 0\n  let i = 0\n\n  for (i = 0; i < input.length; i++) {\n    code = input[i].charCodeAt(0)\n    if (code === 48) {\n      continue\n    }\n    if (!((code >= 48 && code <= 57) || (code >= 65 && code <= 70) || (code >= 97 && code <= 102))) {\n      return ''\n    }\n    acc += input[i]\n    break\n  }\n\n  for (i += 1; i < input.length; i++) {\n    code = input[i].charCodeAt(0)\n    if (!((code >= 48 && code <= 57) || (code >= 65 && code <= 70) || (code >= 97 && code <= 102))) {\n      return ''\n    }\n    acc += input[i]\n  }\n  return acc\n}\n\n/**\n * @typedef {Object} GetIPV6Result\n * @property {boolean} error - Indicates if there was an error parsing the IPv6 address.\n * @property {string} address - The parsed IPv6 address.\n * @property {string} [zone] - The zone identifier, if present.\n */\n\n/**\n * @param {string} value\n * @returns {boolean}\n */\nconst nonSimpleDomain = RegExp.prototype.test.bind(/[^!\"$&'()*+,\\-.;=_`a-z{}~]/u)\n\n/**\n * @param {Array<string>} buffer\n * @returns {boolean}\n */\nfunction consumeIsZone (buffer) {\n  buffer.length = 0\n  return true\n}\n\n/**\n * @param {Array<string>} buffer\n * @param {Array<string>} address\n * @param {GetIPV6Result} output\n * @returns {boolean}\n */\nfunction consumeHextets (buffer, address, output) {\n  if (buffer.length) {\n    const hex = stringArrayToHexStripped(buffer)\n    if (hex !== '') {\n      address.push(hex)\n    } else {\n      output.error = true\n      return false\n    }\n    buffer.length = 0\n  }\n  return true\n}\n\n/**\n * @param {string} input\n * @returns {GetIPV6Result}\n */\nfunction getIPV6 (input) {\n  let tokenCount = 0\n  const output = { error: false, address: '', zone: '' }\n  /** @type {Array<string>} */\n  const address = []\n  /** @type {Array<string>} */\n  const buffer = []\n  let endipv6Encountered = false\n  let endIpv6 = false\n\n  let consume = consumeHextets\n\n  for (let i = 0; i < input.length; i++) {\n    const cursor = input[i]\n    if (cursor === '[' || cursor === ']') { continue }\n    if (cursor === ':') {\n      if (endipv6Encountered === true) {\n        endIpv6 = true\n      }\n      if (!consume(buffer, address, output)) { break }\n      if (++tokenCount > 7) {\n        // not valid\n        output.error = true\n        break\n      }\n      if (i > 0 && input[i - 1] === ':') {\n        endipv6Encountered = true\n      }\n      address.push(':')\n      continue\n    } else if (cursor === '%') {\n      if (!consume(buffer, address, output)) { break }\n      // switch to zone detection\n      consume = consumeIsZone\n    } else {\n      buffer.push(cursor)\n      continue\n    }\n  }\n  if (buffer.length) {\n    if (consume === consumeIsZone) {\n      output.zone = buffer.join('')\n    } else if (endIpv6) {\n      address.push(buffer.join(''))\n    } else {\n      address.push(stringArrayToHexStripped(buffer))\n    }\n  }\n  output.address = address.join('')\n  return output\n}\n\n/**\n * @typedef {Object} NormalizeIPv6Result\n * @property {string} host - The normalized host.\n * @property {string} [escapedHost] - The escaped host.\n * @property {boolean} isIPV6 - Indicates if the host is an IPv6 address.\n */\n\n/**\n * @param {string} host\n * @returns {NormalizeIPv6Result}\n */\nfunction normalizeIPv6 (host) {\n  if (findToken(host, ':') < 2) { return { host, isIPV6: false } }\n  const ipv6 = getIPV6(host)\n\n  if (!ipv6.error) {\n    let newHost = ipv6.address\n    let escapedHost = ipv6.address\n    if (ipv6.zone) {\n      newHost += '%' + ipv6.zone\n      escapedHost += '%25' + ipv6.zone\n    }\n    return { host: newHost, isIPV6: true, escapedHost }\n  } else {\n    return { host, isIPV6: false }\n  }\n}\n\n/**\n * @param {string} str\n * @param {string} token\n * @returns {number}\n */\nfunction findToken (str, token) {\n  let ind = 0\n  for (let i = 0; i < str.length; i++) {\n    if (str[i] === token) ind++\n  }\n  return ind\n}\n\n/**\n * @param {string} path\n * @returns {string}\n *\n * @see https://datatracker.ietf.org/doc/html/rfc3986#section-5.2.4\n */\nfunction removeDotSegments (path) {\n  let input = path\n  const output = []\n  let nextSlash = -1\n  let len = 0\n\n  // eslint-disable-next-line no-cond-assign\n  while (len = input.length) {\n    if (len === 1) {\n      if (input === '.') {\n        break\n      } else if (input === '/') {\n        output.push('/')\n        break\n      } else {\n        output.push(input)\n        break\n      }\n    } else if (len === 2) {\n      if (input[0] === '.') {\n        if (input[1] === '.') {\n          break\n        } else if (input[1] === '/') {\n          input = input.slice(2)\n          continue\n        }\n      } else if (input[0] === '/') {\n        if (input[1] === '.' || input[1] === '/') {\n          output.push('/')\n          break\n        }\n      }\n    } else if (len === 3) {\n      if (input === '/..') {\n        if (output.length !== 0) {\n          output.pop()\n        }\n        output.push('/')\n        break\n      }\n    }\n    if (input[0] === '.') {\n      if (input[1] === '.') {\n        if (input[2] === '/') {\n          input = input.slice(3)\n          continue\n        }\n      } else if (input[1] === '/') {\n        input = input.slice(2)\n        continue\n      }\n    } else if (input[0] === '/') {\n      if (input[1] === '.') {\n        if (input[2] === '/') {\n          input = input.slice(2)\n          continue\n        } else if (input[2] === '.') {\n          if (input[3] === '/') {\n            input = input.slice(3)\n            if (output.length !== 0) {\n              output.pop()\n            }\n            continue\n          }\n        }\n      }\n    }\n\n    // Rule 2E: Move normal path segment to output\n    if ((nextSlash = input.indexOf('/', 1)) === -1) {\n      output.push(input)\n      break\n    } else {\n      output.push(input.slice(0, nextSlash))\n      input = input.slice(nextSlash)\n    }\n  }\n\n  return output.join('')\n}\n\n/**\n * @param {import('../types/index').URIComponent} component\n * @param {boolean} esc\n * @returns {import('../types/index').URIComponent}\n */\nfunction normalizeComponentEncoding (component, esc) {\n  const func = esc !== true ? escape : unescape\n  if (component.scheme !== undefined) {\n    component.scheme = func(component.scheme)\n  }\n  if (component.userinfo !== undefined) {\n    component.userinfo = func(component.userinfo)\n  }\n  if (component.host !== undefined) {\n    component.host = func(component.host)\n  }\n  if (component.path !== undefined) {\n    component.path = func(component.path)\n  }\n  if (component.query !== undefined) {\n    component.query = func(component.query)\n  }\n  if (component.fragment !== undefined) {\n    component.fragment = func(component.fragment)\n  }\n  return component\n}\n\n/**\n * @param {import('../types/index').URIComponent} component\n * @returns {string|undefined}\n */\nfunction recomposeAuthority (component) {\n  const uriTokens = []\n\n  if (component.userinfo !== undefined) {\n    uriTokens.push(component.userinfo)\n    uriTokens.push('@')\n  }\n\n  if (component.host !== undefined) {\n    let host = unescape(component.host)\n    if (!isIPv4(host)) {\n      const ipV6res = normalizeIPv6(host)\n      if (ipV6res.isIPV6 === true) {\n        host = `[${ipV6res.escapedHost}]`\n      } else {\n        host = component.host\n      }\n    }\n    uriTokens.push(host)\n  }\n\n  if (typeof component.port === 'number' || typeof component.port === 'string') {\n    uriTokens.push(':')\n    uriTokens.push(String(component.port))\n  }\n\n  return uriTokens.length ? uriTokens.join('') : undefined\n};\n\nmodule.exports = {\n  nonSimpleDomain,\n  recomposeAuthority,\n  normalizeComponentEncoding,\n  removeDotSegments,\n  isIPv4,\n  isUUID,\n  normalizeIPv6,\n  stringArrayToHexStripped\n}\n","'use strict'\n\nconst { isUUID } = require('./utils')\nconst URN_REG = /([\\da-z][\\d\\-a-z]{0,31}):((?:[\\w!$'()*+,\\-.:;=@]|%[\\da-f]{2})+)/iu\n\nconst supportedSchemeNames = /** @type {const} */ (['http', 'https', 'ws',\n  'wss', 'urn', 'urn:uuid'])\n\n/** @typedef {supportedSchemeNames[number]} SchemeName */\n\n/**\n * @param {string} name\n * @returns {name is SchemeName}\n */\nfunction isValidSchemeName (name) {\n  return supportedSchemeNames.indexOf(/** @type {*} */ (name)) !== -1\n}\n\n/**\n * @callback SchemeFn\n * @param {import('../types/index').URIComponent} component\n * @param {import('../types/index').Options} options\n * @returns {import('../types/index').URIComponent}\n */\n\n/**\n * @typedef {Object} SchemeHandler\n * @property {SchemeName} scheme - The scheme name.\n * @property {boolean} [domainHost] - Indicates if the scheme supports domain hosts.\n * @property {SchemeFn} parse - Function to parse the URI component for this scheme.\n * @property {SchemeFn} serialize - Function to serialize the URI component for this scheme.\n * @property {boolean} [skipNormalize] - Indicates if normalization should be skipped for this scheme.\n * @property {boolean} [absolutePath] - Indicates if the scheme uses absolute paths.\n * @property {boolean} [unicodeSupport] - Indicates if the scheme supports Unicode.\n */\n\n/**\n * @param {import('../types/index').URIComponent} wsComponent\n * @returns {boolean}\n */\nfunction wsIsSecure (wsComponent) {\n  if (wsComponent.secure === true) {\n    return true\n  } else if (wsComponent.secure === false) {\n    return false\n  } else if (wsComponent.scheme) {\n    return (\n      wsComponent.scheme.length === 3 &&\n      (wsComponent.scheme[0] === 'w' || wsComponent.scheme[0] === 'W') &&\n      (wsComponent.scheme[1] === 's' || wsComponent.scheme[1] === 'S') &&\n      (wsComponent.scheme[2] === 's' || wsComponent.scheme[2] === 'S')\n    )\n  } else {\n    return false\n  }\n}\n\n/** @type {SchemeFn} */\nfunction httpParse (component) {\n  if (!component.host) {\n    component.error = component.error || 'HTTP URIs must have a host.'\n  }\n\n  return component\n}\n\n/** @type {SchemeFn} */\nfunction httpSerialize (component) {\n  const secure = String(component.scheme).toLowerCase() === 'https'\n\n  // normalize the default port\n  if (component.port === (secure ? 443 : 80) || component.port === '') {\n    component.port = undefined\n  }\n\n  // normalize the empty path\n  if (!component.path) {\n    component.path = '/'\n  }\n\n  // NOTE: We do not parse query strings for HTTP URIs\n  // as WWW Form Url Encoded query strings are part of the HTML4+ spec,\n  // and not the HTTP spec.\n\n  return component\n}\n\n/** @type {SchemeFn} */\nfunction wsParse (wsComponent) {\n// indicate if the secure flag is set\n  wsComponent.secure = wsIsSecure(wsComponent)\n\n  // construct resouce name\n  wsComponent.resourceName = (wsComponent.path || '/') + (wsComponent.query ? '?' + wsComponent.query : '')\n  wsComponent.path = undefined\n  wsComponent.query = undefined\n\n  return wsComponent\n}\n\n/** @type {SchemeFn} */\nfunction wsSerialize (wsComponent) {\n// normalize the default port\n  if (wsComponent.port === (wsIsSecure(wsComponent) ? 443 : 80) || wsComponent.port === '') {\n    wsComponent.port = undefined\n  }\n\n  // ensure scheme matches secure flag\n  if (typeof wsComponent.secure === 'boolean') {\n    wsComponent.scheme = (wsComponent.secure ? 'wss' : 'ws')\n    wsComponent.secure = undefined\n  }\n\n  // reconstruct path from resource name\n  if (wsComponent.resourceName) {\n    const [path, query] = wsComponent.resourceName.split('?')\n    wsComponent.path = (path && path !== '/' ? path : undefined)\n    wsComponent.query = query\n    wsComponent.resourceName = undefined\n  }\n\n  // forbid fragment component\n  wsComponent.fragment = undefined\n\n  return wsComponent\n}\n\n/** @type {SchemeFn} */\nfunction urnParse (urnComponent, options) {\n  if (!urnComponent.path) {\n    urnComponent.error = 'URN can not be parsed'\n    return urnComponent\n  }\n  const matches = urnComponent.path.match(URN_REG)\n  if (matches) {\n    const scheme = options.scheme || urnComponent.scheme || 'urn'\n    urnComponent.nid = matches[1].toLowerCase()\n    urnComponent.nss = matches[2]\n    const urnScheme = `${scheme}:${options.nid || urnComponent.nid}`\n    const schemeHandler = getSchemeHandler(urnScheme)\n    urnComponent.path = undefined\n\n    if (schemeHandler) {\n      urnComponent = schemeHandler.parse(urnComponent, options)\n    }\n  } else {\n    urnComponent.error = urnComponent.error || 'URN can not be parsed.'\n  }\n\n  return urnComponent\n}\n\n/** @type {SchemeFn} */\nfunction urnSerialize (urnComponent, options) {\n  if (urnComponent.nid === undefined) {\n    throw new Error('URN without nid cannot be serialized')\n  }\n  const scheme = options.scheme || urnComponent.scheme || 'urn'\n  const nid = urnComponent.nid.toLowerCase()\n  const urnScheme = `${scheme}:${options.nid || nid}`\n  const schemeHandler = getSchemeHandler(urnScheme)\n\n  if (schemeHandler) {\n    urnComponent = schemeHandler.serialize(urnComponent, options)\n  }\n\n  const uriComponent = urnComponent\n  const nss = urnComponent.nss\n  uriComponent.path = `${nid || options.nid}:${nss}`\n\n  options.skipEscape = true\n  return uriComponent\n}\n\n/** @type {SchemeFn} */\nfunction urnuuidParse (urnComponent, options) {\n  const uuidComponent = urnComponent\n  uuidComponent.uuid = uuidComponent.nss\n  uuidComponent.nss = undefined\n\n  if (!options.tolerant && (!uuidComponent.uuid || !isUUID(uuidComponent.uuid))) {\n    uuidComponent.error = uuidComponent.error || 'UUID is not valid.'\n  }\n\n  return uuidComponent\n}\n\n/** @type {SchemeFn} */\nfunction urnuuidSerialize (uuidComponent) {\n  const urnComponent = uuidComponent\n  // normalize UUID\n  urnComponent.nss = (uuidComponent.uuid || '').toLowerCase()\n  return urnComponent\n}\n\nconst http = /** @type {SchemeHandler} */ ({\n  scheme: 'http',\n  domainHost: true,\n  parse: httpParse,\n  serialize: httpSerialize\n})\n\nconst https = /** @type {SchemeHandler} */ ({\n  scheme: 'https',\n  domainHost: http.domainHost,\n  parse: httpParse,\n  serialize: httpSerialize\n})\n\nconst ws = /** @type {SchemeHandler} */ ({\n  scheme: 'ws',\n  domainHost: true,\n  parse: wsParse,\n  serialize: wsSerialize\n})\n\nconst wss = /** @type {SchemeHandler} */ ({\n  scheme: 'wss',\n  domainHost: ws.domainHost,\n  parse: ws.parse,\n  serialize: ws.serialize\n})\n\nconst urn = /** @type {SchemeHandler} */ ({\n  scheme: 'urn',\n  parse: urnParse,\n  serialize: urnSerialize,\n  skipNormalize: true\n})\n\nconst urnuuid = /** @type {SchemeHandler} */ ({\n  scheme: 'urn:uuid',\n  parse: urnuuidParse,\n  serialize: urnuuidSerialize,\n  skipNormalize: true\n})\n\nconst SCHEMES = /** @type {Record<SchemeName, SchemeHandler>} */ ({\n  http,\n  https,\n  ws,\n  wss,\n  urn,\n  'urn:uuid': urnuuid\n})\n\nObject.setPrototypeOf(SCHEMES, null)\n\n/**\n * @param {string|undefined} scheme\n * @returns {SchemeHandler|undefined}\n */\nfunction getSchemeHandler (scheme) {\n  return (\n    scheme && (\n      SCHEMES[/** @type {SchemeName} */ (scheme)] ||\n      SCHEMES[/** @type {SchemeName} */(scheme.toLowerCase())])\n  ) ||\n    undefined\n}\n\nmodule.exports = {\n  wsIsSecure,\n  SCHEMES,\n  isValidSchemeName,\n  getSchemeHandler,\n}\n","'use strict'\n\nconst { normalizeIPv6, removeDotSegments, recomposeAuthority, normalizeComponentEncoding, isIPv4, nonSimpleDomain } = require('./lib/utils')\nconst { SCHEMES, getSchemeHandler } = require('./lib/schemes')\n\n/**\n * @template {import('./types/index').URIComponent|string} T\n * @param {T} uri\n * @param {import('./types/index').Options} [options]\n * @returns {T}\n */\nfunction normalize (uri, options) {\n  if (typeof uri === 'string') {\n    uri = /** @type {T} */ (serialize(parse(uri, options), options))\n  } else if (typeof uri === 'object') {\n    uri = /** @type {T} */ (parse(serialize(uri, options), options))\n  }\n  return uri\n}\n\n/**\n * @param {string} baseURI\n * @param {string} relativeURI\n * @param {import('./types/index').Options} [options]\n * @returns {string}\n */\nfunction resolve (baseURI, relativeURI, options) {\n  const schemelessOptions = options ? Object.assign({ scheme: 'null' }, options) : { scheme: 'null' }\n  const resolved = resolveComponent(parse(baseURI, schemelessOptions), parse(relativeURI, schemelessOptions), schemelessOptions, true)\n  schemelessOptions.skipEscape = true\n  return serialize(resolved, schemelessOptions)\n}\n\n/**\n * @param {import ('./types/index').URIComponent} base\n * @param {import ('./types/index').URIComponent} relative\n * @param {import('./types/index').Options} [options]\n * @param {boolean} [skipNormalization=false]\n * @returns {import ('./types/index').URIComponent}\n */\nfunction resolveComponent (base, relative, options, skipNormalization) {\n  /** @type {import('./types/index').URIComponent} */\n  const target = {}\n  if (!skipNormalization) {\n    base = parse(serialize(base, options), options) // normalize base component\n    relative = parse(serialize(relative, options), options) // normalize relative component\n  }\n  options = options || {}\n\n  if (!options.tolerant && relative.scheme) {\n    target.scheme = relative.scheme\n    // target.authority = relative.authority;\n    target.userinfo = relative.userinfo\n    target.host = relative.host\n    target.port = relative.port\n    target.path = removeDotSegments(relative.path || '')\n    target.query = relative.query\n  } else {\n    if (relative.userinfo !== undefined || relative.host !== undefined || relative.port !== undefined) {\n      // target.authority = relative.authority;\n      target.userinfo = relative.userinfo\n      target.host = relative.host\n      target.port = relative.port\n      target.path = removeDotSegments(relative.path || '')\n      target.query = relative.query\n    } else {\n      if (!relative.path) {\n        target.path = base.path\n        if (relative.query !== undefined) {\n          target.query = relative.query\n        } else {\n          target.query = base.query\n        }\n      } else {\n        if (relative.path[0] === '/') {\n          target.path = removeDotSegments(relative.path)\n        } else {\n          if ((base.userinfo !== undefined || base.host !== undefined || base.port !== undefined) && !base.path) {\n            target.path = '/' + relative.path\n          } else if (!base.path) {\n            target.path = relative.path\n          } else {\n            target.path = base.path.slice(0, base.path.lastIndexOf('/') + 1) + relative.path\n          }\n          target.path = removeDotSegments(target.path)\n        }\n        target.query = relative.query\n      }\n      // target.authority = base.authority;\n      target.userinfo = base.userinfo\n      target.host = base.host\n      target.port = base.port\n    }\n    target.scheme = base.scheme\n  }\n\n  target.fragment = relative.fragment\n\n  return target\n}\n\n/**\n * @param {import ('./types/index').URIComponent|string} uriA\n * @param {import ('./types/index').URIComponent|string} uriB\n * @param {import ('./types/index').Options} options\n * @returns {boolean}\n */\nfunction equal (uriA, uriB, options) {\n  if (typeof uriA === 'string') {\n    uriA = unescape(uriA)\n    uriA = serialize(normalizeComponentEncoding(parse(uriA, options), true), { ...options, skipEscape: true })\n  } else if (typeof uriA === 'object') {\n    uriA = serialize(normalizeComponentEncoding(uriA, true), { ...options, skipEscape: true })\n  }\n\n  if (typeof uriB === 'string') {\n    uriB = unescape(uriB)\n    uriB = serialize(normalizeComponentEncoding(parse(uriB, options), true), { ...options, skipEscape: true })\n  } else if (typeof uriB === 'object') {\n    uriB = serialize(normalizeComponentEncoding(uriB, true), { ...options, skipEscape: true })\n  }\n\n  return uriA.toLowerCase() === uriB.toLowerCase()\n}\n\n/**\n * @param {Readonly<import('./types/index').URIComponent>} cmpts\n * @param {import('./types/index').Options} [opts]\n * @returns {string}\n */\nfunction serialize (cmpts, opts) {\n  const component = {\n    host: cmpts.host,\n    scheme: cmpts.scheme,\n    userinfo: cmpts.userinfo,\n    port: cmpts.port,\n    path: cmpts.path,\n    query: cmpts.query,\n    nid: cmpts.nid,\n    nss: cmpts.nss,\n    uuid: cmpts.uuid,\n    fragment: cmpts.fragment,\n    reference: cmpts.reference,\n    resourceName: cmpts.resourceName,\n    secure: cmpts.secure,\n    error: ''\n  }\n  const options = Object.assign({}, opts)\n  const uriTokens = []\n\n  // find scheme handler\n  const schemeHandler = getSchemeHandler(options.scheme || component.scheme)\n\n  // perform scheme specific serialization\n  if (schemeHandler && schemeHandler.serialize) schemeHandler.serialize(component, options)\n\n  if (component.path !== undefined) {\n    if (!options.skipEscape) {\n      component.path = escape(component.path)\n\n      if (component.scheme !== undefined) {\n        component.path = component.path.split('%3A').join(':')\n      }\n    } else {\n      component.path = unescape(component.path)\n    }\n  }\n\n  if (options.reference !== 'suffix' && component.scheme) {\n    uriTokens.push(component.scheme, ':')\n  }\n\n  const authority = recomposeAuthority(component)\n  if (authority !== undefined) {\n    if (options.reference !== 'suffix') {\n      uriTokens.push('//')\n    }\n\n    uriTokens.push(authority)\n\n    if (component.path && component.path[0] !== '/') {\n      uriTokens.push('/')\n    }\n  }\n  if (component.path !== undefined) {\n    let s = component.path\n\n    if (!options.absolutePath && (!schemeHandler || !schemeHandler.absolutePath)) {\n      s = removeDotSegments(s)\n    }\n\n    if (\n      authority === undefined &&\n      s[0] === '/' &&\n      s[1] === '/'\n    ) {\n      // don't allow the path to start with \"//\"\n      s = '/%2F' + s.slice(2)\n    }\n\n    uriTokens.push(s)\n  }\n\n  if (component.query !== undefined) {\n    uriTokens.push('?', component.query)\n  }\n\n  if (component.fragment !== undefined) {\n    uriTokens.push('#', component.fragment)\n  }\n  return uriTokens.join('')\n}\n\nconst URI_PARSE = /^(?:([^#/:?]+):)?(?:\\/\\/((?:([^#/?@]*)@)?(\\[[^#/?\\]]+\\]|[^#/:?]*)(?::(\\d*))?))?([^#?]*)(?:\\?([^#]*))?(?:#((?:.|[\\n\\r])*))?/u\n\n/**\n * @param {string} uri\n * @param {import('./types/index').Options} [opts]\n * @returns\n */\nfunction parse (uri, opts) {\n  const options = Object.assign({}, opts)\n  /** @type {import('./types/index').URIComponent} */\n  const parsed = {\n    scheme: undefined,\n    userinfo: undefined,\n    host: '',\n    port: undefined,\n    path: '',\n    query: undefined,\n    fragment: undefined\n  }\n\n  let isIP = false\n  if (options.reference === 'suffix') {\n    if (options.scheme) {\n      uri = options.scheme + ':' + uri\n    } else {\n      uri = '//' + uri\n    }\n  }\n\n  const matches = uri.match(URI_PARSE)\n\n  if (matches) {\n    // store each component\n    parsed.scheme = matches[1]\n    parsed.userinfo = matches[3]\n    parsed.host = matches[4]\n    parsed.port = parseInt(matches[5], 10)\n    parsed.path = matches[6] || ''\n    parsed.query = matches[7]\n    parsed.fragment = matches[8]\n\n    // fix port number\n    if (isNaN(parsed.port)) {\n      parsed.port = matches[5]\n    }\n    if (parsed.host) {\n      const ipv4result = isIPv4(parsed.host)\n      if (ipv4result === false) {\n        const ipv6result = normalizeIPv6(parsed.host)\n        parsed.host = ipv6result.host.toLowerCase()\n        isIP = ipv6result.isIPV6\n      } else {\n        isIP = true\n      }\n    }\n    if (parsed.scheme === undefined && parsed.userinfo === undefined && parsed.host === undefined && parsed.port === undefined && parsed.query === undefined && !parsed.path) {\n      parsed.reference = 'same-document'\n    } else if (parsed.scheme === undefined) {\n      parsed.reference = 'relative'\n    } else if (parsed.fragment === undefined) {\n      parsed.reference = 'absolute'\n    } else {\n      parsed.reference = 'uri'\n    }\n\n    // check for reference errors\n    if (options.reference && options.reference !== 'suffix' && options.reference !== parsed.reference) {\n      parsed.error = parsed.error || 'URI is not a ' + options.reference + ' reference.'\n    }\n\n    // find scheme handler\n    const schemeHandler = getSchemeHandler(options.scheme || parsed.scheme)\n\n    // check if scheme can't handle IRIs\n    if (!options.unicodeSupport && (!schemeHandler || !schemeHandler.unicodeSupport)) {\n      // if host component is a domain name\n      if (parsed.host && (options.domainHost || (schemeHandler && schemeHandler.domainHost)) && isIP === false && nonSimpleDomain(parsed.host)) {\n        // convert Unicode IDN -> ASCII IDN\n        try {\n          parsed.host = URL.domainToASCII(parsed.host.toLowerCase())\n        } catch (e) {\n          parsed.error = parsed.error || \"Host's domain name can not be converted to ASCII: \" + e\n        }\n      }\n      // convert IRI -> URI\n    }\n\n    if (!schemeHandler || (schemeHandler && !schemeHandler.skipNormalize)) {\n      if (uri.indexOf('%') !== -1) {\n        if (parsed.scheme !== undefined) {\n          parsed.scheme = unescape(parsed.scheme)\n        }\n        if (parsed.host !== undefined) {\n          parsed.host = unescape(parsed.host)\n        }\n      }\n      if (parsed.path) {\n        parsed.path = escape(unescape(parsed.path))\n      }\n      if (parsed.fragment) {\n        parsed.fragment = encodeURI(decodeURIComponent(parsed.fragment))\n      }\n    }\n\n    // perform scheme specific parsing\n    if (schemeHandler && schemeHandler.parse) {\n      schemeHandler.parse(parsed, options)\n    }\n  } else {\n    parsed.error = parsed.error || 'URI can not be parsed.'\n  }\n  return parsed\n}\n\nconst fastUri = {\n  SCHEMES,\n  normalize,\n  resolve,\n  resolveComponent,\n  equal,\n  serialize,\n  parse\n}\n\nmodule.exports = fastUri\nmodule.exports.default = fastUri\nmodule.exports.fastUri = fastUri\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst uri = require(\"fast-uri\");\nuri.code = 'require(\"ajv/dist/runtime/uri\").default';\nexports.default = uri;\n//# sourceMappingURL=uri.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CodeGen = exports.Name = exports.nil = exports.stringify = exports.str = exports._ = exports.KeywordCxt = void 0;\nvar validate_1 = require(\"./compile/validate\");\nObject.defineProperty(exports, \"KeywordCxt\", { enumerable: true, get: function () { return validate_1.KeywordCxt; } });\nvar codegen_1 = require(\"./compile/codegen\");\nObject.defineProperty(exports, \"_\", { enumerable: true, get: function () { return codegen_1._; } });\nObject.defineProperty(exports, \"str\", { enumerable: true, get: function () { return codegen_1.str; } });\nObject.defineProperty(exports, \"stringify\", { enumerable: true, get: function () { return codegen_1.stringify; } });\nObject.defineProperty(exports, \"nil\", { enumerable: true, get: function () { return codegen_1.nil; } });\nObject.defineProperty(exports, \"Name\", { enumerable: true, get: function () { return codegen_1.Name; } });\nObject.defineProperty(exports, \"CodeGen\", { enumerable: true, get: function () { return codegen_1.CodeGen; } });\nconst validation_error_1 = require(\"./runtime/validation_error\");\nconst ref_error_1 = require(\"./compile/ref_error\");\nconst rules_1 = require(\"./compile/rules\");\nconst compile_1 = require(\"./compile\");\nconst codegen_2 = require(\"./compile/codegen\");\nconst resolve_1 = require(\"./compile/resolve\");\nconst dataType_1 = require(\"./compile/validate/dataType\");\nconst util_1 = require(\"./compile/util\");\nconst $dataRefSchema = require(\"./refs/data.json\");\nconst uri_1 = require(\"./runtime/uri\");\nconst defaultRegExp = (str, flags) => new RegExp(str, flags);\ndefaultRegExp.code = \"new RegExp\";\nconst META_IGNORE_OPTIONS = [\"removeAdditional\", \"useDefaults\", \"coerceTypes\"];\nconst EXT_SCOPE_NAMES = new Set([\n    \"validate\",\n    \"serialize\",\n    \"parse\",\n    \"wrapper\",\n    \"root\",\n    \"schema\",\n    \"keyword\",\n    \"pattern\",\n    \"formats\",\n    \"validate$data\",\n    \"func\",\n    \"obj\",\n    \"Error\",\n]);\nconst removedOptions = {\n    errorDataPath: \"\",\n    format: \"`validateFormats: false` can be used instead.\",\n    nullable: '\"nullable\" keyword is supported by default.',\n    jsonPointers: \"Deprecated jsPropertySyntax can be used instead.\",\n    extendRefs: \"Deprecated ignoreKeywordsWithRef can be used instead.\",\n    missingRefs: \"Pass empty schema with $id that should be ignored to ajv.addSchema.\",\n    processCode: \"Use option `code: {process: (code, schemaEnv: object) => string}`\",\n    sourceCode: \"Use option `code: {source: true}`\",\n    strictDefaults: \"It is default now, see option `strict`.\",\n    strictKeywords: \"It is default now, see option `strict`.\",\n    uniqueItems: '\"uniqueItems\" keyword is always validated.',\n    unknownFormats: \"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).\",\n    cache: \"Map is used as cache, schema object as key.\",\n    serialize: \"Map is used as cache, schema object as key.\",\n    ajvErrors: \"It is default now.\",\n};\nconst deprecatedOptions = {\n    ignoreKeywordsWithRef: \"\",\n    jsPropertySyntax: \"\",\n    unicode: '\"minLength\"/\"maxLength\" account for unicode characters by default.',\n};\nconst MAX_EXPRESSION = 200;\n// eslint-disable-next-line complexity\nfunction requiredOptions(o) {\n    var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t, _u, _v, _w, _x, _y, _z, _0;\n    const s = o.strict;\n    const _optz = (_a = o.code) === null || _a === void 0 ? void 0 : _a.optimize;\n    const optimize = _optz === true || _optz === undefined ? 1 : _optz || 0;\n    const regExp = (_c = (_b = o.code) === null || _b === void 0 ? void 0 : _b.regExp) !== null && _c !== void 0 ? _c : defaultRegExp;\n    const uriResolver = (_d = o.uriResolver) !== null && _d !== void 0 ? _d : uri_1.default;\n    return {\n        strictSchema: (_f = (_e = o.strictSchema) !== null && _e !== void 0 ? _e : s) !== null && _f !== void 0 ? _f : true,\n        strictNumbers: (_h = (_g = o.strictNumbers) !== null && _g !== void 0 ? _g : s) !== null && _h !== void 0 ? _h : true,\n        strictTypes: (_k = (_j = o.strictTypes) !== null && _j !== void 0 ? _j : s) !== null && _k !== void 0 ? _k : \"log\",\n        strictTuples: (_m = (_l = o.strictTuples) !== null && _l !== void 0 ? _l : s) !== null && _m !== void 0 ? _m : \"log\",\n        strictRequired: (_p = (_o = o.strictRequired) !== null && _o !== void 0 ? _o : s) !== null && _p !== void 0 ? _p : false,\n        code: o.code ? { ...o.code, optimize, regExp } : { optimize, regExp },\n        loopRequired: (_q = o.loopRequired) !== null && _q !== void 0 ? _q : MAX_EXPRESSION,\n        loopEnum: (_r = o.loopEnum) !== null && _r !== void 0 ? _r : MAX_EXPRESSION,\n        meta: (_s = o.meta) !== null && _s !== void 0 ? _s : true,\n        messages: (_t = o.messages) !== null && _t !== void 0 ? _t : true,\n        inlineRefs: (_u = o.inlineRefs) !== null && _u !== void 0 ? _u : true,\n        schemaId: (_v = o.schemaId) !== null && _v !== void 0 ? _v : \"$id\",\n        addUsedSchema: (_w = o.addUsedSchema) !== null && _w !== void 0 ? _w : true,\n        validateSchema: (_x = o.validateSchema) !== null && _x !== void 0 ? _x : true,\n        validateFormats: (_y = o.validateFormats) !== null && _y !== void 0 ? _y : true,\n        unicodeRegExp: (_z = o.unicodeRegExp) !== null && _z !== void 0 ? _z : true,\n        int32range: (_0 = o.int32range) !== null && _0 !== void 0 ? _0 : true,\n        uriResolver: uriResolver,\n    };\n}\nclass Ajv {\n    constructor(opts = {}) {\n        this.schemas = {};\n        this.refs = {};\n        this.formats = {};\n        this._compilations = new Set();\n        this._loading = {};\n        this._cache = new Map();\n        opts = this.opts = { ...opts, ...requiredOptions(opts) };\n        const { es5, lines } = this.opts.code;\n        this.scope = new codegen_2.ValueScope({ scope: {}, prefixes: EXT_SCOPE_NAMES, es5, lines });\n        this.logger = getLogger(opts.logger);\n        const formatOpt = opts.validateFormats;\n        opts.validateFormats = false;\n        this.RULES = (0, rules_1.getRules)();\n        checkOptions.call(this, removedOptions, opts, \"NOT SUPPORTED\");\n        checkOptions.call(this, deprecatedOptions, opts, \"DEPRECATED\", \"warn\");\n        this._metaOpts = getMetaSchemaOptions.call(this);\n        if (opts.formats)\n            addInitialFormats.call(this);\n        this._addVocabularies();\n        this._addDefaultMetaSchema();\n        if (opts.keywords)\n            addInitialKeywords.call(this, opts.keywords);\n        if (typeof opts.meta == \"object\")\n            this.addMetaSchema(opts.meta);\n        addInitialSchemas.call(this);\n        opts.validateFormats = formatOpt;\n    }\n    _addVocabularies() {\n        this.addKeyword(\"$async\");\n    }\n    _addDefaultMetaSchema() {\n        const { $data, meta, schemaId } = this.opts;\n        let _dataRefSchema = $dataRefSchema;\n        if (schemaId === \"id\") {\n            _dataRefSchema = { ...$dataRefSchema };\n            _dataRefSchema.id = _dataRefSchema.$id;\n            delete _dataRefSchema.$id;\n        }\n        if (meta && $data)\n            this.addMetaSchema(_dataRefSchema, _dataRefSchema[schemaId], false);\n    }\n    defaultMeta() {\n        const { meta, schemaId } = this.opts;\n        return (this.opts.defaultMeta = typeof meta == \"object\" ? meta[schemaId] || meta : undefined);\n    }\n    validate(schemaKeyRef, // key, ref or schema object\n    // eslint-disable-next-line @typescript-eslint/no-redundant-type-constituents\n    data // to be validated\n    ) {\n        let v;\n        if (typeof schemaKeyRef == \"string\") {\n            v = this.getSchema(schemaKeyRef);\n            if (!v)\n                throw new Error(`no schema with key or ref \"${schemaKeyRef}\"`);\n        }\n        else {\n            v = this.compile(schemaKeyRef);\n        }\n        const valid = v(data);\n        if (!(\"$async\" in v))\n            this.errors = v.errors;\n        return valid;\n    }\n    compile(schema, _meta) {\n        const sch = this._addSchema(schema, _meta);\n        return (sch.validate || this._compileSchemaEnv(sch));\n    }\n    compileAsync(schema, meta) {\n        if (typeof this.opts.loadSchema != \"function\") {\n            throw new Error(\"options.loadSchema should be a function\");\n        }\n        const { loadSchema } = this.opts;\n        return runCompileAsync.call(this, schema, meta);\n        async function runCompileAsync(_schema, _meta) {\n            await loadMetaSchema.call(this, _schema.$schema);\n            const sch = this._addSchema(_schema, _meta);\n            return sch.validate || _compileAsync.call(this, sch);\n        }\n        async function loadMetaSchema($ref) {\n            if ($ref && !this.getSchema($ref)) {\n                await runCompileAsync.call(this, { $ref }, true);\n            }\n        }\n        async function _compileAsync(sch) {\n            try {\n                return this._compileSchemaEnv(sch);\n            }\n            catch (e) {\n                if (!(e instanceof ref_error_1.default))\n                    throw e;\n                checkLoaded.call(this, e);\n                await loadMissingSchema.call(this, e.missingSchema);\n                return _compileAsync.call(this, sch);\n            }\n        }\n        function checkLoaded({ missingSchema: ref, missingRef }) {\n            if (this.refs[ref]) {\n                throw new Error(`AnySchema ${ref} is loaded but ${missingRef} cannot be resolved`);\n            }\n        }\n        async function loadMissingSchema(ref) {\n            const _schema = await _loadSchema.call(this, ref);\n            if (!this.refs[ref])\n                await loadMetaSchema.call(this, _schema.$schema);\n            if (!this.refs[ref])\n                this.addSchema(_schema, ref, meta);\n        }\n        async function _loadSchema(ref) {\n            const p = this._loading[ref];\n            if (p)\n                return p;\n            try {\n                return await (this._loading[ref] = loadSchema(ref));\n            }\n            finally {\n                delete this._loading[ref];\n            }\n        }\n    }\n    // Adds schema to the instance\n    addSchema(schema, // If array is passed, `key` will be ignored\n    key, // Optional schema key. Can be passed to `validate` method instead of schema object or id/ref. One schema per instance can have empty `id` and `key`.\n    _meta, // true if schema is a meta-schema. Used internally, addMetaSchema should be used instead.\n    _validateSchema = this.opts.validateSchema // false to skip schema validation. Used internally, option validateSchema should be used instead.\n    ) {\n        if (Array.isArray(schema)) {\n            for (const sch of schema)\n                this.addSchema(sch, undefined, _meta, _validateSchema);\n            return this;\n        }\n        let id;\n        if (typeof schema === \"object\") {\n            const { schemaId } = this.opts;\n            id = schema[schemaId];\n            if (id !== undefined && typeof id != \"string\") {\n                throw new Error(`schema ${schemaId} must be string`);\n            }\n        }\n        key = (0, resolve_1.normalizeId)(key || id);\n        this._checkUnique(key);\n        this.schemas[key] = this._addSchema(schema, _meta, key, _validateSchema, true);\n        return this;\n    }\n    // Add schema that will be used to validate other schemas\n    // options in META_IGNORE_OPTIONS are alway set to false\n    addMetaSchema(schema, key, // schema key\n    _validateSchema = this.opts.validateSchema // false to skip schema validation, can be used to override validateSchema option for meta-schema\n    ) {\n        this.addSchema(schema, key, true, _validateSchema);\n        return this;\n    }\n    //  Validate schema against its meta-schema\n    validateSchema(schema, throwOrLogError) {\n        if (typeof schema == \"boolean\")\n            return true;\n        let $schema;\n        $schema = schema.$schema;\n        if ($schema !== undefined && typeof $schema != \"string\") {\n            throw new Error(\"$schema must be a string\");\n        }\n        $schema = $schema || this.opts.defaultMeta || this.defaultMeta();\n        if (!$schema) {\n            this.logger.warn(\"meta-schema not available\");\n            this.errors = null;\n            return true;\n        }\n        const valid = this.validate($schema, schema);\n        if (!valid && throwOrLogError) {\n            const message = \"schema is invalid: \" + this.errorsText();\n            if (this.opts.validateSchema === \"log\")\n                this.logger.error(message);\n            else\n                throw new Error(message);\n        }\n        return valid;\n    }\n    // Get compiled schema by `key` or `ref`.\n    // (`key` that was passed to `addSchema` or full schema reference - `schema.$id` or resolved id)\n    getSchema(keyRef) {\n        let sch;\n        while (typeof (sch = getSchEnv.call(this, keyRef)) == \"string\")\n            keyRef = sch;\n        if (sch === undefined) {\n            const { schemaId } = this.opts;\n            const root = new compile_1.SchemaEnv({ schema: {}, schemaId });\n            sch = compile_1.resolveSchema.call(this, root, keyRef);\n            if (!sch)\n                return;\n            this.refs[keyRef] = sch;\n        }\n        return (sch.validate || this._compileSchemaEnv(sch));\n    }\n    // Remove cached schema(s).\n    // If no parameter is passed all schemas but meta-schemas are removed.\n    // If RegExp is passed all schemas with key/id matching pattern but meta-schemas are removed.\n    // Even if schema is referenced by other schemas it still can be removed as other schemas have local references.\n    removeSchema(schemaKeyRef) {\n        if (schemaKeyRef instanceof RegExp) {\n            this._removeAllSchemas(this.schemas, schemaKeyRef);\n            this._removeAllSchemas(this.refs, schemaKeyRef);\n            return this;\n        }\n        switch (typeof schemaKeyRef) {\n            case \"undefined\":\n                this._removeAllSchemas(this.schemas);\n                this._removeAllSchemas(this.refs);\n                this._cache.clear();\n                return this;\n            case \"string\": {\n                const sch = getSchEnv.call(this, schemaKeyRef);\n                if (typeof sch == \"object\")\n                    this._cache.delete(sch.schema);\n                delete this.schemas[schemaKeyRef];\n                delete this.refs[schemaKeyRef];\n                return this;\n            }\n            case \"object\": {\n                const cacheKey = schemaKeyRef;\n                this._cache.delete(cacheKey);\n                let id = schemaKeyRef[this.opts.schemaId];\n                if (id) {\n                    id = (0, resolve_1.normalizeId)(id);\n                    delete this.schemas[id];\n                    delete this.refs[id];\n                }\n                return this;\n            }\n            default:\n                throw new Error(\"ajv.removeSchema: invalid parameter\");\n        }\n    }\n    // add \"vocabulary\" - a collection of keywords\n    addVocabulary(definitions) {\n        for (const def of definitions)\n            this.addKeyword(def);\n        return this;\n    }\n    addKeyword(kwdOrDef, def // deprecated\n    ) {\n        let keyword;\n        if (typeof kwdOrDef == \"string\") {\n            keyword = kwdOrDef;\n            if (typeof def == \"object\") {\n                this.logger.warn(\"these parameters are deprecated, see docs for addKeyword\");\n                def.keyword = keyword;\n            }\n        }\n        else if (typeof kwdOrDef == \"object\" && def === undefined) {\n            def = kwdOrDef;\n            keyword = def.keyword;\n            if (Array.isArray(keyword) && !keyword.length) {\n                throw new Error(\"addKeywords: keyword must be string or non-empty array\");\n            }\n        }\n        else {\n            throw new Error(\"invalid addKeywords parameters\");\n        }\n        checkKeyword.call(this, keyword, def);\n        if (!def) {\n            (0, util_1.eachItem)(keyword, (kwd) => addRule.call(this, kwd));\n            return this;\n        }\n        keywordMetaschema.call(this, def);\n        const definition = {\n            ...def,\n            type: (0, dataType_1.getJSONTypes)(def.type),\n            schemaType: (0, dataType_1.getJSONTypes)(def.schemaType),\n        };\n        (0, util_1.eachItem)(keyword, definition.type.length === 0\n            ? (k) => addRule.call(this, k, definition)\n            : (k) => definition.type.forEach((t) => addRule.call(this, k, definition, t)));\n        return this;\n    }\n    getKeyword(keyword) {\n        const rule = this.RULES.all[keyword];\n        return typeof rule == \"object\" ? rule.definition : !!rule;\n    }\n    // Remove keyword\n    removeKeyword(keyword) {\n        // TODO return type should be Ajv\n        const { RULES } = this;\n        delete RULES.keywords[keyword];\n        delete RULES.all[keyword];\n        for (const group of RULES.rules) {\n            const i = group.rules.findIndex((rule) => rule.keyword === keyword);\n            if (i >= 0)\n                group.rules.splice(i, 1);\n        }\n        return this;\n    }\n    // Add format\n    addFormat(name, format) {\n        if (typeof format == \"string\")\n            format = new RegExp(format);\n        this.formats[name] = format;\n        return this;\n    }\n    errorsText(errors = this.errors, // optional array of validation errors\n    { separator = \", \", dataVar = \"data\" } = {} // optional options with properties `separator` and `dataVar`\n    ) {\n        if (!errors || errors.length === 0)\n            return \"No errors\";\n        return errors\n            .map((e) => `${dataVar}${e.instancePath} ${e.message}`)\n            .reduce((text, msg) => text + separator + msg);\n    }\n    $dataMetaSchema(metaSchema, keywordsJsonPointers) {\n        const rules = this.RULES.all;\n        metaSchema = JSON.parse(JSON.stringify(metaSchema));\n        for (const jsonPointer of keywordsJsonPointers) {\n            const segments = jsonPointer.split(\"/\").slice(1); // first segment is an empty string\n            let keywords = metaSchema;\n            for (const seg of segments)\n                keywords = keywords[seg];\n            for (const key in rules) {\n                const rule = rules[key];\n                if (typeof rule != \"object\")\n                    continue;\n                const { $data } = rule.definition;\n                const schema = keywords[key];\n                if ($data && schema)\n                    keywords[key] = schemaOrData(schema);\n            }\n        }\n        return metaSchema;\n    }\n    _removeAllSchemas(schemas, regex) {\n        for (const keyRef in schemas) {\n            const sch = schemas[keyRef];\n            if (!regex || regex.test(keyRef)) {\n                if (typeof sch == \"string\") {\n                    delete schemas[keyRef];\n                }\n                else if (sch && !sch.meta) {\n                    this._cache.delete(sch.schema);\n                    delete schemas[keyRef];\n                }\n            }\n        }\n    }\n    _addSchema(schema, meta, baseId, validateSchema = this.opts.validateSchema, addSchema = this.opts.addUsedSchema) {\n        let id;\n        const { schemaId } = this.opts;\n        if (typeof schema == \"object\") {\n            id = schema[schemaId];\n        }\n        else {\n            if (this.opts.jtd)\n                throw new Error(\"schema must be object\");\n            else if (typeof schema != \"boolean\")\n                throw new Error(\"schema must be object or boolean\");\n        }\n        let sch = this._cache.get(schema);\n        if (sch !== undefined)\n            return sch;\n        baseId = (0, resolve_1.normalizeId)(id || baseId);\n        const localRefs = resolve_1.getSchemaRefs.call(this, schema, baseId);\n        sch = new compile_1.SchemaEnv({ schema, schemaId, meta, baseId, localRefs });\n        this._cache.set(sch.schema, sch);\n        if (addSchema && !baseId.startsWith(\"#\")) {\n            // TODO atm it is allowed to overwrite schemas without id (instead of not adding them)\n            if (baseId)\n                this._checkUnique(baseId);\n            this.refs[baseId] = sch;\n        }\n        if (validateSchema)\n            this.validateSchema(schema, true);\n        return sch;\n    }\n    _checkUnique(id) {\n        if (this.schemas[id] || this.refs[id]) {\n            throw new Error(`schema with key or id \"${id}\" already exists`);\n        }\n    }\n    _compileSchemaEnv(sch) {\n        if (sch.meta)\n            this._compileMetaSchema(sch);\n        else\n            compile_1.compileSchema.call(this, sch);\n        /* istanbul ignore if */\n        if (!sch.validate)\n            throw new Error(\"ajv implementation error\");\n        return sch.validate;\n    }\n    _compileMetaSchema(sch) {\n        const currentOpts = this.opts;\n        this.opts = this._metaOpts;\n        try {\n            compile_1.compileSchema.call(this, sch);\n        }\n        finally {\n            this.opts = currentOpts;\n        }\n    }\n}\nAjv.ValidationError = validation_error_1.default;\nAjv.MissingRefError = ref_error_1.default;\nexports.default = Ajv;\nfunction checkOptions(checkOpts, options, msg, log = \"error\") {\n    for (const key in checkOpts) {\n        const opt = key;\n        if (opt in options)\n            this.logger[log](`${msg}: option ${key}. ${checkOpts[opt]}`);\n    }\n}\nfunction getSchEnv(keyRef) {\n    keyRef = (0, resolve_1.normalizeId)(keyRef); // TODO tests fail without this line\n    return this.schemas[keyRef] || this.refs[keyRef];\n}\nfunction addInitialSchemas() {\n    const optsSchemas = this.opts.schemas;\n    if (!optsSchemas)\n        return;\n    if (Array.isArray(optsSchemas))\n        this.addSchema(optsSchemas);\n    else\n        for (const key in optsSchemas)\n            this.addSchema(optsSchemas[key], key);\n}\nfunction addInitialFormats() {\n    for (const name in this.opts.formats) {\n        const format = this.opts.formats[name];\n        if (format)\n            this.addFormat(name, format);\n    }\n}\nfunction addInitialKeywords(defs) {\n    if (Array.isArray(defs)) {\n        this.addVocabulary(defs);\n        return;\n    }\n    this.logger.warn(\"keywords option as map is deprecated, pass array\");\n    for (const keyword in defs) {\n        const def = defs[keyword];\n        if (!def.keyword)\n            def.keyword = keyword;\n        this.addKeyword(def);\n    }\n}\nfunction getMetaSchemaOptions() {\n    const metaOpts = { ...this.opts };\n    for (const opt of META_IGNORE_OPTIONS)\n        delete metaOpts[opt];\n    return metaOpts;\n}\nconst noLogs = { log() { }, warn() { }, error() { } };\nfunction getLogger(logger) {\n    if (logger === false)\n        return noLogs;\n    if (logger === undefined)\n        return console;\n    if (logger.log && logger.warn && logger.error)\n        return logger;\n    throw new Error(\"logger must implement log, warn and error methods\");\n}\nconst KEYWORD_NAME = /^[a-z_$][a-z0-9_$:-]*$/i;\nfunction checkKeyword(keyword, def) {\n    const { RULES } = this;\n    (0, util_1.eachItem)(keyword, (kwd) => {\n        if (RULES.keywords[kwd])\n            throw new Error(`Keyword ${kwd} is already defined`);\n        if (!KEYWORD_NAME.test(kwd))\n            throw new Error(`Keyword ${kwd} has invalid name`);\n    });\n    if (!def)\n        return;\n    if (def.$data && !(\"code\" in def || \"validate\" in def)) {\n        throw new Error('$data keyword must have \"code\" or \"validate\" function');\n    }\n}\nfunction addRule(keyword, definition, dataType) {\n    var _a;\n    const post = definition === null || definition === void 0 ? void 0 : definition.post;\n    if (dataType && post)\n        throw new Error('keyword with \"post\" flag cannot have \"type\"');\n    const { RULES } = this;\n    let ruleGroup = post ? RULES.post : RULES.rules.find(({ type: t }) => t === dataType);\n    if (!ruleGroup) {\n        ruleGroup = { type: dataType, rules: [] };\n        RULES.rules.push(ruleGroup);\n    }\n    RULES.keywords[keyword] = true;\n    if (!definition)\n        return;\n    const rule = {\n        keyword,\n        definition: {\n            ...definition,\n            type: (0, dataType_1.getJSONTypes)(definition.type),\n            schemaType: (0, dataType_1.getJSONTypes)(definition.schemaType),\n        },\n    };\n    if (definition.before)\n        addBeforeRule.call(this, ruleGroup, rule, definition.before);\n    else\n        ruleGroup.rules.push(rule);\n    RULES.all[keyword] = rule;\n    (_a = definition.implements) === null || _a === void 0 ? void 0 : _a.forEach((kwd) => this.addKeyword(kwd));\n}\nfunction addBeforeRule(ruleGroup, rule, before) {\n    const i = ruleGroup.rules.findIndex((_rule) => _rule.keyword === before);\n    if (i >= 0) {\n        ruleGroup.rules.splice(i, 0, rule);\n    }\n    else {\n        ruleGroup.rules.push(rule);\n        this.logger.warn(`rule ${before} is not defined`);\n    }\n}\nfunction keywordMetaschema(def) {\n    let { metaSchema } = def;\n    if (metaSchema === undefined)\n        return;\n    if (def.$data && this.opts.$data)\n        metaSchema = schemaOrData(metaSchema);\n    def.validateSchema = this.compile(metaSchema, true);\n}\nconst $dataRef = {\n    $ref: \"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#\",\n};\nfunction schemaOrData(schema) {\n    return { anyOf: [schema, $dataRef] };\n}\n//# sourceMappingURL=core.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst def = {\n    keyword: \"id\",\n    code() {\n        throw new Error('NOT SUPPORTED: keyword \"id\", use \"$id\" for schema ID');\n    },\n};\nexports.default = def;\n//# sourceMappingURL=id.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.callRef = exports.getValidate = void 0;\nconst ref_error_1 = require(\"../../compile/ref_error\");\nconst code_1 = require(\"../code\");\nconst codegen_1 = require(\"../../compile/codegen\");\nconst names_1 = require(\"../../compile/names\");\nconst compile_1 = require(\"../../compile\");\nconst util_1 = require(\"../../compile/util\");\nconst def = {\n    keyword: \"$ref\",\n    schemaType: \"string\",\n    code(cxt) {\n        const { gen, schema: $ref, it } = cxt;\n        const { baseId, schemaEnv: env, validateName, opts, self } = it;\n        const { root } = env;\n        if (($ref === \"#\" || $ref === \"#/\") && baseId === root.baseId)\n            return callRootRef();\n        const schOrEnv = compile_1.resolveRef.call(self, root, baseId, $ref);\n        if (schOrEnv === undefined)\n            throw new ref_error_1.default(it.opts.uriResolver, baseId, $ref);\n        if (schOrEnv instanceof compile_1.SchemaEnv)\n            return callValidate(schOrEnv);\n        return inlineRefSchema(schOrEnv);\n        function callRootRef() {\n            if (env === root)\n                return callRef(cxt, validateName, env, env.$async);\n            const rootName = gen.scopeValue(\"root\", { ref: root });\n            return callRef(cxt, (0, codegen_1._) `${rootName}.validate`, root, root.$async);\n        }\n        function callValidate(sch) {\n            const v = getValidate(cxt, sch);\n            callRef(cxt, v, sch, sch.$async);\n        }\n        function inlineRefSchema(sch) {\n            const schName = gen.scopeValue(\"schema\", opts.code.source === true ? { ref: sch, code: (0, codegen_1.stringify)(sch) } : { ref: sch });\n            const valid = gen.name(\"valid\");\n            const schCxt = cxt.subschema({\n                schema: sch,\n                dataTypes: [],\n                schemaPath: codegen_1.nil,\n                topSchemaRef: schName,\n                errSchemaPath: $ref,\n            }, valid);\n            cxt.mergeEvaluated(schCxt);\n            cxt.ok(valid);\n        }\n    },\n};\nfunction getValidate(cxt, sch) {\n    const { gen } = cxt;\n    return sch.validate\n        ? gen.scopeValue(\"validate\", { ref: sch.validate })\n        : (0, codegen_1._) `${gen.scopeValue(\"wrapper\", { ref: sch })}.validate`;\n}\nexports.getValidate = getValidate;\nfunction callRef(cxt, v, sch, $async) {\n    const { gen, it } = cxt;\n    const { allErrors, schemaEnv: env, opts } = it;\n    const passCxt = opts.passContext ? names_1.default.this : codegen_1.nil;\n    if ($async)\n        callAsyncRef();\n    else\n        callSyncRef();\n    function callAsyncRef() {\n        if (!env.$async)\n            throw new Error(\"async schema referenced by sync schema\");\n        const valid = gen.let(\"valid\");\n        gen.try(() => {\n            gen.code((0, codegen_1._) `await ${(0, code_1.callValidateCode)(cxt, v, passCxt)}`);\n            addEvaluatedFrom(v); // TODO will not work with async, it has to be returned with the result\n            if (!allErrors)\n                gen.assign(valid, true);\n        }, (e) => {\n            gen.if((0, codegen_1._) `!(${e} instanceof ${it.ValidationError})`, () => gen.throw(e));\n            addErrorsFrom(e);\n            if (!allErrors)\n                gen.assign(valid, false);\n        });\n        cxt.ok(valid);\n    }\n    function callSyncRef() {\n        cxt.result((0, code_1.callValidateCode)(cxt, v, passCxt), () => addEvaluatedFrom(v), () => addErrorsFrom(v));\n    }\n    function addErrorsFrom(source) {\n        const errs = (0, codegen_1._) `${source}.errors`;\n        gen.assign(names_1.default.vErrors, (0, codegen_1._) `${names_1.default.vErrors} === null ? ${errs} : ${names_1.default.vErrors}.concat(${errs})`); // TODO tagged\n        gen.assign(names_1.default.errors, (0, codegen_1._) `${names_1.default.vErrors}.length`);\n    }\n    function addEvaluatedFrom(source) {\n        var _a;\n        if (!it.opts.unevaluated)\n            return;\n        const schEvaluated = (_a = sch === null || sch === void 0 ? void 0 : sch.validate) === null || _a === void 0 ? void 0 : _a.evaluated;\n        // TODO refactor\n        if (it.props !== true) {\n            if (schEvaluated && !schEvaluated.dynamicProps) {\n                if (schEvaluated.props !== undefined) {\n                    it.props = util_1.mergeEvaluated.props(gen, schEvaluated.props, it.props);\n                }\n            }\n            else {\n                const props = gen.var(\"props\", (0, codegen_1._) `${source}.evaluated.props`);\n                it.props = util_1.mergeEvaluated.props(gen, props, it.props, codegen_1.Name);\n            }\n        }\n        if (it.items !== true) {\n            if (schEvaluated && !schEvaluated.dynamicItems) {\n                if (schEvaluated.items !== undefined) {\n                    it.items = util_1.mergeEvaluated.items(gen, schEvaluated.items, it.items);\n                }\n            }\n            else {\n                const items = gen.var(\"items\", (0, codegen_1._) `${source}.evaluated.items`);\n                it.items = util_1.mergeEvaluated.items(gen, items, it.items, codegen_1.Name);\n            }\n        }\n    }\n}\nexports.callRef = callRef;\nexports.default = def;\n//# sourceMappingURL=ref.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst id_1 = require(\"./id\");\nconst ref_1 = require(\"./ref\");\nconst core = [\n    \"$schema\",\n    \"$id\",\n    \"$defs\",\n    \"$vocabulary\",\n    { keyword: \"$comment\" },\n    \"definitions\",\n    id_1.default,\n    ref_1.default,\n];\nexports.default = core;\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"../../compile/codegen\");\nconst ops = codegen_1.operators;\nconst KWDs = {\n    maximum: { okStr: \"<=\", ok: ops.LTE, fail: ops.GT },\n    minimum: { okStr: \">=\", ok: ops.GTE, fail: ops.LT },\n    exclusiveMaximum: { okStr: \"<\", ok: ops.LT, fail: ops.GTE },\n    exclusiveMinimum: { okStr: \">\", ok: ops.GT, fail: ops.LTE },\n};\nconst error = {\n    message: ({ keyword, schemaCode }) => (0, codegen_1.str) `must be ${KWDs[keyword].okStr} ${schemaCode}`,\n    params: ({ keyword, schemaCode }) => (0, codegen_1._) `{comparison: ${KWDs[keyword].okStr}, limit: ${schemaCode}}`,\n};\nconst def = {\n    keyword: Object.keys(KWDs),\n    type: \"number\",\n    schemaType: \"number\",\n    $data: true,\n    error,\n    code(cxt) {\n        const { keyword, data, schemaCode } = cxt;\n        cxt.fail$data((0, codegen_1._) `${data} ${KWDs[keyword].fail} ${schemaCode} || isNaN(${data})`);\n    },\n};\nexports.default = def;\n//# sourceMappingURL=limitNumber.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"../../compile/codegen\");\nconst error = {\n    message: ({ schemaCode }) => (0, codegen_1.str) `must be multiple of ${schemaCode}`,\n    params: ({ schemaCode }) => (0, codegen_1._) `{multipleOf: ${schemaCode}}`,\n};\nconst def = {\n    keyword: \"multipleOf\",\n    type: \"number\",\n    schemaType: \"number\",\n    $data: true,\n    error,\n    code(cxt) {\n        const { gen, data, schemaCode, it } = cxt;\n        // const bdt = bad$DataType(schemaCode, <string>def.schemaType, $data)\n        const prec = it.opts.multipleOfPrecision;\n        const res = gen.let(\"res\");\n        const invalid = prec\n            ? (0, codegen_1._) `Math.abs(Math.round(${res}) - ${res}) > 1e-${prec}`\n            : (0, codegen_1._) `${res} !== parseInt(${res})`;\n        cxt.fail$data((0, codegen_1._) `(${schemaCode} === 0 || (${res} = ${data}/${schemaCode}, ${invalid}))`);\n    },\n};\nexports.default = def;\n//# sourceMappingURL=multipleOf.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// https://mathiasbynens.be/notes/javascript-encoding\n// https://github.com/bestiejs/punycode.js - punycode.ucs2.decode\nfunction ucs2length(str) {\n    const len = str.length;\n    let length = 0;\n    let pos = 0;\n    let value;\n    while (pos < len) {\n        length++;\n        value = str.charCodeAt(pos++);\n        if (value >= 0xd800 && value <= 0xdbff && pos < len) {\n            // high surrogate, and there is a next character\n            value = str.charCodeAt(pos);\n            if ((value & 0xfc00) === 0xdc00)\n                pos++; // low surrogate\n        }\n    }\n    return length;\n}\nexports.default = ucs2length;\nucs2length.code = 'require(\"ajv/dist/runtime/ucs2length\").default';\n//# sourceMappingURL=ucs2length.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"../../compile/codegen\");\nconst util_1 = require(\"../../compile/util\");\nconst ucs2length_1 = require(\"../../runtime/ucs2length\");\nconst error = {\n    message({ keyword, schemaCode }) {\n        const comp = keyword === \"maxLength\" ? \"more\" : \"fewer\";\n        return (0, codegen_1.str) `must NOT have ${comp} than ${schemaCode} characters`;\n    },\n    params: ({ schemaCode }) => (0, codegen_1._) `{limit: ${schemaCode}}`,\n};\nconst def = {\n    keyword: [\"maxLength\", \"minLength\"],\n    type: \"string\",\n    schemaType: \"number\",\n    $data: true,\n    error,\n    code(cxt) {\n        const { keyword, data, schemaCode, it } = cxt;\n        const op = keyword === \"maxLength\" ? codegen_1.operators.GT : codegen_1.operators.LT;\n        const len = it.opts.unicode === false ? (0, codegen_1._) `${data}.length` : (0, codegen_1._) `${(0, util_1.useFunc)(cxt.gen, ucs2length_1.default)}(${data})`;\n        cxt.fail$data((0, codegen_1._) `${len} ${op} ${schemaCode}`);\n    },\n};\nexports.default = def;\n//# sourceMappingURL=limitLength.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst code_1 = require(\"../code\");\nconst codegen_1 = require(\"../../compile/codegen\");\nconst error = {\n    message: ({ schemaCode }) => (0, codegen_1.str) `must match pattern \"${schemaCode}\"`,\n    params: ({ schemaCode }) => (0, codegen_1._) `{pattern: ${schemaCode}}`,\n};\nconst def = {\n    keyword: \"pattern\",\n    type: \"string\",\n    schemaType: \"string\",\n    $data: true,\n    error,\n    code(cxt) {\n        const { data, $data, schema, schemaCode, it } = cxt;\n        // TODO regexp should be wrapped in try/catchs\n        const u = it.opts.unicodeRegExp ? \"u\" : \"\";\n        const regExp = $data ? (0, codegen_1._) `(new RegExp(${schemaCode}, ${u}))` : (0, code_1.usePattern)(cxt, schema);\n        cxt.fail$data((0, codegen_1._) `!${regExp}.test(${data})`);\n    },\n};\nexports.default = def;\n//# sourceMappingURL=pattern.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"../../compile/codegen\");\nconst error = {\n    message({ keyword, schemaCode }) {\n        const comp = keyword === \"maxProperties\" ? \"more\" : \"fewer\";\n        return (0, codegen_1.str) `must NOT have ${comp} than ${schemaCode} properties`;\n    },\n    params: ({ schemaCode }) => (0, codegen_1._) `{limit: ${schemaCode}}`,\n};\nconst def = {\n    keyword: [\"maxProperties\", \"minProperties\"],\n    type: \"object\",\n    schemaType: \"number\",\n    $data: true,\n    error,\n    code(cxt) {\n        const { keyword, data, schemaCode } = cxt;\n        const op = keyword === \"maxProperties\" ? codegen_1.operators.GT : codegen_1.operators.LT;\n        cxt.fail$data((0, codegen_1._) `Object.keys(${data}).length ${op} ${schemaCode}`);\n    },\n};\nexports.default = def;\n//# sourceMappingURL=limitProperties.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst code_1 = require(\"../code\");\nconst codegen_1 = require(\"../../compile/codegen\");\nconst util_1 = require(\"../../compile/util\");\nconst error = {\n    message: ({ params: { missingProperty } }) => (0, codegen_1.str) `must have required property '${missingProperty}'`,\n    params: ({ params: { missingProperty } }) => (0, codegen_1._) `{missingProperty: ${missingProperty}}`,\n};\nconst def = {\n    keyword: \"required\",\n    type: \"object\",\n    schemaType: \"array\",\n    $data: true,\n    error,\n    code(cxt) {\n        const { gen, schema, schemaCode, data, $data, it } = cxt;\n        const { opts } = it;\n        if (!$data && schema.length === 0)\n            return;\n        const useLoop = schema.length >= opts.loopRequired;\n        if (it.allErrors)\n            allErrorsMode();\n        else\n            exitOnErrorMode();\n        if (opts.strictRequired) {\n            const props = cxt.parentSchema.properties;\n            const { definedProperties } = cxt.it;\n            for (const requiredKey of schema) {\n                if ((props === null || props === void 0 ? void 0 : props[requiredKey]) === undefined && !definedProperties.has(requiredKey)) {\n                    const schemaPath = it.schemaEnv.baseId + it.errSchemaPath;\n                    const msg = `required property \"${requiredKey}\" is not defined at \"${schemaPath}\" (strictRequired)`;\n                    (0, util_1.checkStrictMode)(it, msg, it.opts.strictRequired);\n                }\n            }\n        }\n        function allErrorsMode() {\n            if (useLoop || $data) {\n                cxt.block$data(codegen_1.nil, loopAllRequired);\n            }\n            else {\n                for (const prop of schema) {\n                    (0, code_1.checkReportMissingProp)(cxt, prop);\n                }\n            }\n        }\n        function exitOnErrorMode() {\n            const missing = gen.let(\"missing\");\n            if (useLoop || $data) {\n                const valid = gen.let(\"valid\", true);\n                cxt.block$data(valid, () => loopUntilMissing(missing, valid));\n                cxt.ok(valid);\n            }\n            else {\n                gen.if((0, code_1.checkMissingProp)(cxt, schema, missing));\n                (0, code_1.reportMissingProp)(cxt, missing);\n                gen.else();\n            }\n        }\n        function loopAllRequired() {\n            gen.forOf(\"prop\", schemaCode, (prop) => {\n                cxt.setParams({ missingProperty: prop });\n                gen.if((0, code_1.noPropertyInData)(gen, data, prop, opts.ownProperties), () => cxt.error());\n            });\n        }\n        function loopUntilMissing(missing, valid) {\n            cxt.setParams({ missingProperty: missing });\n            gen.forOf(missing, schemaCode, () => {\n                gen.assign(valid, (0, code_1.propertyInData)(gen, data, missing, opts.ownProperties));\n                gen.if((0, codegen_1.not)(valid), () => {\n                    cxt.error();\n                    gen.break();\n                });\n            }, codegen_1.nil);\n        }\n    },\n};\nexports.default = def;\n//# sourceMappingURL=required.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"../../compile/codegen\");\nconst error = {\n    message({ keyword, schemaCode }) {\n        const comp = keyword === \"maxItems\" ? \"more\" : \"fewer\";\n        return (0, codegen_1.str) `must NOT have ${comp} than ${schemaCode} items`;\n    },\n    params: ({ schemaCode }) => (0, codegen_1._) `{limit: ${schemaCode}}`,\n};\nconst def = {\n    keyword: [\"maxItems\", \"minItems\"],\n    type: \"array\",\n    schemaType: \"number\",\n    $data: true,\n    error,\n    code(cxt) {\n        const { keyword, data, schemaCode } = cxt;\n        const op = keyword === \"maxItems\" ? codegen_1.operators.GT : codegen_1.operators.LT;\n        cxt.fail$data((0, codegen_1._) `${data}.length ${op} ${schemaCode}`);\n    },\n};\nexports.default = def;\n//# sourceMappingURL=limitItems.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// https://github.com/ajv-validator/ajv/issues/889\nconst equal = require(\"fast-deep-equal\");\nequal.code = 'require(\"ajv/dist/runtime/equal\").default';\nexports.default = equal;\n//# sourceMappingURL=equal.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst dataType_1 = require(\"../../compile/validate/dataType\");\nconst codegen_1 = require(\"../../compile/codegen\");\nconst util_1 = require(\"../../compile/util\");\nconst equal_1 = require(\"../../runtime/equal\");\nconst error = {\n    message: ({ params: { i, j } }) => (0, codegen_1.str) `must NOT have duplicate items (items ## ${j} and ${i} are identical)`,\n    params: ({ params: { i, j } }) => (0, codegen_1._) `{i: ${i}, j: ${j}}`,\n};\nconst def = {\n    keyword: \"uniqueItems\",\n    type: \"array\",\n    schemaType: \"boolean\",\n    $data: true,\n    error,\n    code(cxt) {\n        const { gen, data, $data, schema, parentSchema, schemaCode, it } = cxt;\n        if (!$data && !schema)\n            return;\n        const valid = gen.let(\"valid\");\n        const itemTypes = parentSchema.items ? (0, dataType_1.getSchemaTypes)(parentSchema.items) : [];\n        cxt.block$data(valid, validateUniqueItems, (0, codegen_1._) `${schemaCode} === false`);\n        cxt.ok(valid);\n        function validateUniqueItems() {\n            const i = gen.let(\"i\", (0, codegen_1._) `${data}.length`);\n            const j = gen.let(\"j\");\n            cxt.setParams({ i, j });\n            gen.assign(valid, true);\n            gen.if((0, codegen_1._) `${i} > 1`, () => (canOptimize() ? loopN : loopN2)(i, j));\n        }\n        function canOptimize() {\n            return itemTypes.length > 0 && !itemTypes.some((t) => t === \"object\" || t === \"array\");\n        }\n        function loopN(i, j) {\n            const item = gen.name(\"item\");\n            const wrongType = (0, dataType_1.checkDataTypes)(itemTypes, item, it.opts.strictNumbers, dataType_1.DataType.Wrong);\n            const indices = gen.const(\"indices\", (0, codegen_1._) `{}`);\n            gen.for((0, codegen_1._) `;${i}--;`, () => {\n                gen.let(item, (0, codegen_1._) `${data}[${i}]`);\n                gen.if(wrongType, (0, codegen_1._) `continue`);\n                if (itemTypes.length > 1)\n                    gen.if((0, codegen_1._) `typeof ${item} == \"string\"`, (0, codegen_1._) `${item} += \"_\"`);\n                gen\n                    .if((0, codegen_1._) `typeof ${indices}[${item}] == \"number\"`, () => {\n                    gen.assign(j, (0, codegen_1._) `${indices}[${item}]`);\n                    cxt.error();\n                    gen.assign(valid, false).break();\n                })\n                    .code((0, codegen_1._) `${indices}[${item}] = ${i}`);\n            });\n        }\n        function loopN2(i, j) {\n            const eql = (0, util_1.useFunc)(gen, equal_1.default);\n            const outer = gen.name(\"outer\");\n            gen.label(outer).for((0, codegen_1._) `;${i}--;`, () => gen.for((0, codegen_1._) `${j} = ${i}; ${j}--;`, () => gen.if((0, codegen_1._) `${eql}(${data}[${i}], ${data}[${j}])`, () => {\n                cxt.error();\n                gen.assign(valid, false).break(outer);\n            })));\n        }\n    },\n};\nexports.default = def;\n//# sourceMappingURL=uniqueItems.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"../../compile/codegen\");\nconst util_1 = require(\"../../compile/util\");\nconst equal_1 = require(\"../../runtime/equal\");\nconst error = {\n    message: \"must be equal to constant\",\n    params: ({ schemaCode }) => (0, codegen_1._) `{allowedValue: ${schemaCode}}`,\n};\nconst def = {\n    keyword: \"const\",\n    $data: true,\n    error,\n    code(cxt) {\n        const { gen, data, $data, schemaCode, schema } = cxt;\n        if ($data || (schema && typeof schema == \"object\")) {\n            cxt.fail$data((0, codegen_1._) `!${(0, util_1.useFunc)(gen, equal_1.default)}(${data}, ${schemaCode})`);\n        }\n        else {\n            cxt.fail((0, codegen_1._) `${schema} !== ${data}`);\n        }\n    },\n};\nexports.default = def;\n//# sourceMappingURL=const.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"../../compile/codegen\");\nconst util_1 = require(\"../../compile/util\");\nconst equal_1 = require(\"../../runtime/equal\");\nconst error = {\n    message: \"must be equal to one of the allowed values\",\n    params: ({ schemaCode }) => (0, codegen_1._) `{allowedValues: ${schemaCode}}`,\n};\nconst def = {\n    keyword: \"enum\",\n    schemaType: \"array\",\n    $data: true,\n    error,\n    code(cxt) {\n        const { gen, data, $data, schema, schemaCode, it } = cxt;\n        if (!$data && schema.length === 0)\n            throw new Error(\"enum must have non-empty array\");\n        const useLoop = schema.length >= it.opts.loopEnum;\n        let eql;\n        const getEql = () => (eql !== null && eql !== void 0 ? eql : (eql = (0, util_1.useFunc)(gen, equal_1.default)));\n        let valid;\n        if (useLoop || $data) {\n            valid = gen.let(\"valid\");\n            cxt.block$data(valid, loopEnum);\n        }\n        else {\n            /* istanbul ignore if */\n            if (!Array.isArray(schema))\n                throw new Error(\"ajv implementation error\");\n            const vSchema = gen.const(\"vSchema\", schemaCode);\n            valid = (0, codegen_1.or)(...schema.map((_x, i) => equalCode(vSchema, i)));\n        }\n        cxt.pass(valid);\n        function loopEnum() {\n            gen.assign(valid, false);\n            gen.forOf(\"v\", schemaCode, (v) => gen.if((0, codegen_1._) `${getEql()}(${data}, ${v})`, () => gen.assign(valid, true).break()));\n        }\n        function equalCode(vSchema, i) {\n            const sch = schema[i];\n            return typeof sch === \"object\" && sch !== null\n                ? (0, codegen_1._) `${getEql()}(${data}, ${vSchema}[${i}])`\n                : (0, codegen_1._) `${data} === ${sch}`;\n        }\n    },\n};\nexports.default = def;\n//# sourceMappingURL=enum.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst limitNumber_1 = require(\"./limitNumber\");\nconst multipleOf_1 = require(\"./multipleOf\");\nconst limitLength_1 = require(\"./limitLength\");\nconst pattern_1 = require(\"./pattern\");\nconst limitProperties_1 = require(\"./limitProperties\");\nconst required_1 = require(\"./required\");\nconst limitItems_1 = require(\"./limitItems\");\nconst uniqueItems_1 = require(\"./uniqueItems\");\nconst const_1 = require(\"./const\");\nconst enum_1 = require(\"./enum\");\nconst validation = [\n    // number\n    limitNumber_1.default,\n    multipleOf_1.default,\n    // string\n    limitLength_1.default,\n    pattern_1.default,\n    // object\n    limitProperties_1.default,\n    required_1.default,\n    // array\n    limitItems_1.default,\n    uniqueItems_1.default,\n    // any\n    { keyword: \"type\", schemaType: [\"string\", \"array\"] },\n    { keyword: \"nullable\", schemaType: \"boolean\" },\n    const_1.default,\n    enum_1.default,\n];\nexports.default = validation;\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.validateAdditionalItems = void 0;\nconst codegen_1 = require(\"../../compile/codegen\");\nconst util_1 = require(\"../../compile/util\");\nconst error = {\n    message: ({ params: { len } }) => (0, codegen_1.str) `must NOT have more than ${len} items`,\n    params: ({ params: { len } }) => (0, codegen_1._) `{limit: ${len}}`,\n};\nconst def = {\n    keyword: \"additionalItems\",\n    type: \"array\",\n    schemaType: [\"boolean\", \"object\"],\n    before: \"uniqueItems\",\n    error,\n    code(cxt) {\n        const { parentSchema, it } = cxt;\n        const { items } = parentSchema;\n        if (!Array.isArray(items)) {\n            (0, util_1.checkStrictMode)(it, '\"additionalItems\" is ignored when \"items\" is not an array of schemas');\n            return;\n        }\n        validateAdditionalItems(cxt, items);\n    },\n};\nfunction validateAdditionalItems(cxt, items) {\n    const { gen, schema, data, keyword, it } = cxt;\n    it.items = true;\n    const len = gen.const(\"len\", (0, codegen_1._) `${data}.length`);\n    if (schema === false) {\n        cxt.setParams({ len: items.length });\n        cxt.pass((0, codegen_1._) `${len} <= ${items.length}`);\n    }\n    else if (typeof schema == \"object\" && !(0, util_1.alwaysValidSchema)(it, schema)) {\n        const valid = gen.var(\"valid\", (0, codegen_1._) `${len} <= ${items.length}`); // TODO var\n        gen.if((0, codegen_1.not)(valid), () => validateItems(valid));\n        cxt.ok(valid);\n    }\n    function validateItems(valid) {\n        gen.forRange(\"i\", items.length, len, (i) => {\n            cxt.subschema({ keyword, dataProp: i, dataPropType: util_1.Type.Num }, valid);\n            if (!it.allErrors)\n                gen.if((0, codegen_1.not)(valid), () => gen.break());\n        });\n    }\n}\nexports.validateAdditionalItems = validateAdditionalItems;\nexports.default = def;\n//# sourceMappingURL=additionalItems.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.validateTuple = void 0;\nconst codegen_1 = require(\"../../compile/codegen\");\nconst util_1 = require(\"../../compile/util\");\nconst code_1 = require(\"../code\");\nconst def = {\n    keyword: \"items\",\n    type: \"array\",\n    schemaType: [\"object\", \"array\", \"boolean\"],\n    before: \"uniqueItems\",\n    code(cxt) {\n        const { schema, it } = cxt;\n        if (Array.isArray(schema))\n            return validateTuple(cxt, \"additionalItems\", schema);\n        it.items = true;\n        if ((0, util_1.alwaysValidSchema)(it, schema))\n            return;\n        cxt.ok((0, code_1.validateArray)(cxt));\n    },\n};\nfunction validateTuple(cxt, extraItems, schArr = cxt.schema) {\n    const { gen, parentSchema, data, keyword, it } = cxt;\n    checkStrictTuple(parentSchema);\n    if (it.opts.unevaluated && schArr.length && it.items !== true) {\n        it.items = util_1.mergeEvaluated.items(gen, schArr.length, it.items);\n    }\n    const valid = gen.name(\"valid\");\n    const len = gen.const(\"len\", (0, codegen_1._) `${data}.length`);\n    schArr.forEach((sch, i) => {\n        if ((0, util_1.alwaysValidSchema)(it, sch))\n            return;\n        gen.if((0, codegen_1._) `${len} > ${i}`, () => cxt.subschema({\n            keyword,\n            schemaProp: i,\n            dataProp: i,\n        }, valid));\n        cxt.ok(valid);\n    });\n    function checkStrictTuple(sch) {\n        const { opts, errSchemaPath } = it;\n        const l = schArr.length;\n        const fullTuple = l === sch.minItems && (l === sch.maxItems || sch[extraItems] === false);\n        if (opts.strictTuples && !fullTuple) {\n            const msg = `\"${keyword}\" is ${l}-tuple, but minItems or maxItems/${extraItems} are not specified or different at path \"${errSchemaPath}\"`;\n            (0, util_1.checkStrictMode)(it, msg, opts.strictTuples);\n        }\n    }\n}\nexports.validateTuple = validateTuple;\nexports.default = def;\n//# sourceMappingURL=items.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst items_1 = require(\"./items\");\nconst def = {\n    keyword: \"prefixItems\",\n    type: \"array\",\n    schemaType: [\"array\"],\n    before: \"uniqueItems\",\n    code: (cxt) => (0, items_1.validateTuple)(cxt, \"items\"),\n};\nexports.default = def;\n//# sourceMappingURL=prefixItems.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"../../compile/codegen\");\nconst util_1 = require(\"../../compile/util\");\nconst code_1 = require(\"../code\");\nconst additionalItems_1 = require(\"./additionalItems\");\nconst error = {\n    message: ({ params: { len } }) => (0, codegen_1.str) `must NOT have more than ${len} items`,\n    params: ({ params: { len } }) => (0, codegen_1._) `{limit: ${len}}`,\n};\nconst def = {\n    keyword: \"items\",\n    type: \"array\",\n    schemaType: [\"object\", \"boolean\"],\n    before: \"uniqueItems\",\n    error,\n    code(cxt) {\n        const { schema, parentSchema, it } = cxt;\n        const { prefixItems } = parentSchema;\n        it.items = true;\n        if ((0, util_1.alwaysValidSchema)(it, schema))\n            return;\n        if (prefixItems)\n            (0, additionalItems_1.validateAdditionalItems)(cxt, prefixItems);\n        else\n            cxt.ok((0, code_1.validateArray)(cxt));\n    },\n};\nexports.default = def;\n//# sourceMappingURL=items2020.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"../../compile/codegen\");\nconst util_1 = require(\"../../compile/util\");\nconst error = {\n    message: ({ params: { min, max } }) => max === undefined\n        ? (0, codegen_1.str) `must contain at least ${min} valid item(s)`\n        : (0, codegen_1.str) `must contain at least ${min} and no more than ${max} valid item(s)`,\n    params: ({ params: { min, max } }) => max === undefined ? (0, codegen_1._) `{minContains: ${min}}` : (0, codegen_1._) `{minContains: ${min}, maxContains: ${max}}`,\n};\nconst def = {\n    keyword: \"contains\",\n    type: \"array\",\n    schemaType: [\"object\", \"boolean\"],\n    before: \"uniqueItems\",\n    trackErrors: true,\n    error,\n    code(cxt) {\n        const { gen, schema, parentSchema, data, it } = cxt;\n        let min;\n        let max;\n        const { minContains, maxContains } = parentSchema;\n        if (it.opts.next) {\n            min = minContains === undefined ? 1 : minContains;\n            max = maxContains;\n        }\n        else {\n            min = 1;\n        }\n        const len = gen.const(\"len\", (0, codegen_1._) `${data}.length`);\n        cxt.setParams({ min, max });\n        if (max === undefined && min === 0) {\n            (0, util_1.checkStrictMode)(it, `\"minContains\" == 0 without \"maxContains\": \"contains\" keyword ignored`);\n            return;\n        }\n        if (max !== undefined && min > max) {\n            (0, util_1.checkStrictMode)(it, `\"minContains\" > \"maxContains\" is always invalid`);\n            cxt.fail();\n            return;\n        }\n        if ((0, util_1.alwaysValidSchema)(it, schema)) {\n            let cond = (0, codegen_1._) `${len} >= ${min}`;\n            if (max !== undefined)\n                cond = (0, codegen_1._) `${cond} && ${len} <= ${max}`;\n            cxt.pass(cond);\n            return;\n        }\n        it.items = true;\n        const valid = gen.name(\"valid\");\n        if (max === undefined && min === 1) {\n            validateItems(valid, () => gen.if(valid, () => gen.break()));\n        }\n        else if (min === 0) {\n            gen.let(valid, true);\n            if (max !== undefined)\n                gen.if((0, codegen_1._) `${data}.length > 0`, validateItemsWithCount);\n        }\n        else {\n            gen.let(valid, false);\n            validateItemsWithCount();\n        }\n        cxt.result(valid, () => cxt.reset());\n        function validateItemsWithCount() {\n            const schValid = gen.name(\"_valid\");\n            const count = gen.let(\"count\", 0);\n            validateItems(schValid, () => gen.if(schValid, () => checkLimits(count)));\n        }\n        function validateItems(_valid, block) {\n            gen.forRange(\"i\", 0, len, (i) => {\n                cxt.subschema({\n                    keyword: \"contains\",\n                    dataProp: i,\n                    dataPropType: util_1.Type.Num,\n                    compositeRule: true,\n                }, _valid);\n                block();\n            });\n        }\n        function checkLimits(count) {\n            gen.code((0, codegen_1._) `${count}++`);\n            if (max === undefined) {\n                gen.if((0, codegen_1._) `${count} >= ${min}`, () => gen.assign(valid, true).break());\n            }\n            else {\n                gen.if((0, codegen_1._) `${count} > ${max}`, () => gen.assign(valid, false).break());\n                if (min === 1)\n                    gen.assign(valid, true);\n                else\n                    gen.if((0, codegen_1._) `${count} >= ${min}`, () => gen.assign(valid, true));\n            }\n        }\n    },\n};\nexports.default = def;\n//# sourceMappingURL=contains.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.validateSchemaDeps = exports.validatePropertyDeps = exports.error = void 0;\nconst codegen_1 = require(\"../../compile/codegen\");\nconst util_1 = require(\"../../compile/util\");\nconst code_1 = require(\"../code\");\nexports.error = {\n    message: ({ params: { property, depsCount, deps } }) => {\n        const property_ies = depsCount === 1 ? \"property\" : \"properties\";\n        return (0, codegen_1.str) `must have ${property_ies} ${deps} when property ${property} is present`;\n    },\n    params: ({ params: { property, depsCount, deps, missingProperty } }) => (0, codegen_1._) `{property: ${property},\n    missingProperty: ${missingProperty},\n    depsCount: ${depsCount},\n    deps: ${deps}}`, // TODO change to reference\n};\nconst def = {\n    keyword: \"dependencies\",\n    type: \"object\",\n    schemaType: \"object\",\n    error: exports.error,\n    code(cxt) {\n        const [propDeps, schDeps] = splitDependencies(cxt);\n        validatePropertyDeps(cxt, propDeps);\n        validateSchemaDeps(cxt, schDeps);\n    },\n};\nfunction splitDependencies({ schema }) {\n    const propertyDeps = {};\n    const schemaDeps = {};\n    for (const key in schema) {\n        if (key === \"__proto__\")\n            continue;\n        const deps = Array.isArray(schema[key]) ? propertyDeps : schemaDeps;\n        deps[key] = schema[key];\n    }\n    return [propertyDeps, schemaDeps];\n}\nfunction validatePropertyDeps(cxt, propertyDeps = cxt.schema) {\n    const { gen, data, it } = cxt;\n    if (Object.keys(propertyDeps).length === 0)\n        return;\n    const missing = gen.let(\"missing\");\n    for (const prop in propertyDeps) {\n        const deps = propertyDeps[prop];\n        if (deps.length === 0)\n            continue;\n        const hasProperty = (0, code_1.propertyInData)(gen, data, prop, it.opts.ownProperties);\n        cxt.setParams({\n            property: prop,\n            depsCount: deps.length,\n            deps: deps.join(\", \"),\n        });\n        if (it.allErrors) {\n            gen.if(hasProperty, () => {\n                for (const depProp of deps) {\n                    (0, code_1.checkReportMissingProp)(cxt, depProp);\n                }\n            });\n        }\n        else {\n            gen.if((0, codegen_1._) `${hasProperty} && (${(0, code_1.checkMissingProp)(cxt, deps, missing)})`);\n            (0, code_1.reportMissingProp)(cxt, missing);\n            gen.else();\n        }\n    }\n}\nexports.validatePropertyDeps = validatePropertyDeps;\nfunction validateSchemaDeps(cxt, schemaDeps = cxt.schema) {\n    const { gen, data, keyword, it } = cxt;\n    const valid = gen.name(\"valid\");\n    for (const prop in schemaDeps) {\n        if ((0, util_1.alwaysValidSchema)(it, schemaDeps[prop]))\n            continue;\n        gen.if((0, code_1.propertyInData)(gen, data, prop, it.opts.ownProperties), () => {\n            const schCxt = cxt.subschema({ keyword, schemaProp: prop }, valid);\n            cxt.mergeValidEvaluated(schCxt, valid);\n        }, () => gen.var(valid, true) // TODO var\n        );\n        cxt.ok(valid);\n    }\n}\nexports.validateSchemaDeps = validateSchemaDeps;\nexports.default = def;\n//# sourceMappingURL=dependencies.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"../../compile/codegen\");\nconst util_1 = require(\"../../compile/util\");\nconst error = {\n    message: \"property name must be valid\",\n    params: ({ params }) => (0, codegen_1._) `{propertyName: ${params.propertyName}}`,\n};\nconst def = {\n    keyword: \"propertyNames\",\n    type: \"object\",\n    schemaType: [\"object\", \"boolean\"],\n    error,\n    code(cxt) {\n        const { gen, schema, data, it } = cxt;\n        if ((0, util_1.alwaysValidSchema)(it, schema))\n            return;\n        const valid = gen.name(\"valid\");\n        gen.forIn(\"key\", data, (key) => {\n            cxt.setParams({ propertyName: key });\n            cxt.subschema({\n                keyword: \"propertyNames\",\n                data: key,\n                dataTypes: [\"string\"],\n                propertyName: key,\n                compositeRule: true,\n            }, valid);\n            gen.if((0, codegen_1.not)(valid), () => {\n                cxt.error(true);\n                if (!it.allErrors)\n                    gen.break();\n            });\n        });\n        cxt.ok(valid);\n    },\n};\nexports.default = def;\n//# sourceMappingURL=propertyNames.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst code_1 = require(\"../code\");\nconst codegen_1 = require(\"../../compile/codegen\");\nconst names_1 = require(\"../../compile/names\");\nconst util_1 = require(\"../../compile/util\");\nconst error = {\n    message: \"must NOT have additional properties\",\n    params: ({ params }) => (0, codegen_1._) `{additionalProperty: ${params.additionalProperty}}`,\n};\nconst def = {\n    keyword: \"additionalProperties\",\n    type: [\"object\"],\n    schemaType: [\"boolean\", \"object\"],\n    allowUndefined: true,\n    trackErrors: true,\n    error,\n    code(cxt) {\n        const { gen, schema, parentSchema, data, errsCount, it } = cxt;\n        /* istanbul ignore if */\n        if (!errsCount)\n            throw new Error(\"ajv implementation error\");\n        const { allErrors, opts } = it;\n        it.props = true;\n        if (opts.removeAdditional !== \"all\" && (0, util_1.alwaysValidSchema)(it, schema))\n            return;\n        const props = (0, code_1.allSchemaProperties)(parentSchema.properties);\n        const patProps = (0, code_1.allSchemaProperties)(parentSchema.patternProperties);\n        checkAdditionalProperties();\n        cxt.ok((0, codegen_1._) `${errsCount} === ${names_1.default.errors}`);\n        function checkAdditionalProperties() {\n            gen.forIn(\"key\", data, (key) => {\n                if (!props.length && !patProps.length)\n                    additionalPropertyCode(key);\n                else\n                    gen.if(isAdditional(key), () => additionalPropertyCode(key));\n            });\n        }\n        function isAdditional(key) {\n            let definedProp;\n            if (props.length > 8) {\n                // TODO maybe an option instead of hard-coded 8?\n                const propsSchema = (0, util_1.schemaRefOrVal)(it, parentSchema.properties, \"properties\");\n                definedProp = (0, code_1.isOwnProperty)(gen, propsSchema, key);\n            }\n            else if (props.length) {\n                definedProp = (0, codegen_1.or)(...props.map((p) => (0, codegen_1._) `${key} === ${p}`));\n            }\n            else {\n                definedProp = codegen_1.nil;\n            }\n            if (patProps.length) {\n                definedProp = (0, codegen_1.or)(definedProp, ...patProps.map((p) => (0, codegen_1._) `${(0, code_1.usePattern)(cxt, p)}.test(${key})`));\n            }\n            return (0, codegen_1.not)(definedProp);\n        }\n        function deleteAdditional(key) {\n            gen.code((0, codegen_1._) `delete ${data}[${key}]`);\n        }\n        function additionalPropertyCode(key) {\n            if (opts.removeAdditional === \"all\" || (opts.removeAdditional && schema === false)) {\n                deleteAdditional(key);\n                return;\n            }\n            if (schema === false) {\n                cxt.setParams({ additionalProperty: key });\n                cxt.error();\n                if (!allErrors)\n                    gen.break();\n                return;\n            }\n            if (typeof schema == \"object\" && !(0, util_1.alwaysValidSchema)(it, schema)) {\n                const valid = gen.name(\"valid\");\n                if (opts.removeAdditional === \"failing\") {\n                    applyAdditionalSchema(key, valid, false);\n                    gen.if((0, codegen_1.not)(valid), () => {\n                        cxt.reset();\n                        deleteAdditional(key);\n                    });\n                }\n                else {\n                    applyAdditionalSchema(key, valid);\n                    if (!allErrors)\n                        gen.if((0, codegen_1.not)(valid), () => gen.break());\n                }\n            }\n        }\n        function applyAdditionalSchema(key, valid, errors) {\n            const subschema = {\n                keyword: \"additionalProperties\",\n                dataProp: key,\n                dataPropType: util_1.Type.Str,\n            };\n            if (errors === false) {\n                Object.assign(subschema, {\n                    compositeRule: true,\n                    createErrors: false,\n                    allErrors: false,\n                });\n            }\n            cxt.subschema(subschema, valid);\n        }\n    },\n};\nexports.default = def;\n//# sourceMappingURL=additionalProperties.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst validate_1 = require(\"../../compile/validate\");\nconst code_1 = require(\"../code\");\nconst util_1 = require(\"../../compile/util\");\nconst additionalProperties_1 = require(\"./additionalProperties\");\nconst def = {\n    keyword: \"properties\",\n    type: \"object\",\n    schemaType: \"object\",\n    code(cxt) {\n        const { gen, schema, parentSchema, data, it } = cxt;\n        if (it.opts.removeAdditional === \"all\" && parentSchema.additionalProperties === undefined) {\n            additionalProperties_1.default.code(new validate_1.KeywordCxt(it, additionalProperties_1.default, \"additionalProperties\"));\n        }\n        const allProps = (0, code_1.allSchemaProperties)(schema);\n        for (const prop of allProps) {\n            it.definedProperties.add(prop);\n        }\n        if (it.opts.unevaluated && allProps.length && it.props !== true) {\n            it.props = util_1.mergeEvaluated.props(gen, (0, util_1.toHash)(allProps), it.props);\n        }\n        const properties = allProps.filter((p) => !(0, util_1.alwaysValidSchema)(it, schema[p]));\n        if (properties.length === 0)\n            return;\n        const valid = gen.name(\"valid\");\n        for (const prop of properties) {\n            if (hasDefault(prop)) {\n                applyPropertySchema(prop);\n            }\n            else {\n                gen.if((0, code_1.propertyInData)(gen, data, prop, it.opts.ownProperties));\n                applyPropertySchema(prop);\n                if (!it.allErrors)\n                    gen.else().var(valid, true);\n                gen.endIf();\n            }\n            cxt.it.definedProperties.add(prop);\n            cxt.ok(valid);\n        }\n        function hasDefault(prop) {\n            return it.opts.useDefaults && !it.compositeRule && schema[prop].default !== undefined;\n        }\n        function applyPropertySchema(prop) {\n            cxt.subschema({\n                keyword: \"properties\",\n                schemaProp: prop,\n                dataProp: prop,\n            }, valid);\n        }\n    },\n};\nexports.default = def;\n//# sourceMappingURL=properties.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst code_1 = require(\"../code\");\nconst codegen_1 = require(\"../../compile/codegen\");\nconst util_1 = require(\"../../compile/util\");\nconst util_2 = require(\"../../compile/util\");\nconst def = {\n    keyword: \"patternProperties\",\n    type: \"object\",\n    schemaType: \"object\",\n    code(cxt) {\n        const { gen, schema, data, parentSchema, it } = cxt;\n        const { opts } = it;\n        const patterns = (0, code_1.allSchemaProperties)(schema);\n        const alwaysValidPatterns = patterns.filter((p) => (0, util_1.alwaysValidSchema)(it, schema[p]));\n        if (patterns.length === 0 ||\n            (alwaysValidPatterns.length === patterns.length &&\n                (!it.opts.unevaluated || it.props === true))) {\n            return;\n        }\n        const checkProperties = opts.strictSchema && !opts.allowMatchingProperties && parentSchema.properties;\n        const valid = gen.name(\"valid\");\n        if (it.props !== true && !(it.props instanceof codegen_1.Name)) {\n            it.props = (0, util_2.evaluatedPropsToName)(gen, it.props);\n        }\n        const { props } = it;\n        validatePatternProperties();\n        function validatePatternProperties() {\n            for (const pat of patterns) {\n                if (checkProperties)\n                    checkMatchingProperties(pat);\n                if (it.allErrors) {\n                    validateProperties(pat);\n                }\n                else {\n                    gen.var(valid, true); // TODO var\n                    validateProperties(pat);\n                    gen.if(valid);\n                }\n            }\n        }\n        function checkMatchingProperties(pat) {\n            for (const prop in checkProperties) {\n                if (new RegExp(pat).test(prop)) {\n                    (0, util_1.checkStrictMode)(it, `property ${prop} matches pattern ${pat} (use allowMatchingProperties)`);\n                }\n            }\n        }\n        function validateProperties(pat) {\n            gen.forIn(\"key\", data, (key) => {\n                gen.if((0, codegen_1._) `${(0, code_1.usePattern)(cxt, pat)}.test(${key})`, () => {\n                    const alwaysValid = alwaysValidPatterns.includes(pat);\n                    if (!alwaysValid) {\n                        cxt.subschema({\n                            keyword: \"patternProperties\",\n                            schemaProp: pat,\n                            dataProp: key,\n                            dataPropType: util_2.Type.Str,\n                        }, valid);\n                    }\n                    if (it.opts.unevaluated && props !== true) {\n                        gen.assign((0, codegen_1._) `${props}[${key}]`, true);\n                    }\n                    else if (!alwaysValid && !it.allErrors) {\n                        // can short-circuit if `unevaluatedProperties` is not supported (opts.next === false)\n                        // or if all properties were evaluated (props === true)\n                        gen.if((0, codegen_1.not)(valid), () => gen.break());\n                    }\n                });\n            });\n        }\n    },\n};\nexports.default = def;\n//# sourceMappingURL=patternProperties.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst util_1 = require(\"../../compile/util\");\nconst def = {\n    keyword: \"not\",\n    schemaType: [\"object\", \"boolean\"],\n    trackErrors: true,\n    code(cxt) {\n        const { gen, schema, it } = cxt;\n        if ((0, util_1.alwaysValidSchema)(it, schema)) {\n            cxt.fail();\n            return;\n        }\n        const valid = gen.name(\"valid\");\n        cxt.subschema({\n            keyword: \"not\",\n            compositeRule: true,\n            createErrors: false,\n            allErrors: false,\n        }, valid);\n        cxt.failResult(valid, () => cxt.reset(), () => cxt.error());\n    },\n    error: { message: \"must NOT be valid\" },\n};\nexports.default = def;\n//# sourceMappingURL=not.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst code_1 = require(\"../code\");\nconst def = {\n    keyword: \"anyOf\",\n    schemaType: \"array\",\n    trackErrors: true,\n    code: code_1.validateUnion,\n    error: { message: \"must match a schema in anyOf\" },\n};\nexports.default = def;\n//# sourceMappingURL=anyOf.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"../../compile/codegen\");\nconst util_1 = require(\"../../compile/util\");\nconst error = {\n    message: \"must match exactly one schema in oneOf\",\n    params: ({ params }) => (0, codegen_1._) `{passingSchemas: ${params.passing}}`,\n};\nconst def = {\n    keyword: \"oneOf\",\n    schemaType: \"array\",\n    trackErrors: true,\n    error,\n    code(cxt) {\n        const { gen, schema, parentSchema, it } = cxt;\n        /* istanbul ignore if */\n        if (!Array.isArray(schema))\n            throw new Error(\"ajv implementation error\");\n        if (it.opts.discriminator && parentSchema.discriminator)\n            return;\n        const schArr = schema;\n        const valid = gen.let(\"valid\", false);\n        const passing = gen.let(\"passing\", null);\n        const schValid = gen.name(\"_valid\");\n        cxt.setParams({ passing });\n        // TODO possibly fail straight away (with warning or exception) if there are two empty always valid schemas\n        gen.block(validateOneOf);\n        cxt.result(valid, () => cxt.reset(), () => cxt.error(true));\n        function validateOneOf() {\n            schArr.forEach((sch, i) => {\n                let schCxt;\n                if ((0, util_1.alwaysValidSchema)(it, sch)) {\n                    gen.var(schValid, true);\n                }\n                else {\n                    schCxt = cxt.subschema({\n                        keyword: \"oneOf\",\n                        schemaProp: i,\n                        compositeRule: true,\n                    }, schValid);\n                }\n                if (i > 0) {\n                    gen\n                        .if((0, codegen_1._) `${schValid} && ${valid}`)\n                        .assign(valid, false)\n                        .assign(passing, (0, codegen_1._) `[${passing}, ${i}]`)\n                        .else();\n                }\n                gen.if(schValid, () => {\n                    gen.assign(valid, true);\n                    gen.assign(passing, i);\n                    if (schCxt)\n                        cxt.mergeEvaluated(schCxt, codegen_1.Name);\n                });\n            });\n        }\n    },\n};\nexports.default = def;\n//# sourceMappingURL=oneOf.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst util_1 = require(\"../../compile/util\");\nconst def = {\n    keyword: \"allOf\",\n    schemaType: \"array\",\n    code(cxt) {\n        const { gen, schema, it } = cxt;\n        /* istanbul ignore if */\n        if (!Array.isArray(schema))\n            throw new Error(\"ajv implementation error\");\n        const valid = gen.name(\"valid\");\n        schema.forEach((sch, i) => {\n            if ((0, util_1.alwaysValidSchema)(it, sch))\n                return;\n            const schCxt = cxt.subschema({ keyword: \"allOf\", schemaProp: i }, valid);\n            cxt.ok(valid);\n            cxt.mergeEvaluated(schCxt);\n        });\n    },\n};\nexports.default = def;\n//# sourceMappingURL=allOf.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"../../compile/codegen\");\nconst util_1 = require(\"../../compile/util\");\nconst error = {\n    message: ({ params }) => (0, codegen_1.str) `must match \"${params.ifClause}\" schema`,\n    params: ({ params }) => (0, codegen_1._) `{failingKeyword: ${params.ifClause}}`,\n};\nconst def = {\n    keyword: \"if\",\n    schemaType: [\"object\", \"boolean\"],\n    trackErrors: true,\n    error,\n    code(cxt) {\n        const { gen, parentSchema, it } = cxt;\n        if (parentSchema.then === undefined && parentSchema.else === undefined) {\n            (0, util_1.checkStrictMode)(it, '\"if\" without \"then\" and \"else\" is ignored');\n        }\n        const hasThen = hasSchema(it, \"then\");\n        const hasElse = hasSchema(it, \"else\");\n        if (!hasThen && !hasElse)\n            return;\n        const valid = gen.let(\"valid\", true);\n        const schValid = gen.name(\"_valid\");\n        validateIf();\n        cxt.reset();\n        if (hasThen && hasElse) {\n            const ifClause = gen.let(\"ifClause\");\n            cxt.setParams({ ifClause });\n            gen.if(schValid, validateClause(\"then\", ifClause), validateClause(\"else\", ifClause));\n        }\n        else if (hasThen) {\n            gen.if(schValid, validateClause(\"then\"));\n        }\n        else {\n            gen.if((0, codegen_1.not)(schValid), validateClause(\"else\"));\n        }\n        cxt.pass(valid, () => cxt.error(true));\n        function validateIf() {\n            const schCxt = cxt.subschema({\n                keyword: \"if\",\n                compositeRule: true,\n                createErrors: false,\n                allErrors: false,\n            }, schValid);\n            cxt.mergeEvaluated(schCxt);\n        }\n        function validateClause(keyword, ifClause) {\n            return () => {\n                const schCxt = cxt.subschema({ keyword }, schValid);\n                gen.assign(valid, schValid);\n                cxt.mergeValidEvaluated(schCxt, valid);\n                if (ifClause)\n                    gen.assign(ifClause, (0, codegen_1._) `${keyword}`);\n                else\n                    cxt.setParams({ ifClause: keyword });\n            };\n        }\n    },\n};\nfunction hasSchema(it, keyword) {\n    const schema = it.schema[keyword];\n    return schema !== undefined && !(0, util_1.alwaysValidSchema)(it, schema);\n}\nexports.default = def;\n//# sourceMappingURL=if.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst util_1 = require(\"../../compile/util\");\nconst def = {\n    keyword: [\"then\", \"else\"],\n    schemaType: [\"object\", \"boolean\"],\n    code({ keyword, parentSchema, it }) {\n        if (parentSchema.if === undefined)\n            (0, util_1.checkStrictMode)(it, `\"${keyword}\" without \"if\" is ignored`);\n    },\n};\nexports.default = def;\n//# sourceMappingURL=thenElse.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst additionalItems_1 = require(\"./additionalItems\");\nconst prefixItems_1 = require(\"./prefixItems\");\nconst items_1 = require(\"./items\");\nconst items2020_1 = require(\"./items2020\");\nconst contains_1 = require(\"./contains\");\nconst dependencies_1 = require(\"./dependencies\");\nconst propertyNames_1 = require(\"./propertyNames\");\nconst additionalProperties_1 = require(\"./additionalProperties\");\nconst properties_1 = require(\"./properties\");\nconst patternProperties_1 = require(\"./patternProperties\");\nconst not_1 = require(\"./not\");\nconst anyOf_1 = require(\"./anyOf\");\nconst oneOf_1 = require(\"./oneOf\");\nconst allOf_1 = require(\"./allOf\");\nconst if_1 = require(\"./if\");\nconst thenElse_1 = require(\"./thenElse\");\nfunction getApplicator(draft2020 = false) {\n    const applicator = [\n        // any\n        not_1.default,\n        anyOf_1.default,\n        oneOf_1.default,\n        allOf_1.default,\n        if_1.default,\n        thenElse_1.default,\n        // object\n        propertyNames_1.default,\n        additionalProperties_1.default,\n        dependencies_1.default,\n        properties_1.default,\n        patternProperties_1.default,\n    ];\n    // array\n    if (draft2020)\n        applicator.push(prefixItems_1.default, items2020_1.default);\n    else\n        applicator.push(additionalItems_1.default, items_1.default);\n    applicator.push(contains_1.default);\n    return applicator;\n}\nexports.default = getApplicator;\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"../../compile/codegen\");\nconst error = {\n    message: ({ schemaCode }) => (0, codegen_1.str) `must match format \"${schemaCode}\"`,\n    params: ({ schemaCode }) => (0, codegen_1._) `{format: ${schemaCode}}`,\n};\nconst def = {\n    keyword: \"format\",\n    type: [\"number\", \"string\"],\n    schemaType: \"string\",\n    $data: true,\n    error,\n    code(cxt, ruleType) {\n        const { gen, data, $data, schema, schemaCode, it } = cxt;\n        const { opts, errSchemaPath, schemaEnv, self } = it;\n        if (!opts.validateFormats)\n            return;\n        if ($data)\n            validate$DataFormat();\n        else\n            validateFormat();\n        function validate$DataFormat() {\n            const fmts = gen.scopeValue(\"formats\", {\n                ref: self.formats,\n                code: opts.code.formats,\n            });\n            const fDef = gen.const(\"fDef\", (0, codegen_1._) `${fmts}[${schemaCode}]`);\n            const fType = gen.let(\"fType\");\n            const format = gen.let(\"format\");\n            // TODO simplify\n            gen.if((0, codegen_1._) `typeof ${fDef} == \"object\" && !(${fDef} instanceof RegExp)`, () => gen.assign(fType, (0, codegen_1._) `${fDef}.type || \"string\"`).assign(format, (0, codegen_1._) `${fDef}.validate`), () => gen.assign(fType, (0, codegen_1._) `\"string\"`).assign(format, fDef));\n            cxt.fail$data((0, codegen_1.or)(unknownFmt(), invalidFmt()));\n            function unknownFmt() {\n                if (opts.strictSchema === false)\n                    return codegen_1.nil;\n                return (0, codegen_1._) `${schemaCode} && !${format}`;\n            }\n            function invalidFmt() {\n                const callFormat = schemaEnv.$async\n                    ? (0, codegen_1._) `(${fDef}.async ? await ${format}(${data}) : ${format}(${data}))`\n                    : (0, codegen_1._) `${format}(${data})`;\n                const validData = (0, codegen_1._) `(typeof ${format} == \"function\" ? ${callFormat} : ${format}.test(${data}))`;\n                return (0, codegen_1._) `${format} && ${format} !== true && ${fType} === ${ruleType} && !${validData}`;\n            }\n        }\n        function validateFormat() {\n            const formatDef = self.formats[schema];\n            if (!formatDef) {\n                unknownFormat();\n                return;\n            }\n            if (formatDef === true)\n                return;\n            const [fmtType, format, fmtRef] = getFormat(formatDef);\n            if (fmtType === ruleType)\n                cxt.pass(validCondition());\n            function unknownFormat() {\n                if (opts.strictSchema === false) {\n                    self.logger.warn(unknownMsg());\n                    return;\n                }\n                throw new Error(unknownMsg());\n                function unknownMsg() {\n                    return `unknown format \"${schema}\" ignored in schema at path \"${errSchemaPath}\"`;\n                }\n            }\n            function getFormat(fmtDef) {\n                const code = fmtDef instanceof RegExp\n                    ? (0, codegen_1.regexpCode)(fmtDef)\n                    : opts.code.formats\n                        ? (0, codegen_1._) `${opts.code.formats}${(0, codegen_1.getProperty)(schema)}`\n                        : undefined;\n                const fmt = gen.scopeValue(\"formats\", { key: schema, ref: fmtDef, code });\n                if (typeof fmtDef == \"object\" && !(fmtDef instanceof RegExp)) {\n                    return [fmtDef.type || \"string\", fmtDef.validate, (0, codegen_1._) `${fmt}.validate`];\n                }\n                return [\"string\", fmtDef, fmt];\n            }\n            function validCondition() {\n                if (typeof formatDef == \"object\" && !(formatDef instanceof RegExp) && formatDef.async) {\n                    if (!schemaEnv.$async)\n                        throw new Error(\"async format in sync schema\");\n                    return (0, codegen_1._) `await ${fmtRef}(${data})`;\n                }\n                return typeof format == \"function\" ? (0, codegen_1._) `${fmtRef}(${data})` : (0, codegen_1._) `${fmtRef}.test(${data})`;\n            }\n        }\n    },\n};\nexports.default = def;\n//# sourceMappingURL=format.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst format_1 = require(\"./format\");\nconst format = [format_1.default];\nexports.default = format;\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.contentVocabulary = exports.metadataVocabulary = void 0;\nexports.metadataVocabulary = [\n    \"title\",\n    \"description\",\n    \"default\",\n    \"deprecated\",\n    \"readOnly\",\n    \"writeOnly\",\n    \"examples\",\n];\nexports.contentVocabulary = [\n    \"contentMediaType\",\n    \"contentEncoding\",\n    \"contentSchema\",\n];\n//# sourceMappingURL=metadata.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst core_1 = require(\"./core\");\nconst validation_1 = require(\"./validation\");\nconst applicator_1 = require(\"./applicator\");\nconst format_1 = require(\"./format\");\nconst metadata_1 = require(\"./metadata\");\nconst draft7Vocabularies = [\n    core_1.default,\n    validation_1.default,\n    (0, applicator_1.default)(),\n    format_1.default,\n    metadata_1.metadataVocabulary,\n    metadata_1.contentVocabulary,\n];\nexports.default = draft7Vocabularies;\n//# sourceMappingURL=draft7.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.DiscrError = void 0;\nvar DiscrError;\n(function (DiscrError) {\n    DiscrError[\"Tag\"] = \"tag\";\n    DiscrError[\"Mapping\"] = \"mapping\";\n})(DiscrError || (exports.DiscrError = DiscrError = {}));\n//# sourceMappingURL=types.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst codegen_1 = require(\"../../compile/codegen\");\nconst types_1 = require(\"../discriminator/types\");\nconst compile_1 = require(\"../../compile\");\nconst ref_error_1 = require(\"../../compile/ref_error\");\nconst util_1 = require(\"../../compile/util\");\nconst error = {\n    message: ({ params: { discrError, tagName } }) => discrError === types_1.DiscrError.Tag\n        ? `tag \"${tagName}\" must be string`\n        : `value of tag \"${tagName}\" must be in oneOf`,\n    params: ({ params: { discrError, tag, tagName } }) => (0, codegen_1._) `{error: ${discrError}, tag: ${tagName}, tagValue: ${tag}}`,\n};\nconst def = {\n    keyword: \"discriminator\",\n    type: \"object\",\n    schemaType: \"object\",\n    error,\n    code(cxt) {\n        const { gen, data, schema, parentSchema, it } = cxt;\n        const { oneOf } = parentSchema;\n        if (!it.opts.discriminator) {\n            throw new Error(\"discriminator: requires discriminator option\");\n        }\n        const tagName = schema.propertyName;\n        if (typeof tagName != \"string\")\n            throw new Error(\"discriminator: requires propertyName\");\n        if (schema.mapping)\n            throw new Error(\"discriminator: mapping is not supported\");\n        if (!oneOf)\n            throw new Error(\"discriminator: requires oneOf keyword\");\n        const valid = gen.let(\"valid\", false);\n        const tag = gen.const(\"tag\", (0, codegen_1._) `${data}${(0, codegen_1.getProperty)(tagName)}`);\n        gen.if((0, codegen_1._) `typeof ${tag} == \"string\"`, () => validateMapping(), () => cxt.error(false, { discrError: types_1.DiscrError.Tag, tag, tagName }));\n        cxt.ok(valid);\n        function validateMapping() {\n            const mapping = getMapping();\n            gen.if(false);\n            for (const tagValue in mapping) {\n                gen.elseIf((0, codegen_1._) `${tag} === ${tagValue}`);\n                gen.assign(valid, applyTagSchema(mapping[tagValue]));\n            }\n            gen.else();\n            cxt.error(false, { discrError: types_1.DiscrError.Mapping, tag, tagName });\n            gen.endIf();\n        }\n        function applyTagSchema(schemaProp) {\n            const _valid = gen.name(\"valid\");\n            const schCxt = cxt.subschema({ keyword: \"oneOf\", schemaProp }, _valid);\n            cxt.mergeEvaluated(schCxt, codegen_1.Name);\n            return _valid;\n        }\n        function getMapping() {\n            var _a;\n            const oneOfMapping = {};\n            const topRequired = hasRequired(parentSchema);\n            let tagRequired = true;\n            for (let i = 0; i < oneOf.length; i++) {\n                let sch = oneOf[i];\n                if ((sch === null || sch === void 0 ? void 0 : sch.$ref) && !(0, util_1.schemaHasRulesButRef)(sch, it.self.RULES)) {\n                    const ref = sch.$ref;\n                    sch = compile_1.resolveRef.call(it.self, it.schemaEnv.root, it.baseId, ref);\n                    if (sch instanceof compile_1.SchemaEnv)\n                        sch = sch.schema;\n                    if (sch === undefined)\n                        throw new ref_error_1.default(it.opts.uriResolver, it.baseId, ref);\n                }\n                const propSch = (_a = sch === null || sch === void 0 ? void 0 : sch.properties) === null || _a === void 0 ? void 0 : _a[tagName];\n                if (typeof propSch != \"object\") {\n                    throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have \"properties/${tagName}\"`);\n                }\n                tagRequired = tagRequired && (topRequired || hasRequired(sch));\n                addMappings(propSch, i);\n            }\n            if (!tagRequired)\n                throw new Error(`discriminator: \"${tagName}\" must be required`);\n            return oneOfMapping;\n            function hasRequired({ required }) {\n                return Array.isArray(required) && required.includes(tagName);\n            }\n            function addMappings(sch, i) {\n                if (sch.const) {\n                    addMapping(sch.const, i);\n                }\n                else if (sch.enum) {\n                    for (const tagValue of sch.enum) {\n                        addMapping(tagValue, i);\n                    }\n                }\n                else {\n                    throw new Error(`discriminator: \"properties/${tagName}\" must have \"const\" or \"enum\"`);\n                }\n            }\n            function addMapping(tagValue, i) {\n                if (typeof tagValue != \"string\" || tagValue in oneOfMapping) {\n                    throw new Error(`discriminator: \"${tagName}\" values must be unique strings`);\n                }\n                oneOfMapping[tagValue] = i;\n            }\n        }\n    },\n};\nexports.default = def;\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.MissingRefError = exports.ValidationError = exports.CodeGen = exports.Name = exports.nil = exports.stringify = exports.str = exports._ = exports.KeywordCxt = exports.Ajv = void 0;\nconst core_1 = require(\"./core\");\nconst draft7_1 = require(\"./vocabularies/draft7\");\nconst discriminator_1 = require(\"./vocabularies/discriminator\");\nconst draft7MetaSchema = require(\"./refs/json-schema-draft-07.json\");\nconst META_SUPPORT_DATA = [\"/properties\"];\nconst META_SCHEMA_ID = \"http://json-schema.org/draft-07/schema\";\nclass Ajv extends core_1.default {\n    _addVocabularies() {\n        super._addVocabularies();\n        draft7_1.default.forEach((v) => this.addVocabulary(v));\n        if (this.opts.discriminator)\n            this.addKeyword(discriminator_1.default);\n    }\n    _addDefaultMetaSchema() {\n        super._addDefaultMetaSchema();\n        if (!this.opts.meta)\n            return;\n        const metaSchema = this.opts.$data\n            ? this.$dataMetaSchema(draft7MetaSchema, META_SUPPORT_DATA)\n            : draft7MetaSchema;\n        this.addMetaSchema(metaSchema, META_SCHEMA_ID, false);\n        this.refs[\"http://json-schema.org/schema\"] = META_SCHEMA_ID;\n    }\n    defaultMeta() {\n        return (this.opts.defaultMeta =\n            super.defaultMeta() || (this.getSchema(META_SCHEMA_ID) ? META_SCHEMA_ID : undefined));\n    }\n}\nexports.Ajv = Ajv;\nmodule.exports = exports = Ajv;\nmodule.exports.Ajv = Ajv;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = Ajv;\nvar validate_1 = require(\"./compile/validate\");\nObject.defineProperty(exports, \"KeywordCxt\", { enumerable: true, get: function () { return validate_1.KeywordCxt; } });\nvar codegen_1 = require(\"./compile/codegen\");\nObject.defineProperty(exports, \"_\", { enumerable: true, get: function () { return codegen_1._; } });\nObject.defineProperty(exports, \"str\", { enumerable: true, get: function () { return codegen_1.str; } });\nObject.defineProperty(exports, \"stringify\", { enumerable: true, get: function () { return codegen_1.stringify; } });\nObject.defineProperty(exports, \"nil\", { enumerable: true, get: function () { return codegen_1.nil; } });\nObject.defineProperty(exports, \"Name\", { enumerable: true, get: function () { return codegen_1.Name; } });\nObject.defineProperty(exports, \"CodeGen\", { enumerable: true, get: function () { return codegen_1.CodeGen; } });\nvar validation_error_1 = require(\"./runtime/validation_error\");\nObject.defineProperty(exports, \"ValidationError\", { enumerable: true, get: function () { return validation_error_1.default; } });\nvar ref_error_1 = require(\"./compile/ref_error\");\nObject.defineProperty(exports, \"MissingRefError\", { enumerable: true, get: function () { return ref_error_1.default; } });\n//# sourceMappingURL=ajv.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.formatNames = exports.fastFormats = exports.fullFormats = void 0;\nfunction fmtDef(validate, compare) {\n    return { validate, compare };\n}\nexports.fullFormats = {\n    // date: http://tools.ietf.org/html/rfc3339#section-5.6\n    date: fmtDef(date, compareDate),\n    // date-time: http://tools.ietf.org/html/rfc3339#section-5.6\n    time: fmtDef(getTime(true), compareTime),\n    \"date-time\": fmtDef(getDateTime(true), compareDateTime),\n    \"iso-time\": fmtDef(getTime(), compareIsoTime),\n    \"iso-date-time\": fmtDef(getDateTime(), compareIsoDateTime),\n    // duration: https://tools.ietf.org/html/rfc3339#appendix-A\n    duration: /^P(?!$)((\\d+Y)?(\\d+M)?(\\d+D)?(T(?=\\d)(\\d+H)?(\\d+M)?(\\d+S)?)?|(\\d+W)?)$/,\n    uri,\n    \"uri-reference\": /^(?:[a-z][a-z0-9+\\-.]*:)?(?:\\/?\\/(?:(?:[a-z0-9\\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\\.[a-z0-9\\-._~!$&'()*+,;=:]+)\\]|(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)|(?:[a-z0-9\\-._~!$&'\"()*+,;=]|%[0-9a-f]{2})*)(?::\\d*)?(?:\\/(?:[a-z0-9\\-._~!$&'\"()*+,;=:@]|%[0-9a-f]{2})*)*|\\/(?:(?:[a-z0-9\\-._~!$&'\"()*+,;=:@]|%[0-9a-f]{2})+(?:\\/(?:[a-z0-9\\-._~!$&'\"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\\-._~!$&'\"()*+,;=:@]|%[0-9a-f]{2})+(?:\\/(?:[a-z0-9\\-._~!$&'\"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\\?(?:[a-z0-9\\-._~!$&'\"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\\-._~!$&'\"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,\n    // uri-template: https://tools.ietf.org/html/rfc6570\n    \"uri-template\": /^(?:(?:[^\\x00-\\x20\"'<>%\\\\^`{|}]|%[0-9a-f]{2})|\\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\\*)?)*\\})*$/i,\n    // For the source: https://gist.github.com/dperini/729294\n    // For test cases: https://mathiasbynens.be/demo/url-regex\n    url: /^(?:https?|ftp):\\/\\/(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z0-9\\u{00a1}-\\u{ffff}]+-)*[a-z0-9\\u{00a1}-\\u{ffff}]+)(?:\\.(?:[a-z0-9\\u{00a1}-\\u{ffff}]+-)*[a-z0-9\\u{00a1}-\\u{ffff}]+)*(?:\\.(?:[a-z\\u{00a1}-\\u{ffff}]{2,})))(?::\\d{2,5})?(?:\\/[^\\s]*)?$/iu,\n    email: /^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,\n    hostname: /^(?=.{1,253}\\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\\.?$/i,\n    // optimized https://www.safaribooksonline.com/library/view/regular-expressions-cookbook/9780596802837/ch07s16.html\n    ipv4: /^(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.){3}(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)$/,\n    ipv6: /^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:)))$/i,\n    regex,\n    // uuid: http://tools.ietf.org/html/rfc4122\n    uuid: /^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,\n    // JSON-pointer: https://tools.ietf.org/html/rfc6901\n    // uri fragment: https://tools.ietf.org/html/rfc3986#appendix-A\n    \"json-pointer\": /^(?:\\/(?:[^~/]|~0|~1)*)*$/,\n    \"json-pointer-uri-fragment\": /^#(?:\\/(?:[a-z0-9_\\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,\n    // relative JSON-pointer: http://tools.ietf.org/html/draft-luff-relative-json-pointer-00\n    \"relative-json-pointer\": /^(?:0|[1-9][0-9]*)(?:#|(?:\\/(?:[^~/]|~0|~1)*)*)$/,\n    // the following formats are used by the openapi specification: https://spec.openapis.org/oas/v3.0.0#data-types\n    // byte: https://github.com/miguelmota/is-base64\n    byte,\n    // signed 32 bit integer\n    int32: { type: \"number\", validate: validateInt32 },\n    // signed 64 bit integer\n    int64: { type: \"number\", validate: validateInt64 },\n    // C-type float\n    float: { type: \"number\", validate: validateNumber },\n    // C-type double\n    double: { type: \"number\", validate: validateNumber },\n    // hint to the UI to hide input strings\n    password: true,\n    // unchecked string payload\n    binary: true,\n};\nexports.fastFormats = {\n    ...exports.fullFormats,\n    date: fmtDef(/^\\d\\d\\d\\d-[0-1]\\d-[0-3]\\d$/, compareDate),\n    time: fmtDef(/^(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)(?:\\.\\d+)?(?:z|[+-]\\d\\d(?::?\\d\\d)?)$/i, compareTime),\n    \"date-time\": fmtDef(/^\\d\\d\\d\\d-[0-1]\\d-[0-3]\\dt(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)(?:\\.\\d+)?(?:z|[+-]\\d\\d(?::?\\d\\d)?)$/i, compareDateTime),\n    \"iso-time\": fmtDef(/^(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)(?:\\.\\d+)?(?:z|[+-]\\d\\d(?::?\\d\\d)?)?$/i, compareIsoTime),\n    \"iso-date-time\": fmtDef(/^\\d\\d\\d\\d-[0-1]\\d-[0-3]\\d[t\\s](?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)(?:\\.\\d+)?(?:z|[+-]\\d\\d(?::?\\d\\d)?)?$/i, compareIsoDateTime),\n    // uri: https://github.com/mafintosh/is-my-json-valid/blob/master/formats.js\n    uri: /^(?:[a-z][a-z0-9+\\-.]*:)(?:\\/?\\/)?[^\\s]*$/i,\n    \"uri-reference\": /^(?:(?:[a-z][a-z0-9+\\-.]*:)?\\/?\\/)?(?:[^\\\\\\s#][^\\s#]*)?(?:#[^\\\\\\s]*)?$/i,\n    // email (sources from jsen validator):\n    // http://stackoverflow.com/questions/201323/using-a-regular-expression-to-validate-an-email-address#answer-8829363\n    // http://www.w3.org/TR/html5/forms.html#valid-e-mail-address (search for 'wilful violation')\n    email: /^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,\n};\nexports.formatNames = Object.keys(exports.fullFormats);\nfunction isLeapYear(year) {\n    // https://tools.ietf.org/html/rfc3339#appendix-C\n    return year % 4 === 0 && (year % 100 !== 0 || year % 400 === 0);\n}\nconst DATE = /^(\\d\\d\\d\\d)-(\\d\\d)-(\\d\\d)$/;\nconst DAYS = [0, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];\nfunction date(str) {\n    // full-date from http://tools.ietf.org/html/rfc3339#section-5.6\n    const matches = DATE.exec(str);\n    if (!matches)\n        return false;\n    const year = +matches[1];\n    const month = +matches[2];\n    const day = +matches[3];\n    return (month >= 1 &&\n        month <= 12 &&\n        day >= 1 &&\n        day <= (month === 2 && isLeapYear(year) ? 29 : DAYS[month]));\n}\nfunction compareDate(d1, d2) {\n    if (!(d1 && d2))\n        return undefined;\n    if (d1 > d2)\n        return 1;\n    if (d1 < d2)\n        return -1;\n    return 0;\n}\nconst TIME = /^(\\d\\d):(\\d\\d):(\\d\\d(?:\\.\\d+)?)(z|([+-])(\\d\\d)(?::?(\\d\\d))?)?$/i;\nfunction getTime(strictTimeZone) {\n    return function time(str) {\n        const matches = TIME.exec(str);\n        if (!matches)\n            return false;\n        const hr = +matches[1];\n        const min = +matches[2];\n        const sec = +matches[3];\n        const tz = matches[4];\n        const tzSign = matches[5] === \"-\" ? -1 : 1;\n        const tzH = +(matches[6] || 0);\n        const tzM = +(matches[7] || 0);\n        if (tzH > 23 || tzM > 59 || (strictTimeZone && !tz))\n            return false;\n        if (hr <= 23 && min <= 59 && sec < 60)\n            return true;\n        // leap second\n        const utcMin = min - tzM * tzSign;\n        const utcHr = hr - tzH * tzSign - (utcMin < 0 ? 1 : 0);\n        return (utcHr === 23 || utcHr === -1) && (utcMin === 59 || utcMin === -1) && sec < 61;\n    };\n}\nfunction compareTime(s1, s2) {\n    if (!(s1 && s2))\n        return undefined;\n    const t1 = new Date(\"2020-01-01T\" + s1).valueOf();\n    const t2 = new Date(\"2020-01-01T\" + s2).valueOf();\n    if (!(t1 && t2))\n        return undefined;\n    return t1 - t2;\n}\nfunction compareIsoTime(t1, t2) {\n    if (!(t1 && t2))\n        return undefined;\n    const a1 = TIME.exec(t1);\n    const a2 = TIME.exec(t2);\n    if (!(a1 && a2))\n        return undefined;\n    t1 = a1[1] + a1[2] + a1[3];\n    t2 = a2[1] + a2[2] + a2[3];\n    if (t1 > t2)\n        return 1;\n    if (t1 < t2)\n        return -1;\n    return 0;\n}\nconst DATE_TIME_SEPARATOR = /t|\\s/i;\nfunction getDateTime(strictTimeZone) {\n    const time = getTime(strictTimeZone);\n    return function date_time(str) {\n        // http://tools.ietf.org/html/rfc3339#section-5.6\n        const dateTime = str.split(DATE_TIME_SEPARATOR);\n        return dateTime.length === 2 && date(dateTime[0]) && time(dateTime[1]);\n    };\n}\nfunction compareDateTime(dt1, dt2) {\n    if (!(dt1 && dt2))\n        return undefined;\n    const d1 = new Date(dt1).valueOf();\n    const d2 = new Date(dt2).valueOf();\n    if (!(d1 && d2))\n        return undefined;\n    return d1 - d2;\n}\nfunction compareIsoDateTime(dt1, dt2) {\n    if (!(dt1 && dt2))\n        return undefined;\n    const [d1, t1] = dt1.split(DATE_TIME_SEPARATOR);\n    const [d2, t2] = dt2.split(DATE_TIME_SEPARATOR);\n    const res = compareDate(d1, d2);\n    if (res === undefined)\n        return undefined;\n    return res || compareTime(t1, t2);\n}\nconst NOT_URI_FRAGMENT = /\\/|:/;\nconst URI = /^(?:[a-z][a-z0-9+\\-.]*:)(?:\\/?\\/(?:(?:[a-z0-9\\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\\.[a-z0-9\\-._~!$&'()*+,;=:]+)\\]|(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)|(?:[a-z0-9\\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\\d*)?(?:\\/(?:[a-z0-9\\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\\/(?:(?:[a-z0-9\\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\\/(?:[a-z0-9\\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\\/(?:[a-z0-9\\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\\?(?:[a-z0-9\\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;\nfunction uri(str) {\n    // http://jmrware.com/articles/2009/uri_regexp/URI_regex.html + optional protocol + required \".\"\n    return NOT_URI_FRAGMENT.test(str) && URI.test(str);\n}\nconst BYTE = /^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;\nfunction byte(str) {\n    BYTE.lastIndex = 0;\n    return BYTE.test(str);\n}\nconst MIN_INT32 = -(2 ** 31);\nconst MAX_INT32 = 2 ** 31 - 1;\nfunction validateInt32(value) {\n    return Number.isInteger(value) && value <= MAX_INT32 && value >= MIN_INT32;\n}\nfunction validateInt64(value) {\n    // JSON and javascript max Int is 2**53, so any int that passes isInteger is valid for Int64\n    return Number.isInteger(value);\n}\nfunction validateNumber() {\n    return true;\n}\nconst Z_ANCHOR = /[^\\\\]\\\\Z/;\nfunction regex(str) {\n    if (Z_ANCHOR.test(str))\n        return false;\n    try {\n        new RegExp(str);\n        return true;\n    }\n    catch (e) {\n        return false;\n    }\n}\n//# sourceMappingURL=formats.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.formatLimitDefinition = void 0;\nconst ajv_1 = require(\"ajv\");\nconst codegen_1 = require(\"ajv/dist/compile/codegen\");\nconst ops = codegen_1.operators;\nconst KWDs = {\n    formatMaximum: { okStr: \"<=\", ok: ops.LTE, fail: ops.GT },\n    formatMinimum: { okStr: \">=\", ok: ops.GTE, fail: ops.LT },\n    formatExclusiveMaximum: { okStr: \"<\", ok: ops.LT, fail: ops.GTE },\n    formatExclusiveMinimum: { okStr: \">\", ok: ops.GT, fail: ops.LTE },\n};\nconst error = {\n    message: ({ keyword, schemaCode }) => (0, codegen_1.str) `should be ${KWDs[keyword].okStr} ${schemaCode}`,\n    params: ({ keyword, schemaCode }) => (0, codegen_1._) `{comparison: ${KWDs[keyword].okStr}, limit: ${schemaCode}}`,\n};\nexports.formatLimitDefinition = {\n    keyword: Object.keys(KWDs),\n    type: \"string\",\n    schemaType: \"string\",\n    $data: true,\n    error,\n    code(cxt) {\n        const { gen, data, schemaCode, keyword, it } = cxt;\n        const { opts, self } = it;\n        if (!opts.validateFormats)\n            return;\n        const fCxt = new ajv_1.KeywordCxt(it, self.RULES.all.format.definition, \"format\");\n        if (fCxt.$data)\n            validate$DataFormat();\n        else\n            validateFormat();\n        function validate$DataFormat() {\n            const fmts = gen.scopeValue(\"formats\", {\n                ref: self.formats,\n                code: opts.code.formats,\n            });\n            const fmt = gen.const(\"fmt\", (0, codegen_1._) `${fmts}[${fCxt.schemaCode}]`);\n            cxt.fail$data((0, codegen_1.or)((0, codegen_1._) `typeof ${fmt} != \"object\"`, (0, codegen_1._) `${fmt} instanceof RegExp`, (0, codegen_1._) `typeof ${fmt}.compare != \"function\"`, compareCode(fmt)));\n        }\n        function validateFormat() {\n            const format = fCxt.schema;\n            const fmtDef = self.formats[format];\n            if (!fmtDef || fmtDef === true)\n                return;\n            if (typeof fmtDef != \"object\" ||\n                fmtDef instanceof RegExp ||\n                typeof fmtDef.compare != \"function\") {\n                throw new Error(`\"${keyword}\": format \"${format}\" does not define \"compare\" function`);\n            }\n            const fmt = gen.scopeValue(\"formats\", {\n                key: format,\n                ref: fmtDef,\n                code: opts.code.formats ? (0, codegen_1._) `${opts.code.formats}${(0, codegen_1.getProperty)(format)}` : undefined,\n            });\n            cxt.fail$data(compareCode(fmt));\n        }\n        function compareCode(fmt) {\n            return (0, codegen_1._) `${fmt}.compare(${data}, ${schemaCode}) ${KWDs[keyword].fail} 0`;\n        }\n    },\n    dependencies: [\"format\"],\n};\nconst formatLimitPlugin = (ajv) => {\n    ajv.addKeyword(exports.formatLimitDefinition);\n    return ajv;\n};\nexports.default = formatLimitPlugin;\n//# sourceMappingURL=limit.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst formats_1 = require(\"./formats\");\nconst limit_1 = require(\"./limit\");\nconst codegen_1 = require(\"ajv/dist/compile/codegen\");\nconst fullName = new codegen_1.Name(\"fullFormats\");\nconst fastName = new codegen_1.Name(\"fastFormats\");\nconst formatsPlugin = (ajv, opts = { keywords: true }) => {\n    if (Array.isArray(opts)) {\n        addFormats(ajv, opts, formats_1.fullFormats, fullName);\n        return ajv;\n    }\n    const [formats, exportName] = opts.mode === \"fast\" ? [formats_1.fastFormats, fastName] : [formats_1.fullFormats, fullName];\n    const list = opts.formats || formats_1.formatNames;\n    addFormats(ajv, list, formats, exportName);\n    if (opts.keywords)\n        (0, limit_1.default)(ajv);\n    return ajv;\n};\nformatsPlugin.get = (name, mode = \"full\") => {\n    const formats = mode === \"fast\" ? formats_1.fastFormats : formats_1.fullFormats;\n    const f = formats[name];\n    if (!f)\n        throw new Error(`Unknown format \"${name}\"`);\n    return f;\n};\nfunction addFormats(ajv, list, fs, exportName) {\n    var _a;\n    var _b;\n    (_a = (_b = ajv.opts.code).formats) !== null && _a !== void 0 ? _a : (_b.formats = (0, codegen_1._) `require(\"ajv-formats/dist/formats\").${exportName}`);\n    for (const f of list)\n        ajv.addFormat(f, fs[f]);\n}\nmodule.exports = exports = formatsPlugin;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = formatsPlugin;\n//# sourceMappingURL=index.js.map","/**\n * AJV-based JSON Schema validator provider\n */\nimport { Ajv } from 'ajv';\nimport _addFormats from 'ajv-formats';\nfunction createDefaultAjvInstance() {\n    const ajv = new Ajv({\n        strict: false,\n        validateFormats: true,\n        validateSchema: false,\n        allErrors: true\n    });\n    const addFormats = _addFormats;\n    addFormats(ajv);\n    return ajv;\n}\n/**\n * @example\n * ```typescript\n * // Use with default AJV instance (recommended)\n * import { AjvJsonSchemaValidator } from '@modelcontextprotocol/sdk/validation/ajv';\n * const validator = new AjvJsonSchemaValidator();\n *\n * // Use with custom AJV instance\n * import { Ajv } from 'ajv';\n * const ajv = new Ajv({ strict: true, allErrors: true });\n * const validator = new AjvJsonSchemaValidator(ajv);\n * ```\n */\nexport class AjvJsonSchemaValidator {\n    /**\n     * Create an AJV validator\n     *\n     * @param ajv - Optional pre-configured AJV instance. If not provided, a default instance will be created.\n     *\n     * @example\n     * ```typescript\n     * // Use default configuration (recommended for most cases)\n     * import { AjvJsonSchemaValidator } from '@modelcontextprotocol/sdk/validation/ajv';\n     * const validator = new AjvJsonSchemaValidator();\n     *\n     * // Or provide custom AJV instance for advanced configuration\n     * import { Ajv } from 'ajv';\n     * import addFormats from 'ajv-formats';\n     *\n     * const ajv = new Ajv({ validateFormats: true });\n     * addFormats(ajv);\n     * const validator = new AjvJsonSchemaValidator(ajv);\n     * ```\n     */\n    constructor(ajv) {\n        this._ajv = ajv !== null && ajv !== void 0 ? ajv : createDefaultAjvInstance();\n    }\n    /**\n     * Create a validator for the given JSON Schema\n     *\n     * The validator is compiled once and can be reused multiple times.\n     * If the schema has an $id, it will be cached by AJV automatically.\n     *\n     * @param schema - Standard JSON Schema object\n     * @returns A validator function that validates input data\n     */\n    getValidator(schema) {\n        var _a;\n        // Check if schema has $id and is already compiled/cached\n        const ajvValidator = '$id' in schema && typeof schema.$id === 'string'\n            ? ((_a = this._ajv.getSchema(schema.$id)) !== null && _a !== void 0 ? _a : this._ajv.compile(schema))\n            : this._ajv.compile(schema);\n        return (input) => {\n            const valid = ajvValidator(input);\n            if (valid) {\n                return {\n                    valid: true,\n                    data: input,\n                    errorMessage: undefined\n                };\n            }\n            else {\n                return {\n                    valid: false,\n                    data: undefined,\n                    errorMessage: this._ajv.errorsText(ajvValidator.errors)\n                };\n            }\n        };\n    }\n}\n//# sourceMappingURL=ajv-provider.js.map","/**\n * Experimental client task features for MCP SDK.\n * WARNING: These APIs are experimental and may change without notice.\n *\n * @experimental\n */\nimport { CallToolResultSchema, McpError, ErrorCode } from '../../types.js';\n/**\n * Experimental task features for MCP clients.\n *\n * Access via `client.experimental.tasks`:\n * ```typescript\n * const stream = client.experimental.tasks.callToolStream({ name: 'tool', arguments: {} });\n * const task = await client.experimental.tasks.getTask(taskId);\n * ```\n *\n * @experimental\n */\nexport class ExperimentalClientTasks {\n    constructor(_client) {\n        this._client = _client;\n    }\n    /**\n     * Calls a tool and returns an AsyncGenerator that yields response messages.\n     * The generator is guaranteed to end with either a 'result' or 'error' message.\n     *\n     * This method provides streaming access to tool execution, allowing you to\n     * observe intermediate task status updates for long-running tool calls.\n     * Automatically validates structured output if the tool has an outputSchema.\n     *\n     * @example\n     * ```typescript\n     * const stream = client.experimental.tasks.callToolStream({ name: 'myTool', arguments: {} });\n     * for await (const message of stream) {\n     *   switch (message.type) {\n     *     case 'taskCreated':\n     *       console.log('Tool execution started:', message.task.taskId);\n     *       break;\n     *     case 'taskStatus':\n     *       console.log('Tool status:', message.task.status);\n     *       break;\n     *     case 'result':\n     *       console.log('Tool result:', message.result);\n     *       break;\n     *     case 'error':\n     *       console.error('Tool error:', message.error);\n     *       break;\n     *   }\n     * }\n     * ```\n     *\n     * @param params - Tool call parameters (name and arguments)\n     * @param resultSchema - Zod schema for validating the result (defaults to CallToolResultSchema)\n     * @param options - Optional request options (timeout, signal, task creation params, etc.)\n     * @returns AsyncGenerator that yields ResponseMessage objects\n     *\n     * @experimental\n     */\n    async *callToolStream(params, resultSchema = CallToolResultSchema, options) {\n        var _a;\n        // Access Client's internal methods\n        const clientInternal = this._client;\n        // Add task creation parameters if server supports it and not explicitly provided\n        const optionsWithTask = {\n            ...options,\n            // We check if the tool is known to be a task during auto-configuration, but assume\n            // the caller knows what they're doing if they pass this explicitly\n            task: (_a = options === null || options === void 0 ? void 0 : options.task) !== null && _a !== void 0 ? _a : (clientInternal.isToolTask(params.name) ? {} : undefined)\n        };\n        const stream = clientInternal.requestStream({ method: 'tools/call', params }, resultSchema, optionsWithTask);\n        // Get the validator for this tool (if it has an output schema)\n        const validator = clientInternal.getToolOutputValidator(params.name);\n        // Iterate through the stream and validate the final result if needed\n        for await (const message of stream) {\n            // If this is a result message and the tool has an output schema, validate it\n            if (message.type === 'result' && validator) {\n                const result = message.result;\n                // If tool has outputSchema, it MUST return structuredContent (unless it's an error)\n                if (!result.structuredContent && !result.isError) {\n                    yield {\n                        type: 'error',\n                        error: new McpError(ErrorCode.InvalidRequest, `Tool ${params.name} has an output schema but did not return structured content`)\n                    };\n                    return;\n                }\n                // Only validate structured content if present (not when there's an error)\n                if (result.structuredContent) {\n                    try {\n                        // Validate the structured content against the schema\n                        const validationResult = validator(result.structuredContent);\n                        if (!validationResult.valid) {\n                            yield {\n                                type: 'error',\n                                error: new McpError(ErrorCode.InvalidParams, `Structured content does not match the tool's output schema: ${validationResult.errorMessage}`)\n                            };\n                            return;\n                        }\n                    }\n                    catch (error) {\n                        if (error instanceof McpError) {\n                            yield { type: 'error', error };\n                            return;\n                        }\n                        yield {\n                            type: 'error',\n                            error: new McpError(ErrorCode.InvalidParams, `Failed to validate structured content: ${error instanceof Error ? error.message : String(error)}`)\n                        };\n                        return;\n                    }\n                }\n            }\n            // Yield the message (either validated result or any other message type)\n            yield message;\n        }\n    }\n    /**\n     * Gets the current status of a task.\n     *\n     * @param taskId - The task identifier\n     * @param options - Optional request options\n     * @returns The task status\n     *\n     * @experimental\n     */\n    async getTask(taskId, options) {\n        return this._client.getTask({ taskId }, options);\n    }\n    /**\n     * Retrieves the result of a completed task.\n     *\n     * @param taskId - The task identifier\n     * @param resultSchema - Zod schema for validating the result\n     * @param options - Optional request options\n     * @returns The task result\n     *\n     * @experimental\n     */\n    async getTaskResult(taskId, resultSchema, options) {\n        // Delegate to the client's underlying Protocol method\n        return this._client.getTaskResult({ taskId }, resultSchema, options);\n    }\n    /**\n     * Lists tasks with optional pagination.\n     *\n     * @param cursor - Optional pagination cursor\n     * @param options - Optional request options\n     * @returns List of tasks with optional next cursor\n     *\n     * @experimental\n     */\n    async listTasks(cursor, options) {\n        // Delegate to the client's underlying Protocol method\n        return this._client.listTasks(cursor ? { cursor } : undefined, options);\n    }\n    /**\n     * Cancels a running task.\n     *\n     * @param taskId - The task identifier\n     * @param options - Optional request options\n     *\n     * @experimental\n     */\n    async cancelTask(taskId, options) {\n        // Delegate to the client's underlying Protocol method\n        return this._client.cancelTask({ taskId }, options);\n    }\n    /**\n     * Sends a request and returns an AsyncGenerator that yields response messages.\n     * The generator is guaranteed to end with either a 'result' or 'error' message.\n     *\n     * This method provides streaming access to request processing, allowing you to\n     * observe intermediate task status updates for task-augmented requests.\n     *\n     * @param request - The request to send\n     * @param resultSchema - Zod schema for validating the result\n     * @param options - Optional request options (timeout, signal, task creation params, etc.)\n     * @returns AsyncGenerator that yields ResponseMessage objects\n     *\n     * @experimental\n     */\n    requestStream(request, resultSchema, options) {\n        return this._client.requestStream(request, resultSchema, options);\n    }\n}\n//# sourceMappingURL=client.js.map","/**\n * Experimental task capability assertion helpers.\n * WARNING: These APIs are experimental and may change without notice.\n *\n * @experimental\n */\n/**\n * Asserts that task creation is supported for tools/call.\n * Used by Client.assertTaskCapability and Server.assertTaskHandlerCapability.\n *\n * @param requests - The task requests capability object\n * @param method - The method being checked\n * @param entityName - 'Server' or 'Client' for error messages\n * @throws Error if the capability is not supported\n *\n * @experimental\n */\nexport function assertToolsCallTaskCapability(requests, method, entityName) {\n    var _a;\n    if (!requests) {\n        throw new Error(`${entityName} does not support task creation (required for ${method})`);\n    }\n    switch (method) {\n        case 'tools/call':\n            if (!((_a = requests.tools) === null || _a === void 0 ? void 0 : _a.call)) {\n                throw new Error(`${entityName} does not support task creation for tools/call (required for ${method})`);\n            }\n            break;\n        default:\n            // Method doesn't support tasks, which is fine - no error\n            break;\n    }\n}\n/**\n * Asserts that task creation is supported for sampling/createMessage or elicitation/create.\n * Used by Server.assertTaskCapability and Client.assertTaskHandlerCapability.\n *\n * @param requests - The task requests capability object\n * @param method - The method being checked\n * @param entityName - 'Server' or 'Client' for error messages\n * @throws Error if the capability is not supported\n *\n * @experimental\n */\nexport function assertClientRequestTaskCapability(requests, method, entityName) {\n    var _a, _b;\n    if (!requests) {\n        throw new Error(`${entityName} does not support task creation (required for ${method})`);\n    }\n    switch (method) {\n        case 'sampling/createMessage':\n            if (!((_a = requests.sampling) === null || _a === void 0 ? void 0 : _a.createMessage)) {\n                throw new Error(`${entityName} does not support task creation for sampling/createMessage (required for ${method})`);\n            }\n            break;\n        case 'elicitation/create':\n            if (!((_b = requests.elicitation) === null || _b === void 0 ? void 0 : _b.create)) {\n                throw new Error(`${entityName} does not support task creation for elicitation/create (required for ${method})`);\n            }\n            break;\n        default:\n            // Method doesn't support tasks, which is fine - no error\n            break;\n    }\n}\n//# sourceMappingURL=helpers.js.map","import { mergeCapabilities, Protocol } from '../shared/protocol.js';\nimport { CallToolResultSchema, CompleteResultSchema, EmptyResultSchema, ErrorCode, GetPromptResultSchema, InitializeResultSchema, LATEST_PROTOCOL_VERSION, ListPromptsResultSchema, ListResourcesResultSchema, ListResourceTemplatesResultSchema, ListToolsResultSchema, McpError, ReadResourceResultSchema, SUPPORTED_PROTOCOL_VERSIONS, ElicitResultSchema, ElicitRequestSchema, CreateTaskResultSchema, CreateMessageRequestSchema, CreateMessageResultSchema } from '../types.js';\nimport { AjvJsonSchemaValidator } from '../validation/ajv-provider.js';\nimport { getObjectShape, isZ4Schema, safeParse } from '../server/zod-compat.js';\nimport { ExperimentalClientTasks } from '../experimental/tasks/client.js';\nimport { assertToolsCallTaskCapability, assertClientRequestTaskCapability } from '../experimental/tasks/helpers.js';\n/**\n * Elicitation default application helper. Applies defaults to the data based on the schema.\n *\n * @param schema - The schema to apply defaults to.\n * @param data - The data to apply defaults to.\n */\nfunction applyElicitationDefaults(schema, data) {\n    if (!schema || data === null || typeof data !== 'object')\n        return;\n    // Handle object properties\n    if (schema.type === 'object' && schema.properties && typeof schema.properties === 'object') {\n        const obj = data;\n        const props = schema.properties;\n        for (const key of Object.keys(props)) {\n            const propSchema = props[key];\n            // If missing or explicitly undefined, apply default if present\n            if (obj[key] === undefined && Object.prototype.hasOwnProperty.call(propSchema, 'default')) {\n                obj[key] = propSchema.default;\n            }\n            // Recurse into existing nested objects/arrays\n            if (obj[key] !== undefined) {\n                applyElicitationDefaults(propSchema, obj[key]);\n            }\n        }\n    }\n    if (Array.isArray(schema.anyOf)) {\n        for (const sub of schema.anyOf) {\n            applyElicitationDefaults(sub, data);\n        }\n    }\n    // Combine schemas\n    if (Array.isArray(schema.oneOf)) {\n        for (const sub of schema.oneOf) {\n            applyElicitationDefaults(sub, data);\n        }\n    }\n}\n/**\n * Determines which elicitation modes are supported based on declared client capabilities.\n *\n * According to the spec:\n * - An empty elicitation capability object defaults to form mode support (backwards compatibility)\n * - URL mode is only supported if explicitly declared\n *\n * @param capabilities - The client's elicitation capabilities\n * @returns An object indicating which modes are supported\n */\nexport function getSupportedElicitationModes(capabilities) {\n    if (!capabilities) {\n        return { supportsFormMode: false, supportsUrlMode: false };\n    }\n    const hasFormCapability = capabilities.form !== undefined;\n    const hasUrlCapability = capabilities.url !== undefined;\n    // If neither form nor url are explicitly declared, form mode is supported (backwards compatibility)\n    const supportsFormMode = hasFormCapability || (!hasFormCapability && !hasUrlCapability);\n    const supportsUrlMode = hasUrlCapability;\n    return { supportsFormMode, supportsUrlMode };\n}\n/**\n * An MCP client on top of a pluggable transport.\n *\n * The client will automatically begin the initialization flow with the server when connect() is called.\n *\n * To use with custom types, extend the base Request/Notification/Result types and pass them as type parameters:\n *\n * ```typescript\n * // Custom schemas\n * const CustomRequestSchema = RequestSchema.extend({...})\n * const CustomNotificationSchema = NotificationSchema.extend({...})\n * const CustomResultSchema = ResultSchema.extend({...})\n *\n * // Type aliases\n * type CustomRequest = z.infer<typeof CustomRequestSchema>\n * type CustomNotification = z.infer<typeof CustomNotificationSchema>\n * type CustomResult = z.infer<typeof CustomResultSchema>\n *\n * // Create typed client\n * const client = new Client<CustomRequest, CustomNotification, CustomResult>({\n *   name: \"CustomClient\",\n *   version: \"1.0.0\"\n * })\n * ```\n */\nexport class Client extends Protocol {\n    /**\n     * Initializes this client with the given name and version information.\n     */\n    constructor(_clientInfo, options) {\n        var _a, _b;\n        super(options);\n        this._clientInfo = _clientInfo;\n        this._cachedToolOutputValidators = new Map();\n        this._cachedKnownTaskTools = new Set();\n        this._cachedRequiredTaskTools = new Set();\n        this._capabilities = (_a = options === null || options === void 0 ? void 0 : options.capabilities) !== null && _a !== void 0 ? _a : {};\n        this._jsonSchemaValidator = (_b = options === null || options === void 0 ? void 0 : options.jsonSchemaValidator) !== null && _b !== void 0 ? _b : new AjvJsonSchemaValidator();\n    }\n    /**\n     * Access experimental features.\n     *\n     * WARNING: These APIs are experimental and may change without notice.\n     *\n     * @experimental\n     */\n    get experimental() {\n        if (!this._experimental) {\n            this._experimental = {\n                tasks: new ExperimentalClientTasks(this)\n            };\n        }\n        return this._experimental;\n    }\n    /**\n     * Registers new capabilities. This can only be called before connecting to a transport.\n     *\n     * The new capabilities will be merged with any existing capabilities previously given (e.g., at initialization).\n     */\n    registerCapabilities(capabilities) {\n        if (this.transport) {\n            throw new Error('Cannot register capabilities after connecting to transport');\n        }\n        this._capabilities = mergeCapabilities(this._capabilities, capabilities);\n    }\n    /**\n     * Override request handler registration to enforce client-side validation for elicitation.\n     */\n    setRequestHandler(requestSchema, handler) {\n        var _a, _b, _c;\n        const shape = getObjectShape(requestSchema);\n        const methodSchema = shape === null || shape === void 0 ? void 0 : shape.method;\n        if (!methodSchema) {\n            throw new Error('Schema is missing a method literal');\n        }\n        // Extract literal value using type-safe property access\n        let methodValue;\n        if (isZ4Schema(methodSchema)) {\n            const v4Schema = methodSchema;\n            const v4Def = (_a = v4Schema._zod) === null || _a === void 0 ? void 0 : _a.def;\n            methodValue = (_b = v4Def === null || v4Def === void 0 ? void 0 : v4Def.value) !== null && _b !== void 0 ? _b : v4Schema.value;\n        }\n        else {\n            const v3Schema = methodSchema;\n            const legacyDef = v3Schema._def;\n            methodValue = (_c = legacyDef === null || legacyDef === void 0 ? void 0 : legacyDef.value) !== null && _c !== void 0 ? _c : v3Schema.value;\n        }\n        if (typeof methodValue !== 'string') {\n            throw new Error('Schema method literal must be a string');\n        }\n        const method = methodValue;\n        if (method === 'elicitation/create') {\n            const wrappedHandler = async (request, extra) => {\n                var _a, _b, _c;\n                const validatedRequest = safeParse(ElicitRequestSchema, request);\n                if (!validatedRequest.success) {\n                    // Type guard: if success is false, error is guaranteed to exist\n                    const errorMessage = validatedRequest.error instanceof Error ? validatedRequest.error.message : String(validatedRequest.error);\n                    throw new McpError(ErrorCode.InvalidParams, `Invalid elicitation request: ${errorMessage}`);\n                }\n                const { params } = validatedRequest.data;\n                const mode = (_a = params.mode) !== null && _a !== void 0 ? _a : 'form';\n                const { supportsFormMode, supportsUrlMode } = getSupportedElicitationModes(this._capabilities.elicitation);\n                if (mode === 'form' && !supportsFormMode) {\n                    throw new McpError(ErrorCode.InvalidParams, 'Client does not support form-mode elicitation requests');\n                }\n                if (mode === 'url' && !supportsUrlMode) {\n                    throw new McpError(ErrorCode.InvalidParams, 'Client does not support URL-mode elicitation requests');\n                }\n                const result = await Promise.resolve(handler(request, extra));\n                // When task creation is requested, validate and return CreateTaskResult\n                if (params.task) {\n                    const taskValidationResult = safeParse(CreateTaskResultSchema, result);\n                    if (!taskValidationResult.success) {\n                        const errorMessage = taskValidationResult.error instanceof Error\n                            ? taskValidationResult.error.message\n                            : String(taskValidationResult.error);\n                        throw new McpError(ErrorCode.InvalidParams, `Invalid task creation result: ${errorMessage}`);\n                    }\n                    return taskValidationResult.data;\n                }\n                // For non-task requests, validate against ElicitResultSchema\n                const validationResult = safeParse(ElicitResultSchema, result);\n                if (!validationResult.success) {\n                    // Type guard: if success is false, error is guaranteed to exist\n                    const errorMessage = validationResult.error instanceof Error ? validationResult.error.message : String(validationResult.error);\n                    throw new McpError(ErrorCode.InvalidParams, `Invalid elicitation result: ${errorMessage}`);\n                }\n                const validatedResult = validationResult.data;\n                const requestedSchema = mode === 'form' ? params.requestedSchema : undefined;\n                if (mode === 'form' && validatedResult.action === 'accept' && validatedResult.content && requestedSchema) {\n                    if ((_c = (_b = this._capabilities.elicitation) === null || _b === void 0 ? void 0 : _b.form) === null || _c === void 0 ? void 0 : _c.applyDefaults) {\n                        try {\n                            applyElicitationDefaults(requestedSchema, validatedResult.content);\n                        }\n                        catch (_d) {\n                            // gracefully ignore errors in default application\n                        }\n                    }\n                }\n                return validatedResult;\n            };\n            // Install the wrapped handler\n            return super.setRequestHandler(requestSchema, wrappedHandler);\n        }\n        if (method === 'sampling/createMessage') {\n            const wrappedHandler = async (request, extra) => {\n                const validatedRequest = safeParse(CreateMessageRequestSchema, request);\n                if (!validatedRequest.success) {\n                    const errorMessage = validatedRequest.error instanceof Error ? validatedRequest.error.message : String(validatedRequest.error);\n                    throw new McpError(ErrorCode.InvalidParams, `Invalid sampling request: ${errorMessage}`);\n                }\n                const { params } = validatedRequest.data;\n                const result = await Promise.resolve(handler(request, extra));\n                // When task creation is requested, validate and return CreateTaskResult\n                if (params.task) {\n                    const taskValidationResult = safeParse(CreateTaskResultSchema, result);\n                    if (!taskValidationResult.success) {\n                        const errorMessage = taskValidationResult.error instanceof Error\n                            ? taskValidationResult.error.message\n                            : String(taskValidationResult.error);\n                        throw new McpError(ErrorCode.InvalidParams, `Invalid task creation result: ${errorMessage}`);\n                    }\n                    return taskValidationResult.data;\n                }\n                // For non-task requests, validate against CreateMessageResultSchema\n                const validationResult = safeParse(CreateMessageResultSchema, result);\n                if (!validationResult.success) {\n                    const errorMessage = validationResult.error instanceof Error ? validationResult.error.message : String(validationResult.error);\n                    throw new McpError(ErrorCode.InvalidParams, `Invalid sampling result: ${errorMessage}`);\n                }\n                return validationResult.data;\n            };\n            // Install the wrapped handler\n            return super.setRequestHandler(requestSchema, wrappedHandler);\n        }\n        // Other handlers use default behavior\n        return super.setRequestHandler(requestSchema, handler);\n    }\n    assertCapability(capability, method) {\n        var _a;\n        if (!((_a = this._serverCapabilities) === null || _a === void 0 ? void 0 : _a[capability])) {\n            throw new Error(`Server does not support ${capability} (required for ${method})`);\n        }\n    }\n    async connect(transport, options) {\n        await super.connect(transport);\n        // When transport sessionId is already set this means we are trying to reconnect.\n        // In this case we don't need to initialize again.\n        if (transport.sessionId !== undefined) {\n            return;\n        }\n        try {\n            const result = await this.request({\n                method: 'initialize',\n                params: {\n                    protocolVersion: LATEST_PROTOCOL_VERSION,\n                    capabilities: this._capabilities,\n                    clientInfo: this._clientInfo\n                }\n            }, InitializeResultSchema, options);\n            if (result === undefined) {\n                throw new Error(`Server sent invalid initialize result: ${result}`);\n            }\n            if (!SUPPORTED_PROTOCOL_VERSIONS.includes(result.protocolVersion)) {\n                throw new Error(`Server's protocol version is not supported: ${result.protocolVersion}`);\n            }\n            this._serverCapabilities = result.capabilities;\n            this._serverVersion = result.serverInfo;\n            // HTTP transports must set the protocol version in each header after initialization.\n            if (transport.setProtocolVersion) {\n                transport.setProtocolVersion(result.protocolVersion);\n            }\n            this._instructions = result.instructions;\n            await this.notification({\n                method: 'notifications/initialized'\n            });\n        }\n        catch (error) {\n            // Disconnect if initialization fails.\n            void this.close();\n            throw error;\n        }\n    }\n    /**\n     * After initialization has completed, this will be populated with the server's reported capabilities.\n     */\n    getServerCapabilities() {\n        return this._serverCapabilities;\n    }\n    /**\n     * After initialization has completed, this will be populated with information about the server's name and version.\n     */\n    getServerVersion() {\n        return this._serverVersion;\n    }\n    /**\n     * After initialization has completed, this may be populated with information about the server's instructions.\n     */\n    getInstructions() {\n        return this._instructions;\n    }\n    assertCapabilityForMethod(method) {\n        var _a, _b, _c, _d, _e;\n        switch (method) {\n            case 'logging/setLevel':\n                if (!((_a = this._serverCapabilities) === null || _a === void 0 ? void 0 : _a.logging)) {\n                    throw new Error(`Server does not support logging (required for ${method})`);\n                }\n                break;\n            case 'prompts/get':\n            case 'prompts/list':\n                if (!((_b = this._serverCapabilities) === null || _b === void 0 ? void 0 : _b.prompts)) {\n                    throw new Error(`Server does not support prompts (required for ${method})`);\n                }\n                break;\n            case 'resources/list':\n            case 'resources/templates/list':\n            case 'resources/read':\n            case 'resources/subscribe':\n            case 'resources/unsubscribe':\n                if (!((_c = this._serverCapabilities) === null || _c === void 0 ? void 0 : _c.resources)) {\n                    throw new Error(`Server does not support resources (required for ${method})`);\n                }\n                if (method === 'resources/subscribe' && !this._serverCapabilities.resources.subscribe) {\n                    throw new Error(`Server does not support resource subscriptions (required for ${method})`);\n                }\n                break;\n            case 'tools/call':\n            case 'tools/list':\n                if (!((_d = this._serverCapabilities) === null || _d === void 0 ? void 0 : _d.tools)) {\n                    throw new Error(`Server does not support tools (required for ${method})`);\n                }\n                break;\n            case 'completion/complete':\n                if (!((_e = this._serverCapabilities) === null || _e === void 0 ? void 0 : _e.completions)) {\n                    throw new Error(`Server does not support completions (required for ${method})`);\n                }\n                break;\n            case 'initialize':\n                // No specific capability required for initialize\n                break;\n            case 'ping':\n                // No specific capability required for ping\n                break;\n        }\n    }\n    assertNotificationCapability(method) {\n        var _a;\n        switch (method) {\n            case 'notifications/roots/list_changed':\n                if (!((_a = this._capabilities.roots) === null || _a === void 0 ? void 0 : _a.listChanged)) {\n                    throw new Error(`Client does not support roots list changed notifications (required for ${method})`);\n                }\n                break;\n            case 'notifications/initialized':\n                // No specific capability required for initialized\n                break;\n            case 'notifications/cancelled':\n                // Cancellation notifications are always allowed\n                break;\n            case 'notifications/progress':\n                // Progress notifications are always allowed\n                break;\n        }\n    }\n    assertRequestHandlerCapability(method) {\n        // Task handlers are registered in Protocol constructor before _capabilities is initialized\n        // Skip capability check for task methods during initialization\n        if (!this._capabilities) {\n            return;\n        }\n        switch (method) {\n            case 'sampling/createMessage':\n                if (!this._capabilities.sampling) {\n                    throw new Error(`Client does not support sampling capability (required for ${method})`);\n                }\n                break;\n            case 'elicitation/create':\n                if (!this._capabilities.elicitation) {\n                    throw new Error(`Client does not support elicitation capability (required for ${method})`);\n                }\n                break;\n            case 'roots/list':\n                if (!this._capabilities.roots) {\n                    throw new Error(`Client does not support roots capability (required for ${method})`);\n                }\n                break;\n            case 'tasks/get':\n            case 'tasks/list':\n            case 'tasks/result':\n            case 'tasks/cancel':\n                if (!this._capabilities.tasks) {\n                    throw new Error(`Client does not support tasks capability (required for ${method})`);\n                }\n                break;\n            case 'ping':\n                // No specific capability required for ping\n                break;\n        }\n    }\n    assertTaskCapability(method) {\n        var _a, _b;\n        assertToolsCallTaskCapability((_b = (_a = this._serverCapabilities) === null || _a === void 0 ? void 0 : _a.tasks) === null || _b === void 0 ? void 0 : _b.requests, method, 'Server');\n    }\n    assertTaskHandlerCapability(method) {\n        var _a;\n        // Task handlers are registered in Protocol constructor before _capabilities is initialized\n        // Skip capability check for task methods during initialization\n        if (!this._capabilities) {\n            return;\n        }\n        assertClientRequestTaskCapability((_a = this._capabilities.tasks) === null || _a === void 0 ? void 0 : _a.requests, method, 'Client');\n    }\n    async ping(options) {\n        return this.request({ method: 'ping' }, EmptyResultSchema, options);\n    }\n    async complete(params, options) {\n        return this.request({ method: 'completion/complete', params }, CompleteResultSchema, options);\n    }\n    async setLoggingLevel(level, options) {\n        return this.request({ method: 'logging/setLevel', params: { level } }, EmptyResultSchema, options);\n    }\n    async getPrompt(params, options) {\n        return this.request({ method: 'prompts/get', params }, GetPromptResultSchema, options);\n    }\n    async listPrompts(params, options) {\n        return this.request({ method: 'prompts/list', params }, ListPromptsResultSchema, options);\n    }\n    async listResources(params, options) {\n        return this.request({ method: 'resources/list', params }, ListResourcesResultSchema, options);\n    }\n    async listResourceTemplates(params, options) {\n        return this.request({ method: 'resources/templates/list', params }, ListResourceTemplatesResultSchema, options);\n    }\n    async readResource(params, options) {\n        return this.request({ method: 'resources/read', params }, ReadResourceResultSchema, options);\n    }\n    async subscribeResource(params, options) {\n        return this.request({ method: 'resources/subscribe', params }, EmptyResultSchema, options);\n    }\n    async unsubscribeResource(params, options) {\n        return this.request({ method: 'resources/unsubscribe', params }, EmptyResultSchema, options);\n    }\n    /**\n     * Calls a tool and waits for the result. Automatically validates structured output if the tool has an outputSchema.\n     *\n     * For task-based execution with streaming behavior, use client.experimental.tasks.callToolStream() instead.\n     */\n    async callTool(params, resultSchema = CallToolResultSchema, options) {\n        // Guard: required-task tools need experimental API\n        if (this.isToolTaskRequired(params.name)) {\n            throw new McpError(ErrorCode.InvalidRequest, `Tool \"${params.name}\" requires task-based execution. Use client.experimental.tasks.callToolStream() instead.`);\n        }\n        const result = await this.request({ method: 'tools/call', params }, resultSchema, options);\n        // Check if the tool has an outputSchema\n        const validator = this.getToolOutputValidator(params.name);\n        if (validator) {\n            // If tool has outputSchema, it MUST return structuredContent (unless it's an error)\n            if (!result.structuredContent && !result.isError) {\n                throw new McpError(ErrorCode.InvalidRequest, `Tool ${params.name} has an output schema but did not return structured content`);\n            }\n            // Only validate structured content if present (not when there's an error)\n            if (result.structuredContent) {\n                try {\n                    // Validate the structured content against the schema\n                    const validationResult = validator(result.structuredContent);\n                    if (!validationResult.valid) {\n                        throw new McpError(ErrorCode.InvalidParams, `Structured content does not match the tool's output schema: ${validationResult.errorMessage}`);\n                    }\n                }\n                catch (error) {\n                    if (error instanceof McpError) {\n                        throw error;\n                    }\n                    throw new McpError(ErrorCode.InvalidParams, `Failed to validate structured content: ${error instanceof Error ? error.message : String(error)}`);\n                }\n            }\n        }\n        return result;\n    }\n    isToolTask(toolName) {\n        var _a, _b, _c, _d;\n        if (!((_d = (_c = (_b = (_a = this._serverCapabilities) === null || _a === void 0 ? void 0 : _a.tasks) === null || _b === void 0 ? void 0 : _b.requests) === null || _c === void 0 ? void 0 : _c.tools) === null || _d === void 0 ? void 0 : _d.call)) {\n            return false;\n        }\n        return this._cachedKnownTaskTools.has(toolName);\n    }\n    /**\n     * Check if a tool requires task-based execution.\n     * Unlike isToolTask which includes 'optional' tools, this only checks for 'required'.\n     */\n    isToolTaskRequired(toolName) {\n        return this._cachedRequiredTaskTools.has(toolName);\n    }\n    /**\n     * Cache validators for tool output schemas.\n     * Called after listTools() to pre-compile validators for better performance.\n     */\n    cacheToolMetadata(tools) {\n        var _a;\n        this._cachedToolOutputValidators.clear();\n        this._cachedKnownTaskTools.clear();\n        this._cachedRequiredTaskTools.clear();\n        for (const tool of tools) {\n            // If the tool has an outputSchema, create and cache the validator\n            if (tool.outputSchema) {\n                const toolValidator = this._jsonSchemaValidator.getValidator(tool.outputSchema);\n                this._cachedToolOutputValidators.set(tool.name, toolValidator);\n            }\n            // If the tool supports task-based execution, cache that information\n            const taskSupport = (_a = tool.execution) === null || _a === void 0 ? void 0 : _a.taskSupport;\n            if (taskSupport === 'required' || taskSupport === 'optional') {\n                this._cachedKnownTaskTools.add(tool.name);\n            }\n            if (taskSupport === 'required') {\n                this._cachedRequiredTaskTools.add(tool.name);\n            }\n        }\n    }\n    /**\n     * Get cached validator for a tool\n     */\n    getToolOutputValidator(toolName) {\n        return this._cachedToolOutputValidators.get(toolName);\n    }\n    async listTools(params, options) {\n        const result = await this.request({ method: 'tools/list', params }, ListToolsResultSchema, options);\n        // Cache the tools and their output schemas for future validation\n        this.cacheToolMetadata(result.tools);\n        return result;\n    }\n    async sendRootsListChanged() {\n        return this.notification({ method: 'notifications/roots/list_changed' });\n    }\n}\n//# sourceMappingURL=index.js.map","/**\n * Normalizes HeadersInit to a plain Record<string, string> for manipulation.\n * Handles Headers objects, arrays of tuples, and plain objects.\n */\nexport function normalizeHeaders(headers) {\n    if (!headers)\n        return {};\n    if (headers instanceof Headers) {\n        return Object.fromEntries(headers.entries());\n    }\n    if (Array.isArray(headers)) {\n        return Object.fromEntries(headers);\n    }\n    return { ...headers };\n}\n/**\n * Creates a fetch function that includes base RequestInit options.\n * This ensures requests inherit settings like credentials, mode, headers, etc. from the base init.\n *\n * @param baseFetch - The base fetch function to wrap (defaults to global fetch)\n * @param baseInit - The base RequestInit to merge with each request\n * @returns A wrapped fetch function that merges base options with call-specific options\n */\nexport function createFetchWithInit(baseFetch = fetch, baseInit) {\n    if (!baseInit) {\n        return baseFetch;\n    }\n    // Return a wrapped fetch that merges base RequestInit with call-specific init\n    return async (url, init) => {\n        const mergedInit = {\n            ...baseInit,\n            ...init,\n            // Headers need special handling - merge instead of replace\n            headers: (init === null || init === void 0 ? void 0 : init.headers) ? { ...normalizeHeaders(baseInit.headers), ...normalizeHeaders(init.headers) } : baseInit.headers\n        };\n        return baseFetch(url, mergedInit);\n    };\n}\n//# sourceMappingURL=transport.js.map","let crypto;\ncrypto = globalThis.crypto; // web browsers\n/**\n * Creates an array of length `size` of random bytes\n * @param size\n * @returns Array of random ints (0 to 255)\n */\nasync function getRandomValues(size) {\n    return (await crypto).getRandomValues(new Uint8Array(size));\n}\n/** Generate cryptographically strong random string\n * @param size The desired length of the string\n * @returns The random string\n */\nasync function random(size) {\n    const mask = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-._~\";\n    const evenDistCutoff = Math.pow(2, 8) - Math.pow(2, 8) % mask.length;\n    let result = \"\";\n    while (result.length < size) {\n        const randomBytes = await getRandomValues(size - result.length);\n        for (const randomByte of randomBytes) {\n            if (randomByte < evenDistCutoff) {\n                result += mask[randomByte % mask.length];\n            }\n        }\n    }\n    return result;\n}\n/** Generate a PKCE challenge verifier\n * @param length Length of the verifier\n * @returns A random verifier `length` characters long\n */\nasync function generateVerifier(length) {\n    return await random(length);\n}\n/** Generate a PKCE code challenge from a code verifier\n * @param code_verifier\n * @returns The base64 url encoded code challenge\n */\nexport async function generateChallenge(code_verifier) {\n    const buffer = await (await crypto).subtle.digest(\"SHA-256\", new TextEncoder().encode(code_verifier));\n    // Generate base64url string\n    // btoa is deprecated in Node.js but is used here for web browser compatibility\n    // (which has no good replacement yet, see also https://github.com/whatwg/html/issues/6811)\n    return btoa(String.fromCharCode(...new Uint8Array(buffer)))\n        .replace(/\\//g, '_')\n        .replace(/\\+/g, '-')\n        .replace(/=/g, '');\n}\n/** Generate a PKCE challenge pair\n * @param length Length of the verifer (between 43-128). Defaults to 43.\n * @returns PKCE challenge pair\n */\nexport default async function pkceChallenge(length) {\n    if (!length)\n        length = 43;\n    if (length < 43 || length > 128) {\n        throw `Expected a length between 43 and 128. Received ${length}.`;\n    }\n    const verifier = await generateVerifier(length);\n    const challenge = await generateChallenge(verifier);\n    return {\n        code_verifier: verifier,\n        code_challenge: challenge,\n    };\n}\n/** Verify that a code_verifier produces the expected code challenge\n * @param code_verifier\n * @param expectedChallenge The code challenge to verify\n * @returns True if challenges are equal. False otherwise.\n */\nexport async function verifyChallenge(code_verifier, expectedChallenge) {\n    const actualChallenge = await generateChallenge(code_verifier);\n    return actualChallenge === expectedChallenge;\n}\n","import * as z from 'zod/v4';\n/**\n * Reusable URL validation that disallows javascript: scheme\n */\nexport const SafeUrlSchema = z\n    .url()\n    .superRefine((val, ctx) => {\n    if (!URL.canParse(val)) {\n        ctx.addIssue({\n            code: z.ZodIssueCode.custom,\n            message: 'URL must be parseable',\n            fatal: true\n        });\n        return z.NEVER;\n    }\n})\n    .refine(url => {\n    const u = new URL(url);\n    return u.protocol !== 'javascript:' && u.protocol !== 'data:' && u.protocol !== 'vbscript:';\n}, { message: 'URL cannot use javascript:, data:, or vbscript: scheme' });\n/**\n * RFC 9728 OAuth Protected Resource Metadata\n */\nexport const OAuthProtectedResourceMetadataSchema = z.looseObject({\n    resource: z.string().url(),\n    authorization_servers: z.array(SafeUrlSchema).optional(),\n    jwks_uri: z.string().url().optional(),\n    scopes_supported: z.array(z.string()).optional(),\n    bearer_methods_supported: z.array(z.string()).optional(),\n    resource_signing_alg_values_supported: z.array(z.string()).optional(),\n    resource_name: z.string().optional(),\n    resource_documentation: z.string().optional(),\n    resource_policy_uri: z.string().url().optional(),\n    resource_tos_uri: z.string().url().optional(),\n    tls_client_certificate_bound_access_tokens: z.boolean().optional(),\n    authorization_details_types_supported: z.array(z.string()).optional(),\n    dpop_signing_alg_values_supported: z.array(z.string()).optional(),\n    dpop_bound_access_tokens_required: z.boolean().optional()\n});\n/**\n * RFC 8414 OAuth 2.0 Authorization Server Metadata\n */\nexport const OAuthMetadataSchema = z.looseObject({\n    issuer: z.string(),\n    authorization_endpoint: SafeUrlSchema,\n    token_endpoint: SafeUrlSchema,\n    registration_endpoint: SafeUrlSchema.optional(),\n    scopes_supported: z.array(z.string()).optional(),\n    response_types_supported: z.array(z.string()),\n    response_modes_supported: z.array(z.string()).optional(),\n    grant_types_supported: z.array(z.string()).optional(),\n    token_endpoint_auth_methods_supported: z.array(z.string()).optional(),\n    token_endpoint_auth_signing_alg_values_supported: z.array(z.string()).optional(),\n    service_documentation: SafeUrlSchema.optional(),\n    revocation_endpoint: SafeUrlSchema.optional(),\n    revocation_endpoint_auth_methods_supported: z.array(z.string()).optional(),\n    revocation_endpoint_auth_signing_alg_values_supported: z.array(z.string()).optional(),\n    introspection_endpoint: z.string().optional(),\n    introspection_endpoint_auth_methods_supported: z.array(z.string()).optional(),\n    introspection_endpoint_auth_signing_alg_values_supported: z.array(z.string()).optional(),\n    code_challenge_methods_supported: z.array(z.string()).optional(),\n    client_id_metadata_document_supported: z.boolean().optional()\n});\n/**\n * OpenID Connect Discovery 1.0 Provider Metadata\n * see: https://openid.net/specs/openid-connect-discovery-1_0.html#ProviderMetadata\n */\nexport const OpenIdProviderMetadataSchema = z.looseObject({\n    issuer: z.string(),\n    authorization_endpoint: SafeUrlSchema,\n    token_endpoint: SafeUrlSchema,\n    userinfo_endpoint: SafeUrlSchema.optional(),\n    jwks_uri: SafeUrlSchema,\n    registration_endpoint: SafeUrlSchema.optional(),\n    scopes_supported: z.array(z.string()).optional(),\n    response_types_supported: z.array(z.string()),\n    response_modes_supported: z.array(z.string()).optional(),\n    grant_types_supported: z.array(z.string()).optional(),\n    acr_values_supported: z.array(z.string()).optional(),\n    subject_types_supported: z.array(z.string()),\n    id_token_signing_alg_values_supported: z.array(z.string()),\n    id_token_encryption_alg_values_supported: z.array(z.string()).optional(),\n    id_token_encryption_enc_values_supported: z.array(z.string()).optional(),\n    userinfo_signing_alg_values_supported: z.array(z.string()).optional(),\n    userinfo_encryption_alg_values_supported: z.array(z.string()).optional(),\n    userinfo_encryption_enc_values_supported: z.array(z.string()).optional(),\n    request_object_signing_alg_values_supported: z.array(z.string()).optional(),\n    request_object_encryption_alg_values_supported: z.array(z.string()).optional(),\n    request_object_encryption_enc_values_supported: z.array(z.string()).optional(),\n    token_endpoint_auth_methods_supported: z.array(z.string()).optional(),\n    token_endpoint_auth_signing_alg_values_supported: z.array(z.string()).optional(),\n    display_values_supported: z.array(z.string()).optional(),\n    claim_types_supported: z.array(z.string()).optional(),\n    claims_supported: z.array(z.string()).optional(),\n    service_documentation: z.string().optional(),\n    claims_locales_supported: z.array(z.string()).optional(),\n    ui_locales_supported: z.array(z.string()).optional(),\n    claims_parameter_supported: z.boolean().optional(),\n    request_parameter_supported: z.boolean().optional(),\n    request_uri_parameter_supported: z.boolean().optional(),\n    require_request_uri_registration: z.boolean().optional(),\n    op_policy_uri: SafeUrlSchema.optional(),\n    op_tos_uri: SafeUrlSchema.optional(),\n    client_id_metadata_document_supported: z.boolean().optional()\n});\n/**\n * OpenID Connect Discovery metadata that may include OAuth 2.0 fields\n * This schema represents the real-world scenario where OIDC providers\n * return a mix of OpenID Connect and OAuth 2.0 metadata fields\n */\nexport const OpenIdProviderDiscoveryMetadataSchema = z.object({\n    ...OpenIdProviderMetadataSchema.shape,\n    ...OAuthMetadataSchema.pick({\n        code_challenge_methods_supported: true\n    }).shape\n});\n/**\n * OAuth 2.1 token response\n */\nexport const OAuthTokensSchema = z\n    .object({\n    access_token: z.string(),\n    id_token: z.string().optional(), // Optional for OAuth 2.1, but necessary in OpenID Connect\n    token_type: z.string(),\n    expires_in: z.coerce.number().optional(),\n    scope: z.string().optional(),\n    refresh_token: z.string().optional()\n})\n    .strip();\n/**\n * OAuth 2.1 error response\n */\nexport const OAuthErrorResponseSchema = z.object({\n    error: z.string(),\n    error_description: z.string().optional(),\n    error_uri: z.string().optional()\n});\n/**\n * Optional version of SafeUrlSchema that allows empty string for retrocompatibility on tos_uri and logo_uri\n */\nexport const OptionalSafeUrlSchema = SafeUrlSchema.optional().or(z.literal('').transform(() => undefined));\n/**\n * RFC 7591 OAuth 2.0 Dynamic Client Registration metadata\n */\nexport const OAuthClientMetadataSchema = z\n    .object({\n    redirect_uris: z.array(SafeUrlSchema),\n    token_endpoint_auth_method: z.string().optional(),\n    grant_types: z.array(z.string()).optional(),\n    response_types: z.array(z.string()).optional(),\n    client_name: z.string().optional(),\n    client_uri: SafeUrlSchema.optional(),\n    logo_uri: OptionalSafeUrlSchema,\n    scope: z.string().optional(),\n    contacts: z.array(z.string()).optional(),\n    tos_uri: OptionalSafeUrlSchema,\n    policy_uri: z.string().optional(),\n    jwks_uri: SafeUrlSchema.optional(),\n    jwks: z.any().optional(),\n    software_id: z.string().optional(),\n    software_version: z.string().optional(),\n    software_statement: z.string().optional()\n})\n    .strip();\n/**\n * RFC 7591 OAuth 2.0 Dynamic Client Registration client information\n */\nexport const OAuthClientInformationSchema = z\n    .object({\n    client_id: z.string(),\n    client_secret: z.string().optional(),\n    client_id_issued_at: z.number().optional(),\n    client_secret_expires_at: z.number().optional()\n})\n    .strip();\n/**\n * RFC 7591 OAuth 2.0 Dynamic Client Registration full response (client information plus metadata)\n */\nexport const OAuthClientInformationFullSchema = OAuthClientMetadataSchema.merge(OAuthClientInformationSchema);\n/**\n * RFC 7591 OAuth 2.0 Dynamic Client Registration error response\n */\nexport const OAuthClientRegistrationErrorSchema = z\n    .object({\n    error: z.string(),\n    error_description: z.string().optional()\n})\n    .strip();\n/**\n * RFC 7009 OAuth 2.0 Token Revocation request\n */\nexport const OAuthTokenRevocationRequestSchema = z\n    .object({\n    token: z.string(),\n    token_type_hint: z.string().optional()\n})\n    .strip();\n//# sourceMappingURL=auth.js.map","/**\n * Utilities for handling OAuth resource URIs.\n */\n/**\n * Converts a server URL to a resource URL by removing the fragment.\n * RFC 8707 section 2 states that resource URIs \"MUST NOT include a fragment component\".\n * Keeps everything else unchanged (scheme, domain, port, path, query).\n */\nexport function resourceUrlFromServerUrl(url) {\n    const resourceURL = typeof url === 'string' ? new URL(url) : new URL(url.href);\n    resourceURL.hash = ''; // Remove fragment\n    return resourceURL;\n}\n/**\n * Checks if a requested resource URL matches a configured resource URL.\n * A requested resource matches if it has the same scheme, domain, port,\n * and its path starts with the configured resource's path.\n *\n * @param requestedResource The resource URL being requested\n * @param configuredResource The resource URL that has been configured\n * @returns true if the requested resource matches the configured resource, false otherwise\n */\nexport function checkResourceAllowed({ requestedResource, configuredResource }) {\n    const requested = typeof requestedResource === 'string' ? new URL(requestedResource) : new URL(requestedResource.href);\n    const configured = typeof configuredResource === 'string' ? new URL(configuredResource) : new URL(configuredResource.href);\n    // Compare the origin (scheme, domain, and port)\n    if (requested.origin !== configured.origin) {\n        return false;\n    }\n    // Handle cases like requested=/foo and configured=/foo/\n    if (requested.pathname.length < configured.pathname.length) {\n        return false;\n    }\n    // Check if the requested path starts with the configured path\n    // Ensure both paths end with / for proper comparison\n    // This ensures that if we have paths like \"/api\" and \"/api/users\",\n    // we properly detect that \"/api/users\" is a subpath of \"/api\"\n    // By adding a trailing slash if missing, we avoid false positives\n    // where paths like \"/api123\" would incorrectly match \"/api\"\n    const requestedPath = requested.pathname.endsWith('/') ? requested.pathname : requested.pathname + '/';\n    const configuredPath = configured.pathname.endsWith('/') ? configured.pathname : configured.pathname + '/';\n    return requestedPath.startsWith(configuredPath);\n}\n//# sourceMappingURL=auth-utils.js.map","/**\n * Base class for all OAuth errors\n */\nexport class OAuthError extends Error {\n    constructor(message, errorUri) {\n        super(message);\n        this.errorUri = errorUri;\n        this.name = this.constructor.name;\n    }\n    /**\n     * Converts the error to a standard OAuth error response object\n     */\n    toResponseObject() {\n        const response = {\n            error: this.errorCode,\n            error_description: this.message\n        };\n        if (this.errorUri) {\n            response.error_uri = this.errorUri;\n        }\n        return response;\n    }\n    get errorCode() {\n        return this.constructor.errorCode;\n    }\n}\n/**\n * Invalid request error - The request is missing a required parameter,\n * includes an invalid parameter value, includes a parameter more than once,\n * or is otherwise malformed.\n */\nexport class InvalidRequestError extends OAuthError {\n}\nInvalidRequestError.errorCode = 'invalid_request';\n/**\n * Invalid client error - Client authentication failed (e.g., unknown client, no client\n * authentication included, or unsupported authentication method).\n */\nexport class InvalidClientError extends OAuthError {\n}\nInvalidClientError.errorCode = 'invalid_client';\n/**\n * Invalid grant error - The provided authorization grant or refresh token is\n * invalid, expired, revoked, does not match the redirection URI used in the\n * authorization request, or was issued to another client.\n */\nexport class InvalidGrantError extends OAuthError {\n}\nInvalidGrantError.errorCode = 'invalid_grant';\n/**\n * Unauthorized client error - The authenticated client is not authorized to use\n * this authorization grant type.\n */\nexport class UnauthorizedClientError extends OAuthError {\n}\nUnauthorizedClientError.errorCode = 'unauthorized_client';\n/**\n * Unsupported grant type error - The authorization grant type is not supported\n * by the authorization server.\n */\nexport class UnsupportedGrantTypeError extends OAuthError {\n}\nUnsupportedGrantTypeError.errorCode = 'unsupported_grant_type';\n/**\n * Invalid scope error - The requested scope is invalid, unknown, malformed, or\n * exceeds the scope granted by the resource owner.\n */\nexport class InvalidScopeError extends OAuthError {\n}\nInvalidScopeError.errorCode = 'invalid_scope';\n/**\n * Access denied error - The resource owner or authorization server denied the request.\n */\nexport class AccessDeniedError extends OAuthError {\n}\nAccessDeniedError.errorCode = 'access_denied';\n/**\n * Server error - The authorization server encountered an unexpected condition\n * that prevented it from fulfilling the request.\n */\nexport class ServerError extends OAuthError {\n}\nServerError.errorCode = 'server_error';\n/**\n * Temporarily unavailable error - The authorization server is currently unable to\n * handle the request due to a temporary overloading or maintenance of the server.\n */\nexport class TemporarilyUnavailableError extends OAuthError {\n}\nTemporarilyUnavailableError.errorCode = 'temporarily_unavailable';\n/**\n * Unsupported response type error - The authorization server does not support\n * obtaining an authorization code using this method.\n */\nexport class UnsupportedResponseTypeError extends OAuthError {\n}\nUnsupportedResponseTypeError.errorCode = 'unsupported_response_type';\n/**\n * Unsupported token type error - The authorization server does not support\n * the requested token type.\n */\nexport class UnsupportedTokenTypeError extends OAuthError {\n}\nUnsupportedTokenTypeError.errorCode = 'unsupported_token_type';\n/**\n * Invalid token error - The access token provided is expired, revoked, malformed,\n * or invalid for other reasons.\n */\nexport class InvalidTokenError extends OAuthError {\n}\nInvalidTokenError.errorCode = 'invalid_token';\n/**\n * Method not allowed error - The HTTP method used is not allowed for this endpoint.\n * (Custom, non-standard error)\n */\nexport class MethodNotAllowedError extends OAuthError {\n}\nMethodNotAllowedError.errorCode = 'method_not_allowed';\n/**\n * Too many requests error - Rate limit exceeded.\n * (Custom, non-standard error based on RFC 6585)\n */\nexport class TooManyRequestsError extends OAuthError {\n}\nTooManyRequestsError.errorCode = 'too_many_requests';\n/**\n * Invalid client metadata error - The client metadata is invalid.\n * (Custom error for dynamic client registration - RFC 7591)\n */\nexport class InvalidClientMetadataError extends OAuthError {\n}\nInvalidClientMetadataError.errorCode = 'invalid_client_metadata';\n/**\n * Insufficient scope error - The request requires higher privileges than provided by the access token.\n */\nexport class InsufficientScopeError extends OAuthError {\n}\nInsufficientScopeError.errorCode = 'insufficient_scope';\n/**\n * Invalid target error - The requested resource is invalid, missing, unknown, or malformed.\n * (Custom error for resource indicators - RFC 8707)\n */\nexport class InvalidTargetError extends OAuthError {\n}\nInvalidTargetError.errorCode = 'invalid_target';\n/**\n * A utility class for defining one-off error codes\n */\nexport class CustomOAuthError extends OAuthError {\n    constructor(customErrorCode, message, errorUri) {\n        super(message, errorUri);\n        this.customErrorCode = customErrorCode;\n    }\n    get errorCode() {\n        return this.customErrorCode;\n    }\n}\n/**\n * A full list of all OAuthErrors, enabling parsing from error responses\n */\nexport const OAUTH_ERRORS = {\n    [InvalidRequestError.errorCode]: InvalidRequestError,\n    [InvalidClientError.errorCode]: InvalidClientError,\n    [InvalidGrantError.errorCode]: InvalidGrantError,\n    [UnauthorizedClientError.errorCode]: UnauthorizedClientError,\n    [UnsupportedGrantTypeError.errorCode]: UnsupportedGrantTypeError,\n    [InvalidScopeError.errorCode]: InvalidScopeError,\n    [AccessDeniedError.errorCode]: AccessDeniedError,\n    [ServerError.errorCode]: ServerError,\n    [TemporarilyUnavailableError.errorCode]: TemporarilyUnavailableError,\n    [UnsupportedResponseTypeError.errorCode]: UnsupportedResponseTypeError,\n    [UnsupportedTokenTypeError.errorCode]: UnsupportedTokenTypeError,\n    [InvalidTokenError.errorCode]: InvalidTokenError,\n    [MethodNotAllowedError.errorCode]: MethodNotAllowedError,\n    [TooManyRequestsError.errorCode]: TooManyRequestsError,\n    [InvalidClientMetadataError.errorCode]: InvalidClientMetadataError,\n    [InsufficientScopeError.errorCode]: InsufficientScopeError,\n    [InvalidTargetError.errorCode]: InvalidTargetError\n};\n//# sourceMappingURL=errors.js.map","import pkceChallenge from 'pkce-challenge';\nimport { LATEST_PROTOCOL_VERSION } from '../types.js';\nimport { OAuthErrorResponseSchema, OpenIdProviderDiscoveryMetadataSchema } from '../shared/auth.js';\nimport { OAuthClientInformationFullSchema, OAuthMetadataSchema, OAuthProtectedResourceMetadataSchema, OAuthTokensSchema } from '../shared/auth.js';\nimport { checkResourceAllowed, resourceUrlFromServerUrl } from '../shared/auth-utils.js';\nimport { InvalidClientError, InvalidClientMetadataError, InvalidGrantError, OAUTH_ERRORS, OAuthError, ServerError, UnauthorizedClientError } from '../server/auth/errors.js';\nexport class UnauthorizedError extends Error {\n    constructor(message) {\n        super(message !== null && message !== void 0 ? message : 'Unauthorized');\n    }\n}\nfunction isClientAuthMethod(method) {\n    return ['client_secret_basic', 'client_secret_post', 'none'].includes(method);\n}\nconst AUTHORIZATION_CODE_RESPONSE_TYPE = 'code';\nconst AUTHORIZATION_CODE_CHALLENGE_METHOD = 'S256';\n/**\n * Determines the best client authentication method to use based on server support and client configuration.\n *\n * Priority order (highest to lowest):\n * 1. client_secret_basic (if client secret is available)\n * 2. client_secret_post (if client secret is available)\n * 3. none (for public clients)\n *\n * @param clientInformation - OAuth client information containing credentials\n * @param supportedMethods - Authentication methods supported by the authorization server\n * @returns The selected authentication method\n */\nexport function selectClientAuthMethod(clientInformation, supportedMethods) {\n    const hasClientSecret = clientInformation.client_secret !== undefined;\n    // If server doesn't specify supported methods, use RFC 6749 defaults\n    if (supportedMethods.length === 0) {\n        return hasClientSecret ? 'client_secret_post' : 'none';\n    }\n    // Prefer the method returned by the server during client registration if valid and supported\n    if ('token_endpoint_auth_method' in clientInformation &&\n        clientInformation.token_endpoint_auth_method &&\n        isClientAuthMethod(clientInformation.token_endpoint_auth_method) &&\n        supportedMethods.includes(clientInformation.token_endpoint_auth_method)) {\n        return clientInformation.token_endpoint_auth_method;\n    }\n    // Try methods in priority order (most secure first)\n    if (hasClientSecret && supportedMethods.includes('client_secret_basic')) {\n        return 'client_secret_basic';\n    }\n    if (hasClientSecret && supportedMethods.includes('client_secret_post')) {\n        return 'client_secret_post';\n    }\n    if (supportedMethods.includes('none')) {\n        return 'none';\n    }\n    // Fallback: use what we have\n    return hasClientSecret ? 'client_secret_post' : 'none';\n}\n/**\n * Applies client authentication to the request based on the specified method.\n *\n * Implements OAuth 2.1 client authentication methods:\n * - client_secret_basic: HTTP Basic authentication (RFC 6749 Section 2.3.1)\n * - client_secret_post: Credentials in request body (RFC 6749 Section 2.3.1)\n * - none: Public client authentication (RFC 6749 Section 2.1)\n *\n * @param method - The authentication method to use\n * @param clientInformation - OAuth client information containing credentials\n * @param headers - HTTP headers object to modify\n * @param params - URL search parameters to modify\n * @throws {Error} When required credentials are missing\n */\nfunction applyClientAuthentication(method, clientInformation, headers, params) {\n    const { client_id, client_secret } = clientInformation;\n    switch (method) {\n        case 'client_secret_basic':\n            applyBasicAuth(client_id, client_secret, headers);\n            return;\n        case 'client_secret_post':\n            applyPostAuth(client_id, client_secret, params);\n            return;\n        case 'none':\n            applyPublicAuth(client_id, params);\n            return;\n        default:\n            throw new Error(`Unsupported client authentication method: ${method}`);\n    }\n}\n/**\n * Applies HTTP Basic authentication (RFC 6749 Section 2.3.1)\n */\nfunction applyBasicAuth(clientId, clientSecret, headers) {\n    if (!clientSecret) {\n        throw new Error('client_secret_basic authentication requires a client_secret');\n    }\n    const credentials = btoa(`${clientId}:${clientSecret}`);\n    headers.set('Authorization', `Basic ${credentials}`);\n}\n/**\n * Applies POST body authentication (RFC 6749 Section 2.3.1)\n */\nfunction applyPostAuth(clientId, clientSecret, params) {\n    params.set('client_id', clientId);\n    if (clientSecret) {\n        params.set('client_secret', clientSecret);\n    }\n}\n/**\n * Applies public client authentication (RFC 6749 Section 2.1)\n */\nfunction applyPublicAuth(clientId, params) {\n    params.set('client_id', clientId);\n}\n/**\n * Parses an OAuth error response from a string or Response object.\n *\n * If the input is a standard OAuth2.0 error response, it will be parsed according to the spec\n * and an instance of the appropriate OAuthError subclass will be returned.\n * If parsing fails, it falls back to a generic ServerError that includes\n * the response status (if available) and original content.\n *\n * @param input - A Response object or string containing the error response\n * @returns A Promise that resolves to an OAuthError instance\n */\nexport async function parseErrorResponse(input) {\n    const statusCode = input instanceof Response ? input.status : undefined;\n    const body = input instanceof Response ? await input.text() : input;\n    try {\n        const result = OAuthErrorResponseSchema.parse(JSON.parse(body));\n        const { error, error_description, error_uri } = result;\n        const errorClass = OAUTH_ERRORS[error] || ServerError;\n        return new errorClass(error_description || '', error_uri);\n    }\n    catch (error) {\n        // Not a valid OAuth error response, but try to inform the user of the raw data anyway\n        const errorMessage = `${statusCode ? `HTTP ${statusCode}: ` : ''}Invalid OAuth error response: ${error}. Raw body: ${body}`;\n        return new ServerError(errorMessage);\n    }\n}\n/**\n * Orchestrates the full auth flow with a server.\n *\n * This can be used as a single entry point for all authorization functionality,\n * instead of linking together the other lower-level functions in this module.\n */\nexport async function auth(provider, options) {\n    var _a, _b;\n    try {\n        return await authInternal(provider, options);\n    }\n    catch (error) {\n        // Handle recoverable error types by invalidating credentials and retrying\n        if (error instanceof InvalidClientError || error instanceof UnauthorizedClientError) {\n            await ((_a = provider.invalidateCredentials) === null || _a === void 0 ? void 0 : _a.call(provider, 'all'));\n            return await authInternal(provider, options);\n        }\n        else if (error instanceof InvalidGrantError) {\n            await ((_b = provider.invalidateCredentials) === null || _b === void 0 ? void 0 : _b.call(provider, 'tokens'));\n            return await authInternal(provider, options);\n        }\n        // Throw otherwise\n        throw error;\n    }\n}\nasync function authInternal(provider, { serverUrl, authorizationCode, scope, resourceMetadataUrl, fetchFn }) {\n    var _a, _b;\n    let resourceMetadata;\n    let authorizationServerUrl;\n    try {\n        resourceMetadata = await discoverOAuthProtectedResourceMetadata(serverUrl, { resourceMetadataUrl }, fetchFn);\n        if (resourceMetadata.authorization_servers && resourceMetadata.authorization_servers.length > 0) {\n            authorizationServerUrl = resourceMetadata.authorization_servers[0];\n        }\n    }\n    catch (_c) {\n        // Ignore errors and fall back to /.well-known/oauth-authorization-server\n    }\n    /**\n     * If we don't get a valid authorization server metadata from protected resource metadata,\n     * fallback to the legacy MCP spec's implementation (version 2025-03-26): MCP server base URL acts as the Authorization server.\n     */\n    if (!authorizationServerUrl) {\n        authorizationServerUrl = new URL('/', serverUrl);\n    }\n    const resource = await selectResourceURL(serverUrl, provider, resourceMetadata);\n    const metadata = await discoverAuthorizationServerMetadata(authorizationServerUrl, {\n        fetchFn\n    });\n    // Handle client registration if needed\n    let clientInformation = await Promise.resolve(provider.clientInformation());\n    if (!clientInformation) {\n        if (authorizationCode !== undefined) {\n            throw new Error('Existing OAuth client information is required when exchanging an authorization code');\n        }\n        const supportsUrlBasedClientId = (metadata === null || metadata === void 0 ? void 0 : metadata.client_id_metadata_document_supported) === true;\n        const clientMetadataUrl = provider.clientMetadataUrl;\n        if (clientMetadataUrl && !isHttpsUrl(clientMetadataUrl)) {\n            throw new InvalidClientMetadataError(`clientMetadataUrl must be a valid HTTPS URL with a non-root pathname, got: ${clientMetadataUrl}`);\n        }\n        const shouldUseUrlBasedClientId = supportsUrlBasedClientId && clientMetadataUrl;\n        if (shouldUseUrlBasedClientId) {\n            // SEP-991: URL-based Client IDs\n            clientInformation = {\n                client_id: clientMetadataUrl\n            };\n            await ((_a = provider.saveClientInformation) === null || _a === void 0 ? void 0 : _a.call(provider, clientInformation));\n        }\n        else {\n            // Fallback to dynamic registration\n            if (!provider.saveClientInformation) {\n                throw new Error('OAuth client information must be saveable for dynamic registration');\n            }\n            const fullInformation = await registerClient(authorizationServerUrl, {\n                metadata,\n                clientMetadata: provider.clientMetadata,\n                fetchFn\n            });\n            await provider.saveClientInformation(fullInformation);\n            clientInformation = fullInformation;\n        }\n    }\n    // Non-interactive flows (e.g., client_credentials, jwt-bearer) don't need a redirect URL\n    const nonInteractiveFlow = !provider.redirectUrl;\n    // Exchange authorization code for tokens, or fetch tokens directly for non-interactive flows\n    if (authorizationCode !== undefined || nonInteractiveFlow) {\n        const tokens = await fetchToken(provider, authorizationServerUrl, {\n            metadata,\n            resource,\n            authorizationCode,\n            fetchFn\n        });\n        await provider.saveTokens(tokens);\n        return 'AUTHORIZED';\n    }\n    const tokens = await provider.tokens();\n    // Handle token refresh or new authorization\n    if (tokens === null || tokens === void 0 ? void 0 : tokens.refresh_token) {\n        try {\n            // Attempt to refresh the token\n            const newTokens = await refreshAuthorization(authorizationServerUrl, {\n                metadata,\n                clientInformation,\n                refreshToken: tokens.refresh_token,\n                resource,\n                addClientAuthentication: provider.addClientAuthentication,\n                fetchFn\n            });\n            await provider.saveTokens(newTokens);\n            return 'AUTHORIZED';\n        }\n        catch (error) {\n            // If this is a ServerError, or an unknown type, log it out and try to continue. Otherwise, escalate so we can fix things and retry.\n            if (!(error instanceof OAuthError) || error instanceof ServerError) {\n                // Could not refresh OAuth tokens\n            }\n            else {\n                // Refresh failed for another reason, re-throw\n                throw error;\n            }\n        }\n    }\n    const state = provider.state ? await provider.state() : undefined;\n    // Start new authorization flow\n    const { authorizationUrl, codeVerifier } = await startAuthorization(authorizationServerUrl, {\n        metadata,\n        clientInformation,\n        state,\n        redirectUrl: provider.redirectUrl,\n        scope: scope || ((_b = resourceMetadata === null || resourceMetadata === void 0 ? void 0 : resourceMetadata.scopes_supported) === null || _b === void 0 ? void 0 : _b.join(' ')) || provider.clientMetadata.scope,\n        resource\n    });\n    await provider.saveCodeVerifier(codeVerifier);\n    await provider.redirectToAuthorization(authorizationUrl);\n    return 'REDIRECT';\n}\n/**\n * SEP-991: URL-based Client IDs\n * Validate that the client_id is a valid URL with https scheme\n */\nexport function isHttpsUrl(value) {\n    if (!value)\n        return false;\n    try {\n        const url = new URL(value);\n        return url.protocol === 'https:' && url.pathname !== '/';\n    }\n    catch (_a) {\n        return false;\n    }\n}\nexport async function selectResourceURL(serverUrl, provider, resourceMetadata) {\n    const defaultResource = resourceUrlFromServerUrl(serverUrl);\n    // If provider has custom validation, delegate to it\n    if (provider.validateResourceURL) {\n        return await provider.validateResourceURL(defaultResource, resourceMetadata === null || resourceMetadata === void 0 ? void 0 : resourceMetadata.resource);\n    }\n    // Only include resource parameter when Protected Resource Metadata is present\n    if (!resourceMetadata) {\n        return undefined;\n    }\n    // Validate that the metadata's resource is compatible with our request\n    if (!checkResourceAllowed({ requestedResource: defaultResource, configuredResource: resourceMetadata.resource })) {\n        throw new Error(`Protected resource ${resourceMetadata.resource} does not match expected ${defaultResource} (or origin)`);\n    }\n    // Prefer the resource from metadata since it's what the server is telling us to request\n    return new URL(resourceMetadata.resource);\n}\n/**\n * Extract resource_metadata, scope, and error from WWW-Authenticate header.\n */\nexport function extractWWWAuthenticateParams(res) {\n    const authenticateHeader = res.headers.get('WWW-Authenticate');\n    if (!authenticateHeader) {\n        return {};\n    }\n    const [type, scheme] = authenticateHeader.split(' ');\n    if (type.toLowerCase() !== 'bearer' || !scheme) {\n        return {};\n    }\n    const resourceMetadataMatch = extractFieldFromWwwAuth(res, 'resource_metadata') || undefined;\n    let resourceMetadataUrl;\n    if (resourceMetadataMatch) {\n        try {\n            resourceMetadataUrl = new URL(resourceMetadataMatch);\n        }\n        catch (_a) {\n            // Ignore invalid URL\n        }\n    }\n    const scope = extractFieldFromWwwAuth(res, 'scope') || undefined;\n    const error = extractFieldFromWwwAuth(res, 'error') || undefined;\n    return {\n        resourceMetadataUrl,\n        scope,\n        error\n    };\n}\n/**\n * Extracts a specific field's value from the WWW-Authenticate header string.\n *\n * @param response The HTTP response object containing the headers.\n * @param fieldName The name of the field to extract (e.g., \"realm\", \"nonce\").\n * @returns The field value\n */\nfunction extractFieldFromWwwAuth(response, fieldName) {\n    const wwwAuthHeader = response.headers.get('WWW-Authenticate');\n    if (!wwwAuthHeader) {\n        return null;\n    }\n    const pattern = new RegExp(`${fieldName}=(?:\"([^\"]+)\"|([^\\\\s,]+))`);\n    const match = wwwAuthHeader.match(pattern);\n    if (match) {\n        // Pattern matches: field_name=\"value\" or field_name=value (unquoted)\n        return match[1] || match[2];\n    }\n    return null;\n}\n/**\n * Extract resource_metadata from response header.\n * @deprecated Use `extractWWWAuthenticateParams` instead.\n */\nexport function extractResourceMetadataUrl(res) {\n    const authenticateHeader = res.headers.get('WWW-Authenticate');\n    if (!authenticateHeader) {\n        return undefined;\n    }\n    const [type, scheme] = authenticateHeader.split(' ');\n    if (type.toLowerCase() !== 'bearer' || !scheme) {\n        return undefined;\n    }\n    const regex = /resource_metadata=\"([^\"]*)\"/;\n    const match = regex.exec(authenticateHeader);\n    if (!match) {\n        return undefined;\n    }\n    try {\n        return new URL(match[1]);\n    }\n    catch (_a) {\n        return undefined;\n    }\n}\n/**\n * Looks up RFC 9728 OAuth 2.0 Protected Resource Metadata.\n *\n * If the server returns a 404 for the well-known endpoint, this function will\n * return `undefined`. Any other errors will be thrown as exceptions.\n */\nexport async function discoverOAuthProtectedResourceMetadata(serverUrl, opts, fetchFn = fetch) {\n    var _a, _b;\n    const response = await discoverMetadataWithFallback(serverUrl, 'oauth-protected-resource', fetchFn, {\n        protocolVersion: opts === null || opts === void 0 ? void 0 : opts.protocolVersion,\n        metadataUrl: opts === null || opts === void 0 ? void 0 : opts.resourceMetadataUrl\n    });\n    if (!response || response.status === 404) {\n        await ((_a = response === null || response === void 0 ? void 0 : response.body) === null || _a === void 0 ? void 0 : _a.cancel());\n        throw new Error(`Resource server does not implement OAuth 2.0 Protected Resource Metadata.`);\n    }\n    if (!response.ok) {\n        await ((_b = response.body) === null || _b === void 0 ? void 0 : _b.cancel());\n        throw new Error(`HTTP ${response.status} trying to load well-known OAuth protected resource metadata.`);\n    }\n    return OAuthProtectedResourceMetadataSchema.parse(await response.json());\n}\n/**\n * Helper function to handle fetch with CORS retry logic\n */\nasync function fetchWithCorsRetry(url, headers, fetchFn = fetch) {\n    try {\n        return await fetchFn(url, { headers });\n    }\n    catch (error) {\n        if (error instanceof TypeError) {\n            if (headers) {\n                // CORS errors come back as TypeError, retry without headers\n                return fetchWithCorsRetry(url, undefined, fetchFn);\n            }\n            else {\n                // We're getting CORS errors on retry too, return undefined\n                return undefined;\n            }\n        }\n        throw error;\n    }\n}\n/**\n * Constructs the well-known path for auth-related metadata discovery\n */\nfunction buildWellKnownPath(wellKnownPrefix, pathname = '', options = {}) {\n    // Strip trailing slash from pathname to avoid double slashes\n    if (pathname.endsWith('/')) {\n        pathname = pathname.slice(0, -1);\n    }\n    return options.prependPathname ? `${pathname}/.well-known/${wellKnownPrefix}` : `/.well-known/${wellKnownPrefix}${pathname}`;\n}\n/**\n * Tries to discover OAuth metadata at a specific URL\n */\nasync function tryMetadataDiscovery(url, protocolVersion, fetchFn = fetch) {\n    const headers = {\n        'MCP-Protocol-Version': protocolVersion\n    };\n    return await fetchWithCorsRetry(url, headers, fetchFn);\n}\n/**\n * Determines if fallback to root discovery should be attempted\n */\nfunction shouldAttemptFallback(response, pathname) {\n    return !response || (response.status >= 400 && response.status < 500 && pathname !== '/');\n}\n/**\n * Generic function for discovering OAuth metadata with fallback support\n */\nasync function discoverMetadataWithFallback(serverUrl, wellKnownType, fetchFn, opts) {\n    var _a, _b;\n    const issuer = new URL(serverUrl);\n    const protocolVersion = (_a = opts === null || opts === void 0 ? void 0 : opts.protocolVersion) !== null && _a !== void 0 ? _a : LATEST_PROTOCOL_VERSION;\n    let url;\n    if (opts === null || opts === void 0 ? void 0 : opts.metadataUrl) {\n        url = new URL(opts.metadataUrl);\n    }\n    else {\n        // Try path-aware discovery first\n        const wellKnownPath = buildWellKnownPath(wellKnownType, issuer.pathname);\n        url = new URL(wellKnownPath, (_b = opts === null || opts === void 0 ? void 0 : opts.metadataServerUrl) !== null && _b !== void 0 ? _b : issuer);\n        url.search = issuer.search;\n    }\n    let response = await tryMetadataDiscovery(url, protocolVersion, fetchFn);\n    // If path-aware discovery fails with 404 and we're not already at root, try fallback to root discovery\n    if (!(opts === null || opts === void 0 ? void 0 : opts.metadataUrl) && shouldAttemptFallback(response, issuer.pathname)) {\n        const rootUrl = new URL(`/.well-known/${wellKnownType}`, issuer);\n        response = await tryMetadataDiscovery(rootUrl, protocolVersion, fetchFn);\n    }\n    return response;\n}\n/**\n * Looks up RFC 8414 OAuth 2.0 Authorization Server Metadata.\n *\n * If the server returns a 404 for the well-known endpoint, this function will\n * return `undefined`. Any other errors will be thrown as exceptions.\n *\n * @deprecated This function is deprecated in favor of `discoverAuthorizationServerMetadata`.\n */\nexport async function discoverOAuthMetadata(issuer, { authorizationServerUrl, protocolVersion } = {}, fetchFn = fetch) {\n    var _a, _b;\n    if (typeof issuer === 'string') {\n        issuer = new URL(issuer);\n    }\n    if (!authorizationServerUrl) {\n        authorizationServerUrl = issuer;\n    }\n    if (typeof authorizationServerUrl === 'string') {\n        authorizationServerUrl = new URL(authorizationServerUrl);\n    }\n    protocolVersion !== null && protocolVersion !== void 0 ? protocolVersion : (protocolVersion = LATEST_PROTOCOL_VERSION);\n    const response = await discoverMetadataWithFallback(authorizationServerUrl, 'oauth-authorization-server', fetchFn, {\n        protocolVersion,\n        metadataServerUrl: authorizationServerUrl\n    });\n    if (!response || response.status === 404) {\n        await ((_a = response === null || response === void 0 ? void 0 : response.body) === null || _a === void 0 ? void 0 : _a.cancel());\n        return undefined;\n    }\n    if (!response.ok) {\n        await ((_b = response.body) === null || _b === void 0 ? void 0 : _b.cancel());\n        throw new Error(`HTTP ${response.status} trying to load well-known OAuth metadata`);\n    }\n    return OAuthMetadataSchema.parse(await response.json());\n}\n/**\n * Builds a list of discovery URLs to try for authorization server metadata.\n * URLs are returned in priority order:\n * 1. OAuth metadata at the given URL\n * 2. OIDC metadata endpoints at the given URL\n */\nexport function buildDiscoveryUrls(authorizationServerUrl) {\n    const url = typeof authorizationServerUrl === 'string' ? new URL(authorizationServerUrl) : authorizationServerUrl;\n    const hasPath = url.pathname !== '/';\n    const urlsToTry = [];\n    if (!hasPath) {\n        // Root path: https://example.com/.well-known/oauth-authorization-server\n        urlsToTry.push({\n            url: new URL('/.well-known/oauth-authorization-server', url.origin),\n            type: 'oauth'\n        });\n        // OIDC: https://example.com/.well-known/openid-configuration\n        urlsToTry.push({\n            url: new URL(`/.well-known/openid-configuration`, url.origin),\n            type: 'oidc'\n        });\n        return urlsToTry;\n    }\n    // Strip trailing slash from pathname to avoid double slashes\n    let pathname = url.pathname;\n    if (pathname.endsWith('/')) {\n        pathname = pathname.slice(0, -1);\n    }\n    // 1. OAuth metadata at the given URL\n    // Insert well-known before the path: https://example.com/.well-known/oauth-authorization-server/tenant1\n    urlsToTry.push({\n        url: new URL(`/.well-known/oauth-authorization-server${pathname}`, url.origin),\n        type: 'oauth'\n    });\n    // 2. OIDC metadata endpoints\n    // RFC 8414 style: Insert /.well-known/openid-configuration before the path\n    urlsToTry.push({\n        url: new URL(`/.well-known/openid-configuration${pathname}`, url.origin),\n        type: 'oidc'\n    });\n    // OIDC Discovery 1.0 style: Append /.well-known/openid-configuration after the path\n    urlsToTry.push({\n        url: new URL(`${pathname}/.well-known/openid-configuration`, url.origin),\n        type: 'oidc'\n    });\n    return urlsToTry;\n}\n/**\n * Discovers authorization server metadata with support for RFC 8414 OAuth 2.0 Authorization Server Metadata\n * and OpenID Connect Discovery 1.0 specifications.\n *\n * This function implements a fallback strategy for authorization server discovery:\n * 1. Attempts RFC 8414 OAuth metadata discovery first\n * 2. If OAuth discovery fails, falls back to OpenID Connect Discovery\n *\n * @param authorizationServerUrl - The authorization server URL obtained from the MCP Server's\n *                                 protected resource metadata, or the MCP server's URL if the\n *                                 metadata was not found.\n * @param options - Configuration options\n * @param options.fetchFn - Optional fetch function for making HTTP requests, defaults to global fetch\n * @param options.protocolVersion - MCP protocol version to use, defaults to LATEST_PROTOCOL_VERSION\n * @returns Promise resolving to authorization server metadata, or undefined if discovery fails\n */\nexport async function discoverAuthorizationServerMetadata(authorizationServerUrl, { fetchFn = fetch, protocolVersion = LATEST_PROTOCOL_VERSION } = {}) {\n    var _a;\n    const headers = {\n        'MCP-Protocol-Version': protocolVersion,\n        Accept: 'application/json'\n    };\n    // Get the list of URLs to try\n    const urlsToTry = buildDiscoveryUrls(authorizationServerUrl);\n    // Try each URL in order\n    for (const { url: endpointUrl, type } of urlsToTry) {\n        const response = await fetchWithCorsRetry(endpointUrl, headers, fetchFn);\n        if (!response) {\n            /**\n             * CORS error occurred - don't throw as the endpoint may not allow CORS,\n             * continue trying other possible endpoints\n             */\n            continue;\n        }\n        if (!response.ok) {\n            await ((_a = response.body) === null || _a === void 0 ? void 0 : _a.cancel());\n            // Continue looking for any 4xx response code.\n            if (response.status >= 400 && response.status < 500) {\n                continue; // Try next URL\n            }\n            throw new Error(`HTTP ${response.status} trying to load ${type === 'oauth' ? 'OAuth' : 'OpenID provider'} metadata from ${endpointUrl}`);\n        }\n        // Parse and validate based on type\n        if (type === 'oauth') {\n            return OAuthMetadataSchema.parse(await response.json());\n        }\n        else {\n            return OpenIdProviderDiscoveryMetadataSchema.parse(await response.json());\n        }\n    }\n    return undefined;\n}\n/**\n * Begins the authorization flow with the given server, by generating a PKCE challenge and constructing the authorization URL.\n */\nexport async function startAuthorization(authorizationServerUrl, { metadata, clientInformation, redirectUrl, scope, state, resource }) {\n    let authorizationUrl;\n    if (metadata) {\n        authorizationUrl = new URL(metadata.authorization_endpoint);\n        if (!metadata.response_types_supported.includes(AUTHORIZATION_CODE_RESPONSE_TYPE)) {\n            throw new Error(`Incompatible auth server: does not support response type ${AUTHORIZATION_CODE_RESPONSE_TYPE}`);\n        }\n        if (metadata.code_challenge_methods_supported &&\n            !metadata.code_challenge_methods_supported.includes(AUTHORIZATION_CODE_CHALLENGE_METHOD)) {\n            throw new Error(`Incompatible auth server: does not support code challenge method ${AUTHORIZATION_CODE_CHALLENGE_METHOD}`);\n        }\n    }\n    else {\n        authorizationUrl = new URL('/authorize', authorizationServerUrl);\n    }\n    // Generate PKCE challenge\n    const challenge = await pkceChallenge();\n    const codeVerifier = challenge.code_verifier;\n    const codeChallenge = challenge.code_challenge;\n    authorizationUrl.searchParams.set('response_type', AUTHORIZATION_CODE_RESPONSE_TYPE);\n    authorizationUrl.searchParams.set('client_id', clientInformation.client_id);\n    authorizationUrl.searchParams.set('code_challenge', codeChallenge);\n    authorizationUrl.searchParams.set('code_challenge_method', AUTHORIZATION_CODE_CHALLENGE_METHOD);\n    authorizationUrl.searchParams.set('redirect_uri', String(redirectUrl));\n    if (state) {\n        authorizationUrl.searchParams.set('state', state);\n    }\n    if (scope) {\n        authorizationUrl.searchParams.set('scope', scope);\n    }\n    if (scope === null || scope === void 0 ? void 0 : scope.includes('offline_access')) {\n        // if the request includes the OIDC-only \"offline_access\" scope,\n        // we need to set the prompt to \"consent\" to ensure the user is prompted to grant offline access\n        // https://openid.net/specs/openid-connect-core-1_0.html#OfflineAccess\n        authorizationUrl.searchParams.append('prompt', 'consent');\n    }\n    if (resource) {\n        authorizationUrl.searchParams.set('resource', resource.href);\n    }\n    return { authorizationUrl, codeVerifier };\n}\n/**\n * Prepares token request parameters for an authorization code exchange.\n *\n * This is the default implementation used by fetchToken when the provider\n * doesn't implement prepareTokenRequest.\n *\n * @param authorizationCode - The authorization code received from the authorization endpoint\n * @param codeVerifier - The PKCE code verifier\n * @param redirectUri - The redirect URI used in the authorization request\n * @returns URLSearchParams for the authorization_code grant\n */\nexport function prepareAuthorizationCodeRequest(authorizationCode, codeVerifier, redirectUri) {\n    return new URLSearchParams({\n        grant_type: 'authorization_code',\n        code: authorizationCode,\n        code_verifier: codeVerifier,\n        redirect_uri: String(redirectUri)\n    });\n}\n/**\n * Internal helper to execute a token request with the given parameters.\n * Used by exchangeAuthorization, refreshAuthorization, and fetchToken.\n */\nasync function executeTokenRequest(authorizationServerUrl, { metadata, tokenRequestParams, clientInformation, addClientAuthentication, resource, fetchFn }) {\n    var _a;\n    const tokenUrl = (metadata === null || metadata === void 0 ? void 0 : metadata.token_endpoint) ? new URL(metadata.token_endpoint) : new URL('/token', authorizationServerUrl);\n    const headers = new Headers({\n        'Content-Type': 'application/x-www-form-urlencoded',\n        Accept: 'application/json'\n    });\n    if (resource) {\n        tokenRequestParams.set('resource', resource.href);\n    }\n    if (addClientAuthentication) {\n        await addClientAuthentication(headers, tokenRequestParams, tokenUrl, metadata);\n    }\n    else if (clientInformation) {\n        const supportedMethods = (_a = metadata === null || metadata === void 0 ? void 0 : metadata.token_endpoint_auth_methods_supported) !== null && _a !== void 0 ? _a : [];\n        const authMethod = selectClientAuthMethod(clientInformation, supportedMethods);\n        applyClientAuthentication(authMethod, clientInformation, headers, tokenRequestParams);\n    }\n    const response = await (fetchFn !== null && fetchFn !== void 0 ? fetchFn : fetch)(tokenUrl, {\n        method: 'POST',\n        headers,\n        body: tokenRequestParams\n    });\n    if (!response.ok) {\n        throw await parseErrorResponse(response);\n    }\n    return OAuthTokensSchema.parse(await response.json());\n}\n/**\n * Exchanges an authorization code for an access token with the given server.\n *\n * Supports multiple client authentication methods as specified in OAuth 2.1:\n * - Automatically selects the best authentication method based on server support\n * - Falls back to appropriate defaults when server metadata is unavailable\n *\n * @param authorizationServerUrl - The authorization server's base URL\n * @param options - Configuration object containing client info, auth code, etc.\n * @returns Promise resolving to OAuth tokens\n * @throws {Error} When token exchange fails or authentication is invalid\n */\nexport async function exchangeAuthorization(authorizationServerUrl, { metadata, clientInformation, authorizationCode, codeVerifier, redirectUri, resource, addClientAuthentication, fetchFn }) {\n    const tokenRequestParams = prepareAuthorizationCodeRequest(authorizationCode, codeVerifier, redirectUri);\n    return executeTokenRequest(authorizationServerUrl, {\n        metadata,\n        tokenRequestParams,\n        clientInformation,\n        addClientAuthentication,\n        resource,\n        fetchFn\n    });\n}\n/**\n * Exchange a refresh token for an updated access token.\n *\n * Supports multiple client authentication methods as specified in OAuth 2.1:\n * - Automatically selects the best authentication method based on server support\n * - Preserves the original refresh token if a new one is not returned\n *\n * @param authorizationServerUrl - The authorization server's base URL\n * @param options - Configuration object containing client info, refresh token, etc.\n * @returns Promise resolving to OAuth tokens (preserves original refresh_token if not replaced)\n * @throws {Error} When token refresh fails or authentication is invalid\n */\nexport async function refreshAuthorization(authorizationServerUrl, { metadata, clientInformation, refreshToken, resource, addClientAuthentication, fetchFn }) {\n    const tokenRequestParams = new URLSearchParams({\n        grant_type: 'refresh_token',\n        refresh_token: refreshToken\n    });\n    const tokens = await executeTokenRequest(authorizationServerUrl, {\n        metadata,\n        tokenRequestParams,\n        clientInformation,\n        addClientAuthentication,\n        resource,\n        fetchFn\n    });\n    // Preserve original refresh token if server didn't return a new one\n    return { refresh_token: refreshToken, ...tokens };\n}\n/**\n * Unified token fetching that works with any grant type via provider.prepareTokenRequest().\n *\n * This function provides a single entry point for obtaining tokens regardless of the\n * OAuth grant type. The provider's prepareTokenRequest() method determines which grant\n * to use and supplies the grant-specific parameters.\n *\n * @param provider - OAuth client provider that implements prepareTokenRequest()\n * @param authorizationServerUrl - The authorization server's base URL\n * @param options - Configuration for the token request\n * @returns Promise resolving to OAuth tokens\n * @throws {Error} When provider doesn't implement prepareTokenRequest or token fetch fails\n *\n * @example\n * // Provider for client_credentials:\n * class MyProvider implements OAuthClientProvider {\n *   prepareTokenRequest(scope) {\n *     const params = new URLSearchParams({ grant_type: 'client_credentials' });\n *     if (scope) params.set('scope', scope);\n *     return params;\n *   }\n *   // ... other methods\n * }\n *\n * const tokens = await fetchToken(provider, authServerUrl, { metadata });\n */\nexport async function fetchToken(provider, authorizationServerUrl, { metadata, resource, authorizationCode, fetchFn } = {}) {\n    const scope = provider.clientMetadata.scope;\n    // Use provider's prepareTokenRequest if available, otherwise fall back to authorization_code\n    let tokenRequestParams;\n    if (provider.prepareTokenRequest) {\n        tokenRequestParams = await provider.prepareTokenRequest(scope);\n    }\n    // Default to authorization_code grant if no custom prepareTokenRequest\n    if (!tokenRequestParams) {\n        if (!authorizationCode) {\n            throw new Error('Either provider.prepareTokenRequest() or authorizationCode is required');\n        }\n        if (!provider.redirectUrl) {\n            throw new Error('redirectUrl is required for authorization_code flow');\n        }\n        const codeVerifier = await provider.codeVerifier();\n        tokenRequestParams = prepareAuthorizationCodeRequest(authorizationCode, codeVerifier, provider.redirectUrl);\n    }\n    const clientInformation = await provider.clientInformation();\n    return executeTokenRequest(authorizationServerUrl, {\n        metadata,\n        tokenRequestParams,\n        clientInformation: clientInformation !== null && clientInformation !== void 0 ? clientInformation : undefined,\n        addClientAuthentication: provider.addClientAuthentication,\n        resource,\n        fetchFn\n    });\n}\n/**\n * Performs OAuth 2.0 Dynamic Client Registration according to RFC 7591.\n */\nexport async function registerClient(authorizationServerUrl, { metadata, clientMetadata, fetchFn }) {\n    let registrationUrl;\n    if (metadata) {\n        if (!metadata.registration_endpoint) {\n            throw new Error('Incompatible auth server: does not support dynamic client registration');\n        }\n        registrationUrl = new URL(metadata.registration_endpoint);\n    }\n    else {\n        registrationUrl = new URL('/register', authorizationServerUrl);\n    }\n    const response = await (fetchFn !== null && fetchFn !== void 0 ? fetchFn : fetch)(registrationUrl, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(clientMetadata)\n    });\n    if (!response.ok) {\n        throw await parseErrorResponse(response);\n    }\n    return OAuthClientInformationFullSchema.parse(await response.json());\n}\n//# sourceMappingURL=auth.js.map","class ParseError extends Error {\n  constructor(message, options) {\n    super(message), this.name = \"ParseError\", this.type = options.type, this.field = options.field, this.value = options.value, this.line = options.line;\n  }\n}\nfunction noop(_arg) {\n}\nfunction createParser(callbacks) {\n  if (typeof callbacks == \"function\")\n    throw new TypeError(\n      \"`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?\"\n    );\n  const { onEvent = noop, onError = noop, onRetry = noop, onComment } = callbacks;\n  let incompleteLine = \"\", isFirstChunk = !0, id, data = \"\", eventType = \"\";\n  function feed(newChunk) {\n    const chunk = isFirstChunk ? newChunk.replace(/^\\xEF\\xBB\\xBF/, \"\") : newChunk, [complete, incomplete] = splitLines(`${incompleteLine}${chunk}`);\n    for (const line of complete)\n      parseLine(line);\n    incompleteLine = incomplete, isFirstChunk = !1;\n  }\n  function parseLine(line) {\n    if (line === \"\") {\n      dispatchEvent();\n      return;\n    }\n    if (line.startsWith(\":\")) {\n      onComment && onComment(line.slice(line.startsWith(\": \") ? 2 : 1));\n      return;\n    }\n    const fieldSeparatorIndex = line.indexOf(\":\");\n    if (fieldSeparatorIndex !== -1) {\n      const field = line.slice(0, fieldSeparatorIndex), offset = line[fieldSeparatorIndex + 1] === \" \" ? 2 : 1, value = line.slice(fieldSeparatorIndex + offset);\n      processField(field, value, line);\n      return;\n    }\n    processField(line, \"\", line);\n  }\n  function processField(field, value, line) {\n    switch (field) {\n      case \"event\":\n        eventType = value;\n        break;\n      case \"data\":\n        data = `${data}${value}\n`;\n        break;\n      case \"id\":\n        id = value.includes(\"\\0\") ? void 0 : value;\n        break;\n      case \"retry\":\n        /^\\d+$/.test(value) ? onRetry(parseInt(value, 10)) : onError(\n          new ParseError(`Invalid \\`retry\\` value: \"${value}\"`, {\n            type: \"invalid-retry\",\n            value,\n            line\n          })\n        );\n        break;\n      default:\n        onError(\n          new ParseError(\n            `Unknown field \"${field.length > 20 ? `${field.slice(0, 20)}\\u2026` : field}\"`,\n            { type: \"unknown-field\", field, value, line }\n          )\n        );\n        break;\n    }\n  }\n  function dispatchEvent() {\n    data.length > 0 && onEvent({\n      id,\n      event: eventType || void 0,\n      // If the data buffer's last character is a U+000A LINE FEED (LF) character,\n      // then remove the last character from the data buffer.\n      data: data.endsWith(`\n`) ? data.slice(0, -1) : data\n    }), id = void 0, data = \"\", eventType = \"\";\n  }\n  function reset(options = {}) {\n    incompleteLine && options.consume && parseLine(incompleteLine), isFirstChunk = !0, id = void 0, data = \"\", eventType = \"\", incompleteLine = \"\";\n  }\n  return { feed, reset };\n}\nfunction splitLines(chunk) {\n  const lines = [];\n  let incompleteLine = \"\", searchIndex = 0;\n  for (; searchIndex < chunk.length; ) {\n    const crIndex = chunk.indexOf(\"\\r\", searchIndex), lfIndex = chunk.indexOf(`\n`, searchIndex);\n    let lineEnd = -1;\n    if (crIndex !== -1 && lfIndex !== -1 ? lineEnd = Math.min(crIndex, lfIndex) : crIndex !== -1 ? crIndex === chunk.length - 1 ? lineEnd = -1 : lineEnd = crIndex : lfIndex !== -1 && (lineEnd = lfIndex), lineEnd === -1) {\n      incompleteLine = chunk.slice(searchIndex);\n      break;\n    } else {\n      const line = chunk.slice(searchIndex, lineEnd);\n      lines.push(line), searchIndex = lineEnd + 1, chunk[searchIndex - 1] === \"\\r\" && chunk[searchIndex] === `\n` && searchIndex++;\n    }\n  }\n  return [lines, incompleteLine];\n}\nexport {\n  ParseError,\n  createParser\n};\n//# sourceMappingURL=index.js.map\n","import { createParser } from \"./index.js\";\nimport { ParseError } from \"./index.js\";\nclass EventSourceParserStream extends TransformStream {\n  constructor({ onError, onRetry, onComment } = {}) {\n    let parser;\n    super({\n      start(controller) {\n        parser = createParser({\n          onEvent: (event) => {\n            controller.enqueue(event);\n          },\n          onError(error) {\n            onError === \"terminate\" ? controller.error(error) : typeof onError == \"function\" && onError(error);\n          },\n          onRetry,\n          onComment\n        });\n      },\n      transform(chunk) {\n        parser.feed(chunk);\n      }\n    });\n  }\n}\nexport {\n  EventSourceParserStream,\n  ParseError\n};\n//# sourceMappingURL=stream.js.map\n","import { createFetchWithInit, normalizeHeaders } from '../shared/transport.js';\nimport { isInitializedNotification, isJSONRPCRequest, isJSONRPCResponse, JSONRPCMessageSchema } from '../types.js';\nimport { auth, extractWWWAuthenticateParams, UnauthorizedError } from './auth.js';\nimport { EventSourceParserStream } from 'eventsource-parser/stream';\n// Default reconnection options for StreamableHTTP connections\nconst DEFAULT_STREAMABLE_HTTP_RECONNECTION_OPTIONS = {\n    initialReconnectionDelay: 1000,\n    maxReconnectionDelay: 30000,\n    reconnectionDelayGrowFactor: 1.5,\n    maxRetries: 2\n};\nexport class StreamableHTTPError extends Error {\n    constructor(code, message) {\n        super(`Streamable HTTP error: ${message}`);\n        this.code = code;\n    }\n}\n/**\n * Client transport for Streamable HTTP: this implements the MCP Streamable HTTP transport specification.\n * It will connect to a server using HTTP POST for sending messages and HTTP GET with Server-Sent Events\n * for receiving messages.\n */\nexport class StreamableHTTPClientTransport {\n    constructor(url, opts) {\n        var _a;\n        this._hasCompletedAuthFlow = false; // Circuit breaker: detect auth success followed by immediate 401\n        this._url = url;\n        this._resourceMetadataUrl = undefined;\n        this._scope = undefined;\n        this._requestInit = opts === null || opts === void 0 ? void 0 : opts.requestInit;\n        this._authProvider = opts === null || opts === void 0 ? void 0 : opts.authProvider;\n        this._fetch = opts === null || opts === void 0 ? void 0 : opts.fetch;\n        this._fetchWithInit = createFetchWithInit(opts === null || opts === void 0 ? void 0 : opts.fetch, opts === null || opts === void 0 ? void 0 : opts.requestInit);\n        this._sessionId = opts === null || opts === void 0 ? void 0 : opts.sessionId;\n        this._reconnectionOptions = (_a = opts === null || opts === void 0 ? void 0 : opts.reconnectionOptions) !== null && _a !== void 0 ? _a : DEFAULT_STREAMABLE_HTTP_RECONNECTION_OPTIONS;\n    }\n    async _authThenStart() {\n        var _a;\n        if (!this._authProvider) {\n            throw new UnauthorizedError('No auth provider');\n        }\n        let result;\n        try {\n            result = await auth(this._authProvider, {\n                serverUrl: this._url,\n                resourceMetadataUrl: this._resourceMetadataUrl,\n                scope: this._scope,\n                fetchFn: this._fetchWithInit\n            });\n        }\n        catch (error) {\n            (_a = this.onerror) === null || _a === void 0 ? void 0 : _a.call(this, error);\n            throw error;\n        }\n        if (result !== 'AUTHORIZED') {\n            throw new UnauthorizedError();\n        }\n        return await this._startOrAuthSse({ resumptionToken: undefined });\n    }\n    async _commonHeaders() {\n        var _a;\n        const headers = {};\n        if (this._authProvider) {\n            const tokens = await this._authProvider.tokens();\n            if (tokens) {\n                headers['Authorization'] = `Bearer ${tokens.access_token}`;\n            }\n        }\n        if (this._sessionId) {\n            headers['mcp-session-id'] = this._sessionId;\n        }\n        if (this._protocolVersion) {\n            headers['mcp-protocol-version'] = this._protocolVersion;\n        }\n        const extraHeaders = normalizeHeaders((_a = this._requestInit) === null || _a === void 0 ? void 0 : _a.headers);\n        return new Headers({\n            ...headers,\n            ...extraHeaders\n        });\n    }\n    async _startOrAuthSse(options) {\n        var _a, _b, _c, _d;\n        const { resumptionToken } = options;\n        try {\n            // Try to open an initial SSE stream with GET to listen for server messages\n            // This is optional according to the spec - server may not support it\n            const headers = await this._commonHeaders();\n            headers.set('Accept', 'text/event-stream');\n            // Include Last-Event-ID header for resumable streams if provided\n            if (resumptionToken) {\n                headers.set('last-event-id', resumptionToken);\n            }\n            const response = await ((_a = this._fetch) !== null && _a !== void 0 ? _a : fetch)(this._url, {\n                method: 'GET',\n                headers,\n                signal: (_b = this._abortController) === null || _b === void 0 ? void 0 : _b.signal\n            });\n            if (!response.ok) {\n                await ((_c = response.body) === null || _c === void 0 ? void 0 : _c.cancel());\n                if (response.status === 401 && this._authProvider) {\n                    // Need to authenticate\n                    return await this._authThenStart();\n                }\n                // 405 indicates that the server does not offer an SSE stream at GET endpoint\n                // This is an expected case that should not trigger an error\n                if (response.status === 405) {\n                    return;\n                }\n                throw new StreamableHTTPError(response.status, `Failed to open SSE stream: ${response.statusText}`);\n            }\n            this._handleSseStream(response.body, options, true);\n        }\n        catch (error) {\n            (_d = this.onerror) === null || _d === void 0 ? void 0 : _d.call(this, error);\n            throw error;\n        }\n    }\n    /**\n     * Calculates the next reconnection delay using  backoff algorithm\n     *\n     * @param attempt Current reconnection attempt count for the specific stream\n     * @returns Time to wait in milliseconds before next reconnection attempt\n     */\n    _getNextReconnectionDelay(attempt) {\n        // Use server-provided retry value if available\n        if (this._serverRetryMs !== undefined) {\n            return this._serverRetryMs;\n        }\n        // Fall back to exponential backoff\n        const initialDelay = this._reconnectionOptions.initialReconnectionDelay;\n        const growFactor = this._reconnectionOptions.reconnectionDelayGrowFactor;\n        const maxDelay = this._reconnectionOptions.maxReconnectionDelay;\n        // Cap at maximum delay\n        return Math.min(initialDelay * Math.pow(growFactor, attempt), maxDelay);\n    }\n    /**\n     * Schedule a reconnection attempt using server-provided retry interval or backoff\n     *\n     * @param lastEventId The ID of the last received event for resumability\n     * @param attemptCount Current reconnection attempt count for this specific stream\n     */\n    _scheduleReconnection(options, attemptCount = 0) {\n        var _a;\n        // Use provided options or default options\n        const maxRetries = this._reconnectionOptions.maxRetries;\n        // Check if we've exceeded maximum retry attempts\n        if (attemptCount >= maxRetries) {\n            (_a = this.onerror) === null || _a === void 0 ? void 0 : _a.call(this, new Error(`Maximum reconnection attempts (${maxRetries}) exceeded.`));\n            return;\n        }\n        // Calculate next delay based on current attempt count\n        const delay = this._getNextReconnectionDelay(attemptCount);\n        // Schedule the reconnection\n        this._reconnectionTimeout = setTimeout(() => {\n            // Use the last event ID to resume where we left off\n            this._startOrAuthSse(options).catch(error => {\n                var _a;\n                (_a = this.onerror) === null || _a === void 0 ? void 0 : _a.call(this, new Error(`Failed to reconnect SSE stream: ${error instanceof Error ? error.message : String(error)}`));\n                // Schedule another attempt if this one failed, incrementing the attempt counter\n                this._scheduleReconnection(options, attemptCount + 1);\n            });\n        }, delay);\n    }\n    _handleSseStream(stream, options, isReconnectable) {\n        if (!stream) {\n            return;\n        }\n        const { onresumptiontoken, replayMessageId } = options;\n        let lastEventId;\n        // Track whether we've received a priming event (event with ID)\n        // Per spec, server SHOULD send a priming event with ID before closing\n        let hasPrimingEvent = false;\n        // Track whether we've received a response - if so, no need to reconnect\n        // Reconnection is for when server disconnects BEFORE sending response\n        let receivedResponse = false;\n        const processStream = async () => {\n            var _a, _b, _c, _d;\n            // this is the closest we can get to trying to catch network errors\n            // if something happens reader will throw\n            try {\n                // Create a pipeline: binary stream -> text decoder -> SSE parser\n                const reader = stream\n                    .pipeThrough(new TextDecoderStream())\n                    .pipeThrough(new EventSourceParserStream({\n                    onRetry: (retryMs) => {\n                        // Capture server-provided retry value for reconnection timing\n                        this._serverRetryMs = retryMs;\n                    }\n                }))\n                    .getReader();\n                while (true) {\n                    const { value: event, done } = await reader.read();\n                    if (done) {\n                        break;\n                    }\n                    // Update last event ID if provided\n                    if (event.id) {\n                        lastEventId = event.id;\n                        // Mark that we've received a priming event - stream is now resumable\n                        hasPrimingEvent = true;\n                        onresumptiontoken === null || onresumptiontoken === void 0 ? void 0 : onresumptiontoken(event.id);\n                    }\n                    // Skip events with no data (priming events, keep-alives)\n                    if (!event.data) {\n                        continue;\n                    }\n                    if (!event.event || event.event === 'message') {\n                        try {\n                            const message = JSONRPCMessageSchema.parse(JSON.parse(event.data));\n                            if (isJSONRPCResponse(message)) {\n                                // Mark that we received a response - no need to reconnect for this request\n                                receivedResponse = true;\n                                if (replayMessageId !== undefined) {\n                                    message.id = replayMessageId;\n                                }\n                            }\n                            (_a = this.onmessage) === null || _a === void 0 ? void 0 : _a.call(this, message);\n                        }\n                        catch (error) {\n                            (_b = this.onerror) === null || _b === void 0 ? void 0 : _b.call(this, error);\n                        }\n                    }\n                }\n                // Handle graceful server-side disconnect\n                // Server may close connection after sending event ID and retry field\n                // Reconnect if: already reconnectable (GET stream) OR received a priming event (POST stream with event ID)\n                // BUT don't reconnect if we already received a response - the request is complete\n                const canResume = isReconnectable || hasPrimingEvent;\n                const needsReconnect = canResume && !receivedResponse;\n                if (needsReconnect && this._abortController && !this._abortController.signal.aborted) {\n                    this._scheduleReconnection({\n                        resumptionToken: lastEventId,\n                        onresumptiontoken,\n                        replayMessageId\n                    }, 0);\n                }\n            }\n            catch (error) {\n                // Handle stream errors - likely a network disconnect\n                (_c = this.onerror) === null || _c === void 0 ? void 0 : _c.call(this, new Error(`SSE stream disconnected: ${error}`));\n                // Attempt to reconnect if the stream disconnects unexpectedly and we aren't closing\n                // Reconnect if: already reconnectable (GET stream) OR received a priming event (POST stream with event ID)\n                // BUT don't reconnect if we already received a response - the request is complete\n                const canResume = isReconnectable || hasPrimingEvent;\n                const needsReconnect = canResume && !receivedResponse;\n                if (needsReconnect && this._abortController && !this._abortController.signal.aborted) {\n                    // Use the exponential backoff reconnection strategy\n                    try {\n                        this._scheduleReconnection({\n                            resumptionToken: lastEventId,\n                            onresumptiontoken,\n                            replayMessageId\n                        }, 0);\n                    }\n                    catch (error) {\n                        (_d = this.onerror) === null || _d === void 0 ? void 0 : _d.call(this, new Error(`Failed to reconnect: ${error instanceof Error ? error.message : String(error)}`));\n                    }\n                }\n            }\n        };\n        processStream();\n    }\n    async start() {\n        if (this._abortController) {\n            throw new Error('StreamableHTTPClientTransport already started! If using Client class, note that connect() calls start() automatically.');\n        }\n        this._abortController = new AbortController();\n    }\n    /**\n     * Call this method after the user has finished authorizing via their user agent and is redirected back to the MCP client application. This will exchange the authorization code for an access token, enabling the next connection attempt to successfully auth.\n     */\n    async finishAuth(authorizationCode) {\n        if (!this._authProvider) {\n            throw new UnauthorizedError('No auth provider');\n        }\n        const result = await auth(this._authProvider, {\n            serverUrl: this._url,\n            authorizationCode,\n            resourceMetadataUrl: this._resourceMetadataUrl,\n            scope: this._scope,\n            fetchFn: this._fetchWithInit\n        });\n        if (result !== 'AUTHORIZED') {\n            throw new UnauthorizedError('Failed to authorize');\n        }\n    }\n    async close() {\n        var _a, _b;\n        if (this._reconnectionTimeout) {\n            clearTimeout(this._reconnectionTimeout);\n            this._reconnectionTimeout = undefined;\n        }\n        (_a = this._abortController) === null || _a === void 0 ? void 0 : _a.abort();\n        (_b = this.onclose) === null || _b === void 0 ? void 0 : _b.call(this);\n    }\n    async send(message, options) {\n        var _a, _b, _c, _d, _e, _f, _g;\n        try {\n            const { resumptionToken, onresumptiontoken } = options || {};\n            if (resumptionToken) {\n                // If we have at last event ID, we need to reconnect the SSE stream\n                this._startOrAuthSse({ resumptionToken, replayMessageId: isJSONRPCRequest(message) ? message.id : undefined }).catch(err => { var _a; return (_a = this.onerror) === null || _a === void 0 ? void 0 : _a.call(this, err); });\n                return;\n            }\n            const headers = await this._commonHeaders();\n            headers.set('content-type', 'application/json');\n            headers.set('accept', 'application/json, text/event-stream');\n            const init = {\n                ...this._requestInit,\n                method: 'POST',\n                headers,\n                body: JSON.stringify(message),\n                signal: (_a = this._abortController) === null || _a === void 0 ? void 0 : _a.signal\n            };\n            const response = await ((_b = this._fetch) !== null && _b !== void 0 ? _b : fetch)(this._url, init);\n            // Handle session ID received during initialization\n            const sessionId = response.headers.get('mcp-session-id');\n            if (sessionId) {\n                this._sessionId = sessionId;\n            }\n            if (!response.ok) {\n                const text = await response.text().catch(() => null);\n                if (response.status === 401 && this._authProvider) {\n                    // Prevent infinite recursion when server returns 401 after successful auth\n                    if (this._hasCompletedAuthFlow) {\n                        throw new StreamableHTTPError(401, 'Server returned 401 after successful authentication');\n                    }\n                    const { resourceMetadataUrl, scope } = extractWWWAuthenticateParams(response);\n                    this._resourceMetadataUrl = resourceMetadataUrl;\n                    this._scope = scope;\n                    const result = await auth(this._authProvider, {\n                        serverUrl: this._url,\n                        resourceMetadataUrl: this._resourceMetadataUrl,\n                        scope: this._scope,\n                        fetchFn: this._fetchWithInit\n                    });\n                    if (result !== 'AUTHORIZED') {\n                        throw new UnauthorizedError();\n                    }\n                    // Mark that we completed auth flow\n                    this._hasCompletedAuthFlow = true;\n                    // Purposely _not_ awaited, so we don't call onerror twice\n                    return this.send(message);\n                }\n                if (response.status === 403 && this._authProvider) {\n                    const { resourceMetadataUrl, scope, error } = extractWWWAuthenticateParams(response);\n                    if (error === 'insufficient_scope') {\n                        const wwwAuthHeader = response.headers.get('WWW-Authenticate');\n                        // Check if we've already tried upscoping with this header to prevent infinite loops.\n                        if (this._lastUpscopingHeader === wwwAuthHeader) {\n                            throw new StreamableHTTPError(403, 'Server returned 403 after trying upscoping');\n                        }\n                        if (scope) {\n                            this._scope = scope;\n                        }\n                        if (resourceMetadataUrl) {\n                            this._resourceMetadataUrl = resourceMetadataUrl;\n                        }\n                        // Mark that upscoping was tried.\n                        this._lastUpscopingHeader = wwwAuthHeader !== null && wwwAuthHeader !== void 0 ? wwwAuthHeader : undefined;\n                        const result = await auth(this._authProvider, {\n                            serverUrl: this._url,\n                            resourceMetadataUrl: this._resourceMetadataUrl,\n                            scope: this._scope,\n                            fetchFn: this._fetch\n                        });\n                        if (result !== 'AUTHORIZED') {\n                            throw new UnauthorizedError();\n                        }\n                        return this.send(message);\n                    }\n                }\n                throw new StreamableHTTPError(response.status, `Error POSTing to endpoint: ${text}`);\n            }\n            // Reset auth loop flag on successful response\n            this._hasCompletedAuthFlow = false;\n            this._lastUpscopingHeader = undefined;\n            // If the response is 202 Accepted, there's no body to process\n            if (response.status === 202) {\n                await ((_c = response.body) === null || _c === void 0 ? void 0 : _c.cancel());\n                // if the accepted notification is initialized, we start the SSE stream\n                // if it's supported by the server\n                if (isInitializedNotification(message)) {\n                    // Start without a lastEventId since this is a fresh connection\n                    this._startOrAuthSse({ resumptionToken: undefined }).catch(err => { var _a; return (_a = this.onerror) === null || _a === void 0 ? void 0 : _a.call(this, err); });\n                }\n                return;\n            }\n            // Get original message(s) for detecting request IDs\n            const messages = Array.isArray(message) ? message : [message];\n            const hasRequests = messages.filter(msg => 'method' in msg && 'id' in msg && msg.id !== undefined).length > 0;\n            // Check the response type\n            const contentType = response.headers.get('content-type');\n            if (hasRequests) {\n                if (contentType === null || contentType === void 0 ? void 0 : contentType.includes('text/event-stream')) {\n                    // Handle SSE stream responses for requests\n                    // We use the same handler as standalone streams, which now supports\n                    // reconnection with the last event ID\n                    this._handleSseStream(response.body, { onresumptiontoken }, false);\n                }\n                else if (contentType === null || contentType === void 0 ? void 0 : contentType.includes('application/json')) {\n                    // For non-streaming servers, we might get direct JSON responses\n                    const data = await response.json();\n                    const responseMessages = Array.isArray(data)\n                        ? data.map(msg => JSONRPCMessageSchema.parse(msg))\n                        : [JSONRPCMessageSchema.parse(data)];\n                    for (const msg of responseMessages) {\n                        (_d = this.onmessage) === null || _d === void 0 ? void 0 : _d.call(this, msg);\n                    }\n                }\n                else {\n                    await ((_e = response.body) === null || _e === void 0 ? void 0 : _e.cancel());\n                    throw new StreamableHTTPError(-1, `Unexpected content type: ${contentType}`);\n                }\n            }\n            else {\n                // No requests in message but got 200 OK - still need to release connection\n                await ((_f = response.body) === null || _f === void 0 ? void 0 : _f.cancel());\n            }\n        }\n        catch (error) {\n            (_g = this.onerror) === null || _g === void 0 ? void 0 : _g.call(this, error);\n            throw error;\n        }\n    }\n    get sessionId() {\n        return this._sessionId;\n    }\n    /**\n     * Terminates the current session by sending a DELETE request to the server.\n     *\n     * Clients that no longer need a particular session\n     * (e.g., because the user is leaving the client application) SHOULD send an\n     * HTTP DELETE to the MCP endpoint with the Mcp-Session-Id header to explicitly\n     * terminate the session.\n     *\n     * The server MAY respond with HTTP 405 Method Not Allowed, indicating that\n     * the server does not allow clients to terminate sessions.\n     */\n    async terminateSession() {\n        var _a, _b, _c, _d;\n        if (!this._sessionId) {\n            return; // No session to terminate\n        }\n        try {\n            const headers = await this._commonHeaders();\n            const init = {\n                ...this._requestInit,\n                method: 'DELETE',\n                headers,\n                signal: (_a = this._abortController) === null || _a === void 0 ? void 0 : _a.signal\n            };\n            const response = await ((_b = this._fetch) !== null && _b !== void 0 ? _b : fetch)(this._url, init);\n            await ((_c = response.body) === null || _c === void 0 ? void 0 : _c.cancel());\n            // We specifically handle 405 as a valid response according to the spec,\n            // meaning the server does not support explicit session termination\n            if (!response.ok && response.status !== 405) {\n                throw new StreamableHTTPError(response.status, `Failed to terminate session: ${response.statusText}`);\n            }\n            this._sessionId = undefined;\n        }\n        catch (error) {\n            (_d = this.onerror) === null || _d === void 0 ? void 0 : _d.call(this, error);\n            throw error;\n        }\n    }\n    setProtocolVersion(version) {\n        this._protocolVersion = version;\n    }\n    get protocolVersion() {\n        return this._protocolVersion;\n    }\n    /**\n     * Resume an SSE stream from a previous event ID.\n     * Opens a GET SSE connection with Last-Event-ID header to replay missed events.\n     *\n     * @param lastEventId The event ID to resume from\n     * @param options Optional callback to receive new resumption tokens\n     */\n    async resumeStream(lastEventId, options) {\n        await this._startOrAuthSse({\n            resumptionToken: lastEventId,\n            onresumptiontoken: options === null || options === void 0 ? void 0 : options.onresumptiontoken\n        });\n    }\n}\n//# sourceMappingURL=streamableHttp.js.map","import { Client } from '@modelcontextprotocol/sdk/client/index.js'\nimport { StreamableHTTPClientTransport } from '@modelcontextprotocol/sdk/client/streamableHttp.js'\n\n/** @public */\nexport interface McpTool {\n  name: string\n  description?: string\n}\n\n/**\n * Fetches available tools from an MCP server\n * @public\n */\nexport async function fetchMcpTools(serverUrl: string): Promise<McpTool[]> {\n  const client = new Client({\n    name: 'browseros-settings',\n    version: '1.0.0',\n  })\n\n  const transport = new StreamableHTTPClientTransport(new URL(serverUrl))\n\n  try {\n    await client.connect(transport)\n    const response = await client.listTools()\n\n    return response.tools.map((tool) => ({\n      name: tool.name,\n      description: tool.description,\n    }))\n  } finally {\n    await client.close()\n  }\n}\n","const list = [\n\t// Native ES errors https://262.ecma-international.org/12.0/#sec-well-known-intrinsic-objects\n\tEvalError,\n\tRangeError,\n\tReferenceError,\n\tSyntaxError,\n\tTypeError,\n\tURIError,\n\n\t// Built-in errors\n\tglobalThis.DOMException,\n\n\t// Node-specific errors\n\t// https://nodejs.org/api/errors.html\n\tglobalThis.AssertionError,\n\tglobalThis.SystemError,\n]\n\t// Non-native Errors are used with `globalThis` because they might be missing. This filter drops them when undefined.\n\t.filter(Boolean)\n\t.map(\n\t\tconstructor => [constructor.name, constructor],\n\t);\n\nconst errorConstructors = new Map(list);\n\nexport default errorConstructors;\n","import errorConstructors from './error-constructors.js';\n\nexport class NonError extends Error {\n\tname = 'NonError';\n\n\tconstructor(message) {\n\t\tsuper(NonError._prepareSuperMessage(message));\n\t}\n\n\tstatic _prepareSuperMessage(message) {\n\t\ttry {\n\t\t\treturn JSON.stringify(message);\n\t\t} catch {\n\t\t\treturn String(message);\n\t\t}\n\t}\n}\n\nconst commonProperties = [\n\t{\n\t\tproperty: 'name',\n\t\tenumerable: false,\n\t},\n\t{\n\t\tproperty: 'message',\n\t\tenumerable: false,\n\t},\n\t{\n\t\tproperty: 'stack',\n\t\tenumerable: false,\n\t},\n\t{\n\t\tproperty: 'code',\n\t\tenumerable: true,\n\t},\n\t{\n\t\tproperty: 'cause',\n\t\tenumerable: false,\n\t},\n];\n\nconst toJsonWasCalled = new WeakSet();\n\nconst toJSON = from => {\n\ttoJsonWasCalled.add(from);\n\tconst json = from.toJSON();\n\ttoJsonWasCalled.delete(from);\n\treturn json;\n};\n\nconst getErrorConstructor = name => errorConstructors.get(name) ?? Error;\n\n// eslint-disable-next-line complexity\nconst destroyCircular = ({\n\tfrom,\n\tseen,\n\tto,\n\tforceEnumerable,\n\tmaxDepth,\n\tdepth,\n\tuseToJSON,\n\tserialize,\n}) => {\n\tif (!to) {\n\t\tif (Array.isArray(from)) {\n\t\t\tto = [];\n\t\t} else if (!serialize && isErrorLike(from)) {\n\t\t\tconst Error = getErrorConstructor(from.name);\n\t\t\tto = new Error();\n\t\t} else {\n\t\t\tto = {};\n\t\t}\n\t}\n\n\tseen.push(from);\n\n\tif (depth >= maxDepth) {\n\t\treturn to;\n\t}\n\n\tif (useToJSON && typeof from.toJSON === 'function' && !toJsonWasCalled.has(from)) {\n\t\treturn toJSON(from);\n\t}\n\n\tconst continueDestroyCircular = value => destroyCircular({\n\t\tfrom: value,\n\t\tseen: [...seen],\n\t\tforceEnumerable,\n\t\tmaxDepth,\n\t\tdepth,\n\t\tuseToJSON,\n\t\tserialize,\n\t});\n\n\tfor (const [key, value] of Object.entries(from)) {\n\t\tif (value && value instanceof Uint8Array && value.constructor.name === 'Buffer') {\n\t\t\tto[key] = '[object Buffer]';\n\t\t\tcontinue;\n\t\t}\n\n\t\t// TODO: Use `stream.isReadable()` when targeting Node.js 18.\n\t\tif (value !== null && typeof value === 'object' && typeof value.pipe === 'function') {\n\t\t\tto[key] = '[object Stream]';\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (typeof value === 'function') {\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!value || typeof value !== 'object') {\n\t\t\t// Gracefully handle non-configurable errors like `DOMException`.\n\t\t\ttry {\n\t\t\t\tto[key] = value;\n\t\t\t} catch {}\n\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!seen.includes(from[key])) {\n\t\t\tdepth++;\n\t\t\tto[key] = continueDestroyCircular(from[key]);\n\n\t\t\tcontinue;\n\t\t}\n\n\t\tto[key] = '[Circular]';\n\t}\n\n\tfor (const {property, enumerable} of commonProperties) {\n\t\tif (typeof from[property] !== 'undefined' && from[property] !== null) {\n\t\t\tObject.defineProperty(to, property, {\n\t\t\t\tvalue: isErrorLike(from[property]) ? continueDestroyCircular(from[property]) : from[property],\n\t\t\t\tenumerable: forceEnumerable ? true : enumerable,\n\t\t\t\tconfigurable: true,\n\t\t\t\twritable: true,\n\t\t\t});\n\t\t}\n\t}\n\n\treturn to;\n};\n\nexport function serializeError(value, options = {}) {\n\tconst {\n\t\tmaxDepth = Number.POSITIVE_INFINITY,\n\t\tuseToJSON = true,\n\t} = options;\n\n\tif (typeof value === 'object' && value !== null) {\n\t\treturn destroyCircular({\n\t\t\tfrom: value,\n\t\t\tseen: [],\n\t\t\tforceEnumerable: true,\n\t\t\tmaxDepth,\n\t\t\tdepth: 0,\n\t\t\tuseToJSON,\n\t\t\tserialize: true,\n\t\t});\n\t}\n\n\t// People sometimes throw things besides Error objects\n\tif (typeof value === 'function') {\n\t\t// `JSON.stringify()` discards functions. We do too, unless a function is thrown directly.\n\t\t// We intentionally use `||` because `.name` is an empty string for anonymous functions.\n\t\treturn `[Function: ${value.name || 'anonymous'}]`;\n\t}\n\n\treturn value;\n}\n\nexport function deserializeError(value, options = {}) {\n\tconst {maxDepth = Number.POSITIVE_INFINITY} = options;\n\n\tif (value instanceof Error) {\n\t\treturn value;\n\t}\n\n\tif (isMinimumViableSerializedError(value)) {\n\t\tconst Error = getErrorConstructor(value.name);\n\t\treturn destroyCircular({\n\t\t\tfrom: value,\n\t\t\tseen: [],\n\t\t\tto: new Error(),\n\t\t\tmaxDepth,\n\t\t\tdepth: 0,\n\t\t\tserialize: false,\n\t\t});\n\t}\n\n\treturn new NonError(value);\n}\n\nexport function isErrorLike(value) {\n\treturn Boolean(value)\n\t&& typeof value === 'object'\n\t&& 'name' in value\n\t&& 'message' in value\n\t&& 'stack' in value;\n}\n\nfunction isMinimumViableSerializedError(value) {\n\treturn Boolean(value)\n\t&& typeof value === 'object'\n\t&& 'message' in value\n\t&& !Array.isArray(value);\n}\n\nexport {default as errorConstructors} from './error-constructors.js';\n","var __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nvar __objRest = (source, exclude) => {\n  var target = {};\n  for (var prop in source)\n    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)\n      target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(source)) {\n      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))\n        target[prop] = source[prop];\n    }\n  return target;\n};\nvar __async = (__this, __arguments, generator) => {\n  return new Promise((resolve, reject) => {\n    var fulfilled = (value) => {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    };\n    var rejected = (value) => {\n      try {\n        step(generator.throw(value));\n      } catch (e) {\n        reject(e);\n      }\n    };\n    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);\n    step((generator = generator.apply(__this, __arguments)).next());\n  });\n};\n\n// src/generic.ts\nimport { serializeError, deserializeError } from \"serialize-error\";\nfunction defineGenericMessanging(config) {\n  let removeRootListener;\n  let perTypeListeners = {};\n  function cleanupRootListener() {\n    if (Object.entries(perTypeListeners).length === 0) {\n      removeRootListener == null ? void 0 : removeRootListener();\n      removeRootListener = void 0;\n    }\n  }\n  let idSeq = Math.floor(Math.random() * 1e4);\n  function getNextId() {\n    return idSeq++;\n  }\n  return {\n    sendMessage(type, data, ...args) {\n      return __async(this, null, function* () {\n        var _a2, _b, _c, _d;\n        const _message = {\n          id: getNextId(),\n          type,\n          data,\n          timestamp: Date.now()\n        };\n        const message = (_b = yield (_a2 = config.verifyMessageData) == null ? void 0 : _a2.call(config, _message)) != null ? _b : _message;\n        (_c = config.logger) == null ? void 0 : _c.debug(`[messaging] sendMessage {id=${message.id}} \\u2500\\u1405`, message, ...args);\n        const response = yield config.sendMessage(message, ...args);\n        const { res, err } = response != null ? response : { err: new Error(\"No response\") };\n        (_d = config.logger) == null ? void 0 : _d.debug(`[messaging] sendMessage {id=${message.id}} \\u140A\\u2500`, { res, err });\n        if (err != null)\n          throw deserializeError(err);\n        return res;\n      });\n    },\n    onMessage(type, onReceived) {\n      var _a2, _b, _c;\n      if (removeRootListener == null) {\n        (_a2 = config.logger) == null ? void 0 : _a2.debug(\n          `[messaging] \"${type}\" initialized the message listener for this context`\n        );\n        removeRootListener = config.addRootListener((message) => {\n          var _a3, _b2;\n          if (typeof message.type != \"string\" || typeof message.timestamp !== \"number\") {\n            if (config.breakError) {\n              return;\n            }\n            const err = Error(\n              `[messaging] Unknown message format, must include the 'type' & 'timestamp' fields, received: ${JSON.stringify(\n                message\n              )}`\n            );\n            (_a3 = config.logger) == null ? void 0 : _a3.error(err);\n            throw err;\n          }\n          (_b2 = config == null ? void 0 : config.logger) == null ? void 0 : _b2.debug(\"[messaging] Received message\", message);\n          const listener = perTypeListeners[message.type];\n          if (listener == null)\n            return;\n          const res = listener(message);\n          return Promise.resolve(res).then((res2) => {\n            var _a4, _b3;\n            return (_b3 = (_a4 = config.verifyMessageData) == null ? void 0 : _a4.call(config, res2)) != null ? _b3 : res2;\n          }).then((res2) => {\n            var _a4;\n            (_a4 = config == null ? void 0 : config.logger) == null ? void 0 : _a4.debug(`[messaging] onMessage {id=${message.id}} \\u2500\\u1405`, { res: res2 });\n            return { res: res2 };\n          }).catch((err) => {\n            var _a4;\n            (_a4 = config == null ? void 0 : config.logger) == null ? void 0 : _a4.debug(`[messaging] onMessage {id=${message.id}} \\u2500\\u1405`, { err });\n            return { err: serializeError(err) };\n          });\n        });\n      }\n      if (perTypeListeners[type] != null) {\n        const err = Error(\n          `[messaging] In this JS context, only one listener can be setup for ${type}`\n        );\n        (_b = config.logger) == null ? void 0 : _b.error(err);\n        throw err;\n      }\n      perTypeListeners[type] = onReceived;\n      (_c = config.logger) == null ? void 0 : _c.log(`[messaging] Added listener for ${type}`);\n      return () => {\n        delete perTypeListeners[type];\n        cleanupRootListener();\n      };\n    },\n    removeAllListeners() {\n      Object.keys(perTypeListeners).forEach((type) => {\n        delete perTypeListeners[type];\n      });\n      cleanupRootListener();\n    }\n  };\n}\n\nexport {\n  __spreadValues,\n  __spreadProps,\n  __objRest,\n  __async,\n  defineGenericMessanging\n};\n","(function (global, factory) {\n  if (typeof define === \"function\" && define.amd) {\n    define(\"webextension-polyfill\", [\"module\"], factory);\n  } else if (typeof exports !== \"undefined\") {\n    factory(module);\n  } else {\n    var mod = {\n      exports: {}\n    };\n    factory(mod);\n    global.browser = mod.exports;\n  }\n})(typeof globalThis !== \"undefined\" ? globalThis : typeof self !== \"undefined\" ? self : this, function (module) {\n  /* webextension-polyfill - v0.10.0 - Fri Aug 12 2022 19:42:44 */\n\n  /* -*- Mode: indent-tabs-mode: nil; js-indent-level: 2 -*- */\n\n  /* vim: set sts=2 sw=2 et tw=80: */\n\n  /* This Source Code Form is subject to the terms of the Mozilla Public\n   * License, v. 2.0. If a copy of the MPL was not distributed with this\n   * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n  \"use strict\";\n\n  if (!globalThis.chrome?.runtime?.id) {\n    throw new Error(\"This script should only be loaded in a browser extension.\");\n  }\n\n  if (typeof globalThis.browser === \"undefined\" || Object.getPrototypeOf(globalThis.browser) !== Object.prototype) {\n    const CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE = \"The message port closed before a response was received.\"; // Wrapping the bulk of this polyfill in a one-time-use function is a minor\n    // optimization for Firefox. Since Spidermonkey does not fully parse the\n    // contents of a function until the first time it's called, and since it will\n    // never actually need to be called, this allows the polyfill to be included\n    // in Firefox nearly for free.\n\n    const wrapAPIs = extensionAPIs => {\n      // NOTE: apiMetadata is associated to the content of the api-metadata.json file\n      // at build time by replacing the following \"include\" with the content of the\n      // JSON file.\n      const apiMetadata = {\n        \"alarms\": {\n          \"clear\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"clearAll\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"get\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getAll\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          }\n        },\n        \"bookmarks\": {\n          \"create\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"get\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getChildren\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getRecent\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getSubTree\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getTree\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"move\": {\n            \"minArgs\": 2,\n            \"maxArgs\": 2\n          },\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removeTree\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"search\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"update\": {\n            \"minArgs\": 2,\n            \"maxArgs\": 2\n          }\n        },\n        \"browserAction\": {\n          \"disable\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          },\n          \"enable\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          },\n          \"getBadgeBackgroundColor\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getBadgeText\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getPopup\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getTitle\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"openPopup\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"setBadgeBackgroundColor\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          },\n          \"setBadgeText\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          },\n          \"setIcon\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"setPopup\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          },\n          \"setTitle\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          }\n        },\n        \"browsingData\": {\n          \"remove\": {\n            \"minArgs\": 2,\n            \"maxArgs\": 2\n          },\n          \"removeCache\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removeCookies\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removeDownloads\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removeFormData\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removeHistory\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removeLocalStorage\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removePasswords\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removePluginData\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"settings\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          }\n        },\n        \"commands\": {\n          \"getAll\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          }\n        },\n        \"contextMenus\": {\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removeAll\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"update\": {\n            \"minArgs\": 2,\n            \"maxArgs\": 2\n          }\n        },\n        \"cookies\": {\n          \"get\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getAll\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getAllCookieStores\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"set\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        },\n        \"devtools\": {\n          \"inspectedWindow\": {\n            \"eval\": {\n              \"minArgs\": 1,\n              \"maxArgs\": 2,\n              \"singleCallbackArg\": false\n            }\n          },\n          \"panels\": {\n            \"create\": {\n              \"minArgs\": 3,\n              \"maxArgs\": 3,\n              \"singleCallbackArg\": true\n            },\n            \"elements\": {\n              \"createSidebarPane\": {\n                \"minArgs\": 1,\n                \"maxArgs\": 1\n              }\n            }\n          }\n        },\n        \"downloads\": {\n          \"cancel\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"download\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"erase\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getFileIcon\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2\n          },\n          \"open\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          },\n          \"pause\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removeFile\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"resume\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"search\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"show\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          }\n        },\n        \"extension\": {\n          \"isAllowedFileSchemeAccess\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"isAllowedIncognitoAccess\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          }\n        },\n        \"history\": {\n          \"addUrl\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"deleteAll\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"deleteRange\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"deleteUrl\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getVisits\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"search\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        },\n        \"i18n\": {\n          \"detectLanguage\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getAcceptLanguages\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          }\n        },\n        \"identity\": {\n          \"launchWebAuthFlow\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        },\n        \"idle\": {\n          \"queryState\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        },\n        \"management\": {\n          \"get\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getAll\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"getSelf\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"setEnabled\": {\n            \"minArgs\": 2,\n            \"maxArgs\": 2\n          },\n          \"uninstallSelf\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          }\n        },\n        \"notifications\": {\n          \"clear\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"create\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2\n          },\n          \"getAll\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"getPermissionLevel\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"update\": {\n            \"minArgs\": 2,\n            \"maxArgs\": 2\n          }\n        },\n        \"pageAction\": {\n          \"getPopup\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getTitle\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"hide\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          },\n          \"setIcon\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"setPopup\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          },\n          \"setTitle\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          },\n          \"show\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          }\n        },\n        \"permissions\": {\n          \"contains\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getAll\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"request\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        },\n        \"runtime\": {\n          \"getBackgroundPage\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"getPlatformInfo\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"openOptionsPage\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"requestUpdateCheck\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"sendMessage\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 3\n          },\n          \"sendNativeMessage\": {\n            \"minArgs\": 2,\n            \"maxArgs\": 2\n          },\n          \"setUninstallURL\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        },\n        \"sessions\": {\n          \"getDevices\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getRecentlyClosed\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"restore\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          }\n        },\n        \"storage\": {\n          \"local\": {\n            \"clear\": {\n              \"minArgs\": 0,\n              \"maxArgs\": 0\n            },\n            \"get\": {\n              \"minArgs\": 0,\n              \"maxArgs\": 1\n            },\n            \"getBytesInUse\": {\n              \"minArgs\": 0,\n              \"maxArgs\": 1\n            },\n            \"remove\": {\n              \"minArgs\": 1,\n              \"maxArgs\": 1\n            },\n            \"set\": {\n              \"minArgs\": 1,\n              \"maxArgs\": 1\n            }\n          },\n          \"managed\": {\n            \"get\": {\n              \"minArgs\": 0,\n              \"maxArgs\": 1\n            },\n            \"getBytesInUse\": {\n              \"minArgs\": 0,\n              \"maxArgs\": 1\n            }\n          },\n          \"sync\": {\n            \"clear\": {\n              \"minArgs\": 0,\n              \"maxArgs\": 0\n            },\n            \"get\": {\n              \"minArgs\": 0,\n              \"maxArgs\": 1\n            },\n            \"getBytesInUse\": {\n              \"minArgs\": 0,\n              \"maxArgs\": 1\n            },\n            \"remove\": {\n              \"minArgs\": 1,\n              \"maxArgs\": 1\n            },\n            \"set\": {\n              \"minArgs\": 1,\n              \"maxArgs\": 1\n            }\n          }\n        },\n        \"tabs\": {\n          \"captureVisibleTab\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 2\n          },\n          \"create\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"detectLanguage\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"discard\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"duplicate\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"executeScript\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2\n          },\n          \"get\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getCurrent\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"getZoom\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getZoomSettings\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"goBack\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"goForward\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"highlight\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"insertCSS\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2\n          },\n          \"move\": {\n            \"minArgs\": 2,\n            \"maxArgs\": 2\n          },\n          \"query\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"reload\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 2\n          },\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removeCSS\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2\n          },\n          \"sendMessage\": {\n            \"minArgs\": 2,\n            \"maxArgs\": 3\n          },\n          \"setZoom\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2\n          },\n          \"setZoomSettings\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2\n          },\n          \"update\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2\n          }\n        },\n        \"topSites\": {\n          \"get\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          }\n        },\n        \"webNavigation\": {\n          \"getAllFrames\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getFrame\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        },\n        \"webRequest\": {\n          \"handlerBehaviorChanged\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          }\n        },\n        \"windows\": {\n          \"create\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"get\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2\n          },\n          \"getAll\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getCurrent\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getLastFocused\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"update\": {\n            \"minArgs\": 2,\n            \"maxArgs\": 2\n          }\n        }\n      };\n\n      if (Object.keys(apiMetadata).length === 0) {\n        throw new Error(\"api-metadata.json has not been included in browser-polyfill\");\n      }\n      /**\n       * A WeakMap subclass which creates and stores a value for any key which does\n       * not exist when accessed, but behaves exactly as an ordinary WeakMap\n       * otherwise.\n       *\n       * @param {function} createItem\n       *        A function which will be called in order to create the value for any\n       *        key which does not exist, the first time it is accessed. The\n       *        function receives, as its only argument, the key being created.\n       */\n\n\n      class DefaultWeakMap extends WeakMap {\n        constructor(createItem, items = undefined) {\n          super(items);\n          this.createItem = createItem;\n        }\n\n        get(key) {\n          if (!this.has(key)) {\n            this.set(key, this.createItem(key));\n          }\n\n          return super.get(key);\n        }\n\n      }\n      /**\n       * Returns true if the given object is an object with a `then` method, and can\n       * therefore be assumed to behave as a Promise.\n       *\n       * @param {*} value The value to test.\n       * @returns {boolean} True if the value is thenable.\n       */\n\n\n      const isThenable = value => {\n        return value && typeof value === \"object\" && typeof value.then === \"function\";\n      };\n      /**\n       * Creates and returns a function which, when called, will resolve or reject\n       * the given promise based on how it is called:\n       *\n       * - If, when called, `chrome.runtime.lastError` contains a non-null object,\n       *   the promise is rejected with that value.\n       * - If the function is called with exactly one argument, the promise is\n       *   resolved to that value.\n       * - Otherwise, the promise is resolved to an array containing all of the\n       *   function's arguments.\n       *\n       * @param {object} promise\n       *        An object containing the resolution and rejection functions of a\n       *        promise.\n       * @param {function} promise.resolve\n       *        The promise's resolution function.\n       * @param {function} promise.reject\n       *        The promise's rejection function.\n       * @param {object} metadata\n       *        Metadata about the wrapped method which has created the callback.\n       * @param {boolean} metadata.singleCallbackArg\n       *        Whether or not the promise is resolved with only the first\n       *        argument of the callback, alternatively an array of all the\n       *        callback arguments is resolved. By default, if the callback\n       *        function is invoked with only a single argument, that will be\n       *        resolved to the promise, while all arguments will be resolved as\n       *        an array if multiple are given.\n       *\n       * @returns {function}\n       *        The generated callback function.\n       */\n\n\n      const makeCallback = (promise, metadata) => {\n        return (...callbackArgs) => {\n          if (extensionAPIs.runtime.lastError) {\n            promise.reject(new Error(extensionAPIs.runtime.lastError.message));\n          } else if (metadata.singleCallbackArg || callbackArgs.length <= 1 && metadata.singleCallbackArg !== false) {\n            promise.resolve(callbackArgs[0]);\n          } else {\n            promise.resolve(callbackArgs);\n          }\n        };\n      };\n\n      const pluralizeArguments = numArgs => numArgs == 1 ? \"argument\" : \"arguments\";\n      /**\n       * Creates a wrapper function for a method with the given name and metadata.\n       *\n       * @param {string} name\n       *        The name of the method which is being wrapped.\n       * @param {object} metadata\n       *        Metadata about the method being wrapped.\n       * @param {integer} metadata.minArgs\n       *        The minimum number of arguments which must be passed to the\n       *        function. If called with fewer than this number of arguments, the\n       *        wrapper will raise an exception.\n       * @param {integer} metadata.maxArgs\n       *        The maximum number of arguments which may be passed to the\n       *        function. If called with more than this number of arguments, the\n       *        wrapper will raise an exception.\n       * @param {boolean} metadata.singleCallbackArg\n       *        Whether or not the promise is resolved with only the first\n       *        argument of the callback, alternatively an array of all the\n       *        callback arguments is resolved. By default, if the callback\n       *        function is invoked with only a single argument, that will be\n       *        resolved to the promise, while all arguments will be resolved as\n       *        an array if multiple are given.\n       *\n       * @returns {function(object, ...*)}\n       *       The generated wrapper function.\n       */\n\n\n      const wrapAsyncFunction = (name, metadata) => {\n        return function asyncFunctionWrapper(target, ...args) {\n          if (args.length < metadata.minArgs) {\n            throw new Error(`Expected at least ${metadata.minArgs} ${pluralizeArguments(metadata.minArgs)} for ${name}(), got ${args.length}`);\n          }\n\n          if (args.length > metadata.maxArgs) {\n            throw new Error(`Expected at most ${metadata.maxArgs} ${pluralizeArguments(metadata.maxArgs)} for ${name}(), got ${args.length}`);\n          }\n\n          return new Promise((resolve, reject) => {\n            if (metadata.fallbackToNoCallback) {\n              // This API method has currently no callback on Chrome, but it return a promise on Firefox,\n              // and so the polyfill will try to call it with a callback first, and it will fallback\n              // to not passing the callback if the first call fails.\n              try {\n                target[name](...args, makeCallback({\n                  resolve,\n                  reject\n                }, metadata));\n              } catch (cbError) {\n                console.warn(`${name} API method doesn't seem to support the callback parameter, ` + \"falling back to call it without a callback: \", cbError);\n                target[name](...args); // Update the API method metadata, so that the next API calls will not try to\n                // use the unsupported callback anymore.\n\n                metadata.fallbackToNoCallback = false;\n                metadata.noCallback = true;\n                resolve();\n              }\n            } else if (metadata.noCallback) {\n              target[name](...args);\n              resolve();\n            } else {\n              target[name](...args, makeCallback({\n                resolve,\n                reject\n              }, metadata));\n            }\n          });\n        };\n      };\n      /**\n       * Wraps an existing method of the target object, so that calls to it are\n       * intercepted by the given wrapper function. The wrapper function receives,\n       * as its first argument, the original `target` object, followed by each of\n       * the arguments passed to the original method.\n       *\n       * @param {object} target\n       *        The original target object that the wrapped method belongs to.\n       * @param {function} method\n       *        The method being wrapped. This is used as the target of the Proxy\n       *        object which is created to wrap the method.\n       * @param {function} wrapper\n       *        The wrapper function which is called in place of a direct invocation\n       *        of the wrapped method.\n       *\n       * @returns {Proxy<function>}\n       *        A Proxy object for the given method, which invokes the given wrapper\n       *        method in its place.\n       */\n\n\n      const wrapMethod = (target, method, wrapper) => {\n        return new Proxy(method, {\n          apply(targetMethod, thisObj, args) {\n            return wrapper.call(thisObj, target, ...args);\n          }\n\n        });\n      };\n\n      let hasOwnProperty = Function.call.bind(Object.prototype.hasOwnProperty);\n      /**\n       * Wraps an object in a Proxy which intercepts and wraps certain methods\n       * based on the given `wrappers` and `metadata` objects.\n       *\n       * @param {object} target\n       *        The target object to wrap.\n       *\n       * @param {object} [wrappers = {}]\n       *        An object tree containing wrapper functions for special cases. Any\n       *        function present in this object tree is called in place of the\n       *        method in the same location in the `target` object tree. These\n       *        wrapper methods are invoked as described in {@see wrapMethod}.\n       *\n       * @param {object} [metadata = {}]\n       *        An object tree containing metadata used to automatically generate\n       *        Promise-based wrapper functions for asynchronous. Any function in\n       *        the `target` object tree which has a corresponding metadata object\n       *        in the same location in the `metadata` tree is replaced with an\n       *        automatically-generated wrapper function, as described in\n       *        {@see wrapAsyncFunction}\n       *\n       * @returns {Proxy<object>}\n       */\n\n      const wrapObject = (target, wrappers = {}, metadata = {}) => {\n        let cache = Object.create(null);\n        let handlers = {\n          has(proxyTarget, prop) {\n            return prop in target || prop in cache;\n          },\n\n          get(proxyTarget, prop, receiver) {\n            if (prop in cache) {\n              return cache[prop];\n            }\n\n            if (!(prop in target)) {\n              return undefined;\n            }\n\n            let value = target[prop];\n\n            if (typeof value === \"function\") {\n              // This is a method on the underlying object. Check if we need to do\n              // any wrapping.\n              if (typeof wrappers[prop] === \"function\") {\n                // We have a special-case wrapper for this method.\n                value = wrapMethod(target, target[prop], wrappers[prop]);\n              } else if (hasOwnProperty(metadata, prop)) {\n                // This is an async method that we have metadata for. Create a\n                // Promise wrapper for it.\n                let wrapper = wrapAsyncFunction(prop, metadata[prop]);\n                value = wrapMethod(target, target[prop], wrapper);\n              } else {\n                // This is a method that we don't know or care about. Return the\n                // original method, bound to the underlying object.\n                value = value.bind(target);\n              }\n            } else if (typeof value === \"object\" && value !== null && (hasOwnProperty(wrappers, prop) || hasOwnProperty(metadata, prop))) {\n              // This is an object that we need to do some wrapping for the children\n              // of. Create a sub-object wrapper for it with the appropriate child\n              // metadata.\n              value = wrapObject(value, wrappers[prop], metadata[prop]);\n            } else if (hasOwnProperty(metadata, \"*\")) {\n              // Wrap all properties in * namespace.\n              value = wrapObject(value, wrappers[prop], metadata[\"*\"]);\n            } else {\n              // We don't need to do any wrapping for this property,\n              // so just forward all access to the underlying object.\n              Object.defineProperty(cache, prop, {\n                configurable: true,\n                enumerable: true,\n\n                get() {\n                  return target[prop];\n                },\n\n                set(value) {\n                  target[prop] = value;\n                }\n\n              });\n              return value;\n            }\n\n            cache[prop] = value;\n            return value;\n          },\n\n          set(proxyTarget, prop, value, receiver) {\n            if (prop in cache) {\n              cache[prop] = value;\n            } else {\n              target[prop] = value;\n            }\n\n            return true;\n          },\n\n          defineProperty(proxyTarget, prop, desc) {\n            return Reflect.defineProperty(cache, prop, desc);\n          },\n\n          deleteProperty(proxyTarget, prop) {\n            return Reflect.deleteProperty(cache, prop);\n          }\n\n        }; // Per contract of the Proxy API, the \"get\" proxy handler must return the\n        // original value of the target if that value is declared read-only and\n        // non-configurable. For this reason, we create an object with the\n        // prototype set to `target` instead of using `target` directly.\n        // Otherwise we cannot return a custom object for APIs that\n        // are declared read-only and non-configurable, such as `chrome.devtools`.\n        //\n        // The proxy handlers themselves will still use the original `target`\n        // instead of the `proxyTarget`, so that the methods and properties are\n        // dereferenced via the original targets.\n\n        let proxyTarget = Object.create(target);\n        return new Proxy(proxyTarget, handlers);\n      };\n      /**\n       * Creates a set of wrapper functions for an event object, which handles\n       * wrapping of listener functions that those messages are passed.\n       *\n       * A single wrapper is created for each listener function, and stored in a\n       * map. Subsequent calls to `addListener`, `hasListener`, or `removeListener`\n       * retrieve the original wrapper, so that  attempts to remove a\n       * previously-added listener work as expected.\n       *\n       * @param {DefaultWeakMap<function, function>} wrapperMap\n       *        A DefaultWeakMap object which will create the appropriate wrapper\n       *        for a given listener function when one does not exist, and retrieve\n       *        an existing one when it does.\n       *\n       * @returns {object}\n       */\n\n\n      const wrapEvent = wrapperMap => ({\n        addListener(target, listener, ...args) {\n          target.addListener(wrapperMap.get(listener), ...args);\n        },\n\n        hasListener(target, listener) {\n          return target.hasListener(wrapperMap.get(listener));\n        },\n\n        removeListener(target, listener) {\n          target.removeListener(wrapperMap.get(listener));\n        }\n\n      });\n\n      const onRequestFinishedWrappers = new DefaultWeakMap(listener => {\n        if (typeof listener !== \"function\") {\n          return listener;\n        }\n        /**\n         * Wraps an onRequestFinished listener function so that it will return a\n         * `getContent()` property which returns a `Promise` rather than using a\n         * callback API.\n         *\n         * @param {object} req\n         *        The HAR entry object representing the network request.\n         */\n\n\n        return function onRequestFinished(req) {\n          const wrappedReq = wrapObject(req, {}\n          /* wrappers */\n          , {\n            getContent: {\n              minArgs: 0,\n              maxArgs: 0\n            }\n          });\n          listener(wrappedReq);\n        };\n      });\n      const onMessageWrappers = new DefaultWeakMap(listener => {\n        if (typeof listener !== \"function\") {\n          return listener;\n        }\n        /**\n         * Wraps a message listener function so that it may send responses based on\n         * its return value, rather than by returning a sentinel value and calling a\n         * callback. If the listener function returns a Promise, the response is\n         * sent when the promise either resolves or rejects.\n         *\n         * @param {*} message\n         *        The message sent by the other end of the channel.\n         * @param {object} sender\n         *        Details about the sender of the message.\n         * @param {function(*)} sendResponse\n         *        A callback which, when called with an arbitrary argument, sends\n         *        that value as a response.\n         * @returns {boolean}\n         *        True if the wrapped listener returned a Promise, which will later\n         *        yield a response. False otherwise.\n         */\n\n\n        return function onMessage(message, sender, sendResponse) {\n          let didCallSendResponse = false;\n          let wrappedSendResponse;\n          let sendResponsePromise = new Promise(resolve => {\n            wrappedSendResponse = function (response) {\n              didCallSendResponse = true;\n              resolve(response);\n            };\n          });\n          let result;\n\n          try {\n            result = listener(message, sender, wrappedSendResponse);\n          } catch (err) {\n            result = Promise.reject(err);\n          }\n\n          const isResultThenable = result !== true && isThenable(result); // If the listener didn't returned true or a Promise, or called\n          // wrappedSendResponse synchronously, we can exit earlier\n          // because there will be no response sent from this listener.\n\n          if (result !== true && !isResultThenable && !didCallSendResponse) {\n            return false;\n          } // A small helper to send the message if the promise resolves\n          // and an error if the promise rejects (a wrapped sendMessage has\n          // to translate the message into a resolved promise or a rejected\n          // promise).\n\n\n          const sendPromisedResult = promise => {\n            promise.then(msg => {\n              // send the message value.\n              sendResponse(msg);\n            }, error => {\n              // Send a JSON representation of the error if the rejected value\n              // is an instance of error, or the object itself otherwise.\n              let message;\n\n              if (error && (error instanceof Error || typeof error.message === \"string\")) {\n                message = error.message;\n              } else {\n                message = \"An unexpected error occurred\";\n              }\n\n              sendResponse({\n                __mozWebExtensionPolyfillReject__: true,\n                message\n              });\n            }).catch(err => {\n              // Print an error on the console if unable to send the response.\n              console.error(\"Failed to send onMessage rejected reply\", err);\n            });\n          }; // If the listener returned a Promise, send the resolved value as a\n          // result, otherwise wait the promise related to the wrappedSendResponse\n          // callback to resolve and send it as a response.\n\n\n          if (isResultThenable) {\n            sendPromisedResult(result);\n          } else {\n            sendPromisedResult(sendResponsePromise);\n          } // Let Chrome know that the listener is replying.\n\n\n          return true;\n        };\n      });\n\n      const wrappedSendMessageCallback = ({\n        reject,\n        resolve\n      }, reply) => {\n        if (extensionAPIs.runtime.lastError) {\n          // Detect when none of the listeners replied to the sendMessage call and resolve\n          // the promise to undefined as in Firefox.\n          // See https://github.com/mozilla/webextension-polyfill/issues/130\n          if (extensionAPIs.runtime.lastError.message === CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE) {\n            resolve();\n          } else {\n            reject(new Error(extensionAPIs.runtime.lastError.message));\n          }\n        } else if (reply && reply.__mozWebExtensionPolyfillReject__) {\n          // Convert back the JSON representation of the error into\n          // an Error instance.\n          reject(new Error(reply.message));\n        } else {\n          resolve(reply);\n        }\n      };\n\n      const wrappedSendMessage = (name, metadata, apiNamespaceObj, ...args) => {\n        if (args.length < metadata.minArgs) {\n          throw new Error(`Expected at least ${metadata.minArgs} ${pluralizeArguments(metadata.minArgs)} for ${name}(), got ${args.length}`);\n        }\n\n        if (args.length > metadata.maxArgs) {\n          throw new Error(`Expected at most ${metadata.maxArgs} ${pluralizeArguments(metadata.maxArgs)} for ${name}(), got ${args.length}`);\n        }\n\n        return new Promise((resolve, reject) => {\n          const wrappedCb = wrappedSendMessageCallback.bind(null, {\n            resolve,\n            reject\n          });\n          args.push(wrappedCb);\n          apiNamespaceObj.sendMessage(...args);\n        });\n      };\n\n      const staticWrappers = {\n        devtools: {\n          network: {\n            onRequestFinished: wrapEvent(onRequestFinishedWrappers)\n          }\n        },\n        runtime: {\n          onMessage: wrapEvent(onMessageWrappers),\n          onMessageExternal: wrapEvent(onMessageWrappers),\n          sendMessage: wrappedSendMessage.bind(null, \"sendMessage\", {\n            minArgs: 1,\n            maxArgs: 3\n          })\n        },\n        tabs: {\n          sendMessage: wrappedSendMessage.bind(null, \"sendMessage\", {\n            minArgs: 2,\n            maxArgs: 3\n          })\n        }\n      };\n      const settingMetadata = {\n        clear: {\n          minArgs: 1,\n          maxArgs: 1\n        },\n        get: {\n          minArgs: 1,\n          maxArgs: 1\n        },\n        set: {\n          minArgs: 1,\n          maxArgs: 1\n        }\n      };\n      apiMetadata.privacy = {\n        network: {\n          \"*\": settingMetadata\n        },\n        services: {\n          \"*\": settingMetadata\n        },\n        websites: {\n          \"*\": settingMetadata\n        }\n      };\n      return wrapObject(extensionAPIs, staticWrappers, apiMetadata);\n    }; // The build process adds a UMD wrapper around this file, which makes the\n    // `module` variable available.\n\n\n    module.exports = wrapAPIs(chrome);\n  } else {\n    module.exports = globalThis.browser;\n  }\n});\n//# sourceMappingURL=browser-polyfill.js.map\n","import {\n  __spreadProps,\n  __spreadValues,\n  defineGenericMessanging\n} from \"./chunk-BQLFSFFZ.js\";\n\n// src/extension.ts\nimport Browser from \"webextension-polyfill\";\nfunction defineExtensionMessaging(config) {\n  return defineGenericMessanging(__spreadProps(__spreadValues({}, config), {\n    sendMessage(message, arg) {\n      if (arg == null) {\n        return Browser.runtime.sendMessage(message);\n      }\n      const options = typeof arg === \"number\" ? { tabId: arg } : arg;\n      return Browser.tabs.sendMessage(\n        options.tabId,\n        message,\n        // Pass frameId if specified\n        options.frameId != null ? { frameId: options.frameId } : void 0\n      );\n    },\n    addRootListener(processMessage) {\n      const listener = (message, sender) => {\n        if (typeof message === \"object\")\n          return processMessage(__spreadProps(__spreadValues({}, message), { sender }));\n        else\n          return processMessage(message);\n      };\n      Browser.runtime.onMessage.addListener(listener);\n      return () => Browser.runtime.onMessage.removeListener(listener);\n    }\n  }));\n}\nexport {\n  defineExtensionMessaging\n};\n","import { defineExtensionMessaging } from '@webext-core/messaging'\nimport type { McpTool } from '@/lib/mcp/client'\n\ntype ServerMessagesProtocol = {\n  checkHealth(): { healthy: boolean }\n  fetchMcpTools(): { tools: McpTool[]; error?: string }\n}\n\n/**\n * @public\n */\nconst { sendMessage, onMessage } =\n  defineExtensionMessaging<ServerMessagesProtocol>()\n\nexport { sendMessage as sendServerMessage, onMessage as onServerMessage }\n","import { defineExtensionMessaging } from '@webext-core/messaging'\nimport type { SearchActionStorage } from '@/lib/search-actions/searchActionsStorage'\n\ntype OpenSidePanelWithSearchParams = {\n  open(props: SearchActionStorage): void\n}\n\n/**\n * @public\n */\nconst { sendMessage, onMessage } =\n  defineExtensionMessaging<OpenSidePanelWithSearchParams>()\n\nexport {\n  sendMessage as openSidePanelWithSearch,\n  onMessage as onOpenSidePanelWithSearch,\n}\n","import { storage } from '@wxt-dev/storage'\nimport type { ChatAction } from '@/lib/chat-actions/types'\n\n/**\n * @public\n */\nexport interface SearchActionStorage {\n  query: string\n  mode: 'chat' | 'agent'\n  action?: ChatAction\n}\n\n/**\n * @public\n */\nexport const searchActionsStorage = storage.defineItem<SearchActionStorage>(\n  'local:search-actions',\n)\n","import { Capabilities } from '@/lib/browseros/capabilities'\nimport { getHealthCheckUrl, getMcpServerUrl } from '@/lib/browseros/helpers'\nimport { openSidePanel, toggleSidePanel } from '@/lib/browseros/toggleSidePanel'\nimport { setupLlmProvidersBackupToBrowserOS } from '@/lib/llm-providers/storage'\nimport { fetchMcpTools } from '@/lib/mcp/client'\nimport { onServerMessage } from '@/lib/messaging/server/serverMessages'\nimport { onOpenSidePanelWithSearch } from '@/lib/messaging/sidepanel/openSidepanelWithSearch'\nimport { searchActionsStorage } from '@/lib/search-actions/searchActionsStorage'\n\nexport default defineBackground(async () => {\n  chrome.sidePanel.setOptions({ enabled: false })\n\n  await Capabilities.initialize()\n  setupLlmProvidersBackupToBrowserOS()\n\n  chrome.action.onClicked.addListener(async (tab) => {\n    if (tab.id) {\n      await toggleSidePanel(tab.id)\n    }\n  })\n\n  onOpenSidePanelWithSearch('open', async (messageData) => {\n    const currentTabsList = await chrome.tabs.query({\n      active: true,\n      currentWindow: true,\n    })\n    const currentTab = currentTabsList?.[0]?.id\n    if (currentTab) {\n      const { opened } = await openSidePanel(currentTab)\n\n      if (opened) {\n        setTimeout(() => {\n          searchActionsStorage.setValue(messageData.data)\n        }, 500)\n      }\n    }\n  })\n\n  chrome.runtime.onInstalled.addListener((details) => {\n    if (details.reason === chrome.runtime.OnInstalledReason.INSTALL) {\n      chrome.tabs.create({\n        url: chrome.runtime.getURL('onboarding.html'),\n      })\n    }\n  })\n\n  onServerMessage('checkHealth', async () => {\n    try {\n      const url = await getHealthCheckUrl()\n      const response = await fetch(url)\n      return { healthy: response.ok }\n    } catch {\n      return { healthy: false }\n    }\n  })\n\n  onServerMessage('fetchMcpTools', async () => {\n    try {\n      const url = await getMcpServerUrl()\n      const tools = await fetchMcpTools(url)\n      return { tools }\n    } catch (err) {\n      return {\n        tools: [],\n        error: err instanceof Error ? err.message : 'Failed to fetch tools',\n      }\n    }\n  })\n})\n"],"names":["defineBackground","arg","SCREENSHOT_SIZES","BrowserOSAdapter","tabId","options","resolve","reject","callback","snapshot","nodeId","text","scrolled","keys","status","tree","size","showHighlights","width","height","dataUrl","pixelSize","version","eventName","properties","code","result","x","y","name","pref","value","pageId","success","prefs","method","key","getBrowserOSAdapter","FEATURE_CONFIG","parseVersion","parts","compareVersions","a","b","i","osVersion","initialized","Capabilities","versionStr","feature","config","minTuple","maxTuple","NEVER","$constructor","initializer","params","init","inst","def","_","proto","k","Parent","Definition","_a","fn","$ZodAsyncError","$ZodEncodeError","globalConfig","newConfig","getEnumValues","entries","numericValues","v","jsonStringifyReplacer","cached","getter","nullish","input","cleanRegex","source","start","end","floatSafeRemainder","val","step","valDecCount","stepString","stepDecCount","match","decCount","valInt","stepInt","EVALUATING","defineLazy","object","assignProp","target","prop","mergeDefs","defs","mergedDescriptors","descriptors","esc","str","slugify","captureStackTrace","_args","isObject","data","allowsEval","F","isPlainObject","o","ctor","prot","shallowClone","propertyKeyTypes","escapeRegex","clone","cl","normalizeParams","_params","optionalKeys","shape","NUMBER_FORMAT_RANGES","pick","schema","mask","currDef","newShape","omit","extend","checks","_shape","safeExtend","merge","partial","Class","oldShape","required","aborted","startIndex","prefixIssues","path","issues","iss","unwrapMessage","message","finalizeIssue","ctx","full","getLengthableOrigin","issue","args","util.jsonStringifyReplacer","$ZodError","$ZodRealError","flattenError","error","mapper","fieldErrors","formErrors","sub","formatError","processError","curr","el","_parse","_Err","_ctx","core.$ZodAsyncError","e","util.finalizeIssue","core.config","util.captureStackTrace","_parseAsync","_safeParse","errors.$ZodError","safeParse","errors.$ZodRealError","_safeParseAsync","safeParseAsync","_encode","_decode","_encodeAsync","_decodeAsync","_safeEncode","_safeDecode","_safeEncodeAsync","_safeDecodeAsync","cuid","cuid2","ulid","xid","ksuid","nanoid","duration","guid","uuid","email","_emoji","emoji","ipv4","ipv6","cidrv4","cidrv6","base64","base64url","e164","dateSource","date","timeSource","hhmm","time","datetime","opts","timeRegex","string","regex","integer","number","boolean","_null","lowercase","uppercase","$ZodCheck","core.$constructor","numericOriginMap","$ZodCheckLessThan","origin","bag","payload","$ZodCheckGreaterThan","$ZodCheckMultipleOf","util.floatSafeRemainder","$ZodCheckNumberFormat","isInt","minimum","maximum","util.NUMBER_FORMAT_RANGES","regexes.integer","$ZodCheckMaxLength","util.nullish","util.getLengthableOrigin","$ZodCheckMinLength","$ZodCheckLengthEquals","length","tooBig","$ZodCheckStringFormat","_b","$ZodCheckRegex","$ZodCheckLowerCase","regexes.lowercase","$ZodCheckUpperCase","regexes.uppercase","$ZodCheckIncludes","escapedRegex","util.escapeRegex","pattern","$ZodCheckStartsWith","$ZodCheckEndsWith","$ZodCheckOverwrite","Doc","lines","minIndent","dedented","line","$ZodType","ch","runChecks","isAborted","util.aborted","asyncResult","currLen","handleCanaryResult","canary","checkResult","r","$ZodString","regexes.string","$ZodStringFormat","checks.$ZodCheckStringFormat","$ZodGUID","regexes.guid","$ZodUUID","regexes.uuid","$ZodEmail","regexes.email","$ZodURL","trimmed","url","$ZodEmoji","regexes.emoji","$ZodNanoID","regexes.nanoid","$ZodCUID","regexes.cuid","$ZodCUID2","regexes.cuid2","$ZodULID","regexes.ulid","$ZodXID","regexes.xid","$ZodKSUID","regexes.ksuid","$ZodISODateTime","regexes.datetime","$ZodISODate","regexes.date","$ZodISOTime","regexes.time","$ZodISODuration","regexes.duration","$ZodIPv4","regexes.ipv4","$ZodIPv6","regexes.ipv6","$ZodCIDRv4","regexes.cidrv4","$ZodCIDRv6","regexes.cidrv6","address","prefix","prefixNum","isValidBase64","$ZodBase64","regexes.base64","isValidBase64URL","regexes.base64url","c","padded","$ZodBase64URL","$ZodE164","regexes.e164","isValidJWT","token","algorithm","tokensParts","header","parsedHeader","$ZodJWT","$ZodNumber","regexes.number","received","$ZodNumberFormat","checks.$ZodCheckNumberFormat","$ZodBoolean","regexes.boolean","$ZodNull","regexes.null","$ZodAny","$ZodUnknown","$ZodNever","handleArrayResult","final","index","util.prefixIssues","$ZodArray","proms","item","handlePropertyResult","normalizeDef","okeys","util.optionalKeys","handleCatchall","unrecognized","keySet","_catchall","t","$ZodObject","sh","newSh","_normalized","util.cached","util.defineLazy","propValues","field","util.isObject","catchall","$ZodObjectJIT","superParse","generateFastpass","doc","normalized","parseStr","util.esc","ids","counter","id","fastpass","jit","core.globalConfig","fastEnabled","util.allowsEval","handleUnionResults","results","nonaborted","$ZodUnion","option","patterns","p","util.cleanRegex","single","first","async","$ZodDiscriminatedUnion","_super","pv","disc","map","values","opt","$ZodIntersection","left","right","handleIntersectionResults","mergeValues","util.isPlainObject","bKeys","sharedKeys","newObj","sharedValue","newArray","itemA","itemB","merged","$ZodRecord","recordKeys","keyResult","$ZodEnum","util.getEnumValues","valuesSet","util.propertyKeyTypes","$ZodLiteral","$ZodTransform","core.$ZodEncodeError","_out","output","handleOptionalResult","$ZodOptional","$ZodNullable","$ZodDefault","handleDefaultResult","$ZodPrefault","$ZodNonOptional","handleNonOptionalResult","$ZodCatch","$ZodPipe","handlePipeResult","next","$ZodReadonly","handleReadonlyResult","$ZodCustom","checks.$ZodCheck","handleRefineResult","_iss","util.issue","$ZodRegistry","_meta","meta","pm","f","registry","globalRegistry","_string","util.normalizeParams","_email","_guid","_uuid","_uuidv4","_uuidv6","_uuidv7","_url","_nanoid","_cuid","_cuid2","_ulid","_xid","_ksuid","_ipv4","_ipv6","_cidrv4","_cidrv6","_base64","_base64url","_e164","_jwt","_isoDateTime","_isoDate","_isoTime","_isoDuration","_number","_coercedNumber","_int","_boolean","_any","_unknown","_never","_lt","checks.$ZodCheckLessThan","_lte","_gt","checks.$ZodCheckGreaterThan","_gte","_multipleOf","checks.$ZodCheckMultipleOf","_maxLength","checks.$ZodCheckMaxLength","_minLength","checks.$ZodCheckMinLength","_length","checks.$ZodCheckLengthEquals","_regex","checks.$ZodCheckRegex","_lowercase","checks.$ZodCheckLowerCase","_uppercase","checks.$ZodCheckUpperCase","_includes","includes","checks.$ZodCheckIncludes","_startsWith","checks.$ZodCheckStartsWith","_endsWith","suffix","checks.$ZodCheckEndsWith","_overwrite","tx","checks.$ZodCheckOverwrite","_normalize","form","_trim","_toLowerCase","_toUpperCase","_slugify","util.slugify","_array","element","_custom","norm","_refine","_superRefine","_check","_issue","ZodISODateTime","core.$ZodISODateTime","schemas.ZodStringFormat","core._isoDateTime","ZodISODate","core.$ZodISODate","core._isoDate","ZodISOTime","core.$ZodISOTime","core._isoTime","ZodISODuration","core.$ZodISODuration","core._isoDuration","core.formatError","core.flattenError","ZodError","ZodRealError","parse","core._parse","parseAsync","core._parseAsync","core._safeParse","core._safeParseAsync","encode","core._encode","decode","core._decode","encodeAsync","core._encodeAsync","decodeAsync","core._decodeAsync","safeEncode","core._safeEncode","safeDecode","core._safeDecode","safeEncodeAsync","core._safeEncodeAsync","safeDecodeAsync","core._safeDecodeAsync","ZodType","core.$ZodType","util.mergeDefs","core.clone","reg","parse.parse","parse.safeParse","parse.parseAsync","parse.safeParseAsync","parse.encode","parse.decode","parse.encodeAsync","parse.decodeAsync","parse.safeEncode","parse.safeDecode","parse.safeEncodeAsync","parse.safeDecodeAsync","check","refine","refinement","superRefine","checks.overwrite","optional","nullable","nonoptional","array","union","intersection","pipe","transform","_default","prefault","_catch","readonly","description","core.globalRegistry","_ZodString","core.$ZodString","checks.regex","checks.includes","checks.startsWith","checks.endsWith","checks.minLength","checks.maxLength","checks.length","checks.lowercase","checks.uppercase","checks.trim","checks.normalize","checks.toLowerCase","checks.toUpperCase","checks.slugify","ZodString","core._email","ZodEmail","core._url","ZodURL","core._jwt","ZodJWT","core._emoji","ZodEmoji","core._guid","ZodGUID","core._uuid","ZodUUID","core._uuidv4","core._uuidv6","core._uuidv7","core._nanoid","ZodNanoID","core._cuid","ZodCUID","core._cuid2","ZodCUID2","core._ulid","ZodULID","core._base64","ZodBase64","core._base64url","ZodBase64URL","core._xid","ZodXID","core._ksuid","ZodKSUID","core._ipv4","ZodIPv4","core._ipv6","ZodIPv6","core._cidrv4","ZodCIDRv4","core._cidrv6","ZodCIDRv6","core._e164","ZodE164","iso.datetime","iso.date","iso.time","iso.duration","core._string","ZodStringFormat","core.$ZodStringFormat","core.$ZodEmail","core.$ZodGUID","core.$ZodUUID","core.$ZodURL","core.$ZodEmoji","core.$ZodNanoID","core.$ZodCUID","core.$ZodCUID2","core.$ZodULID","core.$ZodXID","core.$ZodKSUID","core.$ZodIPv4","core.$ZodIPv6","core.$ZodCIDRv4","core.$ZodCIDRv6","core.$ZodBase64","core.$ZodBase64URL","core.$ZodE164","core.$ZodJWT","ZodNumber","core.$ZodNumber","checks.gt","checks.gte","checks.lt","checks.lte","int","checks.multipleOf","core._number","ZodNumberFormat","core.$ZodNumberFormat","core._int","ZodBoolean","core.$ZodBoolean","core._boolean","ZodNull","core.$ZodNull","core._null","ZodAny","core.$ZodAny","any","core._any","ZodUnknown","core.$ZodUnknown","unknown","core._unknown","ZodNever","core.$ZodNever","never","core._never","ZodArray","core.$ZodArray","minLength","maxLength","len","core._array","ZodObject","core.$ZodObjectJIT","_enum","incoming","util.extend","util.safeExtend","other","util.merge","util.pick","util.omit","util.partial","ZodOptional","util.required","ZodNonOptional","looseObject","ZodUnion","core.$ZodUnion","ZodDiscriminatedUnion","core.$ZodDiscriminatedUnion","discriminatedUnion","discriminator","ZodIntersection","core.$ZodIntersection","ZodRecord","core.$ZodRecord","record","keyType","valueType","ZodEnum","core.$ZodEnum","newEntries","ZodLiteral","core.$ZodLiteral","literal","ZodTransform","core.$ZodTransform","core.$ZodOptional","innerType","ZodNullable","core.$ZodNullable","ZodDefault","core.$ZodDefault","defaultValue","util.shallowClone","ZodPrefault","core.$ZodPrefault","core.$ZodNonOptional","ZodCatch","core.$ZodCatch","catchValue","ZodPipe","core.$ZodPipe","in_","out","ZodReadonly","core.$ZodReadonly","ZodCustom","core.$ZodCustom","custom","core._custom","core._refine","core._superRefine","preprocess","ZodIssueCode","core._coercedNumber","schemas.ZodNumber","EnvSchema","z.object","z.coerce.number","z.string","z.boolean","__vite_import_meta_env__","BROWSEROS_PREFS","McpPortError","getMcpPort","getMcpServerUrl","getHealthCheckUrl","openSidePanel","toggleSidePanel","has","dequal","foo","bar","E_CANCELED","__awaiter$2","thisArg","_arguments","P","generator","adopt","fulfilled","rejected","Semaphore","_value","_cancelError","weight","priority","task","findIndexFromEnd","callback_1","release","insertSorted","entry","previousValue","called","waiters","waiter","queuedPriority","predicate","__awaiter$1","Mutex","cancelError","releaser","browser","storage","createStorage","drivers","createDriver","getDriver","area","driver","areaNames","resolveKey","deliminatorIndex","driverArea","driverKey","getMetaKey","mergeMeta","oldMeta","newMeta","newFields","getValueOrFallback","fallback","getMetaValue","getItem","res","getMeta","metaKey","setItem","setMeta","existingFields","removeItem","removeMeta","watch","cb","areaToKeyMap","keyToOptsMap","orderedKeys","keyStr","areaKeys","resultsMap","keys2","driverResult","areaToDriverMetaKeysMap","areaRes","items","areaToKeyValueMap","areaToMetaUpdatesMap","storageArea","updates","metaKeys","existingMetas","existingMetaMap","metaUpdates","areaToKeysMap","base","targetVersion","migrations","onMigrationComplete","debug","migrate","driverMetaKey","currentVersion","migrationsToRun","migratedValue","migrateToVersion","err","MigrationError","migrationsDone","initMutex","getFallback","getOrInitValue","newValue","opts2","oldValue","getStorageArea","watchListeners","map2","listener","changes","change","DEFAULT_PROVIDER_ID","providersStorage","backupToBrowserOS","backup","setupLlmProvidersBackupToBrowserOS","providers","defaultProviderId","defaultProviderIdStorage","isZ4Schema","s","z4mini.safeParse","getObjectShape","rawShape","getLiteralValue","directValue","LATEST_PROTOCOL_VERSION","SUPPORTED_PROTOCOL_VERSIONS","RELATED_TASK_META_KEY","JSONRPC_VERSION","AssertObjectSchema","z.custom","ProgressTokenSchema","z.union","z.number","CursorSchema","TaskCreationParamsSchema","z.looseObject","z.null","RelatedTaskMetadataSchema","RequestMetaSchema","BaseRequestParamsSchema","RequestSchema","NotificationsParamsSchema","z\n        .object","z.optional","NotificationSchema","ResultSchema","z\n        .looseObject","RequestIdSchema","JSONRPCRequestSchema","z\n    .object","z.literal","isJSONRPCRequest","JSONRPCNotificationSchema","isJSONRPCNotification","JSONRPCResponseSchema","isJSONRPCResponse","ErrorCode","JSONRPCErrorSchema","z.unknown","isJSONRPCError","JSONRPCMessageSchema","EmptyResultSchema","CancelledNotificationParamsSchema","CancelledNotificationSchema","IconSchema","z.array","IconsSchema","BaseMetadataSchema","ImplementationSchema","FormElicitationCapabilitySchema","z.intersection","z.record","ElicitationCapabilitySchema","z.preprocess","ClientTasksCapabilitySchema","z\n            .object","ServerTasksCapabilitySchema","ClientCapabilitiesSchema","InitializeRequestParamsSchema","InitializeRequestSchema","ServerCapabilitiesSchema","InitializeResultSchema","InitializedNotificationSchema","isInitializedNotification","PingRequestSchema","ProgressSchema","ProgressNotificationParamsSchema","ProgressNotificationSchema","PaginatedRequestParamsSchema","PaginatedRequestSchema","PaginatedResultSchema","TaskSchema","z.enum","CreateTaskResultSchema","TaskStatusNotificationParamsSchema","TaskStatusNotificationSchema","GetTaskRequestSchema","GetTaskResultSchema","GetTaskPayloadRequestSchema","ListTasksRequestSchema","ListTasksResultSchema","CancelTaskRequestSchema","CancelTaskResultSchema","ResourceContentsSchema","TextResourceContentsSchema","Base64Schema","BlobResourceContentsSchema","AnnotationsSchema","z.iso.datetime","ResourceSchema","ResourceTemplateSchema","ListResourcesRequestSchema","ListResourcesResultSchema","ListResourceTemplatesRequestSchema","ListResourceTemplatesResultSchema","ResourceRequestParamsSchema","ReadResourceRequestParamsSchema","ReadResourceRequestSchema","ReadResourceResultSchema","ResourceListChangedNotificationSchema","SubscribeRequestParamsSchema","SubscribeRequestSchema","UnsubscribeRequestParamsSchema","UnsubscribeRequestSchema","ResourceUpdatedNotificationParamsSchema","ResourceUpdatedNotificationSchema","PromptArgumentSchema","PromptSchema","ListPromptsRequestSchema","ListPromptsResultSchema","GetPromptRequestParamsSchema","GetPromptRequestSchema","TextContentSchema","ImageContentSchema","AudioContentSchema","ToolUseContentSchema","EmbeddedResourceSchema","ResourceLinkSchema","ContentBlockSchema","PromptMessageSchema","GetPromptResultSchema","PromptListChangedNotificationSchema","ToolAnnotationsSchema","ToolExecutionSchema","ToolSchema","ListToolsRequestSchema","ListToolsResultSchema","CallToolResultSchema","CallToolRequestParamsSchema","CallToolRequestSchema","ToolListChangedNotificationSchema","LoggingLevelSchema","SetLevelRequestParamsSchema","SetLevelRequestSchema","LoggingMessageNotificationParamsSchema","LoggingMessageNotificationSchema","ModelHintSchema","ModelPreferencesSchema","ToolChoiceSchema","ToolResultContentSchema","SamplingContentSchema","z.discriminatedUnion","SamplingMessageContentBlockSchema","SamplingMessageSchema","CreateMessageRequestParamsSchema","CreateMessageRequestSchema","CreateMessageResultSchema","CreateMessageResultWithToolsSchema","BooleanSchemaSchema","StringSchemaSchema","NumberSchemaSchema","UntitledSingleSelectEnumSchemaSchema","TitledSingleSelectEnumSchemaSchema","LegacyTitledEnumSchemaSchema","SingleSelectEnumSchemaSchema","UntitledMultiSelectEnumSchemaSchema","TitledMultiSelectEnumSchemaSchema","MultiSelectEnumSchemaSchema","EnumSchemaSchema","PrimitiveSchemaDefinitionSchema","ElicitRequestFormParamsSchema","ElicitRequestURLParamsSchema","ElicitRequestParamsSchema","ElicitRequestSchema","ElicitationCompleteNotificationParamsSchema","ElicitationCompleteNotificationSchema","ElicitResultSchema","ResourceTemplateReferenceSchema","PromptReferenceSchema","CompleteRequestParamsSchema","CompleteRequestSchema","CompleteResultSchema","RootSchema","ListRootsRequestSchema","ListRootsResultSchema","RootsListChangedNotificationSchema","McpError","errorData","UrlElicitationRequiredError","elicitations","isTerminal","getMethodLiteral","methodSchema","parseWithCompat","DEFAULT_REQUEST_TIMEOUT_MSEC","Protocol","_options","notification","_request","request","extra","handleTaskResult","taskId","queuedMessage","requestId","resolver","errorMessage","messageType","tasks","nextCursor","cancelledTask","controller","messageId","timeout","maxTotalTimeout","onTimeout","resetTimeoutOnProgress","info","totalElapsed","transport","_c","_onclose","_onerror","_onmessage","responseHandlers","handler","_d","_e","_f","capturedTransport","relatedTaskId","errorResponse","abortController","taskCreationParams","taskStore","fullExtra","notificationOptions","resultSchema","requestOptions","effectiveTaskId","response","progressToken","responseHandler","timeoutInfo","isTaskResponse","createResult","pollInterval","relatedRequestId","resumptionToken","onresumptiontoken","relatedTask","_g","earlyReject","jsonrpcRequest","cancel","reason","parseResult","timeoutHandler","responseResolver","jsonrpcNotification","requestSchema","parsed","notificationSchema","sessionId","maxQueueSize","messages","signal","interval","timeoutId","taskParams","statusMessage","updatedTask","cursor","mergeCapabilities","additional","addValue","baseValue","exports","_CodeOrName","Name","_Code","names","strs","addCodeArg","plus","expr","safeStringify","optimize","interpolate","mergeExprItems","strConcat","c1","c2","stringify","getProperty","getEsmExportName","regexpCode","rx","code_1","require$$0","ValueError","UsedValueState","Scope","prefixes","parent","nameOrPrefix","ng","ValueScopeName","nameStr","property","itemIndex","ValueScope","valueKey","vs","_name","keyOrRef","scopeName","usedValues","getCode","valueCode","nameSet","scope_1","require$$1","code_2","scope_2","Node","_names","_constants","Def","varKind","rhs","es5","_n","constants","optimizeExpr","Assign","lhs","sideEffects","addExprNames","AssignOp","op","Label","label","Break","Throw","AnyCode","ParentNode","nodes","n","subtractNames","addNames","BlockNode","Root","Else","If","condition","cond","ns","not","For","ForLoop","iteration","ForRange","from","to","ForIter","loop","iterable","Func","Return","Try","Catch","Finally","CodeGen","extScope","prefixOrName","constant","_constant","keyValues","thenBody","elseBody","node","forBody","arr","obj","tryBody","catchCode","finallyCode","body","nodeCount","toClose","funcBody","N1","N2","replaceName","canOptimize","par","andCode","mappend","and","orCode","or","util","codegen_1","toHash","hash","alwaysValidSchema","it","checkUnknownRules","schemaHasRules","self","rules","checkStrictMode","schemaHasRulesButRef","RULES","schemaRefOrVal","topSchemaRef","schemaPath","keyword","$data","unescapeFragment","unescapeJsonPointer","escapeFragment","escapeJsonPointer","eachItem","xs","makeMergeEvaluated","mergeNames","mergeToName","resultToName","gen","toName","setEvaluated","evaluatedPropsToName","ps","props","snippets","useFunc","Type","getErrorPath","dataProp","dataPropType","jsPropertySyntax","isNumber","msg","mode","names_1","util_1","require$$2","schemaType","reportError","cxt","errorPaths","overrideAllErrors","compositeRule","allErrors","errObj","errorObjectCode","addError","returnErrors","reportExtraError","resetErrorsCount","errsCount","extendErrors","schemaValue","errs","validateName","schemaEnv","E","createErrors","errorObject","errorInstancePath","errorSchemaPath","extraErrorProps","errorPath","instancePath","instPath","errSchemaPath","parentSchema","schPath","propertyName","boolSchema","errors_1","boolError","topBoolOrEmptySchema","falseSchemaError","boolOrEmptySchema","valid","_jsonTypes","jsonTypes","isJSONType","getRules","groups","applicability","schemaHasRulesForType","type","group","shouldUseGroup","rule","shouldUseRule","kwd","dataType","rules_1","applicability_1","require$$3","require$$4","DataType","getSchemaTypes","types","getJSONTypes","ts","coerceAndCheckDataType","coerceTo","coerceToTypes","checkTypes","wrongType","checkDataTypes","coerceData","reportTypeError","COERCIBLE","coerceTypes","coerced","coerceSpecificType","assignParentData","parentData","parentDataProperty","checkDataType","strictNums","correct","EQ","numCond","_cond","dataTypes","notObj","typeError","getTypeErrorContext","schemaCode","defaults","assignDefaults","ty","assignDefault","sch","childData","util_2","checkReportMissingProp","noPropertyInData","checkMissingProp","missing","reportMissingProp","hasPropFunc","isOwnProperty","propertyInData","ownProperties","allSchemaProperties","schemaMap","schemaProperties","callValidateCode","func","context","passSchema","dataAndSchema","valCxt","newRegExp","usePattern","u","regExp","validateArray","validArr","validateItems","notValid","validateUnion","schValid","_sch","schCxt","macroKeywordCode","macroSchema","schemaRef","useKeyword","funcKeywordCode","checkAsyncKeyword","validate","validateRef","validateKeyword","assignValid","modifyData","reportErrs","ruleErrs","validateAsync","validateSync","addErrs","validateErrs","_await","passCxt","errors","validSchemaType","allowUndefined","st","validateKeywordUsage","deps","subschema","getSubschema","schemaProp","extendSubschemaData","dpType","dataPathArr","nextData","dataContextProps","_nextData","extendSubschemaMode","jtdDiscriminator","jtdMetadata","fastDeepEqual","equal","traverse","jsonSchemaTraverseModule","pre","post","_traverse","jsonPtr","rootSchema","parentJsonPtr","parentKeyword","keyIndex","escapeJsonPtr","SIMPLE_INLINED","inlineRef","limit","hasRef","countKeys","REF_KEYWORDS","count","getFullPath","normalize","normalizeId","_getFullPath","TRAILING_SLASH_HASH","resolveUrl","baseId","ANCHOR","getSchemaRefs","schemaId","uriResolver","schId","baseIds","pathPrefix","localRefs","schemaRefs","fullPath","innerBaseId","addRef","addAnchor","ref","_resolve","ambiguos","schOrRef","checkAmbiguosRef","anchor","sch1","sch2","boolSchema_1","dataType_1","dataType_2","defaults_1","keyword_1","subschema_1","require$$5","require$$6","require$$7","resolve_1","require$$8","require$$9","require$$10","validateFunctionCode","isSchemaObj","checkKeywords","schemaCxtHasRules","topSchemaObjCode","validateFunction","funcSourceUrl","destructureValCxtES5","destructureValCxt","commentKeyword","checkNoDefault","resetEvaluated","typeAndKeywords","returnResults","subschemaCode","subSchemaObjCode","updateContext","checkAsyncSchema","checkRefsAndKeywords","schemaKeywords","checkedTypes","rootName","ValidationError","assignEvaluated","evaluated","typeErrors","keywordCode","checkStrictTypes","groupKeywords","iterateKeywords","useDefaults","checkContextTypes","checkMultipleTypes","checkKeywordTypes","includesType","strictTypesError","narrowSchemaTypes","hasApplicableType","schTs","kwdT","withTypes","KeywordCxt","getData","successAction","failAction","append","errorParams","assign","codeBlock","$dataValid","wrong$DataType","invalid$DataSchema","validateSchemaRef","appl","nextContext","schemaCxt","ruleType","JSON_POINTER","RELATIVE_JSON_POINTER","dataLevel","dataNames","jsonPointer","matches","up","errorMsg","segments","segment","pointerType","validation_error","ref_error","MissingRefError","compile","validation_error_1","validate_1","SchemaEnv","env","compileSchema","getCompilingSchema","rootId","_ValidationError","sourceCode","validateCode","resolveRef","root","schOrFunc","inlineOrCompile","schEnv","sameSchemaEnv","s1","s2","resolveSchema","refPath","getJsonPointer","PREVENT_SCOPE_CHANGE","parsedRef","part","partSchema","$ref","isUUID","isIPv4","stringArrayToHexStripped","acc","nonSimpleDomain","consumeIsZone","buffer","consumeHextets","hex","getIPV6","tokenCount","endipv6Encountered","endIpv6","consume","normalizeIPv6","host","findToken","newHost","escapedHost","ind","removeDotSegments","nextSlash","normalizeComponentEncoding","component","recomposeAuthority","uriTokens","ipV6res","utils","URN_REG","supportedSchemeNames","isValidSchemeName","wsIsSecure","wsComponent","httpParse","httpSerialize","secure","wsParse","wsSerialize","query","urnParse","urnComponent","scheme","urnScheme","schemeHandler","getSchemeHandler","urnSerialize","nid","uriComponent","nss","urnuuidParse","uuidComponent","urnuuidSerialize","http","https","ws","wss","SCHEMES","schemes","uri","serialize","baseURI","relativeURI","schemelessOptions","resolved","resolveComponent","relative","skipNormalization","uriA","uriB","cmpts","authority","URI_PARSE","isIP","ipv6result","fastUri","fastUriModule","uri_1","ref_error_1","compile_1","codegen_2","$dataRefSchema","defaultRegExp","flags","META_IGNORE_OPTIONS","EXT_SCOPE_NAMES","removedOptions","deprecatedOptions","MAX_EXPRESSION","requiredOptions","_h","_j","_k","_l","_m","_o","_p","_q","_r","_s","_t","_u","_v","_w","_x","_y","_z","_0","_optz","Ajv","getLogger","formatOpt","checkOptions","getMetaSchemaOptions","addInitialFormats","addInitialKeywords","addInitialSchemas","_dataRefSchema","schemaKeyRef","loadSchema","runCompileAsync","_schema","loadMetaSchema","_compileAsync","checkLoaded","loadMissingSchema","missingRef","_loadSchema","_validateSchema","throwOrLogError","$schema","keyRef","getSchEnv","cacheKey","definitions","kwdOrDef","checkKeyword","addRule","keywordMetaschema","definition","format","separator","dataVar","metaSchema","keywordsJsonPointers","keywords","seg","schemaOrData","schemas","validateSchema","addSchema","currentOpts","checkOpts","log","optsSchemas","metaOpts","noLogs","logger","KEYWORD_NAME","ruleGroup","addBeforeRule","before","_rule","$dataRef","callRootRef","schOrEnv","callValidate","inlineRefSchema","callRef","getValidate","schName","$async","callAsyncRef","callSyncRef","addEvaluatedFrom","addErrorsFrom","schEvaluated","core_1","id_1","ref_1","core","limitNumber","ops","KWDs","multipleOf","prec","invalid","ucs2length_1","ucs2length","pos","limitLength","comp","limitProperties","missingProperty","useLoop","allErrorsMode","exitOnErrorMode","definedProperties","requiredKey","loopAllRequired","loopUntilMissing","limitItems","equal_1","uniqueItems","j","itemTypes","validateUniqueItems","loopN","loopN2","indices","eql","outer","_const","getEql","loopEnum","vSchema","equalCode","validation_1","limitNumber_1","multipleOf_1","limitLength_1","pattern_1","limitProperties_1","required_1","limitItems_1","uniqueItems_1","const_1","enum_1","validation","additionalItems","validateAdditionalItems","validateTuple","extraItems","schArr","checkStrictTuple","l","fullTuple","prefixItems","items_1","items2020","additionalItems_1","contains","min","max","minContains","maxContains","validateItemsWithCount","checkLimits","_valid","block","depsCount","property_ies","propDeps","schDeps","splitDependencies","validatePropertyDeps","validateSchemaDeps","propertyDeps","schemaDeps","hasProperty","depProp","propertyNames","additionalProperties","patProps","checkAdditionalProperties","additionalPropertyCode","isAdditional","definedProp","propsSchema","deleteAdditional","applyAdditionalSchema","additionalProperties_1","allProps","hasDefault","applyPropertySchema","patternProperties","alwaysValidPatterns","checkProperties","validatePatternProperties","pat","checkMatchingProperties","validateProperties","alwaysValid","anyOf","oneOf","passing","validateOneOf","allOf","_if","hasThen","hasSchema","hasElse","validateIf","ifClause","validateClause","thenElse","applicator","prefixItems_1","items2020_1","contains_1","dependencies_1","propertyNames_1","properties_1","patternProperties_1","not_1","anyOf_1","require$$11","oneOf_1","require$$12","allOf_1","require$$13","if_1","require$$14","thenElse_1","require$$15","getApplicator","draft2020","validate$DataFormat","validateFormat","fmts","fDef","fType","unknownFmt","invalidFmt","callFormat","validData","formatDef","unknownFormat","fmtType","fmtRef","getFormat","validCondition","unknownMsg","fmtDef","fmt","format_2","metadata","draft7","applicator_1","format_1","metadata_1","draft7Vocabularies","DiscrError","types_1","discrError","tagName","tag","validateMapping","mapping","getMapping","tagValue","applyTagSchema","oneOfMapping","topRequired","hasRequired","tagRequired","propSch","addMappings","addMapping","draft7_1","discriminator_1","draft7MetaSchema","META_SUPPORT_DATA","META_SCHEMA_ID","module","compare","compareDate","getTime","compareTime","getDateTime","compareDateTime","compareIsoTime","compareIsoDateTime","byte","validateInt32","validateInt64","validateNumber","isLeapYear","year","DATE","DAYS","month","day","d1","d2","TIME","strictTimeZone","hr","sec","tz","tzSign","tzH","tzM","utcMin","utcHr","t1","t2","a1","a2","DATE_TIME_SEPARATOR","dateTime","dt1","dt2","NOT_URI_FRAGMENT","URI","BYTE","MIN_INT32","MAX_INT32","Z_ANCHOR","ajv_1","fCxt","compareCode","formatLimitPlugin","ajv","formats_1","limit_1","fullName","fastName","formatsPlugin","addFormats","formats","exportName","list","fs","createDefaultAjvInstance","_addFormats","AjvJsonSchemaValidator","ajvValidator","ExperimentalClientTasks","_client","clientInternal","optionsWithTask","stream","validator","validationResult","assertToolsCallTaskCapability","requests","entityName","assertClientRequestTaskCapability","applyElicitationDefaults","propSchema","getSupportedElicitationModes","capabilities","hasFormCapability","hasUrlCapability","Client","_clientInfo","methodValue","v4Schema","v4Def","v3Schema","legacyDef","wrappedHandler","validatedRequest","supportsFormMode","supportsUrlMode","taskValidationResult","validatedResult","requestedSchema","capability","level","toolName","tools","tool","toolValidator","taskSupport","normalizeHeaders","headers","createFetchWithInit","baseFetch","baseInit","mergedInit","crypto","getRandomValues","random","evenDistCutoff","randomBytes","randomByte","generateVerifier","generateChallenge","code_verifier","pkceChallenge","verifier","challenge","SafeUrlSchema","z\n    .url","z.ZodIssueCode","z.NEVER","OAuthProtectedResourceMetadataSchema","OAuthMetadataSchema","OpenIdProviderMetadataSchema","OpenIdProviderDiscoveryMetadataSchema","OAuthTokensSchema","OAuthErrorResponseSchema","OptionalSafeUrlSchema","OAuthClientMetadataSchema","z.any","OAuthClientInformationSchema","OAuthClientInformationFullSchema","resourceUrlFromServerUrl","resourceURL","checkResourceAllowed","requestedResource","configuredResource","requested","configured","requestedPath","configuredPath","OAuthError","errorUri","InvalidRequestError","InvalidClientError","InvalidGrantError","UnauthorizedClientError","UnsupportedGrantTypeError","InvalidScopeError","AccessDeniedError","ServerError","TemporarilyUnavailableError","UnsupportedResponseTypeError","UnsupportedTokenTypeError","InvalidTokenError","MethodNotAllowedError","TooManyRequestsError","InvalidClientMetadataError","InsufficientScopeError","InvalidTargetError","OAUTH_ERRORS","UnauthorizedError","isClientAuthMethod","AUTHORIZATION_CODE_RESPONSE_TYPE","AUTHORIZATION_CODE_CHALLENGE_METHOD","selectClientAuthMethod","clientInformation","supportedMethods","hasClientSecret","applyClientAuthentication","client_id","client_secret","applyBasicAuth","applyPostAuth","applyPublicAuth","clientId","clientSecret","credentials","parseErrorResponse","statusCode","error_description","error_uri","errorClass","auth","provider","authInternal","serverUrl","authorizationCode","scope","resourceMetadataUrl","fetchFn","resourceMetadata","authorizationServerUrl","discoverOAuthProtectedResourceMetadata","resource","selectResourceURL","discoverAuthorizationServerMetadata","supportsUrlBasedClientId","clientMetadataUrl","isHttpsUrl","fullInformation","registerClient","nonInteractiveFlow","tokens","fetchToken","newTokens","refreshAuthorization","state","authorizationUrl","codeVerifier","startAuthorization","defaultResource","extractWWWAuthenticateParams","authenticateHeader","resourceMetadataMatch","extractFieldFromWwwAuth","fieldName","wwwAuthHeader","discoverMetadataWithFallback","fetchWithCorsRetry","buildWellKnownPath","wellKnownPrefix","pathname","tryMetadataDiscovery","protocolVersion","shouldAttemptFallback","wellKnownType","issuer","wellKnownPath","rootUrl","buildDiscoveryUrls","hasPath","urlsToTry","endpointUrl","redirectUrl","codeChallenge","prepareAuthorizationCodeRequest","redirectUri","executeTokenRequest","tokenRequestParams","addClientAuthentication","tokenUrl","authMethod","refreshToken","clientMetadata","registrationUrl","ParseError","noop","_arg","createParser","callbacks","onEvent","onError","onRetry","onComment","incompleteLine","isFirstChunk","eventType","feed","newChunk","chunk","complete","incomplete","splitLines","parseLine","dispatchEvent","fieldSeparatorIndex","offset","processField","reset","searchIndex","crIndex","lfIndex","lineEnd","EventSourceParserStream","parser","event","DEFAULT_STREAMABLE_HTTP_RECONNECTION_OPTIONS","StreamableHTTPError","StreamableHTTPClientTransport","extraHeaders","attempt","initialDelay","growFactor","maxDelay","attemptCount","maxRetries","delay","isReconnectable","replayMessageId","lastEventId","hasPrimingEvent","receivedResponse","reader","retryMs","done","hasRequests","contentType","responseMessages","fetchMcpTools","client","constructor","errorConstructors","NonError","commonProperties","toJsonWasCalled","toJSON","json","getErrorConstructor","destroyCircular","seen","forceEnumerable","maxDepth","depth","useToJSON","isErrorLike","Error","continueDestroyCircular","enumerable","serializeError","deserializeError","isMinimumViableSerializedError","__defProp","__defProps","__getOwnPropDescs","__getOwnPropSymbols","__hasOwnProp","__propIsEnum","__defNormalProp","__spreadValues","__spreadProps","__async","__this","__arguments","defineGenericMessanging","removeRootListener","perTypeListeners","cleanupRootListener","idSeq","getNextId","_a2","_message","onReceived","_a3","_b2","res2","_a4","_b3","global","factory","this","CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE","wrapAPIs","extensionAPIs","apiMetadata","DefaultWeakMap","createItem","isThenable","makeCallback","promise","callbackArgs","pluralizeArguments","numArgs","wrapAsyncFunction","cbError","wrapMethod","wrapper","targetMethod","thisObj","hasOwnProperty","wrapObject","wrappers","cache","handlers","proxyTarget","receiver","desc","wrapEvent","wrapperMap","onRequestFinishedWrappers","req","wrappedReq","onMessageWrappers","sender","sendResponse","didCallSendResponse","wrappedSendResponse","sendResponsePromise","isResultThenable","sendPromisedResult","wrappedSendMessageCallback","reply","wrappedSendMessage","apiNamespaceObj","wrappedCb","staticWrappers","settingMetadata","defineExtensionMessaging","Browser","processMessage","onMessage","searchActionsStorage","tab","onOpenSidePanelWithSearch","messageData","currentTab","opened","details","onServerMessage"],"mappings":"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","x_google_ignoreList":[0,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,24,25,26,27,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,118,119,120,121,122]}