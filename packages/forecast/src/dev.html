<!DOCTYPE html>
<html>

<head>
    <title>Forecast: EO Decisions (DEV)</title>
    <link rel="stylesheet" href="styles/main.css">
    <!-- Google Fonts Optimization -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0"
        rel="stylesheet">

    <!-- MOCKS FOR LOCAL DEVELOPMENT -->
    <script src="dev-mocks.js"></script>

    <!-- Suppress Google Maps Deprecation Warning (Clean Console) -->
    <script>
        const originalWarn = console.warn;
        console.warn = function (...args) {
            if (args[0] && typeof args[0] === 'string' && args[0].includes('google.maps.places.Autocomplete is not available')) {
                return; // Suppress this specific warning
            }
            originalWarn.apply(console, args);
        };
    </script>

    <!-- Async Map Initialization -->
    <script>
        window.initMap = function () {
            // Dispatch event for popup.js
            document.dispatchEvent(new Event('google-maps-loaded'));
        };
    </script>

    <!-- Google Maps API for Autocomplete (Dev Only) -->
    <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBp7r2D1nmfSnKysVgJjLOpeEQ7KAQkp2E&libraries=places&loading=async&callback=initMap"></script>

    <!-- Google Maps Extended Component Library (Local) -->
    <script type="module" src="libs/google_maps_extended.js"></script>
</head>

<body>
    <!-- Full Screen Map Background -->
    <!-- Full Screen Map Background (Sandboxed) -->
    <iframe id="map-frame" src="sandbox.html"
        style="position:absolute; top:0; left:0; width:100%; height:100%; border:none; z-index:0;"></iframe>

    <!-- Floating UI Layer -->
    <div id="ui-layer">

        <!-- Top Left Search -->
        <div class="search-container">
            <div class="search-box card-shadow">
                <span class="search-icon material-symbols-outlined">search</span>
                <input type="text" id="location-search" placeholder="Search Kenya counties..." aria-label="Search">
                <span class="search-separator"></span>
                <button class="search-btn date-picker-btn" id="date-picker-btn">
                    <span class="material-symbols-outlined"
                        style="font-size: 20px; margin-right: 6px;">calendar_today</span>
                    <span id="date-display">Dec 22, 2025</span>
                </button>
                <input type="date" id="date-input"
                    style="position: absolute; opacity: 0; pointer-events: none; bottom: 0;">
            </div>
        </div>

        <!-- Filter Chips (EO Metrics) -->
        <div class="filter-chips-container">
            <button class="chip-btn"><span class="material-symbols-outlined">eco</span>Vegetation Health
                Score</button>
            <button class="chip-btn"><span class="material-symbols-outlined">flood</span>Flood Risk Index</button>
            <button class="chip-btn"><span class="material-symbols-outlined">air</span>Air Quality Level</button>
            <button class="chip-btn"><span class="material-symbols-outlined">thermostat</span>Urban Heat
                Level</button>
            <button class="chip-btn"><span class="material-symbols-outlined">water_drop</span>Water
                Availability</button>
        </div>

        <!-- Left Side Panel (Insights) -->
        <div class="side-panel card-shadow" id="side-panel">
            <div class="panel-header">
                <h2>Did You Know?</h2>
                <button class="close-btn material-symbols-outlined">close</button>
            </div>
            <div id="insight-content">
                <div class="empty-state">
                    <span class="material-symbols-outlined"
                        style="font-size: 48px; opacity: 0.5; margin-bottom: 12px; color: #1a73e8;">satellite_alt</span>
                    <p>Search for a location (e.g., "Kitui") to see Earth Observation insights.</p>
                </div>
            </div>
        </div>

        <!-- Bottom Timeline Floating -->
        <div class="timeline-floating card-shadow">
            <div id="time-slider-container"></div>
        </div>

    </div>
    <!-- Map Legend (Floating) -->
    <div id="map-legend" class="map-legend hidden">
        <div class="legend-header">
            <span id="legend-title">VEGETATION</span>
            <span id="legend-source">NASA MODIS</span>
        </div>
        <div class="legend-bar" id="legend-gradient"></div>
        <div class="legend-labels">
            <span id="legend-min">Low</span>
            <span id="legend-max">High</span>
        </div>
    </div>

    <script type="module" src="popup.js"></script>
</body>

</html>